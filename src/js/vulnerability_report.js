let parse_query_string = function () {
  let query = window.location.search.substring(1);
  // Based on: http://stackoverflow.com/questions/8486099/how-do-i-parse-a-url-query-parameters-in-javascript
  var result = {};
  query.split("&").forEach(function (part) {
    if (part) {
      var item = part.split("=");
      var key = item[0];
      var val = decodeURIComponent(item[1]);
      var from = key.indexOf("[");
      if (from === -1) {
        result[key] = val;
      } else {
        var to = key.indexOf("]");
        var index = key.substring(from + 1, to);
        key = key.substring(0, from);
        if (!result[key]) {
          result[key] = [];
        }
        if (!index) {
          result[key].push(val);
        } else {
          result[key][index] = val;
        }
      }
    }
  });
  return result;
};
let query_parameters = parse_query_string();
let TOWNS = [
  {name: "Abington",uid: 25023, county: 'Plymouth'},
  {name: "Acton",uid: 25017, county: 'Middlesex'},
  {name: "Acushnet",uid: 25005, county: 'Bristol'},
  {name: "Adams",uid: 25003, county: 'Berkshire'},
  {name: "Agawam",uid: 25013, county: 'Hampden'},
  {name: "Alford",uid: 25003, county: 'Berkshire'},
  {name: "Amesbury",uid: 25009, county: 'Essex'},
  {name: "Amherst",uid: 25015, county: 'Hampshire'},
  {name: "Andover",uid: 25009, county: 'Essex'},
  {name: "Aquinnah",uid: 25007, county: 'Dukes'},
  {name: "Arlington",uid: 25017, county: 'Middlesex'},
  {name: "Ashburnham",uid: 25027, county: 'Worcester'},
  {name: "Ashby",uid: 25017, county: 'Middlesex'},
  {name: "Ashfield",uid: 25011, county: 'Franklin'},
  {name: "Ashland",uid: 25017, county: 'Middlesex'},
  {name: "Athol",uid: 25027, county: 'Worcester'},
  {name: "Attleboro",uid: 25005, county: 'Bristol'},
  {name: "Auburn",uid: 25027, county: 'Worcester'},
  {name: "Avon",uid: 25021, county: 'Norfolk'},
  {name: "Ayer",uid: 25017, county: 'Middlesex'},
  {name: "Barnstable",uid: 25001, county: 'Barnstable'},
  {name: "Barre",uid: 25027, county: 'Worcester'},
  {name: "Becket",uid: 25003, county: 'Berkshire'},
  {name: "Bedford",uid: 25017, county: 'Middlesex'},
  {name: "Belchertown",uid: 25015, county: 'Hampshire'},
  {name: "Bellingham",uid: 25021, county: 'Norfolk'},
  {name: "Belmont",uid: 25017, county: 'Middlesex'},
  {name: "Berkley",uid: 25005, county: 'Bristol'},
  {name: "Berlin",uid: 25027, county: 'Worcester'},
  {name: "Bernardston",uid: 25011, county: 'Franklin'},
  {name: "Beverly",uid: 25009, county: 'Essex'},
  {name: "Billerica",uid: 25017, county: 'Middlesex'},
  {name: "Blackstone",uid: 25027, county: 'Worcester'},
  {name: "Blandford",uid: 25013, county: 'Hampden'},
  {name: "Bolton",uid: 25027, county: 'Worcester'},
  {name: "Boston",uid: 25025, county: 'Suffolk'},
  {name: "Bourne",uid: 25001, county: 'Barnstable'},
  {name: "Boxborough",uid: 25017, county: 'Middlesex'},
  {name: "Boxford",uid: 25009, county: 'Essex'},
  {name: "Boylston",uid: 25027, county: 'Worcester'},
  {name: "Braintree",uid: 25021, county: 'Norfolk'},
  {name: "Brewster",uid: 25001, county: 'Barnstable'},
  {name: "Bridgewater",uid: 25023, county: 'Plymouth'},
  {name: "Brimfield",uid: 25013, county: 'Hampden'},
  {name: "Brockton",uid: 25023, county: 'Plymouth'},
  {name: "Brookfield",uid: 25027, county: 'Worcester'},
  {name: "Brookline",uid: 25021, county: 'Norfolk'},
  {name: "Buckland",uid: 25011, county: 'Franklin'},
  {name: "Burlington",uid: 25017, county: 'Middlesex'},
  {name: "Cambridge",uid: 25017, county: 'Middlesex'},
  {name: "Canton",uid: 25021, county: 'Norfolk'},
  {name: "Carlisle",uid: 25017, county: 'Middlesex'},
  {name: "Carver",uid: 25023, county: 'Plymouth'},
  {name: "Charlemont",uid: 25011, county: 'Franklin'},
  {name: "Charlton",uid: 25027, county: 'Worcester'},
  {name: "Chatham",uid: 25001, county: 'Barnstable'},
  {name: "Chelmsford",uid: 25017, county: 'Middlesex'},
  {name: "Chelsea",uid: 25025, county: 'Suffolk'},
  {name: "Cheshire",uid: 25003, county: 'Berkshire'},
  {name: "Chester",uid: 25013, county: 'Hampden'},
  {name: "Chesterfield",uid: 25015, county: 'Hampshire'},
  {name: "Chicopee",uid: 25013, county: 'Hampden'},
  {name: "Chilmark",uid: 25007, county: 'Dukes'},
  {name: "Clarksburg",uid: 25003, county: 'Berkshire'},
  {name: "Clinton",uid: 25027, county: 'Worcester'},
  {name: "Cohasset",uid: 25021, county: 'Norfolk'},
  {name: "Colrain",uid: 25011, county: 'Franklin'},
  {name: "Concord",uid: 25017, county: 'Middlesex'},
  {name: "Conway",uid: 25011, county: 'Franklin'},
  {name: "Cummington",uid: 25015, county: 'Hampshire'},
  {name: "Dalton",uid: 25003, county: 'Berkshire'},
  {name: "Danvers",uid: 25009, county: 'Essex'},
  {name: "Dartmouth",uid: 25005, county: 'Bristol'},
  {name: "Dedham",uid: 25021, county: 'Norfolk'},
  {name: "Deerfield",uid: 25011, county: 'Franklin'},
  {name: "Dennis",uid: 25001, county: 'Barnstable'},
  {name: "Dighton",uid: 25005, county: 'Bristol'},
  {name: "Douglas",uid: 25027, county: 'Worcester'},
  {name: "Dover",uid: 25021, county: 'Norfolk'},
  {name: "Dracut",uid: 25017, county: 'Middlesex'},
  {name: "Dudley",uid: 25027, county: 'Worcester'},
  {name: "Dunstable",uid: 25017, county: 'Middlesex'},
  {name: "Duxbury",uid: 25023, county: 'Plymouth'},
  {name: "East Bridgewater", uid: 25023, county: 'Plymouth'},
  {name: "East Brookfield", uid: 25027, county: 'Worcester'},
  {name: "East Longmeadow", uid: 25013, county: 'Hampden'},
  {name: "Eastham",uid: 25001, county: 'Barnstable'},
  {name: "Easthampton",uid: 25015, county: 'Hampshire'},
  {name: "Easton",uid: 25005, county: 'Bristol'},
  {name: "Edgartown",uid: 25007, county: 'Dukes'},
  {name: "Egremont",uid: 25003, county: 'Berkshire'},
  {name: "Erving",uid: 25011, county: 'Franklin'},
  {name: "Essex",uid: 25009, county: 'Essex'},
  {name: "Everett",uid: 25017, county: 'Middlesex'},
  {name: "Fairhaven",uid: 25005, county: 'Bristol'},
  {name: "Fall River", uid: 25005, county: 'Bristol'},
  {name: "Falmouth",uid: 25001, county: 'Barnstable'},
  {name: "Fitchburg",uid: 25027, county: 'Worcester'},
  {name: "Florida",uid: 25003, county: 'Berkshire'},
  {name: "Foxborough",uid: 25021, county: 'Norfolk'},
  {name: "Framingham",uid: 25017, county: 'Middlesex'},
  {name: "Franklin",uid: 25021, county: 'Norfolk'},
  {name: "Freetown",uid: 25005, county: 'Bristol'},
  {name: "Gardner",uid: 25027, county: 'Worcester'},
  {name: "Georgetown",uid: 25009, county: 'Essex'},
  {name: "Gill",uid: 25011, county: 'Franklin'},
  {name: "Gloucester",uid: 25009, county: 'Essex'},
  {name: "Goshen",uid: 25015, county: 'Hampshire'},
  {name: "Gosnold",uid: 25007, county: 'Dukes'},
  {name: "Grafton",uid: 25027, county: 'Worcester'},
  {name: "Granby",uid: 25015, county: 'Hampshire'},
  {name: "Granville",uid: 25013, county: 'Hampden'},
  {name: "Great Barrington", uid: 25003, county: 'Berkshire'},
  {name: "Greenfield",uid: 25011, county: 'Franklin'},
  {name: "Groton",uid: 25017, county: 'Middlesex'},
  {name: "Groveland",uid: 25009, county: 'Essex'},
  {name: "Hadley",uid: 25015, county: 'Hampshire'},
  {name: "Halifax",uid: 25023, county: 'Plymouth'},
  {name: "Hamilton",uid: 25009, county: 'Essex'},
  {name: "Hampden",uid: 25013, county: 'Hampden'},
  {name: "Hancock",uid: 25003, county: 'Berkshire'},
  {name: "Hanover",uid: 25023, county: 'Plymouth'},
  {name: "Hanson",uid: 25023, county: 'Plymouth'},
  {name: "Hardwick",uid: 25027, county: 'Worcester'},
  {name: "Harvard",uid: 25027, county: 'Worcester'},
  {name: "Harwich",uid: 25001, county: 'Barnstable'},
  {name: "Hatfield",uid: 25015, county: 'Hampshire'},
  {name: "Haverhill",uid: 25009, county: 'Essex'},
  {name: "Hawley",uid: 25011, county: 'Franklin'},
  {name: "Heath",uid: 25011, county: 'Franklin'},
  {name: "Hingham",uid: 25023, county: 'Plymouth'},
  {name: "Hinsdale",uid: 25003, county: 'Berkshire'},
  {name: "Holbrook",uid: 25021, county: 'Norfolk'},
  {name: "Holden",uid: 25027, county: 'Worcester'},
  {name: "Holland",uid: 25013, county: 'Hampden'},
  {name: "Holliston",uid: 25017, county: 'Middlesex'},
  {name: "Holyoke",uid: 25013, county: 'Hampden'},
  {name: "Hopedale",uid: 25027, county: 'Worcester'},
  {name: "Hopkinton",uid: 25017, county: 'Middlesex'},
  {name: "Hubbardston",uid: 25027, county: 'Worcester'},
  {name: "Hudson",uid: 25017, county: 'Middlesex'},
  {name: "Hull",uid: 25023, county: 'Plymouth'},
  {name: "Huntington",uid: 25015, county: 'Hampshire'},
  {name: "Ipswich",uid: 25009, county: 'Essex'},
  {name: "Kingston",uid: 25023, county: 'Plymouth'},
  {name: "Lakeville",uid: 25023, county: 'Plymouth'},
  {name: "Lancaster",uid: 25027, county: 'Worcester'},
  {name: "Lanesborough",uid: 25003, county: 'Berkshire'},
  {name: "Lawrence",uid: 25009, county: 'Essex'},
  {name: "Lee",uid: 25003, county: 'Berkshire'},
  {name: "Leicester",uid: 25027, county: 'Worcester'},
  {name: "Lenox",uid: 25003, county: 'Berkshire'},
  {name: "Leominster",uid: 25027, county: 'Worcester'},
  {name: "Leverett",uid: 25011, county: 'Franklin'},
  {name: "Lexington",uid: 25017, county: 'Middlesex'},
  {name: "Leyden",uid: 25011, county: 'Franklin'},
  {name: "Lincoln",uid: 25017, county: 'Middlesex'},
  {name: "Littleton",uid: 25017, county: 'Middlesex'},
  {name: "Longmeadow",uid: 25013, county: 'Hampden'},
  {name: "Lowell",uid: 25017, county: 'Middlesex'},
  {name: "Ludlow",uid: 25013, county: 'Hampden'},
  {name: "Lunenburg",uid: 25027, county: 'Worcester'},
  {name: "Lynn",uid: 25009, county: 'Essex'},
  {name: "Lynnfield",uid: 25009, county: 'Essex'},
  {name: "Malden",uid: 25017, county: 'Middlesex'},
  {name: "Manchester",uid: 25009, county: 'Essex'},
  {name: "Mansfield",uid: 25005, county: 'Bristol'},
  {name: "Marblehead",uid: 25009, county: 'Essex'},
  {name: "Marion",uid: 25023, county: 'Plymouth'},
  {name: "Marlborough",uid: 25017, county: 'Middlesex'},
  {name: "Marshfield",uid: 25023, county: 'Plymouth'},
  {name: "Mashpee",uid: 25001, county: 'Barnstable'},
  {name: "Mattapoisett",uid: 25023, county: 'Plymouth'},
  {name: "Maynard",uid: 25017, county: 'Middlesex'},
  {name: "Medfield",uid: 25021, county: 'Norfolk'},
  {name: "Medford",uid: 25017, county: 'Middlesex'},
  {name: "Medway",uid: 25021, county: 'Norfolk'},
  {name: "Melrose",uid: 25017, county: 'Middlesex'},
  {name: "Mendon",uid: 25027, county: 'Worcester'},
  {name: "Merrimac",uid: 25009, county: 'Essex'},
  {name: "Methuen",uid: 25009, county: 'Essex'},
  {name: "Middleborough",uid: 25023, county: 'Plymouth'},
  {name: "Middlefield",uid: 25015, county: 'Hampshire'},
  {name: "Middleton",uid: 25009, county: 'Essex'},
  {name: "Milford",uid: 25027, county: 'Worcester'},
  {name: "Millbury",uid: 25027, county: 'Worcester'},
  {name: "Millis",uid: 25021, county: 'Norfolk'},
  {name: "Millville",uid: 25027, county: 'Worcester'},
  {name: "Milton",uid: 25021, county: 'Norfolk'},
  {name: "Monroe",uid: 25011, county: 'Franklin'},
  {name: "Monson",uid: 25013, county: 'Hampden'},
  {name: "Montague",uid: 25011, county: 'Franklin'},
  {name: "Monterey",uid: 25003, county: 'Berkshire'},
  {name: "Montgomery",uid: 25013, county: 'Hampden'},
  {name: "Mount Washington", uid: 25003, county: 'Berkshire'},
  {name: "Nahant",uid: 25009, county: 'Essex'},
  {name: "Nantucket",uid: 25019, county: 'Nantucket'},
  {name: "Natick",uid: 25017, county: 'Middlesex'},
  {name: "Needham",uid: 25021, county: 'Norfolk'},
  {name: "New Ashford", uid: 25003, county: 'Berkshire'},
  {name: "New Bedford", uid: 25005, county: 'Bristol'},
  {name: "New Braintree", uid: 25027, county: 'Worcester'},
  {name: "New Marlborough", uid: 25003, county: 'Berkshire'},
  {name: "New Salem", uid: 25011,  county: 'Franklin'},
  {name: "Newbury",uid: 25009, county: 'Essex'},
  {name: "Newburyport",uid: 25009, county: 'Essex'},
  {name: "Newton",uid: 25017, county: 'Middlesex'},
  {name: "Norfolk",uid: 25021, county: 'Norfolk'},
  {name: "North Adams", uid: 25003, county:  'Berkshire'},
  {name: "North Andover", uid: 25009, county: 'Essex'},
  {name: "North Attleborough", uid: 25005, county: 'Bristol'},
  {name: "North Brookfield", uid: 25027, county: 'Worcester'},
  {name: "North Reading", uid: 25017, county: 'Middlesex'},
  {name: "Northampton",uid: 25015, county: 'Hampshire'},
  {name: "Northborough",uid: 25027, county: 'Worcester'},
  {name: "Northbridge",uid: 25027, county: 'Worcester'},
  {name: "Northfield",uid: 25011, county: 'Franklin'},
  {name: "Norton",uid: 25005, county: 'Bristol'},
  {name: "Norwell",uid: 25023, county: 'Plymouth'},
  {name: "Norwood",uid: 25021, county: 'Norfolk'},
  {name: "Oak Bluffs", uid: 25007, county: 'Dukes'},
  {name: "Oakham",uid: 25027, county: 'Worcester'},
  {name: "Orange",uid: 25011, county: 'Franklin'},
  {name: "Orleans",uid: 25001, county: 'Barnstable'},
  {name: "Otis",uid: 25003, county: 'Berkshire'},
  {name: "Oxford",uid: 25027, county: 'Worcester'},
  {name: "Palmer",uid: 25013, county: 'Hampden'},
  {name: "Paxton",uid: 25027, county: 'Worcester'},
  {name: "Peabody",uid: 25009, county: 'Essex'},
  {name: "Pelham",uid: 25015, county: 'Hampshire'},
  {name: "Pembroke",uid: 25023, county: 'Plymouth'},
  {name: "Pepperell",uid: 25017, county: 'Middlesex'},
  {name: "Peru",uid: 25003, county: 'Berkshire'},
  {name: "Petersham", uid: 25027, county: 'Worcester'},
  {name: "Phillipston",uid: 25027, county: 'Worcester'},
  {name: "Pittsfield",uid: 25003, county: 'Berkshire'},
  {name: "Plainfield",uid: 25015, county: 'Hampshire'},
  {name: "Plainville",uid: 25021, county: 'Norfolk'},
  {name: "Plymouth",uid: 25023, county: 'Plymouth'},
  {name: "Plympton",uid: 25023, county: 'Plymouth'},
  {name: "Princeton",uid: 25027, county: 'Worcester'},
  {name: "Provincetown",uid: 25001, county: 'Barnstable'},
  {name: "Quincy",uid: 25021, county: 'Norfolk'},
  {name: "Randolph",uid: 25021, county: 'Norfolk'},
  {name: "Raynham",uid: 25005, county: 'Bristol'},
  {name: "Reading",uid: 25017, county: 'Middlesex'},
  {name: "Rehoboth",uid: 25005, county: 'Bristol'},
  {name: "Revere",uid: 25025, county: 'Suffolk'},
  {name: "Richmond",uid: 25003, county: 'Berkshire'},
  {name: "Rochester",uid: 25023, county: 'Plymouth'},
  {name: "Rockland",uid: 25023, county: 'Plymouth'},
  {name: "Rockport",uid: 25009, county: 'Essex'},
  {name: "Rowe",uid: 25011, county: 'Franklin'},
  {name: "Rowley",uid: 25009, county: 'Essex'},
  {name: "Royalston",uid: 25027, county: 'Worcester'},
  {name: "Russell",uid: 25013, county: 'Hampden'},
  {name: "Rutland",uid: 25027, county: 'Worcester'},
  {name: "Salem",uid: 25009, county: 'Essex'},
  {name: "Salisbury",uid: 25009, county: 'Essex'},
  {name: "Sandisfield",uid: 25003, county: 'Berkshire'},
  {name: "Sandwich",uid: 25001, county: 'Barnstable'},
  {name: "Saugus",uid: 25009, county: 'Essex'},
  {name: "Savoy",uid: 25003, county: 'Berkshire'},
  {name: "Scituate",uid: 25023, county: 'Plymouth'},
  {name: "Seekonk",uid: 25005, county: 'Bristol'},
  {name: "Sharon",uid: 25021, county: 'Norfolk'},
  {name: "Sheffield",uid: 25003, county: 'Berkshire'},
  {name: "Shelburne",uid: 25011, county: 'Franklin'},
  {name: "Sherborn",uid: 25017, county: 'Middlesex'},
  {name: "Shirley",uid: 25017, county: 'Middlesex'},
  {name: "Shrewsbury",uid: 25027, county: 'Worcester'},
  {name: "Shutesbury",uid: 25011, county: 'Franklin'},
  {name: "Somerset",uid: 25005, county: 'Bristol'},
  {name: "Somerville",uid: 25017, county: 'Middlesex'},
  {name: "South Hadley", uid: 25015, county: 'Hampshire'},
  {name: "Southampton",uid: 25015, county: 'Hampshire'},
  {name: "Southborough",uid: 25027, county: 'Worcester'},
  {name: "Southbridge",uid: 25027, county: 'Worcester'},
  {name: "Southwick",uid: 25013, county: 'Hampden'},
  {name: "Spencer",uid: 25027, county: 'Worcester'},
  {name: "Springfield",uid: 25013, county: 'Hampden'},
  {name: "Sterling",uid: 25027, county: 'Worcester'},
  {name: "Stockbridge",uid: 25003, county: 'Berkshire'},
  {name: "Stoneham",uid: 25017, county: 'Middlesex'},
  {name: "Stoughton",uid: 25021, county: 'Norfolk'},
  {name: "Stow",uid: 25017, county: 'Middlesex'},
  {name: "Sturbridge",uid: 25027, county: 'Worcester'},
  {name: "Sudbury",uid: 25017, county: 'Middlesex'},
  {name: "Sunderland",uid: 25011, county: 'Franklin'},
  {name: "Sutton",uid: 25027, county: 'Worcester'},
  {name: "Swampscott",uid: 25009, county: 'Essex'},
  {name: "Swansea",uid: 25005, county: 'Bristol'},
  {name: "Taunton",uid: 25005, county: 'Bristol'},
  {name: "Templeton",uid: 25027, county: 'Worcester'},
  {name: "Tewksbury",uid: 25017, county: 'Middlesex'},
  {name: "Tisbury",uid: 25007, county: 'Dukes'},
  {name: "Tolland",uid: 25013, county: 'Hampden'},
  {name: "Topsfield",uid: 25009, county: 'Essex'},
  {name: "Townsend",uid: 25017, county: 'Middlesex'},
  {name: "Truro",uid: 25001, county: 'Barnstable'},
  {name: "Tyngsborough",uid: 25017, county: 'Middlesex'},
  {name: "Tyringham",uid: 25003, county: 'Berkshire'},
  {name: "Upton",uid: 25027, county: 'Worcester'},
  {name: "Uxbridge",uid: 25027, county: 'Worcester'},
  {name: "Wakefield",uid: 25017, county: 'Middlesex'},
  {name: "Wales",uid: 25013, county: 'Hampden'},
  {name: "Walpole",uid: 25021, county: 'Norfolk'},
  {name: "Waltham",uid: 25017, county: 'Middlesex'},
  {name: "Ware",uid: 25015, county: 'Hampshire'},
  {name: "Wareham",uid: 25023, county: 'Plymouth'},
  {name: "Warren",uid: 25027, county: 'Worcester'},
  {name: "Warwick",uid: 25011, county: 'Franklin'},
  {name: "Washington",uid: 25003, county: 'Berkshire'},
  {name: "Watertown",uid: 25017, county: 'Middlesex'},
  {name: "Wayland",uid: 25017, county: 'Middlesex'},
  {name: "Webster",uid: 25027, county: 'Worcester'},
  {name: "Wellesley",uid: 25021, county: 'Norfolk'},
  {name: "Wellfleet",uid: 25001, county: 'Barnstable'},
  {name: "Wendell",uid: 25011, county: 'Franklin'},
  {name: "Wenham",uid: 25009, county: 'Essex'},
  {name: "West Boylston", uid: 25027, county: 'Worcester'},
  {name: "West Bridgewater", uid: 25023, county: 'Plymouth'},
  {name: "West Brookfield", uid: 25027, county: 'Worcester'},
  {name: "West Newbury", uid: 25009, county: 'Essex'},
  {name: "West Springfield", uid: 25013, county:  'Hampden'},
  {name: "West Stockbridge", uid: 25003, county: 'Berkshire'},
  {name: "West Tisbury", uid: 25007, county: 'Dukes'},
  {name: "Westborough",uid: 25027, county: 'Worcester'},
  {name: "Westfield",uid: 25013, county: 'Hampden'},
  {name: "Westford",uid: 25017, county: 'Middlesex'},
  {name: "Westhampton",uid: 25015, county: 'Hampshire'},
  {name: "Westminster",uid: 25027, county: 'Worcester'},
  {name: "Weston",uid: 25017, county: 'Middlesex'},
  {name: "Westport",uid: 25005, county: 'Bristol'},
  {name: "Westwood",uid: 25021, county: 'Norfolk'},
  {name: "Weymouth",uid: 25021, county: 'Norfolk'},
  {name: "Whately",uid: 25011, county: 'Franklin'},
  {name: "Whitman",uid: 25023, county: 'Plymouth'},
  {name: "Wilbraham",uid: 25013, county: 'Hampden'},
  {name: "Williamsburg",uid: 25015, county: 'Hampshire'},
  {name: "Williamstown",uid: 25003, county: 'Berkshire'},
  {name: "Wilmington",uid: 25017, county: 'Middlesex'},
  {name: "Winchendon",uid: 25027, county: 'Worcester'},
  {name: "Winchester",uid: 25017, county: 'Middlesex'},
  {name: "Windsor",uid: 25003, county: 'Berkshire'},
  {name: "Winthrop",uid: 25025, county: 'Suffolk'},
  {name: "Woburn",uid: 25017, county: 'Middlesex'},
  {name: "Worcester",uid: 25027, county: 'Worcester'},
  {name: "Worthington",uid: 25015, county: 'Hampshire'},
  {name: "Wrentham",uid: 25021, county: 'Norfolk'},
  {name: "Yarmouth",uid: 25001, county: 'Barnstable'},
];

let CLIMATE_VULNERABILITY_TOWNS = _.map(TOWNS, (town) => {
  return town.name;
}).sort();

CLIMATE_VULNERABILITY_TOWN_TO_COUNTY = {};
_.each(TOWNS, (town) => {
  CLIMATE_VULNERABILITY_TOWN_TO_COUNTY[town.name] = town.county;
});

/*
 */
let ractive = new Ractive({
  template: "#vulnerability_report_template",
  el: "ractive_root",
  data: {
    town: _.find(TOWNS, function (i) {
        if (i.name == query_parameters['town']) {
          return i;
        }
    }),
    hazard: query_parameters['hazard']
  },
  decorators: {
      tooltip:  RactiveTooltip
  },
});

// Load the data that is needed to be loaded...
$.getJSON('/climate-report/' + query_parameters['town'], function(data) {
  ractive.set('town_data', data);
});

// Example Chart
var ctx = document.getElementById('heat_report_chart_1').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
        datasets: [{
            label: 'My First dataset',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [0, 10, 5, 2, 20, 30, 45]
        }]
    },

    // Configuration options go here
  options: {}
});
var ctx = document.getElementById('heat_report_chart_2').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
        datasets: [{
            label: 'My First dataset',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [0, 10, 5, 2, 20, 30, 45]
        }]
    },

    // Configuration options go here
    options: {}
});
