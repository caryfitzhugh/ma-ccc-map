<!DOCTYPE html>
<html >
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MA CCSC Map Viewer</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="all">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.8.1/bootstrap-table.min.css">
  <link rel='stylesheet prefetch' href='./vendor/leaflet-1.0.3/dist/leaflet.css'>
  <style>
html,body,#container{height:100%;width:100%;overflow:hidden}body{padding-top:0}input[type=radio],input[type=checkbox]{margin:0}#map{width:auto;height:100%;margin-left:0;cursor:crosshair}#map.tray-open{width:auto;margin-left:400px}.layer-controls{position:fixed;z-index:1001;top:0;left:0;width:400px}.layer-controls .header{padding:10px;text-align:center;background:#fff}.layer-controls .tabs{text-align:center;color:#fff;font-weight:700;padding-top:0}.layer-controls .tabs a .notice-me-banner{position:absolute;z-index:10000;background:#fff;padding:10px;font-size:12px;top:40px;right:8px;left:8px;color:#000;font-weight:400;white-space:normal;box-shadow:0 0 10px rgba(0,0,0,.7)}.arrow_box{position:relative;background:#fff;border:4px solid #063}.arrow_box:after,.arrow_box:before{bottom:100%;left:50%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.arrow_box:after{border-color:rgba(255,255,255,0);border-bottom-color:#fff;border-width:10px;margin-left:-10px}.arrow_box:before{border-color:rgba(0,102,51,0);border-bottom-color:#063;border-width:16px;margin-left:-16px}.layer-controls .tabs a{color:#fff;padding:8px;white-space:nowrap;background:#063;font-size:14px;cursor:pointer;display:inline-block;border-top:2px solid #063;border-left:1px solid #fff;width:22.5%}.layer-controls .tabs a.layers-tab{width:20%}.layer-controls .tabs a.legend-map-controls-tab{width:48%}.layer-controls .tabs a.locations-tab{width:32%}.layer-controls .tabs a.active{color:#063;background:#fff;border-top:1px solid #063;border-left:1px solid #063}.layer-controls .tray.show{bottom:0;max-height:5000px;overflow-y:auto;overflow-x:hidden;border-right:1px solid #aaa}.layer-controls .tray{background:#fff;position:fixed;top:108px;left:0;width:400px;overflow:hidden;max-height:0;border-right:1px solid #aaa}.layer-controls .tray .contents{padding:10px}.layer-controls .tray .search-header{margin:0;opacity:1;background:#fff;position:absolute;left:0;right:0;top:0;z-index:1;border-top:1px solid #063;box-shadow:0 1px 5px rgba(0,0,0,.5);border-bottom:1px solid #063}.layer-controls .tray .search-header>.row{border-bottom:1px solid #063}.layer-controls .search-header .sector-select{display:flex;justify-content:space-between;flex-direction:row;white-space:nowrap;color:#063;background:#fff;cursor:pointer;align-items:baseline;border:0;width:100%;font-size:16px;padding:5px;padding-bottom:0}.layer-controls .search-header .sector-select .sector-selection-dropdown .btn-primary{background:#063;color:#fff;border-radius:0;border:1px solid #063}.layer-controls .search-header .sector-select .sector-selection-dropdown{position:absolute;top:72px;right:5px;background:#fff;border:1px solid #000;padding:1em}.layer-controls .search-header .sector-select .selected-text-container{overflow:hidden;max-width:265px;text-overflow:ellipsis}.layer-controls .search-header .sector-select .selected{font-size:80%}.layer-controls .search-header .sector-select label{display:inline-block;border:0;font-weight:700}.layer-controls .search-header .sector-select label:hover{cursor:default;color:#063}.layer-controls .tray .search-header input{border:0;width:100%;font-size:20px;padding:5px;padding-right:30px}.layer-controls .tray .search-header .fa-times-circle-o{position:absolute;right:10px;top:0;font-size:20px;line-height:40px}.layer-controls .tray .search-results{position:absolute;top:68px;left:0;right:0;bottom:0;overflow-y:auto;position:relative}.layer-controls .tray .search-results .result{padding:5px;border-bottom:1px solid #999;font-size:16px}.layer-controls .tray .search-results-empty{text-align:center}.layer-controls .tray .search-results-empty .fa-search{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:80px;background:#f6892e;border-radius:40px;height:80px;width:80px;display:inline-block}.layer-controls .tray .active-layers-empty{text-align:center}.layer-controls .tray .active-layers-empty .fa-globe{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:80px;background:#f6892e;border-radius:40px;height:80px;width:80px;display:inline-block}#control_panel_root .active-layer{position:relative}#control_panel_root .active-layer .disable-active-layer-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3)}#control_panel_root .active-layer .disable-active-layer-overlay{padding-top:40px;text-align:center}#control_panel_root .active-layer .disable-active-layer-overlay>label{display:inline;background:#fff;box-shadow:0 0 5px #000;padding:10px 20px}.layer-controls .layer-group:first-child{padding:5px}.layer-controls .layer-group{list-style-type:none;padding-left:10px}.layer-controls .layer-group .info{padding:0 5px}.active-layer .info.warning,.layer-controls .layer-group .info.warning{color:#333;background:#ffc756}.active-layer .name .info{padding:0 5px}.modal-wrapper .response .error{padding:5px 10px}.modal-wrapper .response a{cursor:pointer}.modal-wrapper .response .error,.active-layer .info.danger,.layer-controls .layer-group .info.danger{color:#FFF;background:#D40A0A}.layer-import-modal .input-upload{display:flex;flex-direction:row;justify-content:space-between}.layer-import-modal .drop-target{border:2px dashed #aaa;width:100%;line-height:200px;font-size:20px;text-align:center}.layer-controls .bulk{text-align:right;border-top:1px solid #063;border-bottom:1px solid #063;background:#fff;padding:5px}.layer-controls .bulk a{padding:0 5px}.layer-controls .tray .active-layers-empty{text-align:center}.layer-controls .tray .active-layers-empty .fa-globe{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:80px;background:#f6892e;border-radius:40px;height:80px;width:80px;display:inline-block}.modal-wrapper{position:fixed;top:0;left:0;right:0;height:0;overflow:hidden;z-index:5000}.modal-wrapper .wizard-modal .fa-arrow-right,.modal-wrapper .wizard-modal .fa-arrow-left{display:none}.modal-wrapper.open{height:100%}.modal-wrapper.open .wizard-modal .fa-arrow-right,.modal-wrapper.open .wizard-modal .fa-arrow-left{display:inline-block}.modal-wrapper .modal-bg{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:900}.modal-wrapper .modal-content{position:absolute;border-radius:0 0 10px 10px;top:0;left:20%;width:60%;height:auto;background:#fff;z-index:1000;overflow-y:auto;max-height:90%;padding-bottom:20px}.modal-wrapper .fa-close{position:absolute;top:10px;right:20px;color:#fff;background:#5690ca;font-size:15px;padding:10px;border-radius:20px;z-index:1001}.layer-info-modal .legend-img{max-width:60%}.feature-info-modal td{padding:2px 4px}.feature-info-modal .line-chart{white-space:nowrap;height:100px;background:#fff;border:1px solid #000;display:inline-block;padding-bottom:30px;margin:5px;position:relative}.feature-info-modal .line-chart .bar{display:inline-block;height:100%;position:relative;width:20px}.feature-info-modal .line-chart .bar .color{background:#000;width:80%;margin:0 10%;position:absolute;bottom:0}.feature-info-modal .line-chart .bar.current .color{background:red}.feature-info-modal .line-chart .bar .label{opacity:0;transition:.5s all;position:absolute;line-height:20px;font-size:14px;border:1px solid #000;box-shadow:0 0 5px #000;bottom:0;padding:3px 5px;color:#000;text-align:center;z-index:10;background:#fff}.feature-info-modal .line-chart .bar:hover{box-shadow:0 0 5px #efefef}.feature-info-modal .line-chart .bar:hover .label{opacity:1;transition:.5s all}.feature-info-modal .line-chart label{position:absolute;bottom:0;left:0;right:0;text-align:center}.feature-info-modal iframe{width:100%;height:100%;border:0;margin-bottom:15px}.layer-controls .active-layer{border-bottom:1px solid #063;padding:1px 5px}.layer-controls .active-layer{border-bottom:0}.layer-controls .active-layer label{margin-bottom:0}.layer-controls .active-layer .control-bar{margin-top:3px;margin-bottom:5px}.layer-controls .active-layer .active-details{margin-bottom:15px}.active-layer .detail-block.carbon .options{display:inline-block;width:70%}.active-layer .detail-block.carbon .options div{display:block}.active-layer .detail-block{line-height:25px}.active-layer .detail-block .labelled-range{position:relative;padding-bottom:15px}.active-layer .detail-block .labelled-range span{position:absolute;top:15px}.active-layer .detail-block .labelled-range span:first-child{left:5px}.active-layer .detail-block .labelled-range span:last-child{right:5px}.active-layer .detail-block .labelled-range input{}.active-layer .detail-block.power_stations img{width:30px}.active-layer .detail-block .legend-label{font-weight:700}.active-layer .detail-block.esri-legend{text-align:left}.active-layer .detail-block.esri-legend .legend-block{display:block}.active-layer .detail-block.esri-legend .legend-block img{display:inline-block;width:25%}.active-layer .detail-block.esri-legend .legend-block span{}.active-layer .detail-block.esri-legend.extreme-precip .legend-block img{width:10%}.active-layer .detail-block.legend .color-block{display:inline-block;min-width:9.08%;margin:0;position:relative}.active-layer .detail-block.legend .color-block svg,.active-layer .detail-block.legend .color-block svg rect{width:100%;height:25px}.detail-block.legend-url-text.spa_surface_water,.detail-block.legend-url-text.spa_ground_water{position:relative}.detail-block.legend-url-text.spa_ground_water span.legend-text,.detail-block.legend-url-text.spa_surface_water span.legend-text{position:absolute;top:-34px;left:130px}.active-layer .detail-block.legend{margin:10px 0}.active-layer .detail-block.legend .color-legend{text-align:center;font-weight:300;font-size:90%;margin-top:-6px}.active-layer .detail-block.legend .color-block .color{width:100%;height:100%}.active-layer .detail-block.legend .color-block label{text-align:center;width:100%;font-weight:300;vertical-align:text-top}.active-layer .detail-block.legend-url-text{text-align:center;font-weight:300;font-size:90%}.active-layer .detail-block label{display:inline-block;width:25%;border:0}.active-layer .opacity input,.active-layer .plants-and-animals select,.active-layer .extreme-precip select,.active-layer .sea-level input{display:inline-block;width:40%;margin-right:10px}.active-layer .legend img{display:inline-block;max-width:70%}.active-layer .legend.nlcd label,.active-layer .legend.anthromes label,.active-layer .legend.nfhl label,.active-layer .legend.regulated_wells label,.active-layer .legend.lulc_2011 label,.active-layer .legend.lulc_2011 label,.active-layer .legend.lulc_2050 label,.active-layer .legend.gap_lc label{display:none}.active-layer .legend.nlcd img,.active-layer .legend.regulated_wells img,.active-layer .legend.lulc_2011 img,.active-layer .legend.anthromes img,.active-layer .legend.lulc_2050 img,.active-layer .legend.gap_lc img{width:100%;max-width:100%}.active-layer .legend.private_wells img{width:74%;max-width:74%}.active-layer .legend.sovi img{width:50%}.active-layer .legend.nfhl img{width:70%}.active-layer .legend.soils img.soils-0{width:50%;max-width:50%}.active-layer .legend.soils img.soils-1{width:115%;max-width:115%}.layer-controls .active-layer .show-confidence input{width:auto}.layer-controls .active-layer .control-bar .fa{padding:2px 5px}.layer-controls .active-layer .control-bar .fa-trash-o{float:right}.layer-controls label:hover{transform:.5s all;cursor:pointer;color:#000}.layer-controls label{font-size:90%;border-bottom:1px solid #999;display:block}.layer-controls .layer{padding:4px;font-size:90%;clear:both}.layer-controls .layer a.info{float:right;font-size:14px;line-height:18px}.map-controls{position:fixed;z-index:1000;top:10px;right:10px;min-width:100px;color:#666;font-size:16px;padding:5px;padding-right:50px}.map-controls .add-layer{position:relative}.map-controls .add-layer .fa-plus-circle{font-size:75%;top:16px;right:10px;position:absolute;background:#fff}.map-control{float:left;margin:5px;position:relative}.map-control-bg{position:absolute;top:-1000px;right:-10000px;width:20000px;height:20000px;background:rgba(0,0,0,.3);z-index:100}.control-details{background:#fff;position:absolute;top:35px;right:0;padding:10px;z-index:150}.control-details a{padding:2px 4px;display:block;white-space:nowrap}.control-details a.active{background:#428bca;text-shadow:1px 1px 2px #333;color:#fff}.zoom-controls{position:absolute;right:0;margin:5px 5px 5px 10px;background:#fff;font-size:18px;font-weight:400;text-align:center;border:1px solid #eaeaea;box-shadow:1px 1px 4px #999}.zoom-controls a:hover,.show-cursor{cursor:pointer;text-decoration:none}.zoom-controls a:hover{background:#428bca;text-shadow:1px 1px 2px #333;color:#fff}.zoom-controls a:last-child{border-bottom:0}.zoom-controls a.disable:hover{cursor:default}.zoom-controls a.disable{color:#bbb}.zoom-controls a{padding:4px 8px;display:block;border-bottom:1px solid #eaeaea}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.leaflet-bottom .leaflet-control-scale{position:fixed;right:0;bottom:25px}.water-well{color:#fff;font-weight:700;width:8px!important;height:8px!important;background:#0000fa;border:1px solid #0000fa}.water-wells-cluster{color:#fff;font-weight:300;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,0,250,.7);border:1px solid #0000fa;text-align:center;font-size:14px}.oil-wells-cluster{color:#000;font-weight:300;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,255,0,.5);border-radius:35px;border:1px solid green;text-align:center;font-size:14px}.other-wells-cluster{color:#000;font-weight:30{{layer_default_id}}0;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,0,255,.5);border-radius:35px;border:1px solid #00f;text-align:center;font-size:14px}.gas-wells-cluster{color:#000;font-weight:700;width:35px!important;height:35px!important;line-height:35px;background:rgba(255,0,0,.5);border-radius:35px;border:1px solid red;text-align:center;font-size:12px}.wellsCluster{color:#000;font-weight:700;width:35px;height:35px;line-height:40px;background:transparent url(img/wellsCluster.png) 0 0 no-repeat scroll;text-align:center;text-indent:-20px;font-size:11px}.sewer_overflowsCluster{color:#000;font-weight:300;width:50px;height:48px;line-height:85px;background:transparent url(img/sewer-overflowsCluster.png) 0 0 no-repeat scroll;text-align:center;text-indent:-20px;font-size:14px}.spdesCluster{color:#000;width:40px;font-weight:700;height:40px;line-height:63px;background:transparent url(img/spdes.png) 0 0 no-repeat scroll;text-align:center;text-indent:0;font-size:14px}.hospitalCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/hospitalCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.damsCluster{color:#000;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/damsCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.bulkstorageCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:35px;background:transparent url(img/bulkstorage.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.ghg_facilitiesCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/ghg_facilitiesCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.alscCluster{color:#000;font-weight:700;width:37px;height:45px;line-height:38px;background:transparent url(img/alscCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:4px;font-size:1.2em}.out-of-zoom-alerts{position:fixed;bottom:0;left:0;right:0;text-align:center;z-index:100001}.out-of-zoom-alerts .alert{width:50%;margin-left:10px;margin-right:10px;display:inline-block;margin-bottom:0;border-bottom:0;border-radius:0}.leaflet-tile-pane,.leaflet-objects-pane,.leaflet-overlay-pane,.leaflet-shadow-pane{z-index:initial!important}.leaflet-marker-pane{z-index:10000}.leaflet-popup-pane{z-index:15000}@media (max-width:600px){.layer-controls .tray,.layer-controls{right:0;width:auto}.map-controls{top:115px}.print-control{display:none}.modal-wrapper .wizard-modal .fa-arrow-right{top:auto;right:0;bottom:0}.modal-wrapper .wizard-modal .fa-arrow-left{top:auto;left:0;bottom:0}.modal-wrapper .modal-content{width:auto;left:0;right:0}}.printin-legends{display:none}@media print{.hide-printing{display:none}#control_panel_root>div{display:none}#control_panel_root>div.printing-legends{position:absolute;display:block;top:100%}#control_panel_root>div.printing-legends .columns{column-count:4!important;column-gap:1em!important}#control_panel_root>div.printing-legends .columns .active-layer{display:inline-block;position:relative;width:100%;margin:0 0 1em}#control_panel_root>div.printing-legends .columns .active-layer label.layer-name{text-align:center;width:100%;border-bottom:1px solid #000;border-top:1px solid #000}#control_panel_root>div.printing-legends .columns .active-layer .opacity{display:none}#control_panel_root>div.printing-legends .columns .active-layer{width:40%;float:left;margin:10px}.zoom-controls,.layer-controls,.map-controls{display:none}.print-legend-page{display:block;position:absolute;top:100%;page-break-before:always}.print-header{position:absolute;top:0;z-index:990000}html,body{height:100%;display:block}#content,#map{height:50%}#map.tray-open{margin-left:0}body{height:200%;overflow:auto}}.fa-spin-custom,.glyphicon-spin{-webkit-animation:spin 1000ms infinite linear;animation:spin 1000ms infinite linear}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.modal-wrapper .modal-content.wizard-modal{box-shadow:0 0 5px #333;min-height:200px;height:100%;padding-bottom:0}.wizard-modal .back-to-start{float:right;margin-right:50px;margin-top:13px}.wizard-modal .footer{color:#999;text-align:center;font-size:80%;clear:both;line-height:30px;padding-top:20px}.wizard-modal .container-fluid{overflow-y:auto;height:100%}.wizard-modal .fa-arrow-right,.wizard-modal .fa-arrow-left{position:fixed;padding:25px;font-size:16px;display:inline-block;color:#fff;background:#5690ca}.wizard-modal .fa-arrow-left{top:100px;left:10%}.wizard-modal .fa-arrow-right{top:100px;right:10%}.wizard-modal .fa-arrow-left:hover,.wizard-modal .fa-arrow-right:hover{background:#063;cursor:pointer}.wizard-modal h1{border-bottom:1px solid #000}.wizard-modal img{min-width:300px;min-height:300px;float:right}.wizard-modal img.full-width{display:block;width:100%}
</style>
</head>

<body>
    <div class="print-header visible-print">
      <img height="50px" src="img/ma-shield.gif">
    </div>
    <div class='main-header hide-printing'> </div>
    <div id="container">
      <div id='ractive_root'>
        <div id='control_panel_root'></div>
      </div>

      <div id="map" class="sidebar-map" style="background-color:white;"></div>
    </div>

    <div class='print-legend-page visible-print visible-print-block'>
      <!--PRINT PARAMETERS-->
    </div>

<!-- VIEW TEMPLATES -->
<script id='control_panel_template' type="text/ractive">
  {{>map_controls_template}}
  {{>layer_controls_template}}
  {{>layer_info_modal_template}}
  {{>sharing_modal_template}}
  {{>map_details_modal_template}}
  {{>printing_legends_template}}
  {{>wizard_template}}
  {{>wizard_standalone_template}}
  {{>map_out_of_view_layers_template}}
  {{>layer_import_modal_template}}
</script>

<script id='map_out_of_view_layers_template' type='text/ractive'>
  {{#if (out_of_view_layers(layers.active, map_state.zoom)).length > 0}}
    <div class='out-of-zoom-alerts'>
      {{#(out_of_view_layers(layers.active, map_state.zoom))}}
        <div class='alert alert-warning'>
          <label>{{name}} </label>
          is not visible at this zoom level.
          <a class='btn btn-sm btn-primary' on-click='zoom-to-view-layer'> Zoom to Layer </a>
        </div>
      {{/(out_of_view_layers(layers.active, map_state.zoom))}}
    </div>
  {{/if (out_of_view_layers(layers.active, map_state.zoom)).length > 0}}
</script>

<script id='wizard_link_template' type='text/ractive'>
  Show a Link Here
</script>

<script id='layer_import_modal_template' type="text/ractive">
  <div class='modal-wrapper {{layer_import.show_modal ? "open" : "closed"}} '>
    <div class='modal-bg' on-tap="close-layer-import-modal"></div>
    <div class='modal-content layer-import-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="close-layer-import-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2> Layer Import </h2>
            <p> This mapper allows you to import and view your own map layer in the browser.  </p>
            <div class='input-upload'>
              <input id='layer_import_file_input' type='file' value='{{layer_import.import_file}}'
                  accept=".kml, .geojson, .json, .gpx "/>
              {{#if layer_import.import_file}}
                {{#if layer_import.import_file_processing}}
                  Loading ... <span class='fa fa-spinner fa-spin-custom'></span>
                {{else}}
                  <span class='btn btn-primary' on-click='upload-layer-import-file'> Import </span>
                {{/if layer_import.import_file_processing}}
              {{/if layer_import.import_file}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>


<script id='wizard_standalone_template' type="text/ractive">
  <div class='modal-wrapper {{wizard.standalone ? "open" : "closed"}} '>
    <div class='modal-bg' on-tap="close-standalone-wizard"></div>
    <div class='modal-content wizard-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="close-standalone-wizard"></span>
        {{#wizard.standalone.templates.wizard }}
          {{> . }}
        {{/wizard.standalone.templates.wizard }}
      </div>
    </div>
  </div>
</script>

<script id='wizard_template' type="text/ractive">
  <div class='modal-wrapper {{wizard.open ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="close-wizard"></div>
    <div class='modal-content wizard-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="close-wizard"></span>
        <span class='fa fa-arrow-right noselect' on-tap="next-wizard"></span>
        <span class='fa fa-arrow-left noselect' on-tap="prev-wizard"></span>
        {{#if "welcome" != wizard.steps[wizard.current_step]}}
          <span class='btn btn-sm btn-primary back-to-start show-cursor' on-tap="show-wizard">Back To Start</span>
        {{/if "welcome" != wizard.steps[wizard.current_step]}}

        {{#if "welcome" === wizard.steps[wizard.current_step]}}
          <h1>Welcome</h1>
          <p>Thanks for visiting the Massachusetts Climate Change Mapping Tool; a place to interactively explore data and create maps related to climate change impacts, vulnerability and adaptation across Massachusetts.</p>
          <h2>What's in the Map?</h2>
          <p>Our library of viewable map layers and interactive map functions has been developed by recommendations from state experts in climate change. </p>
          <h2>What's Not in the Map?</h2>
          <p>Our map viewer contains only a portion of the mappable data sources available in the Clearinghouse. </p>
          <h2>Using the viewer</h2>
          <p>Before getting started, scroll through this Map Guide to get familiar with the layout and functions of the interface. Most layers contain multiple data sources that can be explored with map controls. Many layers can be clicked upon in the map to provide more specific local information or data values. You can also share your map digitally or create pdf maps with legends.</p>
          <ul>
            <li> <a class='show-cursor' on-tap='wizard-sidebar-intro'> Learn about the sidebar </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-base-layers'> Moving the map and base layers </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-adding-things'> Adding things to the map </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-find-more-info'> Finding out more about a layer </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-order-layers'> Ordering layers </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-using-legends-tab'> Using Legends Tab </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-printing'> Printing the Map </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-advanced-layer-controls'> Advanced Layer Controls </a> </li>
          </ul>
        {{/if "welcome" === wizard.steps[wizard.current_step]}}
        {{#if "sidebar_intro" === wizard.steps[wizard.current_step]}}
          <h1> Using the sidebar </h1>
          <img src="img/wizard/sidebar_intro.gif">
          <p><strong>Layers</strong>
            tab gives you access to a variety of map layers and data sources organized by sector. You can browse the layers in each sector or use the search box at the top.
          </p>

          <p>
            <strong>Legend</strong>
            tab provides map legend information, allows you to adjust the layer information and how it is shown in the map.
          </p>

          <p>
            <strong>Locations</strong>
            tab allows you to search for a location (town, country, watershed) in Massachusetts. The map will zoom to the location you select from the search results.
          </p>
        {{/if "sidebar_intro" === wizard.steps[wizard.current_step]}}

        {{#if "base_layers" === wizard.steps[wizard.current_step]}}
          <h1> Adjusting your map view and base layer</h1>
          <img src="img/wizard/base_layers.gif">
          <p><strong>Click and drag</strong>
            on the map itself to adjust the map view.
          </p>
          <p>
            Use the controls in the upper right to <strong> zoom in and out </strong>.  You may also double-click on the map, or use your mouse scroll wheel to zoom.
          </p>

          <p>
            Click the <strong>House</strong> icon (<span class='fa fa-home'></span>) to return to the default view of Massachusetts.
          </p>

          <p>
            Click the <strong>Target</strong> icon (<span class='fa fa-crosshairs'></span>) to zoom to your current location
            <br>
            <em>(note: your browser will request permission to locate you)</em>
          </p>

          <p>
            Click the <strong>Base Map</strong> button to select one of the available base map layers.
          </p>
        {{/if "base_layers" === wizard.steps[wizard.current_step]}}

        {{#if "adding_things" === wizard.steps[wizard.current_step]}}
          <h1> Adding things to the map</h1>
          <img src="img/wizard/adding_things.gif">
          <p>
            You can add layers by clicking on the Layers tab, which will show you all the layers available to be added to the map.
            <br>
            You can also use the search box to find layers.
          </p>
          <p>
            Once you find a layer you are interested in, you can click its name or checkbox to enable it. Once it is loaded it will display on the map. Some layers may take a few moments to load.
          </p>
        {{/if "adding_things" === wizard.steps[wizard.current_step]}}

        {{#if "find_more_info" === wizard.steps[wizard.current_step]}}
          <h1> Finding out more about a layer</h1>
          <p>
            Click on the <span class='fa fa-info-circle'></span> to learn more about the layer
            and find a link to its source, where you can often find detailed data descriptions and relevant information.
          </p>
          <p>
            For some layers you can also click <strong>directly on the map</strong> to identify the value at that location.
          </p>
          <img class='full-width' src="img/wizard/find_more_info.gif">
        {{/if "find_more_info" === wizard.steps[wizard.current_step]}}

        {{#if "order_layers" === wizard.steps[wizard.current_step]}}
          <h1> Ordering Layers </h1>
          <p>
            If a layer is active but you cannot see any features, it may be hidden behind other layers.
            Layers are ordered in the sidebar as they are ‘stacked’ in the map view.
          </p>
          <p>
            You can use the <span class='fa fa-angle-double-up'></span> to move layers to the top, or click and drag on the <span class='fa fa-hand-stop-o'></span> to drag layers into the order you prefer.
            Note that some types of layers will always draw on top of other layers - and these will not have the <span class='fa fa-angle-double-up'></span> or <span class='fa fa-hand-stop-o'></span> available.
          </p>
          <p>
            You can always hide (<span class='fa fa-eye'></span>) or remove (<span class='fa fa-trash'></span>) these layers to take them out of the map view.
          </p>
          <img class='full-width' src="img/wizard/order_layers.gif">
        {{/if "order_layers" === wizard.steps[wizard.current_step]}}

        {{#if "using_legends_tab" === wizard.steps[wizard.current_step]}}
          <h1> Using Legends Tab </h1>
          <p>
            Each layer has a set of buttons that vary depending on the functions available for that layer.
          </p>
          <p>
            All layers have:
              <br>
              <span class='fa fa-angle-double-up'></span> which moves the layer to the top of the map
              <br>
              <span class='fa fa-eye'></span> which hides or shows the layer
              <br>
              <span class='fa fa-info-circle'></span> which provides layer information
              <br>
              <span class='fa fa-trash'></span> which removes the layer from the view
          </p>
          <p>
            Opacity can be adjusted using the slider
          </p>
          <p>
            <strong>Expand / Collapse all </strong> – these buttons change how the legend information is viewed in the sidebar. It does not affect how layers appear in the map view. Each legend can also be opened or closed by clicking on the layer name or the triangle to the left.
            <br>
            <strong>Hide all </strong> – this hides all layers but does not remove them from the map view or change how their legends appear in the sidebar.
            <br>
            <strong>Remove all</strong> – this removes all layers from the map and their legends from the sidebar.
          </p>
          <img class='full-width' src="img/wizard/order_layers.gif">
        {{/if "using_legends_tab" === wizard.steps[wizard.current_step]}}

        {{#if "printing" === wizard.steps[wizard.current_step]}}
          <h1> Printing the Map </h1>
          <p>
            The <span class='fa fa-print'></span> button will export your map and legends to a layout and open the print dialog window automatically from your browser.
          </p>
          <p>
            The print layout includes a full-page map view and one or more additional pages for legend information. Note that the map view that is exported includes the area beneath the sidebar.
          </p>
          <p>
            <em> Hint: you can hide the sidebar by double-clicking on any tab name, or clicking on the name of the open tab. When the sidebar is collapsed, the map view shows what will be sent to the print layout.  </em>
          </p>
          <img class='full-width' src="img/wizard/printing.gif">
        {{/if "printing" === wizard.steps[wizard.current_step]}}
        {{#if "advanced_layer_controls" === wizard.steps[wizard.current_step]}}
          <h1> Advanced Layer Controls </h1>
          <p>
            Some layers, especially those in the <strong>Climate Data</strong> and <strong>Ecosystems</strong> folders, contain multiple datasets as part of the layer. These datasets can be accessed using customized controls found in the <strong>Legend</strong> tab once the layer is active.
          </p>
          <p>
            Use drop down menus, buttons and sliders to navigate to the data you are interested in. <em>Note: for most interactive layers, the legend color bar will automatically adjust based on which data you select to show in the map.</em>
          </p>
          <p>
          You can also <strong>Clone</strong> (<span class='fa fa-clone'></span>) a specific dataset and add it to the map as a ‘stand-alone’ layer. This is helpful when comparing multiple datasets from one or more of these types of interactive layers. The new layer is added to the list in the <strong>Legend</strong> tab (but does <em>not</em> appear in the list on the <strong>Layers</strong> tab).
          </p>
          <p>
            Most interactive layers include the ability to click on the map <span class='fa fa-map-marker'></span> to return a value for that location.
          </p>
          <img class='full-width' src="img/wizard/advanced_layer_controls.gif">
        {{/if "advanced_layer_controls" === wizard.steps[wizard.current_step]}}

        <!--
          <div class='footer'>
            Hint {{wizard.current_step + 1}} / {{wizard.steps.length}}
          </div>
        -->
      </div>
    </div>
  </div>
</script>

<script id='printing_legends_template' type="text/ractive">
  <div class='printing-legends visible-print-block'>
    <div class='columns'>
      {{#layers.active}}
        <div class='active-layer'>
          <label class='layer-name'> {{name}} </label>
         {{> layer_controls_details_blocks_template}}
        </div>
      {{/layers.active}}
    </div>
  </div>
</script>

<script id='map_details_modal_template' type="text/ractive">
  <div class='modal-wrapper {{(map_details.location && map_details.feature_info_requests.length > 0) ? "open" : "closed"}}' >
    <div class='modal-bg' on-tap="hide-feature-info-modal"></div>
    <div class='modal-content feature-info-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-feature-info-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Location Info
             <!--  <small>{{map_details.location.lat}},{{map_details.location.lng}}</small> -->
            </h2>
          </div>
        </div>
        {{#map_details.feature_info_requests}}
          <div class='row response'>
            {{#map_details.feature_info_responses[response_id]}}
              {{#error}}
                <div class='col-xs-2'>
                  <label> {{name}} </label>
                </div>
                <div class='col-xs-10'>
                  <span class='error'> Error Loading </span>
                  {{#if (show_error_details)}}
                    <a on-click='toggle-show-feature-info-response-details'> Hide Details. </a>
                    <pre>{{error}}</pre>
                  {{else}}
                    <a on-click='toggle-show-feature-info-response-details'> Show Details. </a>
                  {{/if (show_error_details)}}
                </div>
              {{else}}
                {{> active_layer.templates.info}}
              {{/error}}

            {{else}}
              <div class='col-xs-2'>
                <label> {{name}} </label>
              </div>
              <div class='col-xs-10'>
                <span> loading ...
                  <span class='fa fa-spinner fa-spin-custom'></span>
                </span>
              </div>
            {{/if}}
          </div>
        {{/map_details.feature_info_requests}}
      </div>
    </div>
  </div>
</script>

<script id='sharing_modal_template' type="text/ractive">
  <div class='modal-wrapper {{sharing_modal_loading ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-sharing-modal"></div>
    <div class='modal-content sharing-loading-modal'>
      <div class='container-fluid'>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Loading your map...
              <span class='fa fa-spinner fa-spin-custom'></span>
            </h2>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class='modal-wrapper {{sharing_modal.open ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-sharing-modal"></div>
    <div class='modal-content'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-sharing-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Saving and Sharing Maps
            </h2>
          </div>
        </div>
        <div class='row'>
          <hr/>
        </div>
        <div class='row'>
          <div class='col-xs-12'>
            <p> You can save the current map view, including all active layers and settings, by requesting a save link below. Bookmark the link to return to the map.</p>
            <p>Share this link with others and they will be able to load up the map directly in their web browser.</p>
          </div>
        </div>
        <hr/>
        <div class='row'>
          {{#if sharing_modal.token }}
            {{#if "loading" === sharing_modal.token}}
              <div class='col-xs-3'> &nbsp; </div>
              <a disabled class='btn btn-primary col-xs-6' on-click="request-share-link-token">
                <span class='fa fa-spinner fa-spin-custom'></span>
                Requesting Link...
              </a>
              <div class='col-xs-3'> &nbsp; </div>
            {{ else }}
              <div class='col-xs-1'></div>
              <div class='col-xs-10'>
                <div class='input-group'>
                  <input class='form-control' value='{{sharing_url(sharing_modal.token)}}'>
                  <span class='input-group-btn'>
                    <button id='sharing_copy_button' class='btn btn-primary'
                            disabled="{{(sharing_modal.token || sharing_modal.copied) ? "" :"disabled"}}">{{sharing_modal.copied ? "Copied!" : "Copy"}}</button>
                  </span>
                </div>
              </div>
              <div class='col-xs-1'></div>
            {{/if}}
          {{ else }}
            <div class='col-xs-3'> &nbsp; </div>
            <a class='btn btn-primary col-xs-6' on-click="request-share-link-token"> Request Link </a>
            <div class='col-xs-3'> &nbsp; </div>
          {{/if sharing_modal.token}}
        </div>
      </div>
    </div>
  </div>
</script>

<script id='layer_info_modal_template' type="text/ractive">
  <div class='modal-wrapper {{layer_controls.current_layer_info ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-layer-info-modal"></div>
    <div class='modal-content layer-info-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-layer-info-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              {{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).name}}
              <small>{{layer_controls.current_layer_info}}</small>
            </h2>
          </div>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Service Status </label>
          </div>
          <span class='col-xs-8'>
            <span class='label label-{{layer_load_state(layers_loading_states, layer_controls.current_layer_info)}}'>
              {{layer_load_state_error_count(layers_loading_states, layer_controls.current_layer_info)}}
            </span>
          </span>
          <span class='col-xs-2'>
          </span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Folder </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).folder}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Description </label>
          </div>
          <span class='col-xs-8'>{{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).description}}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Sectors </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).sectors}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Source </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Source URL </label>
          </div>
          <span class='col-xs-8'>
            <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source_url}}" target="_blank">
              {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source_url, 40)}}
            </a>
          </span>
        </div>

        {{#if get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url}}
          <div class='row'>
            <div class='col-xs-4'>
              <label> Download URL </label>
            </div>
            <span class='col-xs-8'>
              <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url}}" download target="_blank">
                {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url, 40)}}
              </a>
            </span>
          </div>
        {{/if}}
        {{#if get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url}}
          <div class='row'>
            <div class='col-xs-4'>
              <label> MetaData URL </label>
            </div>
            <span class='col-xs-8'>
              <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url}}" target="_blank">
                {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url, 40)}}
              </a>
            </span>
          </div>
        {{/if}}
      </div>
    </div>
  </div>
</script>

<script id="zoom_controls_template" type="text/ractive">
  <div class='zoom-controls noselect'>
    <a class='noselect {{map_state.zoom > map_state.zoom_max ? "disable" : ""}}  >'
       decorator="tooltip:Zoom in" on-tap="map-zoom-in"> <span class='fa fa-plus'></span> </a>
    {{#if has_geolocation }}
      <a class='noselect' decorator="tooltip:Zoom to your location" on-tap='map-zoom-me'> <span class='fa fa-crosshairs'></span></a>
    {{/if}}
    <a class='noselect' decorator="tooltip:Zoom to original view" on-tap='map-zoom-home'> <span class='fa fa-home'></span></a>
    <a class='noselect {{map_state.zoom < 1 ? "disable" : ""}}' decorator="tooltip:Zoom out" on-tap="map-zoom-out"> <span class='fa fa-minus'></span> </a>
  </div>
</script>

<script id="layer_controls_template" type="text/ractive">
  <div class='layer-controls noselect'>
    <div class='header'>
      <img height="50px;" src="img/ma-shield.gif"/>
    </div>
    <div class='tabs container-fluid'>
      <div class='row'>
        <a on-tap="show-layers-control" class="layers-tab col-xs-3 {{layer_controls.active_tab === 'layers' ? 'active': '' }}">
          <span class='fa fa-check-square-o'></span>
          Layers
        </a>
        <a on-tap="show-details-control" class="legend-map-controls-tab col-xs-6 {{layer_controls.active_tab === 'details' ? 'active': ''}}">
          <span class='fa fa-sliders'></span>
          Controls &amp; Legends
          {{#if layers.active.length > 0 }}
            <span class='label label-default label-xs'>{{layers.active.length}}</span>
          {{/if}}

          {{#wizard.adding_layers_popup}}
            <span class='arrow_box notice-me-banner' on-click="remove-layer-add-notice">
              <span>After adding layers to the map, click on the Controls &amp; Legends tab to dig deeper!</span>
            </span>
          {{/wizard.adding_layers_popup}}
        </a>
        <a on-tap='show-search-control' class="locations-tab col-xs-3 {{layer_controls.active_tab === 'search' ? 'active': ''}} " >
          <span class='fa fa-search'></span>
          Quick Zoom
        </a>
      </div>
    </div>
    <div class="tray {{layer_controls.tray.open ? 'show' : ''}}">
      <div class='tray-container'>
        {{#if layer_controls.active_tab === "layers"}}
          {{>layer_controls_layers_template }}
        {{else}}
          {{#if layer_controls.active_tab === "search"}}
            {{>layer_controls_search_template}}
          {{else}}
            {{>layer_controls_details_template }}
          {{/if}}
        {{/if}}
      </div>
    </div>
  </div>
</script>

<script id="layer_controls_search_template" type="text/ractive">
  <div class='search-header'>
    <input id="search_input" placeholder="Type a search" value="{{layer_controls.search_string}}">
    {{#if layer_controls.search_string.length > 0 }}
      <a>
        <span class='fa fa-times-circle-o show-cursor' on-tap="clear-search-query"></span>
      </a>
    {{/if}}
  </div>

  <div class='search-results'>
    {{#layer_controls.search_results}}
      <div class='result show-cursor'
            on-tap="zoom-to-search-result">
        <a class='' decorator="tooltip:Focus map on {{properties.name}}">
          <span class='fa fa-circle-o'></span>
        </a>
        <span> {{name}} </span>
      </div>
    {{/layer_controls.search_results}}

    {{#if layer_controls.search_results.length === 0}}
      <div class='search-results-empty'>
        <span class='fa fa-search'></span>
        <div class='text'>
          Type a search above to find Massachusetts locations.
        </div>
      </div>
    {{/if layer_controls.search_results.length === 0}}

  </div>
</script>

<script id="layer_controls_layer_group_template" type="text/ractive">
      <div class='show-cursor' on-tap="toggle-layer-active" >
        {{#if is_active}}
          <span class='fa fa-check-square-o'></span>
        {{else}}
          <span class='fa fa-square-o'></span>
        {{/if is_active}}
        <label class='show-cursor'>{{name}}</label>
      </div>
</script>
<script id="layer_controls_layer_group_tree_template" type="text/ractive">
  <li>
    {{#if folder_name}}
      <label on-tap="toggle-layer-group-collapse">
        {{#if is_expanded}}
          <span class='fa fa-caret-down'></span>
        {{else}}
          <span class='fa fa-caret-right'></span>
        {{/if}}

        {{folder_name}}
      </label>
    {{/if}}

    {{#if is_expanded}}
      <ul class='layer-group'>
        {{#children:i}}
          {{#if this.folder_name}}
            {{> layer_controls_layer_group_tree_template}}
          {{else}}
            <li class='layer show-cursor' on-tap="toggle-layer-active">
              {{#is_active_layer(layers.active, this)}}
                {{#if (layer_load_state(layers_loading_states, this) === "success")}}
                  <span class='fa fa-check-square-o'></span>
                {{else}}
                  <span class='fa fa-spinner fa-spin-custom'></span>
                {{/if}}
              {{else}}
                <span class='fa fa-square-o'></span>
              {{/if}}
              <a class='info {{layer_load_state(layers_loading_states, this)}}'
                 on-tap='show-layer-info'>
                <span class='fa fa-info'> </span>
              </a>
              <span>{{get_layer_defaults(layers.defaults, this).name}}</span>
            </li>
          {{/if}}
        {{/children}}
      </ul>
    {{/if}}
  </li>
</script>

<script id="layer_controls_layers_template" type="text/ractive">
  <div class='contents'>
    <div class='search-header col-md-12'>
      <div class='row'>
        <input id="layers_search_input" placeholder="Search for layers..." value="{{layers.search_string}}">
        {{#if layers.search_string.length > 0 }}
          <a>
            <span class='fa fa-times-circle-o show-cursor' on-tap="clear-layers-search-query"></span>
          </a>
        {{/if}}
      </div>
      <div class='row'>
        <div class='sector-select'>
          <label> Sectors: </label>
          <div class='selected-text-container' on-click='toggle-sector-dropdown'>
            <span class='selected'>{{selected_sectors_text(sectors.selected)}}</span>
          </div>
          <span on-click='toggle-sector-dropdown'
           class='fa fa-caret-down'></span>
          {{#if sectors.show_dropdown}}
            <div class='sector-selection-dropdown'>
              {{#sectors.all}}
                <div on-click='toggle-sector-selection'>
                  {{#if is_sector_selected(sectors.selected, .)}}
                    <span class='fa fa-check-square-o'></span>
                  {{else}}
                    <span class='fa fa-square-o'></span>
                  {{/if is_sector_selected(sectors.selected, .)}}
                  <span class='sector-name'>{{.}}</span>
                </div>
              {{/sectors.all}}
              <hr/>
              <span class='btn btn-block btn-primary' on-click='toggle-sector-dropdown'>
                Done
              </span>
              <span class='btn btn-sm btn-block btn-secondary' on-click='clear-sector-dropdown'>
                Clear All
              </span>
            </div>
          {{/if sectors.show_dropdown}}
        </div>
      </div>
    </div>
    <div class='search-results'>
      <ul class='layer-group'>
        {{#if layers.tree}}
          {{> layer_controls_layer_group_tree_template layers.tree}}
        {{/if}}
      </ul>
    </div>
  </div>
</script>

<script id="layer_controls_details_blocks_template" type="text/ractive">
  {{#if parameters.opacity !== false}}
    <div class='detail-block opacity'>
      <label  decorator='tooltip:Use slider to adjust layer transparency'> Opacity: </label>
      <input type="range" value="{{parameters.opacity}}" min="0" max="100">
      {{parameters.opacity}}%
    </div>
  {{/if}}
  {{#if !copied_source}}
    {{#templates.legend }}
      {{> templates.legend}}
    {{/templates.legend }}
  {{/if !copied_source}}

</script>

<script id="layer_controls_details_template" type="text/ractive">
  {{#if layers.active.length > 0 }}
    <div class='bulk'>
      {{#if !all_active_collapsed(layers.active)}}
        <a on-tap='collapse-all-layers' class='show-cursor'> Collapse All</a>
      {{else}}
        <a on-tap='expand-all-layers' class='show-cursor'> Expand All</a>
      {{/if}}

      {{#if !all_active_hidden(layers.active)}}
        <a on-tap='hide-all-layers' class='show-cursor'> Hide All</a>
      {{else}}
        <a on-tap='visible-all-layers' class='show-cursor'> Show All</a>
      {{/if}}

      <a on-tap='deactivate-all-layers' class='show-cursor'> Remove All</a>
    </div>
  {{else}}
    <div class='active-layers-empty'>
      <span class='fa fa-globe'></span>
      <div class='text'>
        You need to select some layers to display on the map.
        <br/>
        Look in the Layers tab to the left to choose.
      </div>
    </div>
  {{/if}}

  {{#each layers.active}}
    <div decorator='{{parameters.no_sorting ? "" : "sortable"}}' class='active-layer'>
      {{#if "" === layer_load_state(layers_loading_states, layer_default_id)}}
        <div class='disable-active-layer-overlay'>
          <label> Loading {{name}}...
            <span class='fa fa-spinner fa-spin-custom'></span>
          </label>
        </div>
      {{/if "" !== layer_load_state(layers_loading_states, layer_default_id)}}

      <label class='name' on-tap="toggle-active-collapsed">
        <span class='show-cursor'>
          {{#if is_collapsed}}
            <span decorator="tooltip:Expand Legend" class='fa fa-caret-right'></span>
            {{#if layer_load_state(layers_loading_states, layer_default_id) !== "success"}}
              <a decorator="tooltip:Show layer metadata" on-tap="show-active-layer-info" class='info {{layer_load_state(layers_loading_states, layer_default_id)}}'>
                <span class='show-cursor fa fa-info'></span>
              </a>
            {{/if}}
          {{else}}
            <span decorator="tooltip:Minimize Legend" class='fa fa-caret-down'></span>
          {{/if}}
          {{#if !parameters.no_sorting}}
            <span decorator="tooltip:Drag to reorder layer" class='drag-handle fa fa-hand-stop-o'></span>
          {{/if !parameters.no_sorting}}
          {{name}}
        </span>
      </label>

      {{#if !is_collapsed}}
        <div class='active-details'>
          <div class='control-bar'>
            <a decorator="tooltip:Remove layer" on-tap="remove-active">
              <span class='show-cursor fa fa-trash-o' > </span>
            </a>
            {{#if !parameters.no_sorting}}
              <a decorator="tooltip:Move to top" on-tap='move-active-to-top'>
                <span class='show-cursor fa fa-angle-double-up'> </span>
              </a>
            {{/if}}
            {{#if is_hidden}}
              <a decorator="tooltip:Make layer visible"  on-tap='make-active-visible'>
                <span class='show-cursor fa fa-eye-slash' ></span>
              </a>
            {{else}}
              <a decorator="tooltip:Make layer hidden"  on-tap='make-active-hidden'>
                <span class='show-cursor fa fa-eye'></span>
              </a>
            {{/if}}

            {{#if able_to_copy(this) }}
              <a decorator="tooltip:Clone this layer" on-tap="clone-active-layer">
                <span class='show-cursor fa fa-clone'></span>
              </a>
            {{/if}}

            <a decorator="tooltip:Show layer metadata" on-tap="show-active-layer-info" class='info {{layer_load_state(layers_loading_states, layer_default_id)}}'>
              <span class='show-cursor fa fa-info'></span>
            </a>

            {{#if layer_has_click_info(this)}}
              <a decorator="tooltip:Click on the map to find out more details">
                <span class='fa fa-map-marker' > </span>
              </a>
            {{/if layer_has_click_info(this)}}

            {{#if layer_has_standalone_wizard(this)}}
              <a decorator="tooltip:This layer has detailed instructions. Click to view" on-tap="show-standalone-wizard">
                <span class='fa fa-question'> </span>
              </a>
            {{/if layer_has_standalone_wizard(this)}}

          </div>
          {{> layer_controls_details_blocks_template}}
        </div>
      {{/if}}
    </div>
  {{/each}}
</script>

<script id="map_controls_template" type="text/ractive">
<div class='map-controls'>
  <div class='map-control print-control btn-group'>
    <span class='btn btn-md btn-default' on-tap="show-wizard">
      <span class='fa fa-question'></span>
    </span>
    <span class='btn btn-md btn-default add-layer'
          on-tap="open-layer-import-modal">
      <span class='fa fa-map-o'></span>
      <span class='fa fa-plus-circle'></span>
    </span>
    <span class='btn btn-md btn-default'
          on-tap="print-map">
      <span class='fa fa-print'></span>
    </span>

    <span class='btn btn-md btn-default'
          on-tap="open-sharing-modal">
      <span class='fa fa-share-alt'></span>
    </span>

  </div>

  <div class='map-control'>
    <span class='btn btn-md btn-default {{map_controls.base_layer_control_open ? "active" : ""}}'
          on-tap="toggle-base-layer-control"
      > Base Map </span>
    {{#map_controls.base_layer_control_open }}
      <div class='control-details base-layers'>
        {{#each base_layers}}
          <a class="base-layer show-cursor {{map_controls.active_base_layer === name ? 'active' : ''}}" on-tap="activate-base-layer">{{name}}</a>
        {{/each}}
      </div>
      <div class='map-control-bg' on-tap='toggle-base-layer-control'></div>
    {{/map_controls.base_layer_control_open }}
  </div>
  {{>zoom_controls_template}}
</div>
</script>

<!-- VIEW TEMPLATES -->

    <script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/leaflet-1.0.3/dist/leaflet-src.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e,i){var n={version:"1.0.3"};"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=n:"function"==typeof define&&define.amd&&define(n),void 0!==t&&function(){var e=t.L;n.noConflict=function(){return t.L=e,this},t.L=n}(),n.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++){o=arguments[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++n.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(i,o),o=!1)},s=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],s=n-o;return t===n&&i?t:((t-o)%s+s)%s+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return n.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?n.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(n.Util.templateRe,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){return t["webkit"+e]||t["moz"+e]||t["ms"+e]}function i(e){var i=+new Date,n=Math.max(0,16-(i-o));return o=i+n,t.setTimeout(e,n)}var o=0,s=t.requestAnimationFrame||e("RequestAnimationFrame")||i,r=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};n.Util.requestAnimFrame=function(e,o,r){if(!r||s!==i)return s.call(t,n.bind(e,o));e.call(o)},n.Util.cancelAnimFrame=function(e){e&&r.call(t,e)}}(),n.extend=n.Util.extend,n.bind=n.Util.bind,n.stamp=n.Util.stamp,n.setOptions=n.Util.setOptions,n.Class=function(){},n.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,o=n.Util.create(i);o.constructor=e,e.prototype=o;for(var s in this)this.hasOwnProperty(s)&&"prototype"!==s&&(e[s]=this[s]);return t.statics&&(n.extend(e,t.statics),delete t.statics),t.includes&&(n.Util.extend.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=n.Util.extend(n.Util.create(o.options),t.options)),n.extend(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},n.Class.include=function(t){return n.extend(this.prototype,t),this},n.Class.mergeOptions=function(t){return n.extend(this.prototype.options,t),this},n.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},n.Evented=n.Class.extend({on:function(t,e,i){if("object"===(void 0===t?"undefined":_typeof(t)))for(var o in t)this._on(o,t[o],e);else for(var s=0,r=(t=n.Util.splitWords(t)).length;s<r;s++)this._on(t[s],e,i);return this},off:function(t,e,i){if(t)if("object"===(void 0===t?"undefined":_typeof(t)))for(var o in t)this._off(o,t[o],e);else for(var s=0,r=(t=n.Util.splitWords(t)).length;s<r;s++)this._off(t[s],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var o={fn:e,ctx:i},s=n,r=0,a=s.length;r<a;r++)if(s[r].fn===e&&s[r].ctx===i)return;s.push(o)},_off:function(t,e,i){var o,s,r;if(this._events&&(o=this._events[t]))if(e){if(i===this&&(i=void 0),o)for(s=0,r=o.length;s<r;s++){var a=o[s];if(a.ctx===i&&a.fn===e)return a.fn=n.Util.falseFn,this._firingCount&&(this._events[t]=o=o.slice()),void o.splice(s,1)}}else{for(s=0,r=o.length;s<r;s++)o[s].fn=n.Util.falseFn;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var o=n.Util.extend({},e,{type:t,target:this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var h=s[r];h.fn.call(h.ctx||this,o)}this._firingCount--}}return i&&this._propagateEvent(o),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"===(void 0===t?"undefined":_typeof(t))){for(var o in t)this.once(o,t[o],e);return this}var s=n.bind(function(){this.off(t,e,i).off(t,s,i)},this);return this.on(t,e,i).on(t,s,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[n.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[n.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n.extend({layer:t.target},t),!0)}});var o=n.Evented.prototype;o.addEventListener=o.on,o.removeEventListener=o.clearAllEventListeners=o.off,o.addOneTimeEventListener=o.once,o.fireEvent=o.fire,o.hasEventListeners=o.listens,n.Mixin={Events:o},function(){var i=navigator.userAgent.toLowerCase(),o=e.documentElement,s="ActiveXObject"in t,r=-1!==i.indexOf("webkit"),a=-1!==i.indexOf("phantom"),h=-1!==i.search("android [23]"),l=-1!==i.indexOf("chrome"),u=-1!==i.indexOf("gecko")&&!r&&!t.opera&&!s,c=0===navigator.platform.indexOf("Win"),d="undefined"!=typeof orientation||-1!==i.indexOf("mobile"),_=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent||_,p=s&&"transition"in o.style,f="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!h,g="MozPerspective"in o.style,v="OTransition"in o.style,y=!t.L_NO_TOUCH&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);n.Browser={ie:s,ielt9:s&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:r,gecko:u,android:-1!==i.indexOf("android"),android23:h,chrome:l,safari:!l&&-1!==i.indexOf("safari"),win:c,ie3d:p,webkit3d:f,gecko3d:g,opera12:v,any3d:!t.L_DISABLE_3D&&(p||f||g)&&!v&&!a,mobile:d,mobileWebkit:d&&r,mobileWebkit3d:d&&f,mobileOpera:d&&t.opera,mobileGecko:d&&u,touch:!!y,msPointer:!!_,pointer:!!m,retina:(t.devicePixelRatio||t.screen.deviceXDPI/t.screen.logicalXDPI)>1}}(),n.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},n.Point.prototype={clone:function(){return new n.Point(this.x,this.y)},add:function(t){return this.clone()._add(n.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(n.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new n.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new n.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){var e=(t=n.point(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=n.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=n.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+n.Util.formatNum(this.x)+", "+n.Util.formatNum(this.y)+")"}},n.point=function(t,e,i){return t instanceof n.Point?t:n.Util.isArray(t)?new n.Point(t[0],t[1]):void 0===t||null===t?t:"object"===(void 0===t?"undefined":_typeof(t))&&"x"in t&&"y"in t?new n.Point(t.x,t.y):new n.Point(t,e,i)},n.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},n.Bounds.prototype={extend:function(t){return t=n.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new n.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new n.Point(this.min.x,this.max.y)},getTopRight:function(){return new n.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof n.Point?n.point(t):n.bounds(t),t instanceof n.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=n.bounds(t);var e=this.min,i=this.max,o=t.min,s=t.max,r=s.x>=e.x&&o.x<=i.x,a=s.y>=e.y&&o.y<=i.y;return r&&a},overlaps:function(t){t=n.bounds(t);var e=this.min,i=this.max,o=t.min,s=t.max,r=s.x>e.x&&o.x<i.x,a=s.y>e.y&&o.y<i.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},n.bounds=function(t,e){return!t||t instanceof n.Bounds?t:new n.Bounds(t,e)},n.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},n.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new n.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},n.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},create:function(t,i,n){var o=e.createElement(t);return o.className=i||"",n&&n.appendChild(o),o},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=n.DomUtil.getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(void 0!==t.classList)for(var i=n.Util.splitWords(e),o=0,s=i.length;o<s;o++)t.classList.add(i[o]);else if(!n.DomUtil.hasClass(t,e)){var r=n.DomUtil.getClass(t);n.DomUtil.setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){void 0!==t.classList?t.classList.remove(e):n.DomUtil.setClass(t,n.Util.trim((" "+n.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e},getClass:function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&n.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},setTransform:function(t,e,i){var o=e||new n.Point(0,0);t.style[n.DomUtil.TRANSFORM]=(n.Browser.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,n.Browser.any3d?n.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new n.Point(0,0)}},function(){n.DomUtil.TRANSFORM=n.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var i=n.DomUtil.TRANSITION=n.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(n.DomUtil.TRANSITION_END="webkitTransition"===i||"OTransition"===i?i+"End":"transitionend","onselectstart"in e)n.DomUtil.disableTextSelection=function(){n.DomEvent.on(t,"selectstart",n.DomEvent.preventDefault)},n.DomUtil.enableTextSelection=function(){n.DomEvent.off(t,"selectstart",n.DomEvent.preventDefault)};else{var o=n.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);n.DomUtil.disableTextSelection=function(){if(o){var t=e.documentElement.style;this._userSelect=t[o],t[o]="none"}},n.DomUtil.enableTextSelection=function(){o&&(e.documentElement.style[o]=this._userSelect,delete this._userSelect)}}n.DomUtil.disableImageDrag=function(){n.DomEvent.on(t,"dragstart",n.DomEvent.preventDefault)},n.DomUtil.enableImageDrag=function(){n.DomEvent.off(t,"dragstart",n.DomEvent.preventDefault)},n.DomUtil.preventOutline=function(e){for(;-1===e.tabIndex;)e=e.parentNode;e&&e.style&&(n.DomUtil.restoreOutline(),this._outlineElement=e,this._outlineStyle=e.style.outline,e.style.outline="none",n.DomEvent.on(t,"keydown",n.DomUtil.restoreOutline,this))},n.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,n.DomEvent.off(t,"keydown",n.DomUtil.restoreOutline,this))}}(),n.LatLng=function(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)},n.LatLng.prototype={equals:function(t,e){return!!t&&(t=n.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+n.Util.formatNum(this.lat,t)+", "+n.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return n.CRS.Earth.distance(this,n.latLng(t))},wrap:function(){return n.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return n.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new n.LatLng(this.lat,this.lng,this.alt)}},n.latLng=function(t,e,i){return t instanceof n.LatLng?t:n.Util.isArray(t)&&"object"!==_typeof(t[0])?3===t.length?new n.LatLng(t[0],t[1],t[2]):2===t.length?new n.LatLng(t[0],t[1]):null:void 0===t||null===t?t:"object"===(void 0===t?"undefined":_typeof(t))&&"lat"in t?new n.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new n.LatLng(t,e,i)},n.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},n.LatLngBounds.prototype={extend:function(t){var e,i,o=this._southWest,s=this._northEast;if(t instanceof n.LatLng)e=t,i=t;else{if(!(t instanceof n.LatLngBounds))return t?this.extend(n.latLng(t)||n.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return o||s?(o.lat=Math.min(e.lat,o.lat),o.lng=Math.min(e.lng,o.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new n.LatLng(e.lat,e.lng),this._northEast=new n.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,o=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new n.LatLngBounds(new n.LatLng(e.lat-o,e.lng-s),new n.LatLng(i.lat+o,i.lng+s))},getCenter:function(){return new n.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new n.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new n.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof n.LatLng||"lat"in t?n.latLng(t):n.latLngBounds(t);var e,i,o=this._southWest,s=this._northEast;return t instanceof n.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=o.lat&&i.lat<=s.lat&&e.lng>=o.lng&&i.lng<=s.lng},intersects:function(t){t=n.latLngBounds(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>=e.lat&&o.lat<=i.lat,a=s.lng>=e.lng&&o.lng<=i.lng;return r&&a},overlaps:function(t){t=n.latLngBounds(t);var e=this._southWest,i=this._northEast,o=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>e.lat&&o.lat<i.lat,a=s.lng>e.lng&&o.lng<i.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=n.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},n.latLngBounds=function(t,e){return t instanceof n.LatLngBounds?t:new n.LatLngBounds(t,e)},n.Projection={},n.Projection.LonLat={project:function(t){return new n.Point(t.lng,t.lat)},unproject:function(t){return new n.LatLng(t.y,t.x)},bounds:n.bounds([-180,-90],[180,90])},n.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,o=Math.max(Math.min(i,t.lat),-i),s=Math.sin(o*e);return new n.Point(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new n.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return n.bounds([-t,-t],[t,t])}()},n.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),o=this.transformation.transform(e.min,i),s=this.transformation.transform(e.max,i);return n.bounds(o,s)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?n.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?n.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,o=t.alt;return n.latLng(i,e,o)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),o=e.lat-i.lat,s=e.lng-i.lng;if(0===o&&0===s)return t;var r=t.getSouthWest(),a=t.getNorthEast(),h=n.latLng({lat:r.lat-o,lng:r.lng-s}),l=n.latLng({lat:a.lat-o,lng:a.lng-s});return new n.LatLngBounds(h,l)}},n.CRS.Simple=n.extend({},n.CRS,{projection:n.Projection.LonLat,transformation:new n.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),n.CRS.Earth=n.extend({},n.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,s=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(s,1))}}),n.CRS.EPSG3857=n.extend({},n.CRS.Earth,{code:"EPSG:3857",projection:n.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*n.Projection.SphericalMercator.R);return new n.Transformation(t,.5,-t,.5)}()}),n.CRS.EPSG900913=n.extend({},n.CRS.EPSG3857,{code:"EPSG:900913"}),n.CRS.EPSG4326=n.extend({},n.CRS.Earth,{code:"EPSG:4326",projection:n.Projection.LonLat,transformation:new n.Transformation(1/180,1,-1/180,.5)}),n.Map=n.Evented.extend({options:{crs:n.CRS.EPSG3857,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=n.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=n.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(n.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=n.DomUtil.TRANSITION&&n.Browser.any3d&&!n.Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),n.DomEvent.on(this._proxy,n.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(n.latLng(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n.extend({animate:i.animate},i.zoom),i.pan=n.extend({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(n.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(n.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var o=this.getZoomScale(e),s=this.getSize().divideBy(2),r=(t instanceof n.Point?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/o),a=this.containerPointToLatLng(s.add(r));return this.setView(a,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():n.latLngBounds(t);var i=n.point(e.paddingTopLeft||e.padding||[0,0]),o=n.point(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(o));s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s;var r=o.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),s),h=this.project(t.getNorthEast(),s);return{center:this.unproject(a.add(h).divideBy(2).add(r),s),zoom:s}},fitBounds:function(t,e){if(!(t=n.latLngBounds(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=n.point(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new n.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){n.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){function o(t){var e=(g*g-f*f+(t?-1:1)*P*P*v*v)/(2*(t?g:f)*P*v),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function s(t){return(Math.exp(t)-Math.exp(-t))/2}function r(t){return(Math.exp(t)+Math.exp(-t))/2}function a(t){return s(t)/r(t)}function h(t){return f*(r(L)/r(L+y*t))}function l(t){return f*(r(L)*a(L+y*t)-s(L))/P}function u(t){return 1-Math.pow(1-t,1.5)}function c(){var i=(Date.now()-x)/b,o=u(i)*w;i<=1?(this._flyToFrame=n.Util.requestAnimFrame(c,this),this._move(this.unproject(d.add(_.subtract(d).multiplyBy(l(o)/v)),p),this.getScaleZoom(f/h(o),p),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(!1===(i=i||{}).animate||!n.Browser.any3d)return this.setView(t,e,i);this._stop();var d=this.project(this.getCenter()),_=this.project(t),m=this.getSize(),p=this._zoom;t=n.latLng(t),e=void 0===e?p:e;var f=Math.max(m.x,m.y),g=f*this.getZoomScale(p,e),v=_.distanceTo(d)||1,y=1.42,P=y*y,L=o(0),x=Date.now(),w=(o(1)-L)/y,b=i.duration?1e3*i.duration:1e3*w*.8;return this._moveStart(!0),c.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=n.latLngBounds(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),o=this._limitCenter(i,this._zoom,n.latLngBounds(t));return i.equals(o)||this.panTo(o,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=n.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),s=i.divideBy(2).round(),r=o.subtract(s);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n.extend({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=n.bind(this._handleGeolocationResponse,this),i=n.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,o=new n.LatLng(e,i),s=o.toBounds(t.coords.accuracy),r=this._locateOptions;if(r.setView){var a=this.getBoundsZoom(s);this.setView(o,r.maxZoom?Math.min(a,r.maxZoom):a)}var h={latlng:o,bounds:s,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(h[l]=t.coords[l]);this.fire("locationfound",h)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}n.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var t in this._layers)this._layers[t].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),o=n.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=o),o},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new n.LatLngBounds(e,i)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=n.latLngBounds(t),i=n.point(i||[0,0]);var o=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),a=t.getNorthWest(),h=t.getSouthEast(),l=this.getSize().subtract(i),u=n.bounds(this.project(h,o),this.project(a,o)).getSize(),c=n.Browser.any3d?this.options.zoomSnap:1,d=Math.min(l.x/u.x,l.y/u.y);return o=this.getScaleZoom(d,o),c&&(o=Math.round(o/(c/100))*(c/100),o=e?Math.ceil(o/c)*c:Math.floor(o/c)*c),Math.max(s,Math.min(r,o))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new n.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new n.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(n.latLng(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(n.point(t),e)},layerPointToLatLng:function(t){var e=n.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(n.latLng(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(n.latLng(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(n.latLngBounds(t))},distance:function(t,e){return this.options.crs.distance(n.latLng(t),n.latLng(e))},containerPointToLayerPoint:function(t){return n.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return n.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(n.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(n.latLng(t)))},mouseEventToContainerPoint:function(t){return n.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=n.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");n.DomEvent.addListener(e,"scroll",this._onScroll,this),this._containerId=n.Util.stamp(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&n.Browser.any3d,n.DomUtil.addClass(t,"leaflet-container"+(n.Browser.touch?" leaflet-touch":"")+(n.Browser.retina?" leaflet-retina":"")+(n.Browser.ielt9?" leaflet-oldie":"")+(n.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=n.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),n.DomUtil.setPosition(this._mapPane,new n.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(n.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),n.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){n.DomUtil.setPosition(this._mapPane,new n.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o)._move(t,e)._moveEnd(o),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return n.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){n.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(n.DomEvent){this._targets={},this._targets[n.stamp(this._container)]=this;var i=e?"off":"on";n.DomEvent[i](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&n.DomEvent[i](t,"resize",this._onResize,this),n.Browser.any3d&&this.options.transform3DLimit&&this[i]("moveend",this._onMoveEnd)}},_onResize:function(){n.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=n.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,o=[],s="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if((i=this._targets[n.stamp(r)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(s&&!n.DomEvent._isExternalTarget(r,t))break;if(o.push(i),s)break}if(r===this._container)break;r=r.parentNode}return o.length||a||s||!n.DomEvent._isExternalTarget(r,t)||(o=[this]),o},_handleDOMEvent:function(t){if(this._loaded&&!n.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;"mousedown"===e&&n.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if("click"===t.type){var o=n.Util.extend({},t);o.type="preclick",this._fireDOMEvent(o,o.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e))).length){var s=i[0];"contextmenu"===e&&s.listens(e,!0)&&n.DomEvent.preventDefault(t);var r={originalEvent:t};if("keypress"!==t.type){var a=s instanceof n.Marker;r.containerPoint=a?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?s.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<i.length;h++)if(i[h].fire(e,r,!0),r.originalEvent._stopped||i[h].options.nonBubblingEvents&&-1!==n.Util.indexOf(i[h].options.nonBubblingEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return n.DomUtil.getPosition(this._mapPane)||new n.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var o=this._getNewPixelOrigin(i,e);return n.bounds([this.project(t.getSouthWest(),e)._subtract(o),this.project(t.getNorthWest(),e)._subtract(o),this.project(t.getSouthEast(),e)._subtract(o),this.project(t.getNorthEast(),e)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var o=this.project(t,e),s=this.getSize().divideBy(2),r=new n.Bounds(o.subtract(s),o.add(s)),a=this._getBoundsOffset(r,i,e);return a.round().equals([0,0])?t:this.unproject(o.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),o=new n.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(t,e,i){var o=n.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),s=o.min.subtract(t.min),r=o.max.subtract(t.max),a=this._rebound(s.x,-r.x),h=this._rebound(s.y,-r.y);return new n.Point(a,h)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),o=n.Browser.any3d?this.options.zoomSnap:1;return o&&(t=Math.round(t/o)*o),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){n.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=n.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=n.DomUtil.TRANSFORM,o=t.style[i];n.DomUtil.setTransform(t,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),o===t.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),i=this.getZoom();n.DomUtil.setTransform(t,this.project(e,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/o);return!(!0!==i.animate&&!this.getSize().contains(s))&&(n.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,o){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,n.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),setTimeout(n.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(n.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),n.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}),n.map=function(t,e){return new n.Map(t,e)},n.Layer=n.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[n.stamp(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[n.stamp(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),n.Map.include({addLayer:function(t){var e=n.stamp(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=n.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&n.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?n.Util.isArray(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[n.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=n.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var s="_leaflet_events";n.DomEvent={on:function(t,e,i,o){if("object"===(void 0===e?"undefined":_typeof(e)))for(var s in e)this._on(t,s,e[s],i);else for(var r=0,a=(e=n.Util.splitWords(e)).length;r<a;r++)this._on(t,e[r],i,o);return this},off:function(t,e,i,o){if("object"===(void 0===e?"undefined":_typeof(e)))for(var s in e)this._off(t,s,e[s],i);else for(var r=0,a=(e=n.Util.splitWords(e)).length;r<a;r++)this._off(t,e[r],i,o);return this},_on:function(e,i,o,r){var a=i+n.stamp(o)+(r?"_"+n.stamp(r):"");if(e[s]&&e[s][a])return this;var h=function(i){return o.call(r||e,i||t.event)},l=h;return n.Browser.pointer&&0===i.indexOf("touch")?this.addPointerListener(e,i,h,a):!n.Browser.touch||"dblclick"!==i||!this.addDoubleTapListener||n.Browser.pointer&&n.Browser.chrome?"addEventListener"in e?"mousewheel"===i?e.addEventListener("onwheel"in e?"wheel":"mousewheel",h,!1):"mouseenter"===i||"mouseleave"===i?(h=function(i){i=i||t.event,n.DomEvent._isExternalTarget(e,i)&&l(i)},e.addEventListener("mouseenter"===i?"mouseover":"mouseout",h,!1)):("click"===i&&n.Browser.android&&(h=function(t){return n.DomEvent._filterClick(t,l)}),e.addEventListener(i,h,!1)):"attachEvent"in e&&e.attachEvent("on"+i,h):this.addDoubleTapListener(e,h,a),e[s]=e[s]||{},e[s][a]=h,this},_off:function(t,e,i,o){var r=e+n.stamp(i)+(o?"_"+n.stamp(o):""),a=t[s]&&t[s][r];return a?(n.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,r):n.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,r):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[s][r]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,n.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return n.DomEvent.on(t,"mousewheel",n.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=n.DomEvent.stopPropagation;return n.DomEvent.on(t,n.Draggable.START.join(" "),e),n.DomEvent.on(t,{click:n.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return n.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new n.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new n.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},_wheelPxFactor:n.Browser.win&&n.Browser.chrome?2:n.Browser.gecko?t.devicePixelRatio:1,getWheelDelta:function(t){return n.Browser.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/n.DomEvent._wheelPxFactor:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(t){n.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,o=n.DomEvent._lastClick&&i-n.DomEvent._lastClick;o&&o>100&&o<500||t.target._simulatedClick&&!t._simulated?n.DomEvent.stop(t):(n.DomEvent._lastClick=i,e(t))}},n.DomEvent.addListener=n.DomEvent.on,n.DomEvent.removeListener=n.DomEvent.off,n.PosAnimation=n.Evented.extend({run:function(t,e,i,o){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=n.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=n.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),n.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){n.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),n.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:n.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,o=t.lat*e,s=this.R_MINOR/i,r=Math.sqrt(1-s*s),a=r*Math.sin(o),h=Math.tan(Math.PI/4-o/2)/Math.pow((1-a)/(1+a),r/2);return o=-i*Math.log(Math.max(h,1e-10)),new n.Point(t.lng*e*i,o)},unproject:function(t){for(var e,i=180/Math.PI,o=this.R,s=this.R_MINOR/o,r=Math.sqrt(1-s*s),a=Math.exp(-t.y/o),h=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=r*Math.sin(h),e=Math.pow((1-e)/(1+e),r/2),h+=u=Math.PI/2-2*Math.atan(a*e)-h;return new n.LatLng(h*i,t.x*i/o)}},n.CRS.EPSG3395=n.extend({},n.CRS.Earth,{code:"EPSG:3395",projection:n.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*n.Projection.Mercator.R);return new n.Transformation(t,.5,-t,.5)}()}),n.GridLayer=n.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:n.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){n.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),n.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(n.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(n.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=n.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return e.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof n.Point?t:new n.Point(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),o=0,s=i.length;o<s;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!n.Browser.ielt9){n.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var o in this._tiles){var s=this._tiles[o];if(s.current&&s.loaded){var r=Math.min(1,(t-s.loaded)/200);n.DomUtil.setOpacity(s.el,r),r<1?e=!0:(s.active&&(i=!0),s.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(n.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=n.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=n.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)this._levels[i].el.children.length||i===t?this._levels[i].el.style.zIndex=e-Math.abs(t-i):(n.DomUtil.remove(this._levels[i].el),this._removeTilesAtZoom(i),delete this._levels[i]);var o=this._levels[t],s=this._map;return o||((o=this._levels[t]={}).el=n.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=e,o.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),o.zoom=t,this._setZoomTransform(o,s.getCenter(),s.getZoom()),n.Util.falseFn(o.el.offsetWidth)),this._level=o,o}},_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)n.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,i,o){var s=Math.floor(t/2),r=Math.floor(e/2),a=i-1,h=new n.Point(+s,+r);h.z=+a;var l=this._tileCoordsToKey(h),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>o&&this._retainParent(s,r,a,o))},_retainChildren:function(t,e,i,o){for(var s=2*t;s<2*t+2;s++)for(var r=2*e;r<2*e+2;r++){var a=new n.Point(s,r);a.z=i+1;var h=this._tileCoordsToKey(a),l=this._tiles[h];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<o&&this._retainChildren(s,r,i+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,i,n){var o=Math.round(e);(void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom)&&(o=void 0);var s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var o=this._map.getZoomScale(i,t.zoom),s=t.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(e,i)).round();n.Browser.any3d?n.DomUtil.setTransform(t.el,s,o):n.DomUtil.setPosition(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(i,this._tileZoom),s=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*o);return new n.Bounds(s.subtract(r),s.add(r))},_update:function(t){var i=this._map;if(i){var o=i.getZoom();if(void 0===t&&(t=i.getCenter()),void 0!==this._tileZoom){var s=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(s),a=r.getCenter(),h=[],l=this.options.keepBuffer,u=new n.Bounds(r.getBottomLeft().subtract([l,-l]),r.getTopRight().add([l,-l]));for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&u.contains(n.point(d.x,d.y))||(this._tiles[c].current=!1)}if(Math.abs(o-this._tileZoom)>1)this._setView(t,o);else{for(var _=r.min.y;_<=r.max.y;_++)for(var m=r.min.x;m<=r.max.x;m++){var p=new n.Point(m,_);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:h.push(p)}}if(h.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)}),0!==h.length){this._loading||(this._loading=!0,this.fire("loading"));var g=e.createDocumentFragment();for(m=0;m<h.length;m++)this._addTile(h[m],g);this._level.el.appendChild(g)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(t);return n.latLngBounds(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),o=t.scaleBy(i),s=o.add(i),r=e.unproject(o,t.z),a=e.unproject(s,t.z),h=new n.LatLngBounds(r,a);return this.options.noWrap||e.wrapLatLngBounds(h),h},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new n.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(n.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){n.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=n.Util.falseFn,t.onmousemove=n.Util.falseFn,n.Browser.ielt9&&this.options.opacity<1&&n.DomUtil.setOpacity(t,this.options.opacity),n.Browser.android&&!n.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),o=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),n.bind(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&n.Util.requestAnimFrame(n.bind(this._tileReady,this,t,null,s)),n.DomUtil.setPosition(s,i),this._tiles[o]={el:s,coords:t,current:!0},e.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var o=this._tileCoordsToKey(t);(i=this._tiles[o])&&(i.loaded=+new Date,this._map._fadeAnimated?(n.DomUtil.setOpacity(i.el,0),n.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=n.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(n.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),n.Browser.ielt9||!this._map._fadeAnimated?n.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(n.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new n.Point(this._wrapX?n.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?n.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new n.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),n.gridLayer=function(t){return new n.GridLayer(t)},n.TileLayer=n.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=n.setOptions(this,e)).detectRetina&&n.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),n.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,i){var o=e.createElement("img");return n.DomEvent.on(o,"load",n.bind(this._tileOnLoad,this,i,o)),n.DomEvent.on(o,"error",n.bind(this._tileOnError,this,i,o)),this.options.crossOrigin&&(o.crossOrigin=""),o.alt="",o.setAttribute("role","presentation"),o.src=this.getTileUrl(t),o},getTileUrl:function(t){var e={r:n.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return n.Util.template(this._url,n.extend(e,this.options))},_tileOnLoad:function(t,e){n.Browser.ielt9?setTimeout(n.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.src!==n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=n.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,o=this.options.minNativeZoom,s=this.options.maxNativeZoom;return null!==o&&i<o?e.divideBy(t.getZoomScale(o,i)).round():null!==s&&i>s?e.divideBy(t.getZoomScale(s,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,n=this.options.zoomOffset,o=this.options.minNativeZoom,s=this.options.maxNativeZoom;return i&&(t=e-t),t+=n,null!==o&&t<o?o:null!==s&&t>s?s:t},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=n.Util.falseFn,e.onerror=n.Util.falseFn,e.complete||(e.src=n.Util.emptyImageUrl,n.DomUtil.remove(e)))}}),n.tileLayer=function(t,e){return new n.TileLayer(t,e)},n.TileLayer.WMS=n.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=n.extend({},this.defaultWmsParams);for(var o in e)o in this.options||(i[o]=e[o]);e=n.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&n.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,n.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),o=this._crs.project(e.getSouthEast()),s=(this._wmsVersion>=1.3&&this._crs===n.CRS.EPSG4326?[o.y,i.x,i.y,o.x]:[i.x,o.y,o.x,i.y]).join(","),r=n.TileLayer.prototype.getTileUrl.call(this,t);return r+n.Util.getParamString(this.wmsParams,r,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return n.extend(this.wmsParams,t),e||this.redraw(),this}}),n.tileLayer.wms=function(t,e){return new n.TileLayer.WMS(t,e)},n.ImageOverlay=n.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(t,e,i){this._url=t,this._bounds=n.latLngBounds(e),n.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(n.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){n.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&n.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&n.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=n.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=n.Util.falseFn,t.onmousemove=n.Util.falseFn,t.onload=n.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;n.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new n.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();n.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){n.DomUtil.setOpacity(this._image,this.options.opacity)}}),n.imageOverlay=function(t,e,i){return new n.ImageOverlay(t,e,i)},n.Icon=n.Class.extend({initialize:function(t){n.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,o=i[e+"Size"];"number"==typeof o&&(o=[o,o]);var s=n.point(o),r=n.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return n.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),n.icon=function(t){return new n.Icon(t)},n.Icon.Default=n.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return n.Icon.Default.imagePath||(n.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||n.Icon.Default.imagePath)+n.Icon.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=n.DomUtil.create("div","leaflet-default-icon-path",e.body),i=n.DomUtil.getStyle(t,"background-image")||n.DomUtil.getStyle(t,"backgroundImage");return e.body.removeChild(t),0===i.indexOf("url")?i.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),n.Marker=n.Layer.extend({options:{icon:new n.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(t,e){n.setOptions(this,e),this._latlng=n.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=n.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),o=!1;i!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),n.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=t.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&(n.DomUtil.addClass(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),n.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&n.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){n.DomUtil.setPosition(this._icon,t),this._shadow&&n.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(n.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),n.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new n.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;n.DomUtil.setOpacity(this._icon,t),this._shadow&&n.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),n.marker=function(t,e){return new n.Marker(t,e)},n.DivIcon=n.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),o=this.options;if(i.innerHTML=!1!==o.html?o.html:"",o.bgPos){var s=n.point(o.bgPos);i.style.backgroundPosition=-s.x+"px "+-s.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),n.divIcon=function(t){return new n.DivIcon(t)},n.DivOverlay=n.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){n.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&n.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&n.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(n.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(n.bind(n.DomUtil.remove,n.DomUtil,this._container),200)):n.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=n.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&n.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&n.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=n.point(this.options.offset),i=this._getAnchor();this._zoomAnimated?n.DomUtil.setPosition(this._container,t.add(i)):e=e.add(t).add(i);var o=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}}),n.Popup=n.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){n.DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof n.Path||this._source.on("preclick",n.DomEvent.stopPropagation))},onRemove:function(t){n.DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof n.Path||this._source.off("preclick",n.DomEvent.stopPropagation))},getEvents:function(){var t=n.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=n.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var i=this._closeButton=n.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",n.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var o=this._wrapper=n.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=n.DomUtil.create("div",t+"-content",o),n.DomEvent.disableClickPropagation(o).disableScrollPropagation(this._contentNode).on(o,"contextmenu",n.DomEvent.stopPropagation),this._tipContainer=n.DomUtil.create("div",t+"-tip-container",e),this._tip=n.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var o=t.offsetHeight,s=this.options.maxHeight;s&&o>s?(e.height=s+"px",n.DomUtil.addClass(t,"leaflet-popup-scrolled")):n.DomUtil.removeClass(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();n.DomUtil.setPosition(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(n.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,o=this._containerWidth,s=new n.Point(this._containerLeft,-i-this._containerBottom);s._add(n.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(s),a=n.point(this.options.autoPanPadding),h=n.point(this.options.autoPanPaddingTopLeft||a),l=n.point(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),c=0,d=0;r.x+o+l.x>u.x&&(c=r.x+o-u.x+l.x),r.x-c-h.x<0&&(c=r.x-h.x),r.y+i+l.y>u.y&&(d=r.y+i-u.y+l.y),r.y-d-h.y<0&&(d=r.y-h.y),(c||d)&&t.fire("autopanstart").panBy([c,d])}},_onCloseButtonClick:function(t){this._close(),n.DomEvent.stop(t)},_getAnchor:function(){return n.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),n.popup=function(t,e){return new n.Popup(t,e)},n.Map.mergeOptions({closePopupOnClick:!0}),n.Map.include({openPopup:function(t,e,i){return t instanceof n.Popup||(t=new n.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),n.Layer.include({bindPopup:function(t,e){return t instanceof n.Popup?(n.setOptions(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new n.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof n.Layer||(e=t,t=this),t instanceof n.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(n.DomEvent.stop(t),e instanceof n.Path?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),n.Tooltip=n.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){n.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){n.DivOverlay.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=n.DivOverlay.prototype.getEvents.call(this);return n.Browser.touch&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=n.DomUtil.create("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,o=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),r=this.options.direction,a=i.offsetWidth,h=i.offsetHeight,l=n.point(this.options.offset),u=this._getAnchor();"top"===r?t=t.add(n.point(-a/2+l.x,-h+l.y+u.y,!0)):"bottom"===r?t=t.subtract(n.point(a/2-l.x,-l.y,!0)):"center"===r?t=t.subtract(n.point(a/2+l.x,h/2-u.y+l.y,!0)):"right"===r||"auto"===r&&s.x<o.x?(r="right",t=t.add(n.point(l.x+u.x,u.y-h/2+l.y,!0))):(r="left",t=t.subtract(n.point(a+u.x-l.x,h/2-u.y-l.y,!0))),n.DomUtil.removeClass(i,"leaflet-tooltip-right"),n.DomUtil.removeClass(i,"leaflet-tooltip-left"),n.DomUtil.removeClass(i,"leaflet-tooltip-top"),n.DomUtil.removeClass(i,"leaflet-tooltip-bottom"),n.DomUtil.addClass(i,"leaflet-tooltip-"+r),n.DomUtil.setPosition(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&n.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return n.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),n.tooltip=function(t,e){return new n.Tooltip(t,e)},n.Map.include({openTooltip:function(t,e,i){return t instanceof n.Tooltip||(t=new n.Tooltip(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),n.Layer.include({bindTooltip:function(t,e){return t instanceof n.Tooltip?(n.setOptions(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=n.tooltip(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),n.Browser.touch&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof n.Layer||(e=t,t=this),t instanceof n.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(n.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(n.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),n.LayerGroup=n.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return n.stamp(t)}}),n.layerGroup=function(t){return new n.LayerGroup(t)},n.FeatureGroup=n.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),n.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),n.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new n.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),n.featureGroup=function(t){return new n.FeatureGroup(t)},n.Renderer=n.Layer.extend({options:{padding:.1},initialize:function(t){n.setOptions(this,t),n.stamp(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&n.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){n.DomUtil.remove(this._container),this.off("update",this._updatePaths,this)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),o=n.DomUtil.getPosition(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),a=this._map.project(t,e).subtract(r),h=s.multiplyBy(-i).add(o).add(s).subtract(a);n.Browser.any3d?n.DomUtil.setTransform(this._container,h,i):n.DomUtil.setPosition(this._container,h)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new n.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),n.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&n.canvas()||n.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=n.SVG&&n.svg({pane:t})||n.Canvas&&n.canvas({pane:t}),this._paneRenderers[t]=e),e}}),n.Path=n.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return n.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(n.Browser.touch?10:0)}}),n.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=new(("undefined"==typeof Uint8Array?"undefined":_typeof(Uint8Array))!==void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,this._simplifyDPStep(t,n,e,0,i-1);var o,s=[];for(o=0;o<i;o++)n[o]&&s.push(t[o]);return s},_simplifyDPStep:function(t,e,i,n,o){var s,r,a,h=0;for(r=n+1;r<=o-1;r++)(a=this._sqClosestPointOnSegment(t[r],t[n],t[o],!0))>h&&(s=r,h=a);h>i&&(e[s]=1,this._simplifyDPStep(t,e,i,n,s),this._simplifyDPStep(t,e,i,s,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i},clipSegment:function(t,e,i,n,o){var s,r,a,h=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(h|l))return[t,e];if(h&l)return!1;s=h||l,r=this._getEdgeIntersection(t,e,s,i,o),a=this._getBitCode(r,i),s===h?(t=r,h=a):(e=r,l=a)}},_getEdgeIntersection:function(t,e,i,o,s){var r,a,h=e.x-t.x,l=e.y-t.y,u=o.min,c=o.max;return 8&i?(r=t.x+h*(c.y-t.y)/l,a=c.y):4&i?(r=t.x+h*(u.y-t.y)/l,a=u.y):2&i?(r=c.x,a=t.y+l*(c.x-t.x)/h):1&i&&(r=u.x,a=t.y+l*(u.x-t.x)/h),new n.Point(r,a,s)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,o){var s,r=e.x,a=e.y,h=i.x-r,l=i.y-a,u=h*h+l*l;return u>0&&((s=((t.x-r)*h+(t.y-a)*l)/u)>1?(r=i.x,a=i.y):s>0&&(r+=h*s,a+=l*s)),h=t.x-r,l=t.y-a,o?h*h+l*l:new n.Point(r,a)}},n.Polyline=n.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){n.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,o=1/0,s=null,r=n.LineUtil._sqClosestPointOnSegment,a=0,h=this._parts.length;a<h;a++)for(var l=this._parts[a],u=1,c=l.length;u<c;u++){var d=r(t,e=l[u-1],i=l[u],!0);d<o&&(o=d,s=r(t,e,i))}return s&&(s.distance=Math.sqrt(o)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if(o=a[t],s=a[t+1],i=o.distanceTo(s),(n+=i)>e)return r=(n-e)/i,this._map.layerPointToLatLng([s.x-r*(s.x-o.x),s.y-r*(s.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=n.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new n.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return n.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=n.Polyline._flat(t),o=0,s=t.length;o<s;o++)i?(e[o]=n.latLng(t[o]),this._bounds.extend(e[o])):e[o]=this._convertLatLngs(t[o]);return e},_project:function(){var t=new n.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new n.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var o,s,r=t[0]instanceof n.LatLng,a=t.length;if(r){for(s=[],o=0;o<a;o++)s[o]=this._map.latLngToLayerPoint(t[o]),i.extend(s[o]);e.push(s)}else for(o=0;o<a;o++)this._projectLatlngs(t[o],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,o,s,r,a,h,l=this._parts;for(e=0,o=0,s=this._rings.length;e<s;e++)for(i=0,r=(h=this._rings[e]).length;i<r-1;i++)(a=n.LineUtil.clipSegment(h[i],h[i+1],t,i,!0))&&(l[o]=l[o]||[],l[o].push(a[0]),a[1]===h[i+1]&&i!==r-2||(l[o].push(a[1]),o++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,o=t.length;i<o;i++)t[i]=n.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),n.polyline=function(t,e){return new n.Polyline(t,e)},n.Polyline._flat=function(t){return!n.Util.isArray(t[0])||"object"!==_typeof(t[0][0])&&void 0!==t[0][0]},n.PolyUtil={},n.PolyUtil.clipPolygon=function(t,e,i){var o,s,r,a,h,l,u,c,d,_=[1,4,2,8],m=n.LineUtil;for(s=0,u=t.length;s<u;s++)t[s]._code=m._getBitCode(t[s],e);for(a=0;a<4;a++){for(c=_[a],o=[],s=0,r=(u=t.length)-1;s<u;r=s++)h=t[s],l=t[r],h._code&c?l._code&c||((d=m._getEdgeIntersection(l,h,c,e,i))._code=m._getBitCode(d,e),o.push(d)):(l._code&c&&((d=m._getEdgeIntersection(l,h,c,e,i))._code=m._getBitCode(d,e),o.push(d)),o.push(h));t=o}return t},n.Polygon=n.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a,h,l=this._rings[0],u=l.length;if(!u)return null;for(s=r=a=0,t=0,e=u-1;t<u;e=t++)i=l[t],n=l[e],o=i.y*n.x-n.y*i.x,r+=(i.x+n.x)*o,a+=(i.y+n.y)*o,s+=3*o;return h=0===s?l[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=n.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof n.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){n.Polyline.prototype._setLatLngs.call(this,t),n.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return n.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new n.Point(e,e);if(t=new n.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var o,s=0,r=this._rings.length;s<r;s++)(o=n.PolyUtil.clipPolygon(this._rings[s],t,!0)).length&&this._parts.push(o)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),n.polygon=function(t,e){return new n.Polygon(t,e)},n.Rectangle=n.Polygon.extend({initialize:function(t,e){n.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=n.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),n.rectangle=function(t,e){return new n.Rectangle(t,e)},n.CircleMarker=n.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){n.setOptions(this,e),this._latlng=n.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=n.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return n.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),o=[t+i,e+i];this._pxBounds=new n.Bounds(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),n.circleMarker=function(t,e){return new n.CircleMarker(t,e)},n.Circle=n.CircleMarker.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=n.extend({},i,{radius:e})),n.setOptions(this,e),this._latlng=n.latLng(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new n.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:n.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,o=i.options.crs;if(o.distance===n.CRS.Earth.distance){var s=Math.PI/180,r=this._mRadius/n.CRS.Earth.R/s,a=i.project([e+r,t]),h=i.project([e-r,t]),l=a.add(h).divideBy(2),u=i.unproject(l).lat,c=Math.acos((Math.cos(r*s)-Math.sin(e*s)*Math.sin(u*s))/(Math.cos(e*s)*Math.cos(u*s)))/s;(isNaN(c)||0===c)&&(c=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(l.x-i.project([u,t-c]).x),1),this._radiusY=Math.max(Math.round(l.y-a.y),1)}else{var d=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(d).x}this._updateBounds()}}),n.circle=function(t,e,i){return new n.Circle(t,e,i)},n.SVG=n.Renderer.extend({getEvents:function(){var t=n.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=n.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=n.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){n.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),n.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=n.SVG.create("path");t.options.className&&n.DomUtil.addClass(e,t.options.className),t.options.interactive&&n.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t),this._layers[n.stamp(t)]=t},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){n.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path),delete this._layers[n.stamp(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,n.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n="a"+i+","+(t._radiusY||i)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){n.DomUtil.toFront(t._path)},_bringToBack:function(t){n.DomUtil.toBack(t._path)}}),n.extend(n.SVG,{create:function(t){return e.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,o,s,r,a,h,l="";for(i=0,s=t.length;i<s;i++){for(o=0,r=(a=t[i]).length;o<r;o++)h=a[o],l+=(o?"L":"M")+h.x+" "+h.y;l+=e?n.Browser.svg?"z":"x":""}return l||"M0 0"}}),n.Browser.svg=!(!e.createElementNS||!n.SVG.create("svg").createSVGRect),n.svg=function(t){return n.Browser.svg||n.Browser.vml?new n.SVG(t):null},n.Browser.vml=!n.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"===_typeof(i.adj)}catch(t){return!1}}(),n.SVG.include(n.Browser.vml?{_initContainer:function(){this._container=n.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(n.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=n.SVG.create("shape");n.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=n.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[n.stamp(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;n.DomUtil.remove(e),t.removeInteractiveTarget(e),delete this._layers[n.stamp(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,o=t.options,s=t._container;s.stroked=!!o.stroke,s.filled=!!o.fill,o.stroke?(e||(e=t._stroke=n.SVG.create("stroke")),s.appendChild(e),e.weight=o.weight+"px",e.color=o.color,e.opacity=o.opacity,o.dashArray?e.dashStyle=n.Util.isArray(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=o.lineCap.replace("butt","flat"),e.joinstyle=o.lineJoin):e&&(s.removeChild(e),t._stroke=null),o.fill?(i||(i=t._fill=n.SVG.create("fill")),s.appendChild(i),i.color=o.fillColor||o.color,i.opacity=o.fillOpacity):i&&(s.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){n.DomUtil.toFront(t._container)},_bringToBack:function(t){n.DomUtil.toBack(t._container)}}:{}),n.Browser.vml&&(n.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),n.Canvas=n.Renderer.extend({getEvents:function(){var t=n.Renderer.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){n.Renderer.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=e.createElement("canvas");n.DomEvent.on(t,"mousemove",n.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var t in this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},n.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),o=n.Browser.retina?2:1;n.DomUtil.setPosition(e,t.min),e.width=o*i.x,e.height=o*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",n.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){n.Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[n.stamp(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,o=e.prev;i?i.prev=o:this._drawLast=o,o?o.next=i:this._drawFirst=i,delete t._order,delete this._layers[n.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||n.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(t){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new n.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),h.setLineDash&&h.setLineDash(t.options&&t.options._dashArray||[]),i=0;i<a;i++){for(n=0,o=r[i].length;n<o;n++)s=r[i][n],h[n?"lineTo":"moveTo"](s.x,s.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,o=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(o)&&!this._map._draggableMoved(e)&&(i=e);i&&(n.DomEvent._fakeStop(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(n.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,o,s=this._drawFirst;s;s=s.next)(i=s.layer).options.interactive&&i._containsPoint(e)&&(o=i);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(n.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),n.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),n.canvas=function(t){return n.Browser.canvas?new n.Canvas(t):null},n.Polyline.prototype._containsPoint=function(t,e){var i,o,s,r,a,h,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;i<r;i++)for(o=0,s=(a=(h=this._parts[i]).length)-1;o<a;s=o++)if((e||0!==o)&&n.LineUtil.pointToSegmentDistance(t,h[s],h[o])<=l)return!0;return!1},n.Polygon.prototype._containsPoint=function(t){var e,i,o,s,r,a,h,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(s=0,h=this._parts.length;s<h;s++)for(r=0,a=(l=(e=this._parts[s]).length)-1;r<l;a=r++)i=e[r],o=e[a],i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(u=!u);return u||n.Polyline.prototype._containsPoint.call(this,t,!0)},n.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},n.GeoJSON=n.FeatureGroup.extend({initialize:function(t,e){n.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,o,s=n.Util.isArray(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)((o=s[e]).geometries||o.geometry||o.features||o.coordinates)&&this.addData(o);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var a=n.GeoJSON.geometryToLayer(t,r);return a?(a.feature=n.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),r.onEachFeature&&r.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return t.options=n.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),n.extend(n.GeoJSON,{geometryToLayer:function(t,e){var i,o,s,r,a="Feature"===t.type?t.geometry:t,h=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||this.coordsToLatLng;if(!h&&!a)return null;switch(a.type){case"Point":return i=c(h),u?u(t,i):new n.Marker(i);case"MultiPoint":for(s=0,r=h.length;s<r;s++)i=c(h[s]),l.push(u?u(t,i):new n.Marker(i));return new n.FeatureGroup(l);case"LineString":case"MultiLineString":return o=this.coordsToLatLngs(h,"LineString"===a.type?0:1,c),new n.Polyline(o,e);case"Polygon":case"MultiPolygon":return o=this.coordsToLatLngs(h,"Polygon"===a.type?1:2,c),new n.Polygon(o,e);case"GeometryCollection":for(s=0,r=a.geometries.length;s<r;s++){var d=this.geometryToLayer({geometry:a.geometries[s],type:"Feature",properties:t.properties},e);d&&l.push(d)}return new n.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new n.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],s=0,r=t.length;s<r;s++)n=e?this.coordsToLatLngs(t[s],e-1,i):(i||this.coordsToLatLng)(t[s]),o.push(n);return o},latLngToCoords:function(t){return void 0!==t.alt?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var o=[],s=0,r=t.length;s<r;s++)o.push(e?n.GeoJSON.latLngsToCoords(t[s],e-1,i):n.GeoJSON.latLngToCoords(t[s]));return!e&&i&&o.push(o[0]),o},getFeature:function(t,e){return t.feature?n.extend({},t.feature,{geometry:e}):n.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var r={toGeoJSON:function(){return n.GeoJSON.getFeature(this,{type:"Point",coordinates:n.GeoJSON.latLngToCoords(this.getLatLng())})}};n.Marker.include(r),n.Circle.include(r),n.CircleMarker.include(r),n.Polyline.prototype.toGeoJSON=function(){var t=!n.Polyline._flat(this._latlngs),e=n.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return n.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},n.Polygon.prototype.toGeoJSON=function(){var t=!n.Polyline._flat(this._latlngs),e=t&&!n.Polyline._flat(this._latlngs[0]),i=n.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),n.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},n.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),n.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var o=t.toGeoJSON();i.push(e?o.geometry:n.GeoJSON.asFeature(o))}}),e?n.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),n.geoJSON=function(t,e){return new n.GeoJSON(t,e)},n.geoJson=n.geoJSON,n.Draggable=n.Evented.extend({options:{clickTolerance:3},statics:{START:n.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(n.DomEvent.on(this._dragStartTarget,n.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(n.Draggable._dragging===this&&this.finishDrag(),n.DomEvent.off(this._dragStartTarget,n.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!n.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(n.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(n.Draggable._dragging=this,this._preventOutline&&n.DomUtil.preventOutline(this._element),n.DomUtil.disableImageDrag(),n.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var i=t.touches?t.touches[0]:t;this._startPoint=new n.Point(i.clientX,i.clientY),n.DomEvent.on(e,n.Draggable.MOVE[t.type],this._onMove,this).on(e,n.Draggable.END[t.type],this._onUp,this)}},_onMove:function(i){if(!i._simulated&&this._enabled)if(i.touches&&i.touches.length>1)this._moved=!0;else{var o=i.touches&&1===i.touches.length?i.touches[0]:i,s=new n.Point(o.clientX,o.clientY).subtract(this._startPoint);(s.x||s.y)&&(Math.abs(s.x)+Math.abs(s.y)<this.options.clickTolerance||(n.DomEvent.preventDefault(i),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=n.DomUtil.getPosition(this._element).subtract(s),n.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,t.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),n.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(s),this._moving=!0,n.Util.cancelAnimFrame(this._animRequest),this._lastEvent=i,this._animRequest=n.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),n.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){n.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(n.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in n.Draggable.MOVE)n.DomEvent.off(e,n.Draggable.MOVE[t],this._onMove,this).off(e,n.Draggable.END[t],this._onUp,this);n.DomUtil.enableImageDrag(),n.DomUtil.enableTextSelection(),this._moved&&this._moving&&(n.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,n.Draggable._dragging=!1}}),n.Handler=n.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),n.Map.mergeOptions({dragging:!0,inertia:!n.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),n.Map.Drag=n.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new n.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}n.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){n.DomUtil.removeClass(this._map._container,"leaflet-grab"),n.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=n.latLngBounds(this._map.options.maxBounds);this._offsetLimit=n.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,r=Math.abs(o+i)<Math.abs(s+i)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,o=!i.inertia||this._times.length<2;if(e.fire("dragend",t),o)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,a=i.easeLinearity,h=s.multiplyBy(a/r),l=h.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),c=h.multiplyBy(u/l),d=u/(i.inertiaDeceleration*a),_=c.multiplyBy(-d/2).round();_.x||_.y?(_=e._limitOffset(_,e.options.maxBounds),n.Util.requestAnimFrame(function(){e.panBy(_,{duration:d,easeLinearity:a,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),n.Map.addInitHook("addHandler","dragging",n.Map.Drag),n.Map.mergeOptions({doubleClickZoom:!0}),n.Map.DoubleClickZoom=n.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),n.Map.addInitHook("addHandler","doubleClickZoom",n.Map.DoubleClickZoom),n.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),n.Map.ScrollWheelZoom=n.Handler.extend({addHooks:function(){n.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){n.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=n.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n.bind(this._performZoom,this),o),n.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=i?Math.ceil(o/i)*i:o,r=t._limitZoom(e+(this._delta>0?s:-s))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}}),n.Map.addInitHook("addHandler","scrollWheelZoom",n.Map.ScrollWheelZoom),n.extend(n.DomEvent,{_touchstart:n.Browser.msPointer?"MSPointerDown":n.Browser.pointer?"pointerdown":"touchstart",_touchend:n.Browser.msPointer?"MSPointerUp":n.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function o(t){var e;if(n.Browser.pointer){if(!n.Browser.edge||"mouse"===t.pointerType)return;e=n.DomEvent._pointersCount}else e=t.touches.length;if(!(e>1)){var i=Date.now(),o=i-(r||i);a=t.touches?t.touches[0]:t,h=o>0&&o<=l,r=i}}function s(t){if(h&&!a.cancelBubble){if(n.Browser.pointer){if(!n.Browser.edge||"mouse"===t.pointerType)return;var i,o,s={};for(o in a)i=a[o],s[o]=i&&i.bind?i.bind(a):i;a=s}a.type="dblclick",e(a),r=null}}var r,a,h=!1,l=250,u="_leaflet_",c=this._touchstart,d=this._touchend;return t[u+c+i]=o,t[u+d+i]=s,t[u+"dblclick"+i]=e,t.addEventListener(c,o,!1),t.addEventListener(d,s,!1),t.addEventListener("dblclick",e,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",o=t[i+this._touchstart+e],s=t[i+this._touchend+e],r=t[i+"dblclick"+e];return t.removeEventListener(this._touchstart,o,!1),t.removeEventListener(this._touchend,s,!1),n.Browser.edge||t.removeEventListener("dblclick",r,!1),this}}),n.extend(n.DomEvent,{POINTER_DOWN:n.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:n.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:n.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:n.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,i,o){var s=n.bind(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(t.target.tagName)<0))return;n.DomEvent.preventDefault(t)}this._handlePointer(t,i)},this);if(t["_leaflet_touchstart"+o]=s,t.addEventListener(this.POINTER_DOWN,s,!1),!this._pointerDocListener){var r=n.bind(this._globalPointerUp,this);e.documentElement.addEventListener(this.POINTER_DOWN,n.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,n.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,r,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,r,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var o=n.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1)},_addPointerEnd:function(t,e,i){var o=n.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=o,t.addEventListener(this.POINTER_UP,o,!1),t.addEventListener(this.POINTER_CANCEL,o,!1)}}),n.Map.mergeOptions({touchZoom:n.Browser.touch&&!n.Browser.android23,bounceAtZoomLimits:!0}),n.Map.TouchZoom=n.Handler.extend({addHooks:function(){n.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),n.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){n.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),n.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var o=i.mouseEventToContainerPoint(t.touches[0]),s=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(o.add(s)._divideBy(2))),this._startDist=o.distanceTo(s),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),n.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),n.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),s=i.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(s,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&s<1||this._zoom>e.getMaxZoom()&&s>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=i._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),n.Util.cancelAnimFrame(this._animRequest);var a=n.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=n.Util.requestAnimFrame(a,this,!0),n.DomEvent.preventDefault(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,n.Util.cancelAnimFrame(this._animRequest),n.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}}),n.Map.addInitHook("addHandler","touchZoom",n.Map.TouchZoom),n.Map.mergeOptions({tap:!0,tapTolerance:15}),n.Map.Tap=n.Handler.extend({addHooks:function(){n.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){n.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(n.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],o=i.target;this._startPos=this._newPos=new n.Point(i.clientX,i.clientY),o.tagName&&"a"===o.tagName.toLowerCase()&&n.DomUtil.addClass(o,"leaflet-active"),this._holdTimeout=setTimeout(n.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),n.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),n.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],o=i.target;o&&o.tagName&&"a"===o.tagName.toLowerCase()&&n.DomUtil.removeClass(o,"leaflet-active"),this._simulateEvent("mouseup",i),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new n.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),n.Browser.touch&&!n.Browser.pointer&&n.Map.addInitHook("addHandler","tap",n.Map.Tap),n.Map.mergeOptions({boxZoom:!0}),n.Map.BoxZoom=n.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){n.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){n.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._resetState(),n.DomUtil.disableTextSelection(),n.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),n.DomEvent.on(e,{contextmenu:n.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=n.DomUtil.create("div","leaflet-zoom-box",this._container),n.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new n.Bounds(this._point,this._startPoint),i=e.getSize();n.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(n.DomUtil.remove(this._box),n.DomUtil.removeClass(this._container,"leaflet-crosshair")),n.DomUtil.enableTextSelection(),n.DomUtil.enableImageDrag(),n.DomEvent.off(e,{contextmenu:n.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(n.bind(this._resetState,this),0);var e=new n.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),n.Map.addInitHook("addHandler","boxZoom",n.Map.BoxZoom),n.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),n.Map.Keyboard=n.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),n.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),n.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,s=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){n.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){n.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,o=this._map;if(i in this._panKeys){if(o._panAnim&&o._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=n.point(e).multiplyBy(3)),o.panBy(e),o.options.maxBounds&&o.panInsideBounds(o.options.maxBounds)}else if(i in this._zoomKeys)o.setZoom(o.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;o.closePopup()}n.DomEvent.stop(t)}}}),n.Map.addInitHook("addHandler","keyboard",n.Map.Keyboard),n.Handler.MarkerDrag=n.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new n.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),n.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&n.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,o=n.DomUtil.getPosition(e._icon),s=e._map.layerPointToLatLng(o);i&&n.DomUtil.setPosition(i,o),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),n.Control=n.Class.extend({options:{position:"topright"},initialize:function(t){n.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),o=t._controlCorners[i];return n.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?o.insertBefore(e,o.firstChild):o.appendChild(e),this},remove:function(){return this._map?(n.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),n.control=function(t){return new n.Control(t)},n.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,s){var r=i+t+" "+i+s;e[t+s]=n.DomUtil.create("div",r,o)}var e=this._controlCorners={},i="leaflet-",o=this._controlContainer=n.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){n.DomUtil.remove(this._controlContainer)}}),n.Control.Zoom=n.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=n.DomUtil.create("div",e+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,o,s){var r=n.DomUtil.create("a",i,o);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),n.DomEvent.on(r,"mousedown dblclick",n.DomEvent.stopPropagation).on(r,"click",n.DomEvent.stop).on(r,"click",s,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";n.DomUtil.removeClass(this._zoomInButton,e),n.DomUtil.removeClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&n.DomUtil.addClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&n.DomUtil.addClass(this._zoomInButton,e)}}),n.Map.mergeOptions({zoomControl:!0}),n.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new n.Control.Zoom,this.addControl(this.zoomControl))}),n.control.zoom=function(t){return new n.Control.Zoom(t)},n.Control.Attribution=n.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){n.setOptions(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=n.DomUtil.create("div","leaflet-control-attribution"),n.DomEvent&&n.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),n.Map.mergeOptions({attributionControl:!0}),n.Map.addInitHook(function(){this.options.attributionControl&&(new n.Control.Attribution).addTo(this)}),n.control.attribution=function(t){return new n.Control.Attribution(t)},n.Control.Scale=n.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e=n.DomUtil.create("div","leaflet-control-scale"),i=this.options;return this._addScales(i,"leaflet-control-scale-line",e),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=n.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=n.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),n.control.scale=function(t){return new n.Control.Scale(t)},n.Control.Layers=n.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){n.setOptions(this,i),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var o in t)this._addLayer(t[o],o);for(o in e)this._addLayer(e[o],o,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(n.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){n.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(n.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):n.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return n.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=n.DomUtil.create("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),n.DomEvent.disableClickPropagation(e),n.Browser.touch||n.DomEvent.disableScrollPropagation(e);var o=this._form=n.DomUtil.create("form",t+"-list");i&&(this._map.on("click",this.collapse,this),n.Browser.android||n.DomEvent.on(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var s=this._layersLink=n.DomUtil.create("a",t+"-toggle",e);s.href="#",s.title="Layers",n.Browser.touch?n.DomEvent.on(s,"click",n.DomEvent.stop).on(s,"click",this.expand,this):n.DomEvent.on(s,"focus",this.expand,this),n.DomEvent.on(o,"click",function(){setTimeout(n.bind(this._onInputClick,this),0)},this),i||this.expand(),this._baseLayersList=n.DomUtil.create("div",t+"-base",o),this._separator=n.DomUtil.create("div",t+"-separator",o),this._overlaysList=n.DomUtil.create("div",t+"-overlays",o),e.appendChild(o)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&n.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(n.bind(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;n.DomUtil.empty(this._baseLayersList),n.DomUtil.empty(this._overlaysList);var t,e,i,o,s=0;for(i=0;i<this._layers.length;i++)o=this._layers[i],this._addItem(o),e=e||o.overlay,t=t||!o.overlay,s+=o.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(n.stamp(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,o=e.createElement("label"),s=this._map.hasLayer(t.layer);t.overlay?((i=e.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=s):i=this._createRadioElement("leaflet-base-layers",s),i.layerId=n.stamp(t.layer),n.DomEvent.on(i,"click",this._onInputClick,this);var r=e.createElement("span");r.innerHTML=" "+t.name;var a=e.createElement("div");return o.appendChild(a),a.appendChild(i),a.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],s=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&s.push(e);for(r=0;r<s.length;r++)this._map.removeLayer(s[r]);for(r=0;r<o.length;r++)this._map.addLayer(o[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._form.getElementsByTagName("input"),n=this._map.getZoom(),o=i.length-1;o>=0;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),n.control.layers=function(t,e,i){return new n.Control.Layers(t,e,i)}}(window,document);
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/esri-leaflet-2.0.8/esri-leaflet.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{}),t.L)}(this,function(t,e){"use strict";function i(t){var e="";t.f=t.f||"json";for(var i in t)if(t.hasOwnProperty(i)){var s,r=t[i],n=Object.prototype.toString.call(r);e.length&&(e+="&"),s="[object Array]"===n?"[object Object]"===Object.prototype.toString.call(r[0])?JSON.stringify(r):r.join(","):"[object Object]"===n?JSON.stringify(r):"[object Date]"===n?r.valueOf():r,e+=encodeURIComponent(i)+"="+encodeURIComponent(s)}return e}function s(t,i){var s=new window.XMLHttpRequest;return s.onerror=function(r){s.onreadystatechange=e.Util.falseFn,t.call(i,{error:{code:500,message:"XMLHttpRequest error"}},null)},s.onreadystatechange=function(){var r,n;if(4===s.readyState){try{r=JSON.parse(s.responseText)}catch(t){r=null,n={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!n&&r.error&&(n=r.error,r=null),s.onerror=e.Util.falseFn,t.call(i,n,r)}},s.ontimeout=function(){this.onerror()},s}function r(t,e,r,n){var o=s(r,n);return o.open("POST",t),void 0!==n&&null!==n&&void 0!==n.options&&(o.timeout=n.options.timeout),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(i(e)),o}function n(t,e,r,n){var o=s(r,n);return o.open("GET",t+"?"+i(e),!0),void 0!==n&&null!==n&&void 0!==n.options&&(o.timeout=n.options.timeout),o.send(null),o}function o(t,e,r,n){var o=i(e),u=s(r,n),l=(t+"?"+o).length;if(l<=2e3&&et.cors?u.open("GET",t+"?"+o):l>2e3&&et.cors&&(u.open("POST",t),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),void 0!==n&&null!==n&&void 0!==n.options&&(u.timeout=n.options.timeout),l<=2e3&&et.cors)u.send(null);else{if(!(l>2e3&&et.cors))return l<=2e3&&!et.cors?a(t,e,r,n):void F("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");u.send(o)}return u}function a(t,s,r,n){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var o="c"+st;s.callback="window._EsriLeafletCallbacks."+o,window._EsriLeafletCallbacks[o]=function(t){if(!0!==window._EsriLeafletCallbacks[o]){var e,i=Object.prototype.toString.call(t);"[object Object]"!==i&&"[object Array]"!==i&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),r.call(n,e,t),window._EsriLeafletCallbacks[o]=!0}};var a=e.DomUtil.create("script",null,document.body);return a.type="text/javascript",a.src=t+"?"+i(s),a.id=o,st++,{id:o,url:a.src,abort:function(){window._EsriLeafletCallbacks._callback[o]({code:0,message:"Request aborted."})}}}function u(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function l(t){return u(t[0],t[t.length-1])||t.push(t[0]),t}function h(t){var e,i=0,s=0,r=t.length,n=t[s];for(s;s<r-1;s++)i+=((e=t[s+1])[0]-n[0])*(e[1]+n[1]),n=e;return i>=0}function c(t,e,i,s){var r=(s[0]-i[0])*(t[1]-i[1])-(s[1]-i[1])*(t[0]-i[0]),n=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),o=(s[1]-i[1])*(e[0]-t[0])-(s[0]-i[0])*(e[1]-t[1]);if(0!==o){var a=r/o,u=n/o;if(a>=0&&a<=1&&u>=0&&u<=1)return!0}return!1}function p(t,e){for(var i=0;i<t.length-1;i++)for(var s=0;s<e.length-1;s++)if(c(t[i],t[i+1],e[s],e[s+1]))return!0;return!1}function d(t,e){for(var i=!1,s=-1,r=t.length,n=r-1;++s<r;n=s)(t[s][1]<=e[1]&&e[1]<t[n][1]||t[n][1]<=e[1]&&e[1]<t[s][1])&&e[0]<(t[n][0]-t[s][0])*(e[1]-t[s][1])/(t[n][1]-t[s][1])+t[s][0]&&(i=!i);return i}function m(t,e){var i=p(t,e),s=d(t,e[0]);return!(i||!s)}function f(t){for(var e,i,s,r=[],n=[],o=0;o<t.length;o++){var a=l(t[o].slice(0));if(!(a.length<4))if(h(a)){var u=[a];r.push(u)}else n.push(a)}for(var c=[];n.length;){s=n.pop();var d=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],m(i,s)){r[e].push(s),d=!0;break}d||c.push(s)}for(;c.length;){s=c.pop();var f=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],p(i,s)){r[e].push(s),f=!0;break}f||r.push([s.reverse()])}return 1===r.length?{type:"Polygon",coordinates:r[0]}:{type:"MultiPolygon",coordinates:r}}function y(t){var e=[],i=t.slice(0),s=l(i.shift().slice(0));if(s.length>=4){h(s)||s.reverse(),e.push(s);for(var r=0;r<i.length;r++){var n=l(i[r].slice(0));n.length>=4&&(h(n)&&n.reverse(),e.push(n))}}return e}function g(t){for(var e=[],i=0;i<t.length;i++)for(var s=y(t[i]),r=s.length-1;r>=0;r--){var n=s[r].slice(0);e.push(n)}return e}function _(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function v(t,e){var i={};return"number"==typeof t.x&&"number"==typeof t.y&&(i.type="Point",i.coordinates=[t.x,t.y]),t.points&&(i.type="MultiPoint",i.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(i.type="LineString",i.coordinates=t.paths[0].slice(0)):(i.type="MultiLineString",i.coordinates=t.paths.slice(0))),t.rings&&(i=f(t.rings.slice(0))),(t.geometry||t.attributes)&&(i.type="Feature",i.geometry=t.geometry?v(t.geometry):null,i.properties=t.attributes?_(t.attributes):null,t.attributes&&(i.id=t.attributes[e]||t.attributes.OBJECTID||t.attributes.FID)),i}function b(t,e){e=e||"OBJECTID";var i,s={wkid:4326},r={};switch(t.type){case"Point":r.x=t.coordinates[0],r.y=t.coordinates[1],r.spatialReference=s;break;case"MultiPoint":r.points=t.coordinates.slice(0),r.spatialReference=s;break;case"LineString":r.paths=[t.coordinates.slice(0)],r.spatialReference=s;break;case"MultiLineString":r.paths=t.coordinates.slice(0),r.spatialReference=s;break;case"Polygon":r.rings=y(t.coordinates.slice(0)),r.spatialReference=s;break;case"MultiPolygon":r.rings=g(t.coordinates.slice(0)),r.spatialReference=s;break;case"Feature":t.geometry&&(r.geometry=b(t.geometry,e)),r.attributes=t.properties?_(t.properties):{},t.id&&(r.attributes[e]=t.id);break;case"FeatureCollection":for(r=[],i=0;i<t.features.length;i++)r.push(b(t.features[i],e));break;case"GeometryCollection":for(r=[],i=0;i<t.geometries.length;i++)r.push(b(t.geometries[i],e))}return r}function x(t,e){return b(t,e)}function S(t,e){return v(t,e)}function A(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function T(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var i=e.latLng(t.ymin,t.xmin),s=e.latLng(t.ymax,t.xmax);return e.latLngBounds(i,s)}return null}function I(t){return t=e.latLngBounds(t),{xmin:t.getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}function w(t,e){var i,s=t.features||t.results,r=s.length;if(e)i=e;else if(t.objectIdFieldName)i=t.objectIdFieldName;else if(t.fields){for(var n=0;n<=t.fields.length-1;n++)if("esriFieldTypeOID"===t.fields[n].type){i=t.fields[n].name;break}}else if(r)for(var o in s[0].attributes)if(o.match(/^(OBJECTID|FID|OID|ID)$/i)){i=o;break}var a={type:"FeatureCollection",features:[]};if(r)for(var u=s.length-1;u>=0;u--){var l=S(s[u],i);a.features.push(l)}return a}function C(t){return"/"!==(t=e.Util.trim(t))[t.length-1]&&(t+="/"),t}function R(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function O(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":e="esriGeometryPolygon";break;case"MultiPolygon":e="esriGeometryPolygon"}return e}function F(){console&&console.warn&&console.warn.apply(console,arguments)}function P(t){return t.getSize().x-it.attributionWidthOffset+"px"}function k(t){if(t.attributionControl&&!t.attributionControl._esriAttributionAdded){t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>');var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(i),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover");var s=document.createElement("style");s.type="text/css",s.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+P(t)+";}",document.getElementsByTagName("head")[0].appendChild(s),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution"),t.on("resize",function(e){t.attributionControl._container.style.maxWidth=P(e.target)}),t.attributionControl._esriAttributionAdded=!0}}function M(t,i){a(t,{},e.Util.bind(function(t,s){if(!t){i._esriAttributions=[];for(var r=0;r<s.contributors.length;r++)for(var n=s.contributors[r],o=0;o<n.coverageAreas.length;o++){var a=n.coverageAreas[o],u=e.latLng(a.bbox[0],a.bbox[1]),l=e.latLng(a.bbox[2],a.bbox[3]);i._esriAttributions.push({attribution:n.attribution,score:a.score,bounds:e.latLngBounds(u,l),minZoom:a.zoomMin,maxZoom:a.zoomMax})}i._esriAttributions.sort(function(t,e){return e.score-t.score}),G({target:i})}},this))}function G(t){var i=t.target,s=i._esriAttributions;if(i&&i.attributionControl&&s){for(var r="",n=i.getBounds(),o=e.latLngBounds(n.getSouthWest().wrap(),n.getNorthEast().wrap()),a=i.getZoom(),u=0;u<s.length;u++){var l=s[u],h=l.attribution;!r.match(h)&&l.bounds.intersects(o)&&a>=l.minZoom&&a<=l.maxZoom&&(r+=", "+h)}r=r.substr(2);var c=i.attributionControl._container.querySelector(".esri-dynamic-attribution");c.innerHTML=r,c.style.maxWidth=P(i),i.fire("attributionupdated",{attribution:r})}}function E(t){return new at(t)}function U(t){return new ut(t)}function q(t){return new lt(t)}function D(t){return new ht(t)}function B(t){return new ct(t)}function z(t){return new pt(t)}function N(t){return new dt(t)}function j(t){return new mt(t)}function Z(t){return new ft(t)}function W(t){return new yt(t)}function J(t,e){return new _t(t,e)}function Q(t,e){return new vt(t,e)}function H(t,e){return new xt(t,e)}function V(t,e){return new St(t,e)}function K(t){this.values=[].concat(t||[])}function X(t){return new It(t)}var $="default"in e?e.default:e,Y=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,tt=""===document.documentElement.style.pointerEvents,et={cors:Y,pointerEvents:tt},it={attributionWidthOffset:55},st=0,rt=et.cors?n:a;rt.CORS=n,rt.JSONP=a;var nt={request:o,get:rt,post:r},ot={shallowClone:A,warn:F,cleanUrl:C,isArcgisOnline:R,geojsonTypeToArcGIS:O,responseToFeatureCollection:w,geojsonToArcGIS:x,arcgisToGeoJSON:S,boundsToExtent:I,extentToBounds:T,calcAttributionWidth:P,setEsriAttribution:k,_getAttributionData:M,_updateMapAttribution:G},at=e.Class.extend({options:{proxy:!1,useCors:Y},generateSetter:function(t,i){return e.Util.bind(function(e){return this.params[t]=e,this},i)},initialize:function(t){if(t.request&&t.options?(this._service=t,e.Util.setOptions(this,t.options)):(e.Util.setOptions(this,t),this.options.url=C(t.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var i in this.setters){var s=this.setters[i];this[i]=this.generateSetter(s,this)}},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},request:function(t,e){return this._service?this._service.request(this.path,this.params,t,e):this._request("request",this.path,this.params,t,e)},_request:function(t,e,i,s,r){var n=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?nt[t](n,i,s,r):nt.get.JSONP(n,i,s,r)}}),ut=at.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,i){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=i,this.params.inSr=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||R(this.options.url)?(this.params.f="geojson",this.request(function(i,s){this._trapSQLerrors(i),t.call(e,i,s,s)},this)):this.request(function(i,s){this._trapSQLerrors(i),t.call(e,i,s&&w(s),s)},this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.count,i)},e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.objectIds,i)},e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(i,s){s&&s.extent&&T(s.extent)?t.call(e,i,T(s.extent),s):(i={message:"Invalid Bounds"},t.call(e,i,null,s))},e)},pixelSize:function(t){var i=e.point(t);return this.params.pixelSize=[i.x,i.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&F("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometry:function(t){return this.params.inSr=4326,t instanceof e.LatLngBounds?(this.params.geometry=I(t),void(this.params.geometryType="esriGeometryEnvelope")):(t.getLatLng&&(t=t.getLatLng()),t instanceof e.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof e.GeoJSON&&(t=t.getLayers()[0].feature.geometry,this.params.geometry=x(t),this.params.geometryType=O(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(this.params.geometry=x(t),void(this.params.geometryType=O(t.type))):void F("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),lt=at.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,s){t.call(e,i,s&&w(s),s)},e)}}),ht=at.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}}),ct=ht.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(t){var e=I(t.getBounds()),i=t.getSize();return this.params.imageDisplay=[i.x,i.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(t){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this},layerDef:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,s){if(i)t.call(e,i,void 0,s);else{var r=w(s);s.results=s.results.reverse();for(var n=0;n<r.features.length;n++)r.features[n].layerId=s.results[n].layerId;t.call(e,void 0,r,s)}})}}),pt=ht.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(t){return t=e.latLng(t),this.params.geometry=JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(t,e){return this.request(function(i,s){t.call(e,i,s&&this._responseToGeoJSON(s),s)},this)},_responseToGeoJSON:function(t){var e=t.location,i=t.catalogItems,s=t.catalogItemVisibilities,r={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:t.objectId,name:t.name,value:t.value},id:t.objectId}};if(t.properties&&t.properties.Values&&(r.pixel.properties.values=t.properties.Values),i&&i.features&&(r.catalogItems=w(i),s&&s.length===r.catalogItems.features.length))for(var n=s.length-1;n>=0;n--)r.catalogItems.features[n].properties.catalogItemVisibility=s[n];return r}}),dt=e.Evented.extend({options:{proxy:!1,useCors:Y,timeout:0},initialize:function(t){t=t||{},this._requestQueue=[],this._authenticating=!1,e.Util.setOptions(this,t),this.options.url=C(this.options.url)},get:function(t,e,i,s){return this._request("get",t,e,i,s)},post:function(t,e,i,s){return this._request("post",t,e,i,s)},request:function(t,e,i,s){return this._request("request",t,e,i,s)},metadata:function(t,e){return this._request("get","",{},t,e)},authenticate:function(t){return this._authenticating=!1,this.options.token=t,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(t){this.options.timeout=t},_request:function(t,e,i,s,r){this.fire("requeststart",{url:this.options.url+e,params:i,method:t},!0);var n=this._createServiceCallback(t,e,i,s,r);if(this.options.token&&(i.token=this.options.token),!this._authenticating){var o=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?nt[t](o,i,n,r):nt.get.JSONP(o,i,n,r)}this._requestQueue.push([t,e,i,s,r])},_createServiceCallback:function(t,i,s,r,n){return e.Util.bind(function(o,a){!o||499!==o.code&&498!==o.code||(this._authenticating=!0,this._requestQueue.push([t,i,s,r,n]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),o.authenticate=e.Util.bind(this.authenticate,this)),r.call(n,o,a),o?this.fire("requesterror",{url:this.options.url+i,params:s,message:o.message,code:o.code,method:t},!0):this.fire("requestsuccess",{url:this.options.url+i,params:s,response:a,method:t},!0),this.fire("requestend",{url:this.options.url+i,params:s,method:t},!0)},this)},_runQueue:function(){for(var t=this._requestQueue.length-1;t>=0;t--){var e=this._requestQueue[t];this[e.shift()].apply(this,e)}this._requestQueue=[]}}),mt=dt.extend({identify:function(){return B(this)},find:function(){return q(this)},query:function(){return U(this)}}),ft=dt.extend({query:function(){return U(this)},identify:function(){return z(this)}}),yt=dt.extend({options:{idAttribute:"OBJECTID"},query:function(){return U(this)},addFeature:function(t,e,i){return delete t.id,t=x(t),this.post("addFeatures",{features:[t]},function(t,s){var r=s&&s.addResults?s.addResults[0]:void 0;e&&e.call(i,t||s.addResults[0].error,r)},i)},updateFeature:function(t,e,i){return t=x(t,this.options.idAttribute),this.post("updateFeatures",{features:[t]},function(t,s){var r=s&&s.updateResults?s.updateResults[0]:void 0;e&&e.call(i,t||s.updateResults[0].error,r)},i)},deleteFeature:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},function(t,s){var r=s&&s.deleteResults?s.deleteResults[0]:void 0;e&&e.call(i,t||s.deleteResults[0].error,r)},i)},deleteFeatures:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},function(t,s){var r=s&&s.deleteResults?s.deleteResults:void 0;e&&e.call(i,t||s.deleteResults[0].error,r)},i)}}),gt="https:"!==window.location.protocol?"http:":"https:",_t=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:gt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(t,i){var s;if("object"==(void 0===t?"undefined":_typeof(t))&&t.urlTemplate&&t.options)s=t;else{if("string"!=typeof t||!_t.TILES[t])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');s=_t.TILES[t]}var r=e.Util.extend(s.options,i);e.Util.setOptions(this,r),this.options.token&&(s.urlTemplate+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,s.urlTemplate,r)},onAdd:function(t){k(t),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&M(this.options.attributionUrl,t),t.on("moveend",G),e.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){t.off("moveend",G),e.TileLayer.prototype.onRemove.call(this,t)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var t=this._map.createPane(this.options.pane);t.style.pointerEvents="none",t.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var t='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return t}}),vt=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(t){t.url=C(t.url),t=e.Util.setOptions(this,t),this.tileUrl=t.url+"tile/{z}/{y}/{x}",this.service=j(t),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(t.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),t.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,this.tileUrl,t)},getTileUrl:function(t){var i=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(t),x:t.x,y:t.y,z:this._lodMap&&this._lodMap[i]?this._lodMap[i]:i},this.options))},createTile:function(t,e){var i=document.createElement("img");return L.DomEvent.on(i,"load",L.bind(this._tileOnLoad,this,e,i)),L.DomEvent.on(i,"error",L.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?i.src=this.getTileUrl(t):this.once("lodmap",function(){i.src=this.getTileUrl(t)},this),i},onAdd:function(t){k(t),this._lodMap||this.metadata(function(e,i){if(!e&&i.spatialReference){var s=i.spatialReference.latestWkid||i.spatialReference.wkid;if(!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution())),t.options.crs===L.CRS.EPSG3857&&102100===s||3857===s){this._lodMap={};for(var r=i.tileInfo.lods,n=vt.MercatorZoomLevels,o=0;o<r.length;o++){var a=r[o];for(var u in n){var l=n[u];if(this._withinPercentage(a.resolution,l,this.options.zoomOffsetAllowance)){this._lodMap[u]=a.level;break}}}this.fire("lodmap")}else proj4||F("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this),e.TileLayer.prototype.onAdd.call(this,t)},metadata:function(t,e){return this.service.metadata(t,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(t){var e="?token="+t;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=t,this.service.authenticate(t),this},_withinPercentage:function(t,e,i){return Math.abs(t/e-1)<i}}),bt=e.ImageOverlay.extend({onAdd:function(t){this._topLeft=t.getPixelBounds().min,e.ImageOverlay.prototype.onAdd.call(this,t)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Lt=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Y,attribution:null,interactive:!1,alt:""},onAdd:function(t){k(t),this._update=e.Util.throttle(this._update,this.options.updateInterval,this),t.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?t.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(e,i){!e&&!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(t){this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(t,i){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=e.popup(i),this._popupFunction=t,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage&&this._currentImage.bringToBack(),this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.options.opacity=t,this._currentImage&&this._currentImage.setOpacity(t),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e){return this.options.from=t,this.options.to=e,this._update(),this},metadata:function(t,e){return this.service.metadata(t,e),this},authenticate:function(t){return this.service.authenticate(t),this},redraw:function(){this._update()},_renderImage:function(t,e,i){this._map&&(i&&(t="data:"+i+";base64,"+t),new bt(t,e,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map).once("load",function(t){if(this._map){var i=t.target,s=this._currentImage;i._bounds.equals(e)&&i._bounds.equals(this._map.getBounds())?(this._currentImage=i,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),s&&this._map&&this._map.removeLayer(s),s&&s._map&&s._map.removeLayer(s)):this._map.removeLayer(i)}this.fire("load",{bounds:e})},this),this.fire("loading",{bounds:e}))},_update:function(){if(this._map){var t=this._map.getZoom(),e=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)){if(t>this.options.maxZoom||t<this.options.minZoom)return void(this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null));var i=this._buildExportParams();this._requestExport(i,e)}}},_renderPopup:function(t,i,s,r){if(t=e.latLng(t),this._shouldRenderPopup&&this._lastClick.equals(t)){var n=this._popupFunction(i,s,r);n&&this._popup.setLatLng(t).setContent(n).openOn(this._map)}},_resetPopupState:function(t){this._shouldRenderPopup=!1,this._lastClick=t.latlng}}),xt=Lt.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(t){t.url=C(t.url),this.service=Z(t),this.service.addEventParent(this),e.Util.setOptions(this,t)},setPixelType:function(t){return this.options.pixelType=t,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(t){return e.Util.isArray(t)?this.options.bandIds=t.join(","):this.options.bandIds=t.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(t,i){return e.Util.isArray(t)?this.options.noData=t.join(","):this.options.noData=t.toString(),i&&(this.options.noDataInterpretation=i),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(t){this.options.renderingRule=t,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(t){this.options.mosaicRule=t,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(t){var i=e.Util.bind(function(i,s,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,s,r)},this),300)},this),s=this.identify().at(t.latlng);this.options.mosaicRule&&s.setMosaicRule(this.options.mosaicRule),s.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=this._map.getBounds(),e=this._map.getSize(),i=this._map.options.crs.project(t._northEast),s=this._map.options.crs.project(t._southWest),r=this._map.latLngToLayerPoint(t._northEast),n=this._map.latLngToLayerPoint(t._southWest);(r.y>0||n.y<e.y)&&(e.y=n.y-r.y);var o=parseInt(this._map.options.crs.code.split(":")[1],10),a={bbox:[s.x,s.y,i.x,i.y].join(","),size:e.x+","+e.y,format:this.options.format,transparent:this.options.transparent,bboxSR:o,imageSR:o};return this.options.from&&this.options.to&&(a.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(a.pixelType=this.options.pixelType),this.options.interpolation&&(a.interpolation=this.options.interpolation),this.options.compressionQuality&&(a.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(a.bandIds=this.options.bandIds),this.options.noData&&(a.noData=this.options.noData),this.options.noDataInterpretation&&(a.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(a.token=this.service.options.token),this.options.renderingRule&&(a.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(a.mosaicRule=JSON.stringify(this.options.mosaicRule)),a},_requestExport:function(t,i){"json"===this.options.f?this.service.request("exportImage",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this._renderImage(e.href,i))},this):(t.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(t),i))}}),St=Lt.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(t){t.url=C(t.url),this.service=j(t),this.service.addEventParent(this),(t.proxy||t.token)&&"json"!==t.f&&(t.f="json"),e.Util.setOptions(this,t)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(t){return this.options.dynamicLayers=t,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(t){return this.options.layers=t,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(t){return this.options.layerDefs=t,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(t){return this.options.timeOptions=t,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(t){var i=e.Util.bind(function(i,s,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,s,r)},this),300)},this),s=this.identify().on(this._map).at(t.latlng);s.simplify(this._map,.5),this.options.layers?s.layers("visible:"+this.options.layers.join(",")):s.layers("visible"),s.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=this._map.getBounds(),e=this._map.getSize(),i=this._map.options.crs.project(t.getNorthEast()),s=this._map.options.crs.project(t.getSouthWest()),r=parseInt(this._map.options.crs.code.split(":")[1],10),n=this._map.latLngToLayerPoint(t._northEast),o=this._map.latLngToLayerPoint(t._southWest);(n.y>0||o.y<e.y)&&(e.y=o.y-n.y);var a={bbox:[s.x,s.y,i.x,i.y].join(","),size:e.x+","+e.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:r,imageSR:r};return this.options.dynamicLayers&&(a.dynamicLayers=this.options.dynamicLayers),this.options.layers&&(a.layers="show:"+this.options.layers.join(",")),this.options.layerDefs&&(a.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(a.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(a.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(a.token=this.service.options.token),this.options.proxy&&(a.proxy=this.options.proxy),a},_requestExport:function(t,i){"json"===this.options.f?this.service.request("export",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this.options.proxy&&(e.href=this.options.proxy+"?"+e.href),e.href?this._renderImage(e.href,i):this._renderImage(e.imageData,i,e.contentType))},this):(t.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(t),i))}}),At=$.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(t){t=$.setOptions(this,t),this._zooming=!1},onAdd:function(t){this._map=t,this._update=$.Util.throttle(this._update,this.options.updateInterval,this),this._reset(),this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this),this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(t){return t.addLayer(this),this},removeFrom:function(t){return t.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells(),this._cells={},this._activeCells={},this._cellsToLoad=0,this._cellsTotal=0,this._cellNumBounds=this._getCellNumBounds(),this._resetWrap(),this._zooming=!1},_resetWrap:function(){var t=this._map,e=t.options.crs;if(!e.infinite){var i=this._getCellSize();e.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,e.wrapLng[0]]).x/i),Math.ceil(t.project([0,e.wrapLng[1]]).x/i)]),e.wrapLat&&(this._wrapLat=[Math.floor(t.project([e.wrapLat[0],0]).y/i),Math.ceil(t.project([e.wrapLat[1],0]).y/i)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._getCellSize(),i=$.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).floor());this._removeOtherCells(i),this._addCells(i),this.fire("cellsupdated")}},_addCells:function(t){var e,i,s,r=[],n=t.getCenter(),o=this._map.getZoom();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)(s=$.point(i,e)).z=o,this._isValidCell(s)&&r.push(s);var a=r.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,r.sort(function(t,e){return t.distanceTo(n)-e.distanceTo(n)}),i=0;i<a;i++)this._addCell(r[i])},_isValidCell:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._cellNumBounds;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var s=this._cellCoordsToBounds(t);return $.latLngBounds(this.options.bounds).intersects(s)},_cellCoordsToBounds:function(t){var e=this._map,i=this.options.cellSize,s=t.multiplyBy(i),r=s.add([i,i]),n=e.wrapLatLng(e.unproject(s,t.z)),o=e.wrapLatLng(e.unproject(r,t.z));return $.latLngBounds(n,o)},_cellCoordsToKey:function(t){return t.x+":"+t.y},_keyToCellCoords:function(t){var e=t.split(":"),i=parseInt(e[0],10),s=parseInt(e[1],10);return $.point(i,s)},_removeOtherCells:function(t){for(var e in this._cells)t.contains(this._keyToCellCoords(e))||this._removeCell(e)},_removeCell:function(t){var e=this._activeCells[t];e&&(delete this._activeCells[t],this.cellLeave&&this.cellLeave(e.bounds,e.coords),this.fire("cellleave",{bounds:e.bounds,coords:e.coords}))},_removeCells:function(){for(var t in this._cells){var e=this._cells[t].bounds,i=this._cells[t].coords;this.cellLeave&&this.cellLeave(e,i),this.fire("cellleave",{bounds:e,coords:i})}},_addCell:function(t){this._wrapCoords(t);var e=this._cellCoordsToKey(t),i=this._cells[e];i&&!this._activeCells[e]&&(this.cellEnter&&this.cellEnter(i.bounds,t),this.fire("cellenter",{bounds:i.bounds,coords:t}),this._activeCells[e]=i),i||(i={coords:t,bounds:this._cellCoordsToBounds(t)},this._cells[e]=i,this._activeCells[e]=i,this.createCell&&this.createCell(i.bounds,t),this.fire("cellcreate",{bounds:i.bounds,coords:t}))},_wrapCoords:function(t){t.x=this._wrapLng?$.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?$.Util.wrapNum(t.y,this._wrapLat):t.y},_getCellNumBounds:function(){var t=this._map.getPixelWorldBounds(),e=this._getCellSize();return t?$.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).ceil().subtract([1,1])):null}});K.prototype.query=function(t){var e=this.getIndex(t);return this.values[e]},K.prototype.getIndex=function(t){this.dirty&&this.sort();for(var e,i,s=0,r=this.values.length-1;s<=r;)if(e=(s+r)/2|0,+(i=this.values[Math.round(e)]).value<+t)s=e+1;else{if(!(+i.value>+t))return e;r=e-1}return Math.abs(~r)},K.prototype.between=function(t,e){var i=this.getIndex(t),s=this.getIndex(e);if(0===i&&0===s)return[];for(;this.values[i-1]&&this.values[i-1].value===t;)i--;for(;this.values[s+1]&&this.values[s+1].value===e;)s++;return this.values[s]&&this.values[s].value===e&&this.values[s+1]&&s++,this.values.slice(i,s)},K.prototype.insert=function(t){return this.values.splice(this.getIndex(t.value),0,t),this},K.prototype.bulkAdd=function(t,e){return this.values=this.values.concat([].concat(t||[])),e?this.sort():this.dirty=!0,this},K.prototype.sort=function(){return this.values.sort(function(t,e){return+e.value-+t.value}).reverse(),this.dirty=!1,this};var Tt=At.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(t){if(At.prototype.initialize.call(this,t),t.url=C(t.url),t=e.setOptions(this,t),this.service=W(t),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var i=!1,s=0;s<this.options.fields.length;s++)this.options.fields[s].match(/^(OBJECTID|FID|OID|ID)$/i)&&(i=!0);!1===i&&F("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new K,this._endTimeIndex=new K):this.options.timeField&&(this._timeIndex=new K),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(t){return k(t),this.service.metadata(function(e,i){if(!e){var s=i.supportedQueryFormats,r=!1;!1===this.service.options.isModern&&(r=!0),!r&&s&&-1!==s.indexOf("geoJSON")&&(this.service.options.isModern=!0),!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}},this),t.on("zoomend",this._handleZoomChange,this),At.prototype.onAdd.call(this,t)},onRemove:function(t){return t.off("zoomend",this._handleZoomChange,this),At.prototype.onRemove.call(this,t)},getAttribution:function(){return this.options.attribution},createCell:function(t,e){this._visibleZoom()&&this._requestFeatures(t,e)},_requestFeatures:function(t,i,s){return 1===++this._activeRequests&&this.fire("loading",{bounds:t},!0),this._buildQuery(t).run(function(r,n,o){o&&o.exceededTransferLimit&&this.fire("drawlimitexceeded"),!r&&n&&n.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(n.features,i),this._postProcessFeatures(t)},this)),r||!n||n.features.length||this._postProcessFeatures(t),r&&this._postProcessFeatures(t),s&&s.call(this,r,n)},this)},_postProcessFeatures:function(t){--this._activeRequests<=0&&this.fire("load",{bounds:t})},_cacheKey:function(t){return t.z+":"+t.x+":"+t.y},_addFeatures:function(t,e){var i=this._cacheKey(e);this._cache[i]=this._cache[i]||[];for(var s=t.length-1;s>=0;s--){var r=t[s].id;-1===this._currentSnapshot.indexOf(r)&&this._currentSnapshot.push(r),-1===this._cache[i].indexOf(r)&&this._cache[i].push(r)}this.options.timeField&&this._buildTimeIndexes(t),this.createLayers(t)},_buildQuery:function(t){var e=this.service.query().intersects(t).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.simplifyFactor&&e.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&e.between(this.options.from,this.options.to),e},setWhere:function(t,i,s){this.options.where=t&&t.length?t:"1=1";for(var r=[],n=[],o=0,a=null,u=e.Util.bind(function(t,u){if(t&&(a=t),u)for(var l=u.features.length-1;l>=0;l--)n.push(u.features[l].id);--o<=0&&(this._currentSnapshot=n,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(r),this.addLayers(n),i&&i.call(s,a)},this)))},this),l=this._currentSnapshot.length-1;l>=0;l--)r.push(this._currentSnapshot[l]);for(var h in this._activeCells){o++;var c=this._keyToCellCoords(h),p=this._cellCoordsToBounds(c);this._requestFeatures(p,h,u)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,i,s,r){var n=this.options.from,o=this.options.to,a=0,u=null,l=e.Util.bind(function(e){e&&(u=e),this._filterExistingFeatures(n,o,t,i),a--,s&&a<=0&&s.call(r,u)},this);if(this.options.from=t,this.options.to=i,this._filterExistingFeatures(n,o,t,i),"server"===this.options.timeFilterMode)for(var h in this._activeCells){a++;var c=this._keyToCellCoords(h),p=this._cellCoordsToBounds(c);this._requestFeatures(p,h,l)}return this},refresh:function(){for(var t in this._activeCells){var e=this._keyToCellCoords(t),i=this._cellCoordsToBounds(e);this._requestFeatures(i,t)}this.redraw&&this.once("load",function(){this.eachFeature(function(t){this._redraw(t.feature.id)},this)},this)},_filterExistingFeatures:function(t,i,s,r){var n=t&&i?this._getFeaturesInTimeRange(t,i):this._currentSnapshot,o=this._getFeaturesInTimeRange(s,r);if(o.indexOf)for(var a=0;a<o.length;a++){var u=n.indexOf(o[a]);u>=0&&n.splice(u,1)}e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(n),this.addLayers(o)},this))},_getFeaturesInTimeRange:function(t,e){var i,s=[];if(this.options.timeField.start&&this.options.timeField.end){var r=this._startTimeIndex.between(t,e),n=this._endTimeIndex.between(t,e);i=r.concat(n)}else i=this._timeIndex.between(t,e);for(var o=i.length-1;o>=0;o--)s.push(i[o].id);return s},_buildTimeIndexes:function(t){var e,i;if(this.options.timeField.start&&this.options.timeField.end){var s=[],r=[];for(e=t.length-1;e>=0;e--)i=t[e],s.push({id:i.id,value:new Date(i.properties[this.options.timeField.start])}),r.push({id:i.id,value:new Date(i.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(s),this._endTimeIndex.bulkAdd(r)}else{var n=[];for(e=t.length-1;e>=0;e--)i=t[e],n.push({id:i.id,value:new Date(i.properties[this.options.timeField])});this._timeIndex.bulkAdd(n)}},_featureWithinTimeRange:function(t){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),i=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var s=+t.properties[this.options.timeField];return s>=e&&s<=i}if(this.options.timeField.start&&this.options.timeField.end){var r=+t.properties[this.options.timeField.start],n=+t.properties[this.options.timeField.end];return r>=e&&r<=i||n>=e&&n<=i}},_visibleZoom:function(){if(!this._map)return!1;var t=this._map.getZoom();return!(t>this.options.maxZoom||t<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var t in this._activeCells){var e=this._activeCells[t].coords,i=this._cacheKey(e);this._cache[i]&&this.addLayers(this._cache[i])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(t){return this.service.authenticate(t),this},metadata:function(t,e){return this.service.metadata(t,e),this},query:function(){return this.service.query()},_getMetadata:function(t){if(this._metadata){t(void 0,this._metadata)}else this.metadata(e.Util.bind(function(e,i){this._metadata=i,t(e,this._metadata)},this))},addFeature:function(t,i,s){this._getMetadata(e.Util.bind(function(r,n){return r?void(i&&i.call(this,r,null)):void this.service.addFeature(t,e.Util.bind(function(e,r){e||(t.properties[n.objectIdField]=r.objectId,t.id=r.objectId,this.createLayers([t])),i&&i.call(s,e,r)},this))},this))},updateFeature:function(t,e,i){this.service.updateFeature(t,function(s,r){s||(this.removeLayers([t.id],!0),this.createLayers([t])),e&&e.call(i,s,r)},this)},deleteFeature:function(t,e,i){this.service.deleteFeature(t,function(t,s){!t&&s.objectId&&this.removeLayers([s.objectId],!0),e&&e.call(i,t,s)},this)},deleteFeatures:function(t,e,i){return this.service.deleteFeatures(t,function(t,s){if(!t&&s.length>0)for(var r=0;r<s.length;r++)this.removeLayers([s[r].objectId],!0);e&&e.call(i,t,s)},this)}}),It=Tt.extend({options:{cacheLayers:!0},initialize:function(t){Tt.prototype.initialize.call(this,t),this._originalStyle=this.options.style,this._layers={}},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return Tt.prototype.onRemove.call(this,t)},createNewLayer:function(t){var i=e.GeoJSON.geometryToLayer(t,this.options);return i.defaultOptions=i.options,i},_updateLayer:function(t,i){var s=[],r=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;switch(i.properties&&(t.feature.properties=i.properties),i.geometry.type){case"Point":s=e.GeoJSON.coordsToLatLng(i.geometry.coordinates),t.setLatLng(s);break;case"LineString":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,0,r),t.setLatLngs(s);break;case"MultiLineString":case"Polygon":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,1,r),t.setLatLngs(s);break;case"MultiPolygon":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,2,r),t.setLatLngs(s)}},createLayers:function(t){for(var e=t.length-1;e>=0;e--){var i,s=t[e],r=this._layers[s.id];this._visibleZoom()&&r&&!this._map.hasLayer(r)&&(this._map.addLayer(r),this.fire("addfeature",{feature:r.feature},!0)),r&&this.options.simplifyFactor>0&&(r.setLatLngs||r.setLatLng)&&this._updateLayer(r,s),r||(i=this.createNewLayer(s),i.feature=s,i.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(i.feature,i),this._layers[i.feature.id]=i,this.setFeatureStyle(i.feature.id,this.options.style),this.fire("createfeature",{feature:i.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(s))&&this._map.addLayer(i))}},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=this._layers[t[e]];i&&this._map.addLayer(i)}},removeLayers:function(t,e){for(var i=t.length-1;i>=0;i--){var s=t[i],r=this._layers[s];r&&(this.fire("removefeature",{feature:r.feature,permanent:e},!0),this._map.removeLayer(r)),r&&e&&delete this._layers[s]}},cellEnter:function(t,i){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),s=this._cache[t];this._activeCells[e]&&s&&this.addLayers(s)},this))},cellLeave:function(t,i){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),s=this._cache[t],r=this._map.getBounds();if(!this._activeCells[e]&&s){for(var n=!0,o=0;o<s.length;o++){var a=this._layers[s[o]];a&&a.getBounds&&r.intersects(a.getBounds())&&(n=!1)}n&&this.removeLayers(s,!this.options.cacheLayers),!this.options.cacheLayers&&n&&(delete this._cache[t],delete this._cells[e],delete this._activeCells[e])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(t){this.resetFeatureStyle(t.feature.id)},this),this},setStyle:function(t){return this.options.style=t,this.eachFeature(function(e){this.setFeatureStyle(e.feature.id,t)},this),this},resetFeatureStyle:function(t){var i=this._layers[t],s=this._originalStyle||L.Path.prototype.options;return i&&(e.Util.extend(i.options,i.defaultOptions),this.setFeatureStyle(t,s)),this},setFeatureStyle:function(t,e){var i=this._layers[t];return"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e),this},eachActiveFeature:function(t,e){if(this._map){var i=this._map.getBounds();for(var s in this._layers)i.intersects(this._layers[s].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[s].feature.id)&&t.call(e,this._layers[s])}return this},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]},bringToBack:function(){this.eachFeature(function(t){t.bringToBack&&t.bringToBack()})},bringToFront:function(){this.eachFeature(function(t){t.bringToFront&&t.bringToFront()})},redraw:function(t){return t&&this._redraw(t),this},_redraw:function(t){var i=this._layers[t],s=i.feature;if(i&&i.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var r=this.options.pointToLayer(s,e.latLng(s.geometry.coordinates[1],s.geometry.coordinates[0])).options.icon;i.setIcon(r)}if(i&&i.setStyle&&this.options.pointToLayer){var n=this.options.pointToLayer(s,e.latLng(s.geometry.coordinates[1],s.geometry.coordinates[0])).options;this.setFeatureStyle(s.id,n)}i&&i.setStyle&&this.options.style&&this.resetStyle(s.id)}});t.VERSION="2.0.8",t.Support=et,t.options=it,t.Util=ot,t.get=rt,t.post=r,t.request=o,t.Task=at,t.task=E,t.Query=ut,t.query=U,t.Find=lt,t.find=q,t.Identify=ht,t.identify=D,t.IdentifyFeatures=ct,t.identifyFeatures=B,t.IdentifyImage=pt,t.identifyImage=z,t.Service=dt,t.service=N,t.MapService=mt,t.mapService=j,t.ImageService=ft,t.imageService=Z,t.FeatureLayerService=yt,t.featureLayerService=W,t.BasemapLayer=_t,t.basemapLayer=J,t.TiledMapLayer=vt,t.tiledMapLayer=Q,t.RasterLayer=Lt,t.ImageMapLayer=xt,t.imageMapLayer=H,t.DynamicMapLayer=St,t.dynamicMapLayer=V,t.FeatureManager=Tt,t.FeatureLayer=It,t.featureLayer=X});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/topojson-master/topojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(){function t(n,t){function r(t){var r,e=n.arcs[t<0?~t:t],o=e[0];return n.transform?(r=[0,0],e.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=e[e.length-1],t<0?[r,o]:[o,r]}function e(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[n<0?~n:n]=1}),f.push(e)}}var o={},i={},u={},f=[],c=-1;return t.forEach(function(r,e){var o,i=n.arcs[r<0?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++c],t[c]=r,t[e]=o)}),t.forEach(function(n){var t,e,o=r(n),f=o[0],c=o[1];if(t=u[f])if(delete u[t.end],t.push(n),t.end=c,e=i[c]){delete i[e.start];var a=e===t?t:t.concat(e);i[a.start=t.start]=u[a.end=e.end]=a}else i[t.start]=u[t.end]=t;else if(t=i[c])if(delete i[t.start],t.unshift(n),t.start=f,e=u[f]){delete u[e.end];var s=e===t?t:e.concat(t);i[s.start=e.start]=u[s.end=t.end]=s}else i[t.start]=u[t.end]=t;else i[(t=[n]).start=f]=u[t.end=c]=t}),e(u,i),e(i,u),t.forEach(function(n){o[n<0?~n:n]||f.push([n])}),f}function r(n,r,e){var o=[];if(arguments.length>1){var i,u=function(n){var t=n<0?~n:n;(a[t]||(a[t]=[])).push({i:n,g:i})},f=function(n){n.forEach(u)},c=function(n){n.forEach(f)},a=[],s={LineString:f,MultiLineString:c,Polygon:c,MultiPolygon:function(n){n.forEach(c)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in s&&(i=t,s[t.type](t.arcs))}(r),a.forEach(arguments.length<3?function(n){o.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&o.push(n[0].i)})}else for(var l=0,p=n.arcs.length;l<p;++l)o.push(l);return{type:"MultiLineString",arcs:t(n,o)}}function e(r,e){function o(n){n.forEach(function(t){t.forEach(function(t){(f[t=t<0?~t:t]||(f[t]=[])).push(n)})}),c.push(n)}function i(n){return l(u(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var f={},c=[],a=[];return e.forEach(function(n){"Polygon"===n.type?o(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(o)}),c.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,a.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),c.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:a.map(function(e){var o=[];if(e.forEach(function(n){n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].length<2&&o.push(n)})})}),o=t(r,o),(n=o.length)>1)for(var u,c=i(e[0][0]),a=0;a<n;++a)if(c===i(o[a])){u=o[0],o[0]=o[a],o[a]=u;break}return o})}}function o(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(n,t)};return null==t.id&&delete r.id,r}function u(n,t){function r(n,t){t.length&&t.pop();for(var r,e=s[n<0?~n:n],o=0,i=e.length;o<i;++o)t.push(r=e[o].slice()),a(r,o);n<0&&f(t,i)}function e(n){return n=n.slice(),a(n,0),n}function o(n){for(var t=[],e=0,o=n.length;e<o;++e)r(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=o(n);t.length<4;)t.push(t[0].slice());return t}function u(n){return n.map(i)}function c(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(c)}:t in l?{type:t,coordinates:l[t](n)}:null}var a=y(n.transform),s=n.arcs,l={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return o(n.arcs)},MultiLineString:function(n){return n.arcs.map(o)},Polygon:function(n){return u(n.arcs)},MultiPolygon:function(n){return n.arcs.map(u)}};return c(t)}function f(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}function c(n,t){for(var r=0,e=n.length;r<e;){var o=r+e>>>1;n[o]<t?r=o+1:e=o}return r}function a(n){function t(n,t){n.forEach(function(n){n<0&&(n=~n);var r=o[n];r?r.push(t):o[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function e(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,t)}):n.type in u&&u[n.type](n.arcs,t)}var o={},i=n.map(function(){return[]}),u={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(e);for(var f in o)for(var a=o[f],s=a.length,l=0;l<s;++l)for(var p=l+1;p<s;++p){var h,v=a[l],y=a[p];(h=i[v])[f=c(h,y)]!==y&&h.splice(f,0,y),(h=i[y])[f=c(h,v)]!==v&&h.splice(f,0,v)}return i}function s(n,t){function r(n){i.remove(n),n[1][2]=t(n),i.push(n)}var e=y(n.transform),o=g(n.transform),i=v();return t||(t=p),n.arcs.forEach(function(n){for(var u,f,c=[],a=0,s=0,l=n.length;s<l;++s)f=n[s],e(n[s]=[f[0],f[1],1/0],s);for(var s=1,l=n.length-1;s<l;++s)(u=n.slice(s-1,s+2))[1][2]=t(u),c.push(u),i.push(u);for(var s=0,l=c.length;s<l;++s)(u=c[s]).previous=c[s-1],u.next=c[s+1];for(;u=i.pop();){var p=u.previous,h=u.next;u[1][2]<a?u[1][2]=a:a=u[1][2],p&&(p.next=h,p[2]=u[2],r(p)),h&&(h.previous=p,h[0]=u[0],r(h))}n.forEach(o)}),n}function l(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return.5*i}function p(n){var t=n[0],r=n[1],e=n[2];return Math.abs((t[0]-e[0])*(r[1]-t[1])-(t[0]-r[0])*(e[1]-t[1]))}function h(n,t){return n[1][2]-t[1][2]}function v(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,o=e[r];if(h(n,o)>=0)break;e[o._=t]=o,e[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,f=e[u];if(i<o&&h(e[i],f)<0&&(f=e[u=i]),r<o&&h(e[r],f)<0&&(f=e[u=r]),u===t)break;e[f._=t]=f,e[n._=t=u]=n}}var r={},e=[],o=0;return r.push=function(t){return n(e[t._=o]=t,o++),o},r.pop=function(){if(!(o<=0)){var n,r=e[0];return--o>0&&(n=e[o],t(e[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(e[u]===r)return u!==--o&&(i=e[o],(h(i,r)<0?n:t)(e[i._=u]=i,u)),u},r}function y(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0),n[0]=(t+=n[0])*e+i,n[1]=(r+=n[1])*o+u}}function g(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0);var c=(n[0]-i)/e|0,a=(n[1]-u)/o|0;n[0]=c-t,n[1]=a-r,t=c,r=a}}function m(){}var d={version:"1.6.18",mesh:function(n){return u(n,r.apply(this,arguments))},meshArcs:r,merge:function(n){return u(n,e.apply(this,arguments))},mergeArcs:e,feature:o,neighbors:a,presimplify:s};"function"==typeof define&&define.amd?define(d):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=d:this.topojson=d}();
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/topojsonHelper.js */
L.TopoJSON=L.GeoJSON.extend({addData:function(o){if("Topology"===o.type)for(key in o.objects)geojson=topojson.feature(o,o.objects[key]),L.GeoJSON.prototype.addData.call(this,geojson);else L.GeoJSON.prototype.addData.call(this,o)}});
</script>

    <script>
      if (!console) {
        window.console = { log: function () { }, warn: function() {}, error: function () {}};
      }
    </script>

    <!-- OUR SYSTEM CODE -->

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/zero-clipboard/ZeroClipboard.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"use strict";var n,r,i,a=e,o=a.document,l=a.navigator,s=a.setTimeout,d=a.clearTimeout,c=a.setInterval,f=a.clearInterval,u=a.getComputedStyle,p=a.encodeURIComponent,h=a.ActiveXObject,y=a.Error,v=a.Number.parseInt||a.parseInt,m=a.Number.parseFloat||a.parseFloat,b=a.Number.isNaN||a.isNaN,g=a.Date.now,w=a.Object.keys,x=a.Object.defineProperty,C=a.Object.prototype.hasOwnProperty,E=a.Array.prototype.slice,T=function(){var e=function(e){return e};if("function"==typeof a.wrap&&"function"==typeof a.unwrap)try{var t=o.createElement("div"),n=a.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=a.unwrap)}catch(e){}return e}(),j=function(e){return E.call(e,0)},_=function(){var e,t,n,r,i,a=j(arguments),o=a[0]||{};for(e=1,t=a.length;e<t;e++)if(null!=(n=a[e]))for(r in n)C.call(n,r)&&(o[r],o!==(i=n[r])&&void 0!==i&&(o[r]=i));return o},D=function e(t){var n,r,i,a;if("object"!==(void 0===t?"undefined":_typeof(t))||null==t||"number"==typeof t.nodeType)n=t;else if("number"==typeof t.length)for(n=[],r=0,i=t.length;r<i;r++)C.call(t,r)&&(n[r]=e(t[r]));else{n={};for(a in t)C.call(t,a)&&(n[a]=e(t[a]))}return n},k=function(e,t){for(var n={},r=0,i=t.length;r<i;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},I=function(e,t){var n={};for(var r in e)-1===t.indexOf(r)&&(n[r]=e[r]);return n},O=function(e){if(e)for(var t in e)C.call(e,t)&&delete e[t];return e},N=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},S=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},A=function(e){var t,n;return"string"==typeof e&&e&&((n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]&&(t=n[1])),t},L=function(){var e,t;try{throw new y}catch(e){t=e}return t&&(e=t.sourceURL||t.fileName||A(t.stack)),e},F=function(){var e,t,n;if(o.currentScript&&(e=o.currentScript.src))return e;if(1===(t=o.getElementsByTagName("script")).length)return t[0].src||void 0;if("readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState&&(e=t[n].src))return e;return"loading"===o.readyState&&(e=t[t.length-1].src)?e:(e=L())?e:void 0},z=function(){var e,t,n,r=o.getElementsByTagName("script");for(e=r.length;e--;){if(!(n=r[e].src)){t=null;break}if(n=S(n),null==t)t=n;else if(t!==n){t=null;break}}return t||void 0},Z=function(){var e=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!l&&(e.test(l.appVersion||"")||e.test(l.platform||"")||-1!==(l.userAgent||"").indexOf("Windows"))},V=function(){return null==e.opener&&(!!e.top&&e!=e.top||!!e.parent&&e!=e.parent)}(),$={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},X={},Y={},B=null,M=0,P=0,H={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},R=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],J=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],K=new RegExp("^flash-("+J.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),U=new RegExp("^flash-("+J.slice(1).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),W={swfPath:function(){return(S(F())||z()||"")+"ZeroClipboard.swf"}(),trustedDomains:e.location.host?[e.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},G=function(e){if("object"===(void 0===e?"undefined":_typeof(e))&&null!==e)for(var t in e)if(C.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(t))W[t]=e[t];else if(null==$.bridge)if("containerId"===t||"swfObjectId"===t){if(!ue(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");W[t]=e[t]}else W[t]=e[t];if("string"!=typeof e||!e)return D(W);if(C.call(W,e))return W[e]},q=function(){return He(),{browser:k(l,["userAgent","platform","appName","appVersion"]),flash:I($,["bridge"]),zeroclipboard:{version:Je.version,config:Je.config()}}},Q=function(){return!!($.disabled||$.outdated||$.sandboxed||$.unavailable||$.degraded||$.deactivated)},ee=function(e,t){var r,i,a,o={};if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)for(r in e)C.call(e,r)&&"string"==typeof r&&r&&"function"==typeof e[r]&&Je.on(r,e[r]);if(a&&a.length){for(r=0,i=a.length;r<i;r++)o[e=a[r].replace(/^on/,"")]=!0,X[e]||(X[e]=[]),X[e].push(t);if(o.ready&&$.ready&&Je.emit({type:"ready"}),o.error){for(r=0,i=J.length;r<i;r++)if(!0===$[J[r].replace(/^flash-/,"")]){Je.emit({type:"error",name:J[r]});break}void 0!==n&&Je.version!==n&&Je.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:n})}}return Je},te=function(e,t){var n,r,i,a,o;if(0===arguments.length)a=w(X);else if("string"==typeof e&&e)a=e.split(/\s+/);else if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)for(n in e)C.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Je.off(n,e[n]);if(a&&a.length)for(n=0,r=a.length;n<r;n++)if(e=a[n].toLowerCase().replace(/^on/,""),(o=X[e])&&o.length)if(t)for(i=o.indexOf(t);-1!==i;)o.splice(i,1),i=o.indexOf(t,i);else o.length=0;return Je},ne=function(e){return"string"==typeof e&&e?D(X[e])||null:D(X)},re=function(e){var t,n,r;if((e=pe(e))&&!we(e))return"ready"===e.type&&!0===$.overdue?Je.emit({type:"error",name:"flash-overdue"}):(t=_({},e),be.call(this,t),"copy"===e.type&&(n=(r=ke(Y)).data,B=r.formatMap),n)},ie=function(){var e=$.sandboxed;if(He(),"boolean"!=typeof $.ready&&($.ready=!1),$.sandboxed!==e&&!0===$.sandboxed)$.ready=!1,Je.emit({type:"error",name:"flash-sandboxed"});else if(!Je.isFlashUnusable()&&null===$.bridge){var t=W.flashLoadTimeout;"number"==typeof t&&t>=0&&(M=s(function(){"boolean"!=typeof $.deactivated&&($.deactivated=!0),!0===$.deactivated&&Je.emit({type:"error",name:"flash-deactivated"})},t)),$.overdue=!1,_e()}},ae=function(){Je.clearData(),Je.blur(),Je.emit("destroy"),De(),Je.off()},oe=function(e,t){var n;if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)n=e,Je.clearData();else{if("string"!=typeof e||!e)return;(n={})[e]=t}for(var r in n)"string"==typeof r&&r&&C.call(n,r)&&"string"==typeof n[r]&&n[r]&&(Y[r]=Pe(n[r]))},le=function(e){void 0===e?(O(Y),B=null):"string"==typeof e&&C.call(Y,e)&&delete Y[e]},se=function(e){return void 0===e?D(Y):"string"==typeof e&&C.call(Y,e)?Y[e]:void 0},de=function(e){if(e&&1===e.nodeType){r&&(ze(r,W.activeClass),r!==e&&ze(r,W.hoverClass)),r=e,Fe(e,W.hoverClass);var t=e.getAttribute("title")||W.title;if("string"==typeof t&&t){var n=je($.bridge);n&&n.setAttribute("title",t)}var i=!0===W.forceHandCursor||"pointer"===Ze(e,"cursor");Be(i),Ye()}},ce=function(){var e=je($.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),r&&(ze(r,W.hoverClass),ze(r,W.activeClass),r=null)},fe=function(){return r||null},ue=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},pe=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"===(void 0===e?"undefined":_typeof(e))&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=i),_(e,{type:t,target:e.target||r||null,relatedTarget:e.relatedTarget||null,currentTarget:$&&$.bridge||null,timeStamp:e.timeStamp||g()||null});var n=H[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&_(e,{target:null,version:$.version}),"error"===e.type&&(K.test(e.name)&&_(e,{target:null,minimumVersion:"11.0.0"}),U.test(e.name)&&_(e,{version:$.version})),"copy"===e.type&&(e.clipboardData={setData:Je.setData,clearData:Je.clearData}),"aftercopy"===e.type&&(e=Ie(e,B)),e.target&&!e.relatedTarget&&(e.relatedTarget=he(e.target)),ye(e)}},he=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?o.getElementById(t):null},ye=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,n="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:void 0,r="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:void 0,i=Ve(t),l=a.screenLeft||a.screenX||0,s=a.screenTop||a.screenY||0,d=o.body.scrollLeft+o.documentElement.scrollLeft,c=o.body.scrollTop+o.documentElement.scrollTop,f=i.left+("number"==typeof e._stageX?e._stageX:0),u=i.top+("number"==typeof e._stageY?e._stageY:0),p=f-d,h=u-c,y=l+p,v=s+h,m="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,_(e,{srcElement:t,fromElement:n,toElement:r,screenX:y,screenY:v,pageX:f,pageY:u,clientX:p,clientY:h,x:p,y:h,movementX:m,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},ve=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},me=function(e,t,n,r){r?s(function(){e.apply(t,n)},0):e.apply(t,n)},be=function(e){if("object"===(void 0===e?"undefined":_typeof(e))&&e&&e.type){var t=ve(e),n=X["*"]||[],r=X[e.type]||[],i=n.concat(r);if(i&&i.length){var o,l,s,d,c,f=this;for(o=0,l=i.length;o<l;o++)d=f,"string"==typeof(s=i[o])&&"function"==typeof a[s]&&(s=a[s]),"object"===(void 0===s?"undefined":_typeof(s))&&s&&"function"==typeof s.handleEvent&&(d=s,s=s.handleEvent),"function"==typeof s&&(c=_({},e),me(s,d,[c],t))}return this}},ge=function(e){var t=null;return(!1===V||e&&"error"===e.type&&e.name&&-1!==R.indexOf(e.name))&&(t=!1),t},we=function(e){var t=e.target||r||null,a="swf"===e._source;switch(delete e._source,e.type){case"error":var o="flash-sandboxed"===e.name||ge(e);"boolean"==typeof o&&($.sandboxed=o),-1!==J.indexOf(e.name)?_($,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(n=e.swfVersion,_($,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Xe();break;case"ready":n=e.swfVersion;var l=!0===$.deactivated;_($,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:l,ready:!l}),Xe();break;case"beforecopy":i=t;break;case"copy":var s,d,c=e.relatedTarget;!Y["text/html"]&&!Y["text/plain"]&&c&&(d=c.value||c.outerHTML||c.innerHTML)&&(s=c.value||c.textContent||c.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s),d!==s&&e.clipboardData.setData("text/html",d)):!Y["text/plain"]&&e.target&&(s=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s));break;case"aftercopy":xe(e),Je.clearData(),t&&t!==Le()&&t.focus&&t.focus();break;case"_mouseover":Je.focus(t),!0===W.bubbleEvents&&a&&(t&&t!==e.relatedTarget&&!N(e.relatedTarget,t)&&Ce(_({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),Ce(_({},e,{type:"mouseover"})));break;case"_mouseout":Je.blur(),!0===W.bubbleEvents&&a&&(t&&t!==e.relatedTarget&&!N(e.relatedTarget,t)&&Ce(_({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),Ce(_({},e,{type:"mouseout"})));break;case"_mousedown":Fe(t,W.activeClass),!0===W.bubbleEvents&&a&&Ce(_({},e,{type:e.type.slice(1)}));break;case"_mouseup":ze(t,W.activeClass),!0===W.bubbleEvents&&a&&Ce(_({},e,{type:e.type.slice(1)}));break;case"_click":i=null,!0===W.bubbleEvents&&a&&Ce(_({},e,{type:e.type.slice(1)}));break;case"_mousemove":!0===W.bubbleEvents&&a&&Ce(_({},e,{type:e.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type))return!0},xe=function(e){if(e.errors&&e.errors.length>0){var t=D(e);_(t,{type:"error",name:"clipboard-error"}),delete t.success,s(function(){Je.emit(t)},0)}},Ce=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,r=n&&n.ownerDocument||o,i={view:r.defaultView||a,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:r.createEvent?0:1},l=_(i,e);n&&r.createEvent&&n.dispatchEvent&&(l=[l.type,l.canBubble,l.cancelable,l.view,l.detail,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget],(t=r.createEvent("MouseEvents")).initMouseEvent&&(t.initMouseEvent.apply(t,l),t._source="js",n.dispatchEvent(t)))}},Ee=function(){var e=W.flashLoadTimeout;if("number"==typeof e&&e>=0){var t=Math.min(1e3,e/10),n=W.swfObjectId+"_fallbackContent";P=c(function(){var e=o.getElementById(n);$e(e)&&(Xe(),$.deactivated=null,Je.emit({type:"error",name:"swf-not-found"}))},t)}},Te=function(){var e=o.createElement("div");return e.id=W.containerId,e.className=W.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Me(W.zIndex),e},je=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},_e=function(){var e,t=$.bridge,n=je(t);if(!t){var r=Ae(a.location.host,W),i="never"===r?"none":"all",l=Ne(_({jsVersion:Je.version},W)),s=W.swfPath+Oe(W.swfPath,W);n=Te();var d=o.createElement("div");n.appendChild(d),o.body.appendChild(n);var c=o.createElement("div"),f="activex"===$.pluginType;c.innerHTML='<object id="'+W.swfObjectId+'" name="'+W.swfObjectId+'" width="100%" height="100%" '+(f?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+s+'"')+">"+(f?'<param name="movie" value="'+s+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+i+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+l+'"/><div id="'+W.swfObjectId+'_fallbackContent">&nbsp;</div></object>',t=c.firstChild,c=null,T(t).ZeroClipboard=Je,n.replaceChild(t,d),Ee()}return t||((t=o[W.swfObjectId])&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),$.bridge=t||null,t},De=function(){var e=$.bridge;if(e){var t=je(e);t&&("activex"===$.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var r in e)"function"==typeof e[r]&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else s(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),Xe(),$.ready=null,$.bridge=null,$.deactivated=null,n=void 0}},ke=function(e){var t={},n={};if("object"===(void 0===e?"undefined":_typeof(e))&&e){for(var r in e)if(r&&C.call(e,r)&&"string"==typeof e[r]&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r}return{data:t,formatMap:n}}},Ie=function(e,t){if("object"!==(void 0===e?"undefined":_typeof(e))||!e||"object"!==(void 0===t?"undefined":_typeof(t))||!t)return e;var n={};for(var r in e)if(C.call(e,r))if("errors"===r){n[r]=e[r]?e[r].slice():[];for(var i=0,a=n[r].length;i<a;i++)n[r][i].format=t[n[r][i].format]}else if("success"!==r&&"data"!==r)n[r]=e[r];else{n[r]={};var o=e[r];for(var l in o)l&&C.call(o,l)&&C.call(t,l)&&(n[r][t[l]]=o[l])}return n},Oe=function(e,t){return null==t||t&&!0===t.cacheBust?(-1===e.indexOf("?")?"?":"&")+"noCache="+g():""},Ne=function(e){var t,n,r,i,o="",l=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?i=[e.trustedDomains]:"object"===_typeof(e.trustedDomains)&&"length"in e.trustedDomains&&(i=e.trustedDomains)),i&&i.length)for(t=0,n=i.length;t<n;t++)if(C.call(i,t)&&i[t]&&"string"==typeof i[t]){if(!(r=Se(i[t])))continue;if("*"===r){l.length=0,l.push(r);break}l.push.apply(l,[r,"//"+r,a.location.protocol+"//"+r])}return l.length&&(o+="trustedOrigins="+p(l.join(","))),!0===e.forceEnhancedClipboard&&(o+=(o?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(o+=(o?"&":"")+"swfObjectId="+p(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(o+=(o?"&":"")+"jsVersion="+p(e.jsVersion)),o},Se=function(e){if(null==e||""===e)return null;if(""===(e=e.replace(/^\s+|\s+$/g,"")))return null;var t=e.indexOf("//"),n=(e=-1===t?e:e.slice(t+2)).indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},Ae=function(){var e=function(e){var t,n,r,i=[];if("string"==typeof e&&(e=[e]),"object"!==(void 0===e?"undefined":_typeof(e))||!e||"number"!=typeof e.length)return i;for(t=0,n=e.length;t<n;t++)if(C.call(e,t)&&(r=Se(e[t]))){if("*"===r){i.length=0,i.push("*");break}-1===i.indexOf(r)&&i.push(r)}return i};return function(t,n){var r=Se(n.swfPath);null===r&&(r=t);var i=e(n.trustedDomains),a=i.length;if(a>0){if(1===a&&"*"===i[0])return"always";if(-1!==i.indexOf(t))return 1===a&&t===r?"sameDomain":"always"}return"never"}}(),Le=function(){try{return o.activeElement}catch(e){return null}},Fe=function(e,t){var n,r,i,a=[];if("string"==typeof t&&t&&(a=t.split(/\s+/)),e&&1===e.nodeType&&a.length>0){for(i=(" "+(e.className||"")+" ").replace(/[\t\r\n\f]/g," "),n=0,r=a.length;n<r;n++)-1===i.indexOf(" "+a[n]+" ")&&(i+=a[n]+" ");(i=i.replace(/^\s+|\s+$/g,""))!==e.className&&(e.className=i)}return e},ze=function(e,t){var n,r,i,a=[];if("string"==typeof t&&t&&(a=t.split(/\s+/)),e&&1===e.nodeType&&a.length>0&&e.className){for(i=(" "+e.className+" ").replace(/[\t\r\n\f]/g," "),n=0,r=a.length;n<r;n++)i=i.replace(" "+a[n]+" "," ");(i=i.replace(/^\s+|\s+$/g,""))!==e.className&&(e.className=i)}return e},Ze=function(e,t){var n=u(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Ve=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),r=a.pageXOffset,i=a.pageYOffset,l=o.documentElement.clientLeft||0,s=o.documentElement.clientTop||0,d=0,c=0;if("relative"===Ze(o.body,"position")){var f=o.body.getBoundingClientRect(),u=o.documentElement.getBoundingClientRect();d=f.left-u.left||0,c=f.top-u.top||0}t.left=n.left+r-l-d,t.top=n.top+i-s-c,t.width="width"in n?n.width:n.right-n.left,t.height="height"in n?n.height:n.bottom-n.top}return t},$e=function(e){if(!e)return!1;var t=u(e,null);if(!t)return!1;var n=m(t.height)>0,r=m(t.width)>0,i=m(t.top)>=0,a=m(t.left)>=0,o=n&&r&&i&&a,l=o?null:Ve(e);return"none"!==t.display&&"collapse"!==t.visibility&&(o||!!l&&(n||l.height>0)&&(r||l.width>0)&&(i||l.top>=0)&&(a||l.left>=0))},Xe=function(){d(M),M=0,f(P),P=0},Ye=function(){var e;if(r&&(e=je($.bridge))){var t=Ve(r);_(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Me(W.zIndex)})}},Be=function(e){!0===$.ready&&($.bridge&&"function"==typeof $.bridge.setHandCursor?$.bridge.setHandCursor(e):$.ready=!1)},Me=function e(t){if(/^(?:auto|inherit)$/.test(t))return t;var n;return"number"!=typeof t||b(t)?"string"==typeof t&&(n=e(v(t,10))):n=t,"number"==typeof n?n:"auto"},Pe=function(e){var t=/(\r\n|\r|\n)/g;return"string"==typeof e&&!0===W.fixLineEndings&&(Z()?/((^|[^\r])\n|\r([^\n]|$))/.test(e)&&(e=e.replace(t,"\r\n")):/\r/.test(e)&&(e=e.replace(t,"\n"))),e},He=function(t){var n,r,i,a=$.sandboxed,o=null;if(t=!0===t,!1===V)o=!1;else{try{r=e.frameElement||null}catch(e){i={name:e.name,message:e.message}}if(r&&1===r.nodeType&&"IFRAME"===r.nodeName)try{o=r.hasAttribute("sandbox")}catch(e){o=null}else{try{n=document.domain||null}catch(e){n=null}(null===n||i&&"SecurityError"===i.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(i.message.toLowerCase()))&&(o=!0)}}return $.sandboxed=o,a===o||t||Re(h),o},Re=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function r(e){e&&(o=!0,e.version&&(c=t(e.version)),!c&&e.description&&(c=t(e.description)),e.filename&&(d=n(e.filename)))}var i,a,o=!1,s=!1,d=!1,c="";if(l.plugins&&l.plugins.length)r(l.plugins["Shockwave Flash"]),l.plugins["Shockwave Flash 2.0"]&&(o=!0,c="2.0.0.11");else if(l.mimeTypes&&l.mimeTypes.length)r((a=l.mimeTypes["application/x-shockwave-flash"])&&a.enabledPlugin);else if(void 0!==e){s=!0;try{i=new e("ShockwaveFlash.ShockwaveFlash.7"),o=!0,c=t(i.GetVariable("$version"))}catch(n){try{i=new e("ShockwaveFlash.ShockwaveFlash.6"),o=!0,c="6.0.21"}catch(n){try{i=new e("ShockwaveFlash.ShockwaveFlash"),o=!0,c=t(i.GetVariable("$version"))}catch(e){s=!1}}}}$.disabled=!0!==o,$.outdated=c&&m(c)<m("11.0.0"),$.version=c||"0.0.0",$.pluginType=d?"pepper":s?"activex":o?"netscape":"unknown"};Re(h),He(!0);var Je=function e(){if(!(this instanceof e))return new e;"function"==typeof e._createClient&&e._createClient.apply(this,j(arguments))};x(Je,"version",{value:"2.3.0-beta.1",writable:!1,configurable:!0,enumerable:!0}),Je.config=function(){return G.apply(this,j(arguments))},Je.state=function(){return q.apply(this,j(arguments))},Je.isFlashUnusable=function(){return Q.apply(this,j(arguments))},Je.on=function(){return ee.apply(this,j(arguments))},Je.off=function(){return te.apply(this,j(arguments))},Je.handlers=function(){return ne.apply(this,j(arguments))},Je.emit=function(){return re.apply(this,j(arguments))},Je.create=function(){return ie.apply(this,j(arguments))},Je.destroy=function(){return ae.apply(this,j(arguments))},Je.setData=function(){return oe.apply(this,j(arguments))},Je.clearData=function(){return le.apply(this,j(arguments))},Je.getData=function(){return se.apply(this,j(arguments))},Je.focus=Je.activate=function(){return de.apply(this,j(arguments))},Je.blur=Je.deactivate=function(){return ce.apply(this,j(arguments))},Je.activeElement=function(){return fe.apply(this,j(arguments))};var Ke=0,Ue={},We=0,Ge={},qe={};_(W,{autoActivate:!0});var Qe=function(e){var t=this;t.id=""+Ke++,Ue[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),Je.on("*",function(e){return t.emit(e)}),Je.on("destroy",function(){t.destroy()}),Je.create()},et=function(e,t){var r,i,a,o={},l=Ue[this.id],s=l&&l.handlers;if(!l)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)for(r in e)C.call(e,r)&&"string"==typeof r&&r&&"function"==typeof e[r]&&this.on(r,e[r]);if(a&&a.length){for(r=0,i=a.length;r<i;r++)o[e=a[r].replace(/^on/,"")]=!0,s[e]||(s[e]=[]),s[e].push(t);if(o.ready&&$.ready&&this.emit({type:"ready",client:this}),o.error){for(r=0,i=J.length;r<i;r++)if($[J[r].replace(/^flash-/,"")]){this.emit({type:"error",name:J[r],client:this});break}void 0!==n&&Je.version!==n&&this.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:n})}}return this},tt=function(e,t){var n,r,i,a,o,l=Ue[this.id],s=l&&l.handlers;if(!s)return this;if(0===arguments.length)a=w(s);else if("string"==typeof e&&e)a=e.split(/\s+/);else if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)for(n in e)C.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(a&&a.length)for(n=0,r=a.length;n<r;n++)if(e=a[n].toLowerCase().replace(/^on/,""),(o=s[e])&&o.length)if(t)for(i=o.indexOf(t);-1!==i;)o.splice(i,1),i=o.indexOf(t,i);else o.length=0;return this},nt=function(e){var t=null,n=Ue[this.id]&&Ue[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:D(n)),t},rt=function(e){if(st.call(this,e)){"object"===(void 0===e?"undefined":_typeof(e))&&e&&"string"==typeof e.type&&e.type&&(e=_({},e));var t=_({},pe(e),{client:this});dt.call(this,t)}return this},it=function(e){if(!Ue[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=ct(e);for(var t=0;t<e.length;t++)if(C.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===Ge[e[t].zcClippingId].indexOf(this.id)&&Ge[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+We++,Ge[e[t].zcClippingId]=[this.id],!0===W.autoActivate&&ft(e[t]));var n=Ue[this.id]&&Ue[this.id].elements;-1===n.indexOf(e[t])&&n.push(e[t])}return this},at=function(e){var t=Ue[this.id];if(!t)return this;for(var n,r=t.elements,i=(e=void 0===e?r.slice(0):ct(e)).length;i--;)if(C.call(e,i)&&e[i]&&1===e[i].nodeType){for(n=0;-1!==(n=r.indexOf(e[i],n));)r.splice(n,1);var a=Ge[e[i].zcClippingId];if(a){for(n=0;-1!==(n=a.indexOf(this.id,n));)a.splice(n,1);0===a.length&&(!0===W.autoActivate&&ut(e[i]),delete e[i].zcClippingId)}}return this},ot=function(){var e=Ue[this.id];return e&&e.elements?e.elements.slice(0):[]},lt=function(){Ue[this.id]&&(this.unclip(),this.off(),delete Ue[this.id])},st=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Ue[this.id],n=t&&t.elements,r=!!n&&n.length>0,i=!e.target||r&&-1!==n.indexOf(e.target),a=e.relatedTarget&&r&&-1!==n.indexOf(e.relatedTarget),o=e.client&&e.client===this;return!(!t||!(i||a||o))},dt=function(e){var t=Ue[this.id];if("object"===(void 0===e?"undefined":_typeof(e))&&e&&e.type&&t){var n=ve(e),r=t&&t.handlers["*"]||[],i=t&&t.handlers[e.type]||[],o=r.concat(i);if(o&&o.length){var l,s,d,c,f,u=this;for(l=0,s=o.length;l<s;l++)c=u,"string"==typeof(d=o[l])&&"function"==typeof a[d]&&(d=a[d]),"object"===(void 0===d?"undefined":_typeof(d))&&d&&"function"==typeof d.handleEvent&&(c=d,d=d.handleEvent),"function"==typeof d&&(f=_({},e),me(d,c,[f],n))}}},ct=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},ft=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=a.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=a.event))&&(t(n),Je.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),qe[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},ut=function(e){if(e&&1===e.nodeType){var t=qe[e.zcClippingId];if("object"===(void 0===t?"undefined":_typeof(t))&&t){for(var n,r,i=["move","leave","enter","out","over"],a=0,o=i.length;a<o;a++)"function"==typeof(r=t[n="mouse"+i[a]])&&e.removeEventListener(n,r,!1);delete qe[e.zcClippingId]}}};Je._createClient=function(){Qe.apply(this,j(arguments))},Je.prototype.on=function(){return et.apply(this,j(arguments))},Je.prototype.off=function(){return tt.apply(this,j(arguments))},Je.prototype.handlers=function(){return nt.apply(this,j(arguments))},Je.prototype.emit=function(){return rt.apply(this,j(arguments))},Je.prototype.clip=function(){return it.apply(this,j(arguments))},Je.prototype.unclip=function(){return at.apply(this,j(arguments))},Je.prototype.elements=function(){return ot.apply(this,j(arguments))},Je.prototype.destroy=function(){return lt.apply(this,j(arguments))},Je.prototype.setText=function(e){if(!Ue[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/plain",e),this},Je.prototype.setHtml=function(e){if(!Ue[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/html",e),this},Je.prototype.setRichText=function(e){if(!Ue[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("application/rtf",e),this},Je.prototype.setData=function(){if(!Ue[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData.apply(this,j(arguments)),this},Je.prototype.clearData=function(){if(!Ue[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Je.clearData.apply(this,j(arguments)),this},Je.prototype.getData=function(){if(!Ue[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Je.getData.apply(this,j(arguments))},"function"==typeof define&&define.amd?define(function(){return Je}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module&&"object"===_typeof(module.exports)&&module.exports?module.exports=Je:e.ZeroClipboard=Je}(function(){return this||window}());
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/uri.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],e):t.URI=e(t.punycode,t.IPv6,t.SecondLevelDomains,t)}(this,function(t,e,r,n){function s(t,e){var r=1<=arguments.length,n=2<=arguments.length;if(!(this instanceof s))return r?n?new s(t,e):new s(t):new s;if(void 0===t){if(r)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}return this.href(t),void 0!==e?this.absoluteTo(e):this}function i(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function a(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function o(t){return"Array"===a(t)}function h(t,e){var r,n,s={};if("RegExp"===a(e))s=null;else if(o(e))for(r=0,n=e.length;r<n;r++)s[e[r]]=!0;else s[e]=!0;for(r=0,n=t.length;r<n;r++)(s&&void 0!==s[t[r]]||!s&&e.test(t[r]))&&(t.splice(r,1),n--,r--);return t}function u(t,e){var r,n;if(o(e)){for(r=0,n=e.length;r<n;r++)if(!u(t,e[r]))return!1;return!0}var s=a(e);for(r=0,n=t.length;r<n;r++)if("RegExp"===s){if("string"==typeof t[r]&&t[r].match(e))return!0}else if(t[r]===e)return!0;return!1}function p(t,e){if(!o(t)||!o(e)||t.length!==e.length)return!1;t.sort(),e.sort();for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function c(t){return escape(t)}function d(t){return encodeURIComponent(t).replace(/[!'()*]/g,c).replace(/\*/g,"%2A")}function l(t){return function(e,r){return void 0===e?this._parts[t]||"":(this._parts[t]=e||null,this.build(!r),this)}}function f(t,e){return function(r,n){return void 0===r?this._parts[t]||"":(null!==r&&(r+="").charAt(0)===e&&(r=r.substring(1)),this._parts[t]=r,this.build(!n),this)}}var m=n&&n.URI;s.version="1.16.1";var y=s.prototype,g=Object.prototype.hasOwnProperty;s._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:s.duplicateQueryParameters,escapeQuerySpace:s.escapeQuerySpace}},s.duplicateQueryParameters=!1,s.escapeQuerySpace=!0,s.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,s.idn_expression=/[^a-z0-9\.-]/i,s.punycode_expression=/(xn--)/i,s.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,s.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/gi,s.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u201e\u2018\u2019]+$/},s.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},s.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,s.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},s.getDomAttribute=function(t){if(t&&t.nodeName){var e=t.nodeName.toLowerCase();return"input"===e&&"image"!==t.type?void 0:s.domAttributes[e]}},s.encode=d,s.decode=decodeURIComponent,s.iso8859=function(){s.encode=escape,s.decode=unescape},s.unicode=function(){s.encode=d,s.decode=decodeURIComponent},s.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},s.encodeQuery=function(t,e){var r=s.encode(t+"");return void 0===e&&(e=s.escapeQuerySpace),e?r.replace(/%20/g,"+"):r},s.decodeQuery=function(t,e){t+="",void 0===e&&(e=s.escapeQuerySpace);try{return s.decode(e?t.replace(/\+/g,"%20"):t)}catch(e){return t}};var _,v={encode:"encode",decode:"decode"},b=function(t,e){return function(r){try{return s[e](r+"").replace(s.characters[t][e].expression,function(r){return s.characters[t][e].map[r]})}catch(t){return r}}};for(_ in v)s[_+"PathSegment"]=b("pathname",v[_]),s[_+"UrnPathSegment"]=b("urnpath",v[_]);v=function(t,e,r){return function(n){var i;i=r?function(t){return s[e](s[r](t))}:s[e];for(var a=0,o=(n=(n+"").split(t)).length;a<o;a++)n[a]=i(n[a]);return n.join(t)}},s.decodePath=v("/","decodePathSegment"),s.decodeUrnPath=v(":","decodeUrnPathSegment"),s.recodePath=v("/","encodePathSegment","decode"),s.recodeUrnPath=v(":","encodeUrnPathSegment","decode"),s.encodeReserved=b("reserved","encode"),s.parse=function(t,e){var r;return e||(e={}),-1<(r=t.indexOf("#"))&&(e.fragment=t.substring(r+1)||null,t=t.substring(0,r)),-1<(r=t.indexOf("?"))&&(e.query=t.substring(r+1)||null,t=t.substring(0,r)),"//"===t.substring(0,2)?(e.protocol=null,t=t.substring(2),t=s.parseAuthority(t,e)):-1<(r=t.indexOf(":"))&&(e.protocol=t.substring(0,r)||null,e.protocol&&!e.protocol.match(s.protocol_expression)?e.protocol=void 0:"//"===t.substring(r+1,r+3)?(t=t.substring(r+3),t=s.parseAuthority(t,e)):(t=t.substring(r+1),e.urn=!0)),e.path=t,e},s.parseHost=function(t,e){var r,n=(t=t.replace(/\\/g,"/")).indexOf("/");if(-1===n&&(n=t.length),"["===t.charAt(0))r=t.indexOf("]"),e.hostname=t.substring(1,r)||null,e.port=t.substring(r+2,n)||null,"/"===e.port&&(e.port=null);else{var s=t.indexOf(":");r=t.indexOf("/"),-1!==(s=t.indexOf(":",s+1))&&(-1===r||s<r)?(e.hostname=t.substring(0,n)||null,e.port=null):(r=t.substring(0,n).split(":"),e.hostname=r[0]||null,e.port=r[1]||null)}return e.hostname&&"/"!==t.substring(n).charAt(0)&&(n++,t="/"+t),t.substring(n)||"/"},s.parseAuthority=function(t,e){return t=s.parseUserinfo(t,e),s.parseHost(t,e)},s.parseUserinfo=function(t,e){var r=t.indexOf("/"),n=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<n&&(-1===r||n<r)?(r=t.substring(0,n).split(":"),e.username=r[0]?s.decode(r[0]):null,r.shift(),e.password=r[0]?s.decode(r.join(":")):null,t=t.substring(n+1)):(e.username=null,e.password=null),t},s.parseQuery=function(t,e){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var r,n,i={},a=t.split("&"),o=a.length,h=0;h<o;h++)r=a[h].split("="),n=s.decodeQuery(r.shift(),e),r=r.length?s.decodeQuery(r.join("="),e):null,g.call(i,n)?("string"!=typeof i[n]&&null!==i[n]||(i[n]=[i[n]]),i[n].push(r)):i[n]=r;return i},s.build=function(t){var e="";return t.protocol&&(e+=t.protocol+":"),t.urn||!e&&!t.hostname||(e+="//"),e+=s.buildAuthority(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(e+="/"),e+=t.path),"string"==typeof t.query&&t.query&&(e+="?"+t.query),"string"==typeof t.fragment&&t.fragment&&(e+="#"+t.fragment),e},s.buildHost=function(t){var e="";return t.hostname?(e=s.ip6_expression.test(t.hostname)?e+"["+t.hostname+"]":e+t.hostname,t.port&&(e+=":"+t.port),e):""},s.buildAuthority=function(t){return s.buildUserinfo(t)+s.buildHost(t)},s.buildUserinfo=function(t){var e="";return t.username&&(e+=s.encode(t.username),t.password&&(e+=":"+s.encode(t.password)),e+="@"),e},s.buildQuery=function(t,e,r){var n,i,a,h,u="";for(i in t)if(g.call(t,i)&&i)if(o(t[i]))for(n={},a=0,h=t[i].length;a<h;a++)void 0!==t[i][a]&&void 0===n[t[i][a]+""]&&(u+="&"+s.buildQueryParameter(i,t[i][a],r),!0!==e&&(n[t[i][a]+""]=!0));else void 0!==t[i]&&(u+="&"+s.buildQueryParameter(i,t[i],r));return u.substring(1)},s.buildQueryParameter=function(t,e,r){return s.encodeQuery(t,r)+(null!==e?"="+s.encodeQuery(e,r):"")},s.addQuery=function(t,e,r){if("object"===(void 0===e?"undefined":_typeof(e)))for(var n in e)g.call(e,n)&&s.addQuery(t,n,e[n]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");void 0===t[e]?t[e]=r:("string"==typeof t[e]&&(t[e]=[t[e]]),o(r)||(r=[r]),t[e]=(t[e]||[]).concat(r))}},s.removeQuery=function(t,e,r){var n;if(o(e))for(r=0,n=e.length;r<n;r++)t[e[r]]=void 0;else if("RegExp"===a(e))for(n in t)e.test(n)&&(t[n]=void 0);else if("object"===(void 0===e?"undefined":_typeof(e)))for(n in e)g.call(e,n)&&s.removeQuery(t,n,e[n]);else{if("string"!=typeof e)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==r?"RegExp"===a(r)?!o(t[e])&&r.test(t[e])?t[e]=void 0:t[e]=h(t[e],r):t[e]===r?t[e]=void 0:o(t[e])&&(t[e]=h(t[e],r)):t[e]=void 0}},s.hasQuery=function(t,e,r,n){if("object"===(void 0===e?"undefined":_typeof(e))){for(var i in e)if(g.call(e,i)&&!s.hasQuery(t,i,e[i]))return!1;return!0}if("string"!=typeof e)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(a(r)){case"Undefined":return e in t;case"Boolean":return t=Boolean(o(t[e])?t[e].length:t[e]),r===t;case"Function":return!!r(t[e],e,t);case"Array":return!!o(t[e])&&(n?u:p)(t[e],r);case"RegExp":return o(t[e])?!!n&&u(t[e],r):Boolean(t[e]&&t[e].match(r));case"Number":r=String(r);case"String":return o(t[e])?!!n&&u(t[e],r):t[e]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},s.commonPath=function(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r++)if(t.charAt(r)!==e.charAt(r)){r--;break}return 1>r?t.charAt(0)===e.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(r)&&"/"===e.charAt(r)||(r=t.substring(0,r).lastIndexOf("/")),t.substring(0,r+1))},s.withinString=function(t,e,r){r||(r={});var n=r.start||s.findUri.start,i=r.end||s.findUri.end,a=r.trim||s.findUri.trim,o=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var h=n.exec(t);if(!h)break;if(h=h.index,!(r.ignoreHtml&&(u=t.slice(Math.max(h-3,0),h))&&o.test(u))){var u=h+t.slice(h).search(i),p=t.slice(h,u).replace(a,"");r.ignore&&r.ignore.test(p)||(u=h+p.length,p=e(p,h,u,t),t=t.slice(0,h)+p+t.slice(u),n.lastIndex=h+p.length)}}return n.lastIndex=0,t},s.ensureValidHostname=function(e){if(e.match(s.invalid_hostname_characters)){if(!t)throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(t.toASCII(e).match(s.invalid_hostname_characters))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]')}},s.noConflict=function(t){return t?(t={URI:this.noConflict()},n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t):(n.URI===this&&(n.URI=m),this)},y.build=function(t){return!0===t?this._deferred_build=!0:(void 0===t||this._deferred_build)&&(this._string=s.build(this._parts),this._deferred_build=!1),this},y.clone=function(){return new s(this)},y.valueOf=y.toString=function(){return this.build(!1)._string},y.protocol=l("protocol"),y.username=l("username"),y.password=l("password"),y.hostname=l("hostname"),y.port=l("port"),y.query=f("query","?"),y.fragment=f("fragment","#"),y.search=function(t,e){var r=this.query(t,e);return"string"==typeof r&&r.length?"?"+r:r},y.hash=function(t,e){var r=this.fragment(t,e);return"string"==typeof r&&r.length?"#"+r:r},y.pathname=function(t,e){if(void 0===t||!0===t){var r=this._parts.path||(this._parts.hostname?"/":"");return t?(this._parts.urn?s.decodeUrnPath:s.decodePath)(r):r}return this._parts.path=this._parts.urn?t?s.recodeUrnPath(t):"":t?s.recodePath(t):"/",this.build(!e),this},y.path=y.pathname,y.href=function(t,e){var r;if(void 0===t)return this.toString();this._string="",this._parts=s._parts();var n=t instanceof s,i="object"===(void 0===t?"undefined":_typeof(t))&&(t.hostname||t.path||t.pathname);if(t.nodeName&&(i=s.getDomAttribute(t),t=t[i]||"",i=!1),!n&&i&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this._parts=s.parse(String(t),this._parts);else{if(!n&&!i)throw new TypeError("invalid input");for(r in n=n?t._parts:t)g.call(this._parts,r)&&(this._parts[r]=n[r])}return this.build(!e),this},y.is=function(t){var e=!1,n=!1,i=!1,a=!1,o=!1,h=!1,u=!1,p=!this._parts.urn;switch(this._parts.hostname&&(p=!1,n=s.ip4_expression.test(this._parts.hostname),i=s.ip6_expression.test(this._parts.hostname),e=n||i,o=(a=!e)&&r&&r.has(this._parts.hostname),h=a&&s.idn_expression.test(this._parts.hostname),u=a&&s.punycode_expression.test(this._parts.hostname)),t.toLowerCase()){case"relative":return p;case"absolute":return!p;case"domain":case"name":return a;case"sld":return o;case"ip":return e;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return i;case"idn":return h;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return u}return null};var w=y.protocol,Q=y.port,A=y.hostname;y.protocol=function(t,e){if(void 0!==t&&t&&!(t=t.replace(/:(\/\/)?$/,"")).match(s.protocol_expression))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return w.call(this,t,e)},y.scheme=y.protocol,y.port=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),t.match(/[^0-9]/))))throw new TypeError('Port "'+t+'" contains characters other than [0-9]');return Q.call(this,t,e)},y.hostname=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t){var r={};if("/"!==s.parseHost(t,r))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=r.hostname}return A.call(this,t,e)},y.host=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t)return this._parts.hostname?s.buildHost(this._parts):"";if("/"!==s.parseHost(t,this._parts))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.build(!e),this},y.authority=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t)return this._parts.hostname?s.buildAuthority(this._parts):"";if("/"!==s.parseAuthority(t,this._parts))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.build(!e),this},y.userinfo=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.username)return"";var r=s.buildUserinfo(this._parts);return r.substring(0,r.length-1)}return"@"!==t[t.length-1]&&(t+="@"),s.parseUserinfo(t,this._parts),this.build(!e),this},y.resource=function(t,e){var r;return void 0===t?this.path()+this.search()+this.hash():(r=s.parse(t),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!e),this)},y.subdomain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,r)||""}return r=this._parts.hostname.length-this.domain().length,r=this._parts.hostname.substring(0,r),r=new RegExp("^"+i(r)),t&&"."!==t.charAt(t.length-1)&&(t+="."),t&&s.ensureValidHostname(t),this._parts.hostname=this._parts.hostname.replace(r,t),this.build(!e),this},y.domain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);return r&&2>r.length?this._parts.hostname:(r=this._parts.hostname.length-this.tld(e).length-1,r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||"")}if(!t)throw new TypeError("cannot set domain empty");return s.ensureValidHostname(t),!this._parts.hostname||this.is("IP")?this._parts.hostname=t:(r=new RegExp(i(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(r,t)),this.build(!e),this},y.tld=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),n=this._parts.hostname.substring(n+1);return!0!==e&&r&&r.list[n.toLowerCase()]?r.get(this._parts.hostname)||n:n}if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');n=new RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(n,t)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");n=new RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(n,t)}return this.build(!e),this},y.directory=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return t?s.decodePath(r):r}return r=this._parts.path.length-this.filename().length,r=this._parts.path.substring(0,r),r=new RegExp("^"+i(r)),this.is("relative")||(t||(t="/"),"/"!==t.charAt(0)&&(t="/"+t)),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=s.recodePath(t),this._parts.path=this._parts.path.replace(r,t),this.build(!e),this},y.filename=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(r+1);return t?s.decodePathSegment(r):r}r=!1,"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(r=!0);var n=new RegExp(i(this.filename())+"$");return t=s.recodePath(t),this._parts.path=this._parts.path.replace(n,t),r?this.normalizePath(e):this.build(!e),this},y.suffix=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path||"/"===this._parts.path)return"";var r=this.filename(),n=r.lastIndexOf(".");return-1===n?"":(r=r.substring(n+1),r=/^[a-z0-9%]+$/i.test(r)?r:"",t?s.decodePathSegment(r):r)}if("."===t.charAt(0)&&(t=t.substring(1)),r=this.suffix())n=t?new RegExp(i(r)+"$"):new RegExp(i("."+r)+"$");else{if(!t)return this;this._parts.path+="."+s.recodePath(t)}return n&&(t=s.recodePath(t),this._parts.path=this._parts.path.replace(n,t)),this.build(!e),this},y.segment=function(t,e,r){var n=this._parts.urn?":":"/",s="/"===(i=this.path()).substring(0,1),i=i.split(n);if(void 0!==t&&"number"!=typeof t&&(r=e,e=t,t=void 0),void 0!==t&&"number"!=typeof t)throw Error('Bad segment "'+t+'", must be 0-based integer');if(s&&i.shift(),0>t&&(t=Math.max(i.length+t,0)),void 0===e)return void 0===t?i:i[t];if(null===t||void 0===i[t])if(o(e)){i=[],t=0;for(var a=e.length;t<a;t++)(e[t].length||i.length&&i[i.length-1].length)&&(i.length&&!i[i.length-1].length&&i.pop(),i.push(e[t]))}else(e||"string"==typeof e)&&(""===i[i.length-1]?i[i.length-1]=e:i.push(e));else e?i[t]=e:i.splice(t,1);return s&&i.unshift(""),this.path(i.join(n),r)},y.segmentCoded=function(t,e,r){var n,i;if("number"!=typeof t&&(r=e,e=t,t=void 0),void 0===e){if(t=this.segment(t,e,r),o(t))for(n=0,i=t.length;n<i;n++)t[n]=s.decode(t[n]);else t=void 0!==t?s.decode(t):void 0;return t}if(o(e))for(n=0,i=e.length;n<i;n++)e[n]=s.encode(e[n]);else e="string"==typeof e||e instanceof String?s.encode(e):e;return this.segment(t,e,r)};var P=y.query;return y.query=function(t,e){if(!0===t)return s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof t){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=t.call(this,r);return this._parts.query=s.buildQuery(n||r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this}return void 0!==t&&"string"!=typeof t?(this._parts.query=s.buildQuery(t,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this):P.call(this,t,e)},y.setQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof t||t instanceof String)n[t]=void 0!==e?e:null;else{if("object"!==(void 0===t?"undefined":_typeof(t)))throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var i in t)g.call(t,i)&&(n[i]=t[i])}return this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.addQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.addQuery(n,t,void 0===e?null:e),this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.removeQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.removeQuery(n,t,e),this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.hasQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.hasQuery(n,t,e,r)},y.setSearch=y.setQuery,y.addSearch=y.addQuery,y.removeSearch=y.removeQuery,y.hasSearch=y.hasQuery,y.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},y.normalizeProtocol=function(t){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!t)),this},y.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&t?this._parts.hostname=t.toASCII(this._parts.hostname):this.is("IPv6")&&e&&(this._parts.hostname=e.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},y.normalizePort=function(t){return"string"==typeof this._parts.protocol&&this._parts.port===s.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!t)),this},y.normalizePath=function(t){var e=this._parts.path;if(!e)return this;if(this._parts.urn)return this._parts.path=s.recodeUrnPath(this._parts.path),this.build(!t),this;if("/"===this._parts.path)return this;var r,n,i,a="";for("/"!==e.charAt(0)&&(r=!0,e="/"+e),"/.."!==e.slice(-3)&&"/."!==e.slice(-2)||(e+="/"),e=e.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),r&&(a=e.substring(1).match(/^(\.\.\/)+/)||"")&&(a=a[0]);-1!==(n=e.indexOf("/.."));)0!==n?(-1===(i=e.substring(0,n).lastIndexOf("/"))&&(i=n),e=e.substring(0,i)+e.substring(n+3)):e=e.substring(3);return r&&this.is("relative")&&(e=a+e.substring(1)),e=s.recodePath(e),this._parts.path=e,this.build(!t),this},y.normalizePathname=y.normalizePath,y.normalizeQuery=function(t){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(s.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!t)),this},y.normalizeFragment=function(t){return this._parts.fragment||(this._parts.fragment=null,this.build(!t)),this},y.normalizeSearch=y.normalizeQuery,y.normalizeHash=y.normalizeFragment,y.iso8859=function(){var t=s.encode,e=s.decode;s.encode=escape,s.decode=decodeURIComponent;try{this.normalize()}finally{s.encode=t,s.decode=e}return this},y.unicode=function(){var t=s.encode,e=s.decode;s.encode=d,s.decode=unescape;try{this.normalize()}finally{s.encode=t,s.decode=e}return this},y.readable=function(){var e=this.clone();e.username("").password("").normalize();var r="";if(e._parts.protocol&&(r+=e._parts.protocol+"://"),e._parts.hostname&&(e.is("punycode")&&t?(r+=t.toUnicode(e._parts.hostname),e._parts.port&&(r+=":"+e._parts.port)):r+=e.host()),e._parts.hostname&&e._parts.path&&"/"!==e._parts.path.charAt(0)&&(r+="/"),r+=e.path(!0),e._parts.query){for(var n="",i=0,a=e._parts.query.split("&"),o=a.length;i<o;i++){var h=(a[i]||"").split("="),n=n+"&"+s.decodeQuery(h[0],this._parts.escapeQuerySpace).replace(/&/g,"%26");void 0!==h[1]&&(n+="="+s.decodeQuery(h[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}r+="?"+n.substring(1)}return r+=s.decodeQuery(e.hash(),!0)},y.absoluteTo=function(t){var e,r,n=this.clone(),i=["protocol","username","password","hostname","port"];if(this._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(t instanceof s||(t=new s(t)),n._parts.protocol||(n._parts.protocol=t._parts.protocol),this._parts.hostname)return n;for(e=0;r=i[e];e++)n._parts[r]=t._parts[r];return n._parts.path?".."===n._parts.path.substring(-2)&&(n._parts.path+="/"):(n._parts.path=t._parts.path,n._parts.query||(n._parts.query=t._parts.query)),"/"!==n.path().charAt(0)&&(i=(i=t.directory())?i:0===t.path().indexOf("/")?"/":"",n._parts.path=(i?i+"/":"")+n._parts.path,n.normalizePath()),n.build(),n},y.relativeTo=function(t){var e,r,n,i=this.clone().normalize();if(i._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(t=new s(t).normalize(),e=i._parts,r=t._parts,n=i.path(),t=t.path(),"/"!==n.charAt(0))throw Error("URI is already relative");if("/"!==t.charAt(0))throw Error("Cannot calculate a URI relative to another relative URI");return e.protocol===r.protocol&&(e.protocol=null),e.username!==r.username||e.password!==r.password||null!==e.protocol||null!==e.username||null!==e.password||e.hostname!==r.hostname||e.port!==r.port?i.build():(e.hostname=null,e.port=null,n===t?(e.path="",i.build()):(n=s.commonPath(n,t))?(r=r.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../"),e.path=r+e.path.substring(n.length)||"./",i.build()):i.build())},y.equals=function(t){var e=this.clone();t=new s(t);var r,n={},i={},a={};if(e.normalize(),t.normalize(),e.toString()===t.toString())return!0;if(n=e.query(),i=t.query(),e.query(""),t.query(""),e.toString()!==t.toString()||n.length!==i.length)return!1;n=s.parseQuery(n,this._parts.escapeQuerySpace),i=s.parseQuery(i,this._parts.escapeQuerySpace);for(r in n)if(g.call(n,r)){if(o(n[r])){if(!p(n[r],i[r]))return!1}else if(n[r]!==i[r])return!1;a[r]=!0}for(r in i)if(g.call(i,r)&&!a[r])return!1;return!0},y.duplicateQueryParameters=function(t){return this._parts.duplicateQueryParameters=!!t,this},y.escapeQuerySpace=function(t){return this._parts.escapeQuerySpace=!!t,this},s});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/colorbrewer.js */
var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};
</script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/ractive.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive=e()}(this,function(){"use strict";function t(t){var e;if(t&&"boolean"!=typeof t)return"undefined"!=typeof window&&document&&t?t.nodeType?t:"string"==typeof t&&(!(e=document.getElementById(t))&&document.querySelector&&(e=document.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function e(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function n(t){return null!=t&&t.toString?t:""}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var r,s;s=n.shift();)for(r in s)Ea.call(s,r)&&(t[r]=s[r]);return t}function r(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.forEach(function(e){for(var n in e)!e.hasOwnProperty(n)||n in t||(t[n]=e[n])}),t}function s(t){return"[object Array]"===Aa.call(t)}function o(t){return Sa.test(Aa.call(t))}function a(t,e){return null===t&&null===e||"object"!==(void 0===t?"undefined":_typeof(t))&&"object"!==(void 0===e?"undefined":_typeof(e))&&t===e}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}function h(t){return t&&"[object Object]"===Aa.call(t)}function c(t,e){return t.replace(/%s/g,function(){return e.shift()})}function l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw t=c(t,n),new Error(t)}function f(){fb.DEBUG&&xa.apply(null,arguments)}function d(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];t=c(t,n),ka(t,n)}function p(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];t=c(t,n),Oa[t]||(Oa[t]=!0,ka(t,n))}function m(){fb.DEBUG&&d.apply(null,arguments)}function v(){fb.DEBUG&&p.apply(null,arguments)}function g(t,e,n){var i=y(t,e,n);return i?i[t][n]:null}function y(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function b(t){return function(){return t}}function w(t){var e,n,i,r,s,o;for(e=t.split("."),(n=Da[e.length])||(n=x(e.length)),s=[],i=function(t,n){return t?"*":e[n]},r=n.length;r--;)o=n[r].map(i).join("."),s.hasOwnProperty(o)||(s.push(o),s[o]=!0);return s}function x(t){var e,n,i,r,s,o,a,u,h="";if(!Da[t]){for(i=[];h.length<t;)h+=1;for(e=parseInt(h,2),r=function(t){return"1"===t},s=0;s<=e;s+=1){for(n=s.toString(2);n.length<t;)n="0"+n;for(u=[],a=n.length,o=0;o<a;o++)u.push(r(n[o]));i[s]=u}Da[t]=i}return Da[t]}function k(t,e,n,i){var r=t[e];if(!r||!r.equalsOrStartsWith(i)&&r.equalsOrStartsWith(n))return t[e]=r?r.replace(n,i):i,!0}function _(t){var e=t.slice(2);return"i"===t[1]&&u(e)?+e:e}function E(t){return null==t?t:(Va.hasOwnProperty(t)||(Va[t]=new Ma(t)),Va[t])}function A(t,e){function n(e,n){var i,r,o;return n.isRoot?o=[].concat(Object.keys(t.viewmodel.data),Object.keys(t.viewmodel.mappings),Object.keys(t.viewmodel.computations)):(i=t.viewmodel.wrapped[n.str],o=(r=i?i.get():t.viewmodel.get(n))?Object.keys(r):null),o&&o.forEach(function(t){"_ractive"===t&&s(r)||e.push(n.join(t))}),e}var i,r,o;for(i=e.str.split("."),o=[Wa];r=i.shift();)"*"===r?o=o.reduce(n,[]):o[0]===Wa?o[0]=E(r):o=o.map(S(r));return o}function S(t){return function(e){return e.join(t)}}function C(t){return t?t.replace(Ia,".$1"):""}function O(t,e,n){if("string"!=typeof e||!u(n))throw new Error("Bad arguments");var i=void 0,r=void 0;if(/\*/.test(e))return r={},A(t,E(C(e))).forEach(function(e){var i=t.viewmodel.get(e);if(!u(i))throw new Error(Ba);r[e.str]=i+n}),t.set(r);if(i=t.get(e),!u(i))throw new Error(Ba);return t.set(e,+i+n)}function P(t,e){return za(this,t,void 0===e?1:+e)}function T(t){this.event=t,this.method="on"+t,this.deprecate=Ha[t]}function F(t,e){-1===t.indexOf(e)&&t.push(e)}function R(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]==e)return!0;return!1}function j(t,e){var n;if(!s(t)||!s(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function N(t){return"string"==typeof t?[t]:void 0===t?[]:t}function D(t){return t[t.length-1]}function I(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function L(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function V(t){setTimeout(t,0)}function M(t,e){return function(){for(var n;n=t.shift();)n(e)}}function U(t,e,n,i){var r;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof Ka)e.then(n,i);else if(!e||"object"!==(void 0===e?"undefined":_typeof(e))&&"function"!=typeof e)n(e);else{try{r=e.then}catch(t){return void i(t)}if("function"==typeof r){var s,o,a;o=function(e){s||(s=!0,U(t,e,n,i))},a=function(t){s||(s=!0,i(t))};try{r.call(e,o,a)}catch(t){if(!s)return i(t),void(s=!0)}}else n(e)}}function W(t,e,n){var i;return e=C(e),"~/"===e.substr(0,2)?q(t,(i=E(e.substring(2))).firstKey):"."===e[0]?(i=z(eu(n),e))&&q(t,i.firstKey):i=B(t,E(e),n),i}function z(t,e){var n;if(void 0!=t&&"string"!=typeof t&&(t=t.str),"."===e)return E(t);if(n=t?t.split("."):[],"../"===e.substr(0,3)){for(;"../"===e.substr(0,3);){if(!n.length)throw new Error('Could not resolve reference - too many "../" prefixes');n.pop(),e=e.substring(3)}return n.push(e),E(n.join("."))}return E(t?t+e.replace(/^\.\//,"."):e.replace(/^\.\/?/,""))}function B(t,e,n,i){var r,s,o,a,u;if(e.isRoot)return e;for(s=e.firstKey;n;)if(r=n.context,n=n.parent,r&&(a=!0,(o=t.viewmodel.get(r))&&("object"===(void 0===o?"undefined":_typeof(o))||"function"==typeof o)&&s in o))return r.join(e.str);return $(t.viewmodel,s)?e:t.parent&&!t.isolated&&(a=!0,n=t.component.parentFragment,s=E(s),u=B(t.parent,s,n,!0))?(t.viewmodel.map(s,{origin:t.parent.viewmodel,keypath:u}),e):i||a?void 0:(t.viewmodel.set(e,void 0),e)}function q(t,e){var n;!t.parent||t.isolated||$(t.viewmodel,e)||(e=E(e),(n=B(t.parent,e,t.component.parentFragment,!0))&&t.viewmodel.map(e,{origin:t.parent.viewmodel,keypath:n}))}function $(t,e){return""===e||e in t.data||e in t.computations||e in t.mappings}function Q(t){t.teardown()}function Z(t){t.unbind()}function H(t){t.unrender()}function K(t){t.cancel()}function G(t){t.detach()}function Y(t){t.detachNodes()}function J(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.parent?t.parent.decrementOutros(t):t.detachNodes(),t.outrosComplete=!0),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&t.parent.decrementTotal()))}function X(){for(var t,e,n;ru.ractives.length;)(n=(e=ru.ractives.pop()).viewmodel.applyChanges())&&uu.fire(e,n);for(tt(),t=0;t<ru.views.length;t+=1)ru.views[t].update();for(ru.views.length=0,t=0;t<ru.tasks.length;t+=1)ru.tasks[t]();if(ru.tasks.length=0,ru.ractives.length)return X()}function tt(){var t,e,n,i;for(t=au.length;t--;)(e=au[t]).keypath?au.splice(t,1):(n=nu(e.root,e.ref,e.parentFragment))&&((i||(i=[])).push({item:e,keypath:n}),au.splice(t,1));i&&i.forEach(et)}function et(t){t.item.resolve(t.keypath)}function nt(t,e,n){var i,r,s,o,a,u,h,c,l,f,d,p,m,v;if(i=new tu(function(t){return r=t}),"object"===(void 0===t?"undefined":_typeof(t))){u=(n=e||{}).easing,h=n.duration,a=[],c=n.step,l=n.complete,(c||l)&&(d={},n.step=null,n.complete=null,f=function(t){return function(e,n){d[t]=n}});for(s in t)t.hasOwnProperty(s)&&((c||l)&&(p=f(s),n={easing:u,duration:h},c&&(n.step=p)),n.complete=l?p:Ca,a.push(it(this,s,t[s],n)));return v={easing:u,duration:h},c&&(v.step=function(t){return c(t,d)}),l&&i.then(function(t){return l(t,d)}),v.complete=r,m=it(this,null,null,v),a.push(m),i.stop=function(){for(var t;t=a.pop();)t.stop();m&&m.stop()},i}return(n=n||{}).complete&&i.then(n.complete),n.complete=r,o=it(this,t,e,n),i.stop=function(){return o.stop()},i}function it(t,e,n,i){var r,s,o,u;return e&&(e=E(C(e))),null!==e&&(u=t.viewmodel.get(e)),fu.abort(e,t),a(u,n)?(i.complete&&i.complete(i.to),vu):(i.easing&&"function"!=typeof(r="function"==typeof i.easing?i.easing:t.easing[i.easing])&&(r=null),s=void 0===i.duration?400:i.duration,o=new pu({keypath:e,from:u,to:n,root:t,duration:s,easing:r,interpolator:i.interpolator,step:i.step,complete:i.complete}),fu.add(o),t._animations.push(o),o)}function rt(){return this.detached?this.detached:(this.el&&I(this.el.__ractive_instances__,this),this.detached=this.fragment.detach(),yu.fire(this),this.detached)}function st(t){return this.el?this.fragment.find(t):null}function ot(t,e){if(this._isComponentQuery?!this.selector||t.name===this.selector:t.node?ca(t.node,this.selector):null)return this.push(t.node||t.instance),e||this._makeDirty(),!0}function at(t){var e;return(e=t.parentFragment)?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function ut(t){var e,n;for(e=[t],n=at(t);n;)e.push(n),n=at(n);return e}function ht(t,e,n,i){var r=[];return wa(r,{selector:{value:e},live:{value:n},_isComponentQuery:{value:i},_test:{value:wu}}),n?(wa(r,{cancel:{value:xu},_root:{value:t},_sort:{value:Eu},_makeDirty:{value:Au},_remove:{value:Su},_dirty:{value:!1,writable:!0}}),r):r}function ct(t,e){var n,i;return this.el?(e=e||{},n=this._liveQueries,(i=n[t])?e&&e.live?i:i.slice():((i=Cu(this,t,!!e.live,!1)).live&&(n.push(t),n["_"+t]=i),this.fragment.findAll(t,i),i)):[]}function lt(t,e){var n,i;return e=e||{},n=this._liveComponentQueries,(i=n[t])?e&&e.live?i:i.slice():((i=Cu(this,t,!!e.live,!0)).live&&(n.push(t),n["_"+t]=i),this.fragment.findAllComponents(t,i),i)}function ft(t){return this.fragment.findComponent(t)}function dt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function pt(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function mt(t,e){var n=void 0===arguments[2]?{}:arguments[2];e&&(n.event?n.event.name=e:n.event={name:e,_noArg:!0},vt(t,E(e).wildcardMatches(),n.event,n.args,!0))}function vt(t,e,n,i){var r,s,o=void 0!==arguments[4]&&arguments[4],a=!0;for(ju.enqueue(t,n),s=e.length;s>=0;s--)(r=t._subs[e[s]])&&(a=gt(t,r,n,i)&&a);ju.dequeue(t),t.parent&&a&&(o&&t.component&&(e=E(t.component.name+"."+e[e.length-1]).wildcardMatches(),n&&(n.component=t)),vt(t.parent,e,n,i))}function gt(t,e,n,i){var r=null,s=!1;n&&!n._noArg&&(i=[n].concat(i));for(var o=0,a=(e=e.slice()).length;o<a;o+=1)!1===e[o].apply(t,i)&&(s=!0);return n&&!n._noArg&&s&&(r=n.original)&&(r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation()),!s}function yt(t){var e={args:Array.prototype.slice.call(arguments,1)};Nu(this,t,e)}function bt(t){var e;return t=E(C(t)),void 0===(e=this.viewmodel.get(t,Lu))&&this.parent&&!this.isolated&&nu(this,t.str,this.component.parentFragment)&&(e=this.viewmodel.get(t)),e}function wt(e,n){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(e=t(e),n=t(n)||null,!e)throw new Error("You must specify a valid target to insert into");e.insertBefore(this.detach(),n),this.el=e,(e.__ractive_instances__||(e.__ractive_instances__=[])).push(this),this.detached=null,xt(this)}function xt(t){Mu.fire(t),t.findAllComponents("*").forEach(function(t){xt(t.instance)})}function kt(t,e,n){var i,r;return t=E(C(t)),i=this.viewmodel.get(t),s(i)&&s(e)?(r=hu.start(this,!0),this.viewmodel.merge(t,i,e,n),hu.end(),r):this.set(t,e,n&&n.complete)}function _t(t,e){var n,i;return n=A(t,e),i={},n.forEach(function(e){i[e.str]=t.get(e.str)}),i}function Et(t,e,n,i){var r,s,o;e=E(C(e)),i=i||th,e.isPattern?(r=new Ju(t,e,n,i),t.viewmodel.patternObservers.push(r),s=!0):r=new Bu(t,e,n,i),r.init(i.init),t.viewmodel.register(e,r,s?"patternObservers":"observers"),r.ready=!0;var a={cancel:function(){var n;o||(s?(n=t.viewmodel.patternObservers.indexOf(r),t.viewmodel.patternObservers.splice(n,1),t.viewmodel.unregister(e,r,"patternObservers")):t.viewmodel.unregister(e,r,"observers"),o=!0)}};return t._observers.push(a),a}function At(t,e,n){var i,r,s,o;if(h(t)){n=e,r=t,i=[];for(t in r)r.hasOwnProperty(t)&&(e=r[t],i.push(this.observe(t,e,n)));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}if("function"==typeof t)return n=e,e=t,t="",Xu(this,t,e,n);if(1===(s=t.split(" ")).length)return Xu(this,t,e,n);for(i=[],o=s.length;o--;)(t=s[o])&&i.push(Xu(this,t,e,n));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}function St(t,e,n){var i=this.observe(t,function(){e.apply(this,arguments),i.cancel()},{init:!1,defer:n&&n.defer});return i}function Ct(t,e){var n=this;if(t)t.split(" ").map(ih).filter(rh).forEach(function(t){var i,r;(i=n._subs[t])&&(e?-1!==(r=i.indexOf(e))&&i.splice(r,1):n._subs[t]=[])});else for(t in this._subs)delete this._subs[t];return this}function Ot(t,e){var n,i,r=this;if("object"===(void 0===t?"undefined":_typeof(t))){n=[];for(i in t)t.hasOwnProperty(i)&&n.push(this.on(i,t[i]));return{cancel:function(){for(var t;t=n.pop();)t.cancel()}}}return t.split(" ").map(ih).filter(rh).forEach(function(t){(r._subs[t]||(r._subs[t]=[])).push(e)}),{cancel:function(){return r.off(t,e)}}}function Pt(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function Tt(t,e,n){var i,r,s,o,a,u,h=[];if(!(i=Ft(t,e,n)))return null;for(r=t.length,a=i.length-2-i[1],o=(s=Math.min(r,i[0]))+i[1],u=0;u<s;u+=1)h.push(u);for(;u<o;u+=1)h.push(-1);for(;u<r;u+=1)h.push(u+a);return h.touchedFrom=0!==a?i[0]:t.length,h}function Ft(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t.length+Math.max(n[0],-t.length));n.length<2;)n.push(0);return n[1]=Math.min(n[1],t.length-n[0]),n;case"sort":case"reverse":return null;case"pop":return t.length?[t.length-1,1]:[0,0];case"push":return[t.length,0].concat(n);case"shift":return[0,t.length?1:0];case"unshift":return[0,0].concat(n)}}function Rt(e,n){var i,r,s,o=this;if(s=this.transitionsEnabled,this.noIntro&&(this.transitionsEnabled=!1),i=hu.start(this,!0),hu.scheduleTask(function(){return bh.fire(o)},!0),this.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(e=t(e)||this.el,n=t(n)||this.anchor,this.el=e,this.anchor=n,!this.append&&e){var a=e.__ractive_instances__;a&&a.length&&jt(a),e.innerHTML=""}return this.cssId&&gh.apply(),e&&((r=e.__ractive_instances__)?r.push(this):e.__ractive_instances__=[this],n?e.insertBefore(this.fragment.render(),n):e.appendChild(this.fragment.render())),hu.end(),this.transitionsEnabled=s,i.then(function(){return wh.fire(o)})}function jt(t){t.splice(0,t.length).forEach(Q)}function Nt(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function Dt(t,e){var n,i;return n='[data-ractive-css~="{'+e+'}"]',i=function(t){var e,i,r,s,o,a,u,h=[];for(e=[];i=Ah.exec(t);)e.push({str:i[0],base:i[1],modifiers:i[2]});for(s=e.map(Lt),u=e.length;u--;)a=s.slice(),r=e[u],a[u]=r.base+n+r.modifiers||"",(o=s.slice())[u]=n+" "+o[u],h.push(a.join(" "),o.join(" "));return h.join(", ")},Ch.test(t)?t.replace(Ch,n):t.replace(Eh,"").replace(_h,function(t,e){var n,r;return Sh.test(e)?t:(n=e.split(",").map(It),r=n.map(i).join(", ")+" ",t.replace(e,r))})}function It(t){return t.trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}function Lt(t){return t.str}function Vt(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!==(void 0===t?"undefined":_typeof(t))?l("data option must be an object or a function, `"+t+"` is not valid"):m("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function Mt(t,e){Vt(e);var n="function"==typeof t,i="function"==typeof e;return e||n||(e={}),n||i?function(){return Wt(i?Ut(e,this):e,n?Ut(t,this):t)}:Wt(e,t)}function Ut(t,e){var n=t.call(e);if(n)return"object"!==(void 0===n?"undefined":_typeof(n))&&l("Data function must return an object"),n.constructor!==Object&&v("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function Wt(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function zt(t){var e,n,i;return t.matchString("=")?(e=t.pos,t.allowWhitespace(),(n=t.matchPattern(xc))?t.matchPattern(kc)?(i=t.matchPattern(xc))?(t.allowWhitespace(),t.matchString("=")?[n,i]:(t.pos=e,null)):(t.pos=e,null):null:(t.pos=e,null)):null}function Bt(t){var e;return(e=t.matchPattern(Ec))?{t:nc,v:e}:null}function qt(t){var e,n;if(!1===t.interpolate[t.inside])return null;for(n=0;n<t.tags.length;n+=1)if(e=$t(t,t.tags[n]))return e}function $t(t,e){var n,i,r,s;if(n=t.pos,t.matchString("\\"+e.open)){if(0===n||"\\"!==t.str[n-1])return e.open}else if(!t.matchString(e.open))return null;if(i=wc(t))return t.matchString(e.close)?(e.open=i[0],e.close=i[1],t.sortMustacheTags(),Sc):null;if(t.allowWhitespace(),t.matchString("/")){t.pos-=1;var o=t.pos;_c(t)?t.pos=o:(t.pos=o-e.close.length,t.error("Attempted to close a section that wasn't open"))}for(s=0;s<e.readers.length;s+=1)if(r=e.readers[s],i=r(t,e))return e.isStatic&&(i.s=!0),t.includeLinePositions&&(i.p=t.getLinePos(n)),i;return t.pos=n,null}function Qt(t){var e;return(e=t.matchPattern(Tc))?{t:Yh,v:e}:null}function Zt(t){var e=t.remaining();return"true"===e.substr(0,4)?(t.pos+=4,{t:ec,v:"true"}):"false"===e.substr(0,5)?(t.pos+=5,{t:ec,v:"false"}):null}function Ht(t){var e;return(e=Lc(t))?Uc.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=Pc(t))?e.v:(e=t.matchPattern(Vc))?e:void 0}function Kt(t){var e,n,i;return e=t.pos,t.allowWhitespace(),null===(n=Mc(t))?(t.pos=e,null):(t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),i=vl(t),null===i?(t.pos=e,null):{t:rc,k:n,v:i}):(t.pos=e,null))}function Gt(t){var e,n,i,r;return e=t.pos,null===(i=Wc(t))?null:(n=[i],t.matchString(",")?(r=Gt(t),r?n.concat(r):(t.pos=e,null)):n)}function Yt(t){function e(t){n.push(t)}var n,i,r;return t.pos,t.allowWhitespace(),null===(i=vl(t))?null:(n=[i],t.allowWhitespace(),t.matchString(",")&&(null===(r=Yt(t))&&t.error(Cc),r.forEach(e)),n)}function Jt(t){return Pc(t)||Fc(t)||Lc(t)||Bc(t)||$c(t)||_c(t)}function Xt(t){var e,n,i,r,s,o;return e=t.pos,(i=t.matchPattern(/^@(?:keypath|index|key)/))||(i=!(n=t.matchPattern(Hc)||"")&&t.relaxedNames&&t.matchPattern(Jc)||t.matchPattern(Yc))||"."!==n||(n="",i="."),i?n||t.relaxedNames||!jc.test(i)?!n&&Rc.test(i)?(r=Rc.exec(i)[0],t.pos=e+r.length,{t:ic,v:r}):(s=(n||"")+C(i),t.matchString("(")&&(-1!==(o=s.lastIndexOf("."))?(s=s.substr(0,o),t.pos=e+s.length):t.pos-=1),{t:sc,n:s.replace(/^this\./,"./").replace(/^this$/,".")}):(t.pos=e,null):null}function te(t){var e;return t.pos,t.matchString("(")?(t.allowWhitespace(),(e=vl(t))||t.error(Cc),t.allowWhitespace(),t.matchString(")")||t.error(Oc),{t:hc,x:e}):null}function ee(t){var e,n;if(t.pos,t.allowWhitespace(),t.matchString(".")){if(t.allowWhitespace(),e=t.matchPattern(Vc))return{t:oc,n:e};t.error("Expected a property name")}return t.matchString("[")?(t.allowWhitespace(),(n=vl(t))||t.error(Cc),t.allowWhitespace(),t.matchString("]")||t.error("Expected ']'"),{t:oc,x:n}):null}function ne(t){var e,n,i,r;return(n=pl(t))?(e=t.pos,t.allowWhitespace(),t.matchString("?")?(t.allowWhitespace(),(i=vl(t))||t.error(Cc),t.allowWhitespace(),t.matchString(":")||t.error('Expected ":"'),t.allowWhitespace(),(r=vl(t))||t.error(Cc),{t:cc,o:[n,i,r]}):(t.pos=e,n)):null}function ie(t){return ml(t)}function re(t){function e(t){switch(t.t){case ec:case ic:case Yh:case nc:return t.v;case Jh:return JSON.stringify(String(t.v));case Xh:return"["+(t.m?t.m.map(e).join(","):"")+"]";case tc:return"{"+(t.m?t.m.map(e).join(","):"")+"}";case rc:return t.k+":"+e(t.v);case uc:return("typeof"===t.s?"typeof ":t.s)+e(t.o);case lc:return e(t.o[0])+("in"===t.s.substr(0,2)?" "+t.s+" ":t.s)+e(t.o[1]);case fc:return e(t.x)+"("+(t.o?t.o.map(e).join(","):"")+")";case hc:return"("+e(t.x)+")";case ac:return e(t.x)+e(t.r);case oc:return t.n?"."+t.n:"["+e(t.x)+"]";case cc:return e(t.o[0])+"?"+e(t.o[1])+":"+e(t.o[2]);case sc:return"_"+n.indexOf(t.n);default:throw new Error("Expected legal JavaScript")}}var n;return se(t,n=[]),{r:n,s:e(t)}}function se(t,e){var n,i;if(t.t===sc&&-1===e.indexOf(t.n)&&e.unshift(t.n),i=t.o||t.m)if(h(i))se(i,e);else for(n=i.length;n--;)se(i[n],e);t.x&&se(t.x,e),t.r&&se(t.r,e),t.v&&se(t.v,e)}function oe(t,e){var n;if(t){for(;t.t===hc&&t.x;)t=t.x;return t.t===sc?e.r=t.n:t.t===Yh&&bl.test(t.v)?e.r=t.v:(n=ae(t))?e.rx=n:e.x=gl(t),e}}function ae(t){for(var e,n=[];t.t===ac&&t.r.t===oc;)(e=t.r).x?e.x.t===sc?n.unshift(e.x):n.unshift(gl(e.x)):n.unshift(e.n),t=t.x;return t.t!==sc?null:{r:t.n,m:n}}function ue(t,e){var n,i=vl(t);return i?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),n={t:Lh},yl(i,n),n):null}function he(t,e){var n,i;return t.matchString("&")?(t.allowWhitespace(),(n=vl(t))?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),i={t:Lh},yl(n,i),i):null):null}function ce(t,e){var n,i,r;return t.pos,t.matchString(">")?(t.allowWhitespace(),t.pos,t.relaxedNames=!0,n=vl(t),t.relaxedNames=!1,t.allowWhitespace(),i=vl(t),t.allowWhitespace(),n?(r={t:zh},yl(n,r),t.allowWhitespace(),i&&yl(i,r={t:Vh,n:vc,f:[r]}),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r):null):null}function le(t,e){var n;return t.matchString("!")?(n=t.remaining().indexOf(e.close),-1!==n?(t.pos+=n+e.close.length,{t:Bh}):void 0):null}function fe(t,e){var n,i,r;if(n=t.pos,!(i=vl(t)))return null;for(r=0;r<e.length;r+=1)if(t.remaining().substr(0,e[r].length)===e[r])return i;return t.pos=n,Zc(t)}function de(t,e){var n,i,r,s;n=t.pos;try{i=El(t,[e.close])}catch(t){s=t}if(!i){if("!"===t.str.charAt(n))return t.pos=n,null;if(s)throw s}if(!t.matchString(e.close)&&(t.error("Expected closing delimiter '"+e.close+"' after reference"),!i)){if("!"===t.nextChar())return null;t.error("Expected expression or legal reference")}return r={t:Ih},yl(i,r),r}function pe(t,e){var n,i;return t.matchPattern(Cl)?(t.pos,n=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),t.allowWhitespace(),t.matchString(e.close)||t.error("expected legal partial name"),i={t:Hh},n&&(i.n=n),i):null}function me(t,e){var n,i,r,s;return n=t.pos,t.matchString(e.open)?(t.allowWhitespace(),t.matchString("/")?(t.allowWhitespace(),i=t.remaining(),-1!==(r=i.indexOf(e.close))?(s={t:Uh,r:i.substr(0,r).split(" ")[0]},t.pos+=r,t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),s):(t.pos=n,null)):(t.pos=n,null)):null}function ve(t,e){var n=t.pos;return t.matchString(e.open)?t.matchPattern(Tl)?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:yc}):(t.pos=n,null):null}function ge(t,e){var n,i=t.pos;return t.matchString(e.open)?t.matchPattern(Rl)?(n=vl(t),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:bc,x:n}):(t.pos=i,null):null}function ye(t,e){var n,i,r,s,o,a,u,h,c,l,f,d;if(n=t.pos,t.matchString("^"))r={t:Vh,f:[],n:pc};else{if(!t.matchString("#"))return null;r={t:Vh,f:[]},t.matchString("partial")&&(t.pos=n-t.standardDelimiters[0].length,t.error("Partial definitions can only be at the top level of the template, or immediately inside components")),(u=t.matchPattern(Ll))&&(d=u,r.n=jl[u])}if(t.allowWhitespace(),(i=vl(t))||t.error("Expected expression"),f=t.matchPattern(Dl)){var p=void 0;(p=t.matchPattern(Il))?r.i=f+","+p:r.i=f}t.allowWhitespace(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),t.sectionDepth+=1,o=r.f,c=[];do{if(s=Ol(t,e))d&&s.r!==d&&t.error("Expected "+e.open+"/"+d+e.close),t.sectionDepth-=1,l=!0;else if(s=Fl(t,e))r.n===pc&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("illegal {{elseif...}} after {{else}}"),h||(h=be(i,r.n)),h.f.push({t:Vh,n:dc,x:gl(xe(c.concat(s.x))),f:o=[]}),c.push(we(s.x));else if(s=Pl(t,e))r.n===pc&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("there can only be one {{else}} block, at the end of a section"),a=!0,h?h.f.push({t:Vh,n:dc,x:gl(xe(c)),f:o=[]}):o=(h=be(i,r.n)).f;else{if(!(s=t.read(Vf)))break;o.push(s)}}while(!l);return h&&(r.n===vc&&(r.n=gc),r.l=h),yl(i,r),r.f.length||delete r.f,r}function be(t,e){var n;return e===vc?(n={t:Vh,n:dc,f:[]},yl(we(t),n)):yl(t,n={t:Vh,n:pc,f:[]}),n}function we(t){return t.t===uc&&"!"===t.s?t.o:{t:uc,s:"!",o:ke(t)}}function xe(t){return 1===t.length?t[0]:{t:lc,s:"&&",o:[ke(t[0]),ke(xe(t.slice(1)))]}}function ke(t){return{t:hc,x:t}}function _e(t){var e,n,i,r,s;return e=t.pos,t.matchString(Ml)?(i=t.remaining(),-1===(r=i.indexOf(Ul))&&t.error("Illegal HTML - expected closing comment sequence ('--\x3e')"),n=i.substr(0,r),t.pos+=r+3,s={t:Bh,c:n},t.includeLinePositions&&(s.p=t.getLinePos(e)),s):null}function Ee(t){return t.replace(cl,function(t,e){var n;return n="#"!==e[0]?ul[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?String.fromCharCode(Ae(n)):t})}function Ae(t){return t?10===t?32:t<128?t:t<=159?hl[t-128]:t<55296?t:t<=57343?65533:t<=65535?t:65533:65533}function Se(t){return t.replace(dl,"&amp;").replace(ll,"&lt;").replace(fl,"&gt;")}function Ce(t){return"string"==typeof t}function Oe(t){return t.t===Bh||t.t===qh}function Pe(t){return(t.t===Vh||t.t===Mh)&&t.f}function Te(t,e,n,i,r){var o,a,u,h,c,l,f,d;for(Gl(t),o=t.length;o--;)(a=t[o]).exclude?t.splice(o,1):e&&a.t===Bh&&t.splice(o,1);for(Yl(t,i?ef:null,r?nf:null),o=t.length;o--;){if((a=t[o]).f){var p=a.t===Wh&&tf.test(a.e);c=n||p,!n&&p&&Yl(a.f,rf,sf),c||(u=t[o-1],h=t[o+1],(!u||"string"==typeof u&&nf.test(u))&&(l=!0),(!h||"string"==typeof h&&ef.test(h))&&(f=!0)),Te(a.f,e,c,l,f)}if(a.l&&(Te(a.l.f,e,n,l,f),t.splice(o+1,0,a.l),delete a.l),a.a)for(d in a.a)a.a.hasOwnProperty(d)&&"string"!=typeof a.a[d]&&Te(a.a[d],e,n,l,f);if(a.m&&Te(a.m,e,n,l,f),a.v)for(d in a.v)a.v.hasOwnProperty(d)&&(s(a.v[d].n)&&Te(a.v[d].n,e,n,l,f),s(a.v[d].d)&&Te(a.v[d].d,e,n,l,f))}for(o=t.length;o--;)"string"==typeof t[o]&&("string"==typeof t[o+1]&&(t[o]=t[o]+t[o+1],t.splice(o+1,1)),n||(t[o]=t[o].replace(Xl," ")),""===t[o]&&t.splice(o,1))}function Fe(t){var e,n;return e=t.pos,t.matchString("</")?(n=t.matchPattern(af))?t.inside&&n!==t.inside?(t.pos=e,null):{t:Qh,e:n}:(t.pos-=2,void t.error("Illegal closing tag")):null}function Re(t){var e,n,i;return t.allowWhitespace(),(n=t.matchPattern(cf))?(e={name:n},null!=(i=je(t))&&(e.value=i),e):null}function je(t){var e,n,i,r;return e=t.pos,/[=\/>\s]/.test(t.nextChar())||t.error("Expected `=`, `/`, `>` or whitespace"),t.allowWhitespace(),t.matchString("=")?(t.allowWhitespace(),n=t.pos,i=t.sectionDepth,null===(r=Ie(t,"'")||Ie(t,'"')||De(t))&&t.error("Expected valid attribute value"),t.sectionDepth!==i&&(t.pos=n,t.error("An attribute value must contain as many opening section tags as closing section tags")),r.length?1===r.length&&"string"==typeof r[0]?Ee(r[0]):r:""):(t.pos=e,null)}function Ne(t){var e,n,i,r,s;return e=t.pos,(n=t.matchPattern(lf))?(i=n,r=t.tags.map(function(t){return t.open}),-1!==(s=uf(i,r))&&(n=n.substr(0,s),t.pos=e+n.length),n):null}function De(t){var e,n;for(t.inAttribute=!0,e=[],n=Ac(t)||Ne(t);null!==n;)e.push(n),n=Ac(t)||Ne(t);return e.length?(t.inAttribute=!1,e):null}function Ie(t,e){var n,i,r;if(n=t.pos,!t.matchString(e))return null;for(t.inAttribute=e,i=[],r=Ac(t)||Le(t,e);null!==r;)i.push(r),r=Ac(t)||Le(t,e);return t.matchString(e)?(t.inAttribute=!1,i):(t.pos=n,null)}function Le(t,e){var n,i,r;return t.pos,i=t.remaining(),(r=t.tags.map(function(t){return t.open})).push(e),-1===(n=uf(i,r))&&t.error("Quoted attribute value must have a closing quote"),n?(t.pos+=n,i.substr(0,n)):null}function Ve(t){var e,n,i;return t.allowWhitespace(),(e=Mc(t))?(i={key:e},t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),(n=t.read())?(i.value=n.v,i):null):null):null}function Me(t,e){var n,i,r,s,o,a,u,h,c;if("string"==typeof t){if(i=mf.exec(t)){var l=t.lastIndexOf(")");return vf.test(t)||e.error("Invalid input after method call expression '"+t.slice(l+1)+"'"),n={m:i[1]},s="["+t.slice(n.m.length+1,l)+"]",r=new ff(s),n.a=gl(r.result[0]),n}if(-1===t.indexOf(":"))return t.trim();t=[t]}if(n={},u=[],h=[],t){for(;t.length;)if("string"==typeof(o=t.shift())){if(-1!==(a=o.indexOf(":"))){a&&u.push(o.substr(0,a)),o.length>a+1&&(h[0]=o.substring(a+1));break}u.push(o)}else u.push(o);h=h.concat(t)}return u.length?h.length||"string"!=typeof u?(n={n:1===u.length&&"string"==typeof u[0]?u[0]:u},1===h.length&&"string"==typeof h[0]?(c=df("["+h[0]+"]"),n.a=c?c.value:h[0].trim()):n.d=h):n=u:n="",n}function Ue(t){var e,n,i,r,s,o,a,u,h,c,l,f,d,p,m,v;if(e=t.pos,t.inside||t.inAttribute)return null;if(!t.matchString("<"))return null;if("/"===t.nextChar())return null;if(n={},t.includeLinePositions&&(n.p=t.getLinePos(e)),t.matchString("!"))return n.t=Gh,t.matchPattern(/^doctype/i)||t.error("Expected DOCTYPE declaration"),n.a=t.matchPattern(/^(.+?)>/),n;if(n.t=Wh,n.e=t.matchPattern(yf),!n.e)return null;for(bf.test(t.nextChar())||t.error("Illegal tag name"),s=function(e,i){var r=i.n||i;kf.test(r)&&(t.pos-=r.length,t.error("Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)")),n.v[e]=i},t.allowWhitespace();o=Ac(t)||hf(t);)o.name?(i=_f[o.name])?n[i]=pf(o.value,t):(r=xf.exec(o.name))?(n.v||(n.v={}),a=pf(o.value,t),s(r[1],a)):t.sanitizeEventAttributes&&wf.test(o.name)||(n.a||(n.a={}),n.a[o.name]=o.value||(""===o.value?"":0)):(n.m||(n.m=[]),n.m.push(o)),t.allowWhitespace();if(t.allowWhitespace(),t.matchString("/")&&(u=!0),!t.matchString(">"))return null;var g=n.e.toLowerCase(),y=t.preserveWhitespace;if(!u&&!al.test(n.e)){t.elementStack.push(g),"script"!==g&&"style"!==g||(t.inside=g),h=[],c=ya(null);do{if(p=t.pos,m=t.remaining(),We(g,m))if(v=of(t)){d=!0;var b=v.e.toLowerCase();if(b!==g&&(t.pos=p,!~t.elementStack.indexOf(b))){var w="Unexpected closing tag";al.test(b)&&(w+=" (<"+b+"> is a void element - it cannot contain children)"),t.error(w)}}else(f=Ol(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?(d=!0,t.pos=p):(f=t.read(Mf))?(c[f.n]&&(t.pos=p,t.error("Duplicate partial definition")),Jl(f.f,t.stripComments,y,!y,!y),c[f.n]=f.f,l=!0):(f=t.read(Vf))?h.push(f):d=!0;else d=!0}while(!d);h.length&&(n.f=h),l&&(n.p=c),t.elementStack.pop()}return t.inside=null,t.sanitizeElements&&-1!==t.sanitizeElements.indexOf(g)?Ef:n}function We(t,e){var n,i;return n=/^<([a-zA-Z][a-zA-Z0-9]*)/.exec(e),i=gf[t],!n||!i||!~i.indexOf(n[1].toLowerCase())}function ze(t){var e,n,i,r;return n=t.remaining(),r=t.inside?"</"+t.inside:"<",t.inside&&!t.interpolate[t.inside]?e=n.indexOf(r):(i=(i=t.tags.map(function(t){return t.open})).concat(t.tags.map(function(t){return"\\"+t.open})),!0===t.inAttribute?i.push('"',"'","=","<",">","`"):t.inAttribute?i.push(t.inAttribute):i.push(r),e=uf(n,i)),e?(-1===e&&(e=n.length),t.pos+=e,t.inside?n.substr(0,e):Ee(n.substr(0,e))):null}function Be(t){return t.replace(Cf,"\\$&")}function qe(t){var e=t.pos,n=t.standardDelimiters[0],i=t.standardDelimiters[1],r=void 0,s=void 0;if(!t.matchPattern(Of)||!t.matchString(n))return t.pos=e,null;var o=t.matchPattern(Pf);if(v("Inline partial comments are deprecated.\nUse this...\n  {{#partial "+o+"}} ... {{/partial}}\n\n...instead of this:\n  \x3c!-- {{>"+o+"}} --\x3e ... \x3c!-- {{/"+o+"}} --\x3e'"),!t.matchString(i)||!t.matchPattern(Tf))return t.pos=e,null;r=[];var a=new RegExp("^\x3c!--\\s*"+Sf(n)+"\\s*\\/\\s*"+o+"\\s*"+Sf(i)+"\\s*--\x3e");do{t.matchPattern(a)?s=!0:((Af=t.read(Vf))||t.error("expected closing comment ('\x3c!-- "+n+"/"+o+i+" --\x3e')"),r.push(Af))}while(!s);return{t:Kh,f:r,n:o}}function $e(t){var e,n,i,r,s;e=t.pos;var o=t.standardDelimiters;if(!t.matchString(o[0]))return null;if(!t.matchPattern(Ff))return t.pos=e,null;(n=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/))||t.error("expected legal partial name"),t.matchString(o[1])||t.error("Expected closing delimiter '"+o[1]+"'"),i=[];do{(r=Ol(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?("partial"===!r.r&&t.error("Expected "+o[0]+"/partial"+o[1]),s=!0):((r=t.read(Vf))||t.error("Expected "+o[0]+"/partial"+o[1]),i.push(r))}while(!s);return{t:Kh,n:n,f:i}}function Qe(t){for(var e=[],n=ya(null),i=!1,r=t.preserveWhitespace;t.pos<t.str.length;){var s=t.pos,o=void 0,a=void 0;(a=t.read(Mf))?(n[a.n]&&(t.pos=s,t.error("Duplicated partial definition")),Jl(a.f,t.stripComments,r,!r,!r),n[a.n]=a.f,i=!0):(o=t.read(Vf))?e.push(o):t.error("Unexpected template content")}var u={v:oa,t:e};return i&&(u.p=n),u}function Ze(t,e){return new Lf(t,e||{}).result}function He(t){var e=ya(qf);return e.parse=function(e,n){return Ke(e,n||t)},e}function Ke(t,e){if(!jf)throw new Error("Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser");return jf(t,e||this.options)}function Ge(t,e){var n;if(!Xo){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}if(Ye(t)&&(t=t.substring(1)),!(n=document.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==n.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in n?n.textContent:n.innerHTML}function Ye(t){return t&&"#"===t[0]}function Je(t){return!("string"==typeof t)}function Xe(t){return t.defaults&&(t=t.defaults),Bf.reduce(function(e,n){return e[n]=t[n],e},{})}function tn(t){var e,n=t._config.template;if(n&&n.fn)return e=en(t,n.fn),e!==n.result?(n.result=e,e=rn(e,t)):void 0}function en(t,e){var n=nn($f.getParseOptions(t));return e.call(t,n)}function nn(t){var e=ya($f);return e.parse=function(e,n){return $f.parse(e,n||t)},e}function rn(t,e){if("string"==typeof t)"#"===t[0]&&(t=$f.fromId(t)),t=jf(t,$f.getParseOptions(e));else{if(void 0==t)throw new Error("The template cannot be "+t+".");if("number"!=typeof t.v)throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==oa)throw new Error("Mismatched template version (expected "+oa+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}return t}function sn(t,e,n){if(e)for(var i in e)!n&&t.hasOwnProperty(i)||(t[i]=e[i])}function on(t,e,n){if(!/_super/.test(n))return n;var i=function(){var t,r=an(i._parent,e),s="_super"in this,o=this._super;return this._super=r,t=n.apply(this,arguments),s?this._super=o:delete this._super,t};return i._parent=t,i._method=n,i}function an(t,e){var n;return e in t?"function"==typeof(n=t[e])?n:function(){return n}:Ca}function un(t,e,n){return"options."+t+" has been deprecated in favour of options."+e+"."+(n?" You cannot specify both options, please use options."+e+".":"")}function hn(t,e,n){if(e in t){if(n in t)throw new Error(un(e,n,!0));m(un(e,n)),t[n]=t[e]}}function cn(t){hn(t,"beforeInit","onconstruct"),hn(t,"init","onrender"),hn(t,"complete","oncomplete"),hn(t,"eventDefinitions","events"),s(t.adaptors)&&hn(t,"adaptors","adapt")}function ln(t,e,n,i){ed(i);for(var r in i)if(Jf.hasOwnProperty(r)){var s=i[r];"el"!==r&&"function"==typeof s?m(r+" is a Ractive option that does not expect a function and will be ignored","init"===t?n:null):n[r]=s}Xf.forEach(function(r){r[t](e,n,i)}),xh[t](e,n,i),Qf[t](e,n,i),Ph[t](e,n,i),fn(e.prototype,n,i)}function fn(t,e,n){for(var i in n)if(!Yf[i]&&n.hasOwnProperty(i)){var r=n[i];"function"==typeof r&&(r=td(t,i,r)),e[i]=r}}function dn(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function pn(){this.dirtyValue=this.dirtyArgs=!0,this.bound&&"function"==typeof this.owner.bubble&&this.owner.bubble()}function mn(){var t;return 1===this.items.length?this.items[0].detach():(t=document.createDocumentFragment(),this.items.forEach(function(e){var n=e.detach();n&&t.appendChild(n)}),t)}function vn(t){var e,n,i,r;if(this.items){for(n=this.items.length,e=0;e<n;e+=1)if((i=this.items[e]).find&&(r=i.find(t)))return r;return null}}function gn(t,e){var n,i,r;if(this.items)for(i=this.items.length,n=0;n<i;n+=1)(r=this.items[n]).findAll&&r.findAll(t,e);return e}function yn(t,e){var n,i,r;if(this.items)for(i=this.items.length,n=0;n<i;n+=1)(r=this.items[n]).findAllComponents&&r.findAllComponents(t,e);return e}function bn(t){var e,n,i,r;if(this.items){for(e=this.items.length,n=0;n<e;n+=1)if((i=this.items[n]).findComponent&&(r=i.findComponent(t)))return r;return null}}function wn(t){var e=t.index;return this.items[e+1]?this.items[e+1].firstNode():this.owner===this.root?this.owner.component?this.owner.component.findNextNode():null:this.owner.findNextNode(this)}function xn(){return this.items&&this.items[0]?this.items[0].firstNode():null}function kn(t,e,n,i){return i=i||0,t.map(function(t){var r,s,o;return t.text?t.text:t.fragments?t.fragments.map(function(t){return kn(t.items,e,n,i)}).join(""):(r=n+"-"+i++,o=t.keypath&&(s=t.root.viewmodel.wrapped[t.keypath.str])?s.value:t.getValue(),e[r]=o,"${"+r+"}")}).join("")}function _n(){var t,e,n,i;return this.dirtyArgs&&(e=ld(this.items,t={},this.root._guid),i=(n=df("["+e+"]",t))?n.value:[this.toString()],this.argsList=i,this.dirtyArgs=!1),this.argsList}function En(){var t=this;do{if(t.pElement)return t.pElement.node}while(t=t.parent);return this.root.detached||this.root.el}function An(){var t,e,n,i;return this.dirtyValue&&(e=ld(this.items,t={},this.root._guid),i=(n=df(e,t))?n.value:this.toString(),this.value=i,this.dirtyValue=!1),this.value}function Sn(){this.registered&&this.root.viewmodel.unregister(this.keypath,this),this.resolver&&this.resolver.unbind()}function Cn(){return this.value}function On(t,e){for(var n,i=0;i<e.prop.length;i++)if(void 0!==(n=t[e.prop[i]]))return n}function Pn(t,e){var n,i,r,s,o,a={},u=!1;for(e||(a.refs=n={});t;){if((o=t.owner)&&(i=o.indexRefs)){if(e&&(r=o.getIndexRef(e)))return a.ref={fragment:t,ref:r},a;if(!e)for(s in i)n[(r=i[s]).n]||(u=!0,n[r.n]={fragment:t,ref:r})}!t.parent&&t.owner&&t.owner.component&&t.owner.component.parentFragment&&!t.owner.component.instance.isolated?(a.componentBoundary=!0,t=t.owner.component.parentFragment):t=t.parent}return u?a:void 0}function Tn(t,e,n){var i;return"@"===e.charAt(0)?new Ed(t,e,n):(i=Cd(t.parentFragment,e))?new Sd(t,i,n):new xd(t,e,n)}function Fn(t,e){var n,i;if(Fd[t])return Fd[t];for(i=[];e--;)i[e]="_"+e;return n=new Function(i.join(","),"return("+t+")"),Fd[t]=n,n}function Rn(t){return t.call()}function jn(t,e){return t.replace(/_([0-9]+)/g,function(t,n){var i,r;return+n>=e.length?"_"+n:(i=e[n],void 0===i?"undefined":i.isSpecial?(r=i.value,"number"==typeof r?r:'"'+r+'"'):i.str)})}function Nn(t){return E("${"+t.replace(/[\.\[\]]/g,"-").replace(/\*/,"#MUL#")+"}")}function Dn(t){return void 0!==t&&"@"!==t[0]}function In(t,e){var n,i,r;if(t.__ractive_nowrap)return t;if(i="__ractive_"+e._guid,n=t[i])return n;if(/this/.test(t.toString())){ba(t,i,{value:Rd.call(t,e),configurable:!0});for(r in t)t.hasOwnProperty(r)&&(t[i][r]=t[r]);return e._boundFunctions.push({fn:t,prop:i}),t[i]}return ba(t,"__ractive_nowrap",{value:t}),t.__ractive_nowrap}function Ln(t){return t.value}function Vn(t){return void 0!=t}function Mn(t){t.forceResolution()}function Un(t,e){function n(e){t.resolve(e)}function i(e){var n=t.keypath;e!=n&&(t.resolve(e),void 0!==n&&t.fragments&&t.fragments.forEach(function(t){t.rebind(n,e)}))}var r,s,o;s=e.parentFragment,o=e.template,t.root=s.root,t.parentFragment=s,t.pElement=s.pElement,t.template=e.template,t.index=e.index||0,t.isStatic=e.template.s,t.type=e.template.t,t.registered=!1,(r=o.r)&&(t.resolver=Pd(t,r,n)),e.template.x&&(t.resolver=new jd(t,s,e.template.x,i)),e.template.rx&&(t.resolver=new Ld(t,e.template.rx,i)),t.template.n!==pc||t.hasOwnProperty("value")||t.setValue(void 0)}function Wn(t){var e,n,i;if(t&&t.isSpecial)return this.keypath=t,void this.setValue(t.value);this.registered&&(this.root.viewmodel.unregister(this.keypath,this),this.registered=!1,e=!0),this.keypath=t,void 0!=t&&(n=this.root.viewmodel.get(t),this.root.viewmodel.register(t,this),this.registered=!0),this.setValue(n),e&&(i=this.twowayBinding)&&i.rebound()}function zn(t,e){this.fragments&&this.fragments.forEach(function(n){return n.rebind(t,e)}),this.resolver&&this.resolver.rebind(t,e)}function Bn(){this.parentFragment.bubble()}function qn(){var t;return 1===this.fragments.length?this.fragments[0].detach():(t=document.createDocumentFragment(),this.fragments.forEach(function(e){t.appendChild(e.detach())}),t)}function $n(t){var e,n,i;for(n=this.fragments.length,e=0;e<n;e+=1)if(i=this.fragments[e].find(t))return i;return null}function Qn(t,e){var n,i;for(i=this.fragments.length,n=0;n<i;n+=1)this.fragments[n].findAll(t,e)}function Zn(t,e){var n,i;for(i=this.fragments.length,n=0;n<i;n+=1)this.fragments[n].findAllComponents(t,e)}function Hn(t){var e,n,i;for(n=this.fragments.length,e=0;e<n;e+=1)if(i=this.fragments[e].findComponent(t))return i;return null}function Kn(t){return this.fragments[t.index+1]?this.fragments[t.index+1].firstNode():this.parentFragment.findNextNode(this)}function Gn(){var t,e,n;if(t=this.fragments.length)for(e=0;e<t;e+=1)if(n=this.fragments[e].firstNode())return n;return this.parentFragment.findNextNode(this)}function Yn(t){var e,n,i,r,s,o=this;if(!this.shuffling&&!this.unbound&&this.currentSubtype===mc){if(this.shuffling=!0,hu.scheduleTask(function(){return o.shuffling=!1}),this.parentFragment,r=[],t.forEach(function(t,n){var i,s,a,u;if(t!==n){if(i=o.fragments[n],void 0===e&&(e=n),-1===t)return o.fragmentsToUnrender.push(i),void i.unbind();t-n,s=o.keypath.join(n),a=o.keypath.join(t),i.index=t,(u=i.registeredIndexRefs)&&u.forEach(Jn),i.rebind(s,a),r[t]=i}else r[t]=o.fragments[n]}),i=this.root.viewmodel.get(this.keypath).length,void 0===e){if(this.length===i)return;e=this.length}for(this.length=this.fragments.length=i,this.rendered&&hu.addView(this),{template:this.template.f,root:this.root,owner:this},n=e;n<i;n+=1)(s=r[n])||this.fragmentsToCreate.push(n),this.fragments[n]=s}}function Jn(t){t.rebind("","")}function Xn(){var t=this;return this.docFrag=document.createDocumentFragment(),this.fragments.forEach(function(e){return t.docFrag.appendChild(e.render())}),this.renderedFragments=this.fragments.slice(),this.fragmentsToRender=[],this.rendered=!0,this.docFrag}function ti(t){var e,n,i=this;this.updating||(this.updating=!0,this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),this.fragmentsToCreate.length?(n={template:this.template.f||[],root:this.root,pElement:this.pElement,owner:this},this.fragmentsToCreate.forEach(function(t){var e;n.context=i.keypath.join(t),n.index=t,e=new zy(n),i.fragmentsToRender.push(i.fragments[t]=e)}),this.fragmentsToCreate.length=0):ni(this,t)&&(this.bubble(),this.rendered&&hu.addView(this)),this.value=t,this.updating=!1)}function ei(t,e,n){if(e===mc&&t.indexRefs&&t.indexRefs[0]){var i=t.indexRefs[0];(n&&"i"===i.t||!n&&"k"===i.t)&&(n||(t.length=0,t.fragmentsToUnrender=t.fragments.slice(0),t.fragmentsToUnrender.forEach(function(t){return t.unbind()}))),i.t=n?"k":"i"}t.currentSubtype=e}function ni(t,e){var n={template:t.template.f||[],root:t.root,pElement:t.parentFragment.pElement,owner:t};if(t.hasContext=!0,t.subtype)switch(t.subtype){case dc:return t.hasContext=!1,ai(t,e,!1,n);case pc:return t.hasContext=!1,ai(t,e,!0,n);case vc:return oi(t,n);case gc:return si(t,e,n);case mc:if(h(e))return ei(t,t.subtype,!0),ri(t,e,n)}return t.ordered=!!o(e),t.ordered?(ei(t,mc,!1),ii(t,e,n)):h(e)||"function"==typeof e?t.template.i?(ei(t,mc,!0),ri(t,e,n)):(ei(t,vc,!1),oi(t,n)):(ei(t,dc,!1),t.hasContext=!1,ai(t,e,!1,n))}function ii(t,e,n){var i,r,s;if((r=e.length)===t.length)return!1;if(r<t.length)t.fragmentsToUnrender=t.fragments.splice(r,t.length-r),t.fragmentsToUnrender.forEach(Z);else if(r>t.length)for(i=t.length;i<r;i+=1)n.context=t.keypath.join(i),n.index=i,s=new zy(n),t.fragmentsToRender.push(t.fragments[i]=s);return t.length=r,!0}function ri(t,e,n){var i,r,s,o,a,u;for(s=t.hasKey||(t.hasKey={}),r=t.fragments.length;r--;)(o=t.fragments[r]).key in e||(a=!0,o.unbind(),t.fragmentsToUnrender.push(o),t.fragments.splice(r,1),s[o.key]=!1);for(r=t.fragments.length;r--;)(o=t.fragments[r]).index!==r&&(o.index=r,(u=o.registeredIndexRefs)&&u.forEach(ci));r=t.fragments.length;for(i in e)s[i]||(a=!0,n.context=t.keypath.join(i),n.key=i,n.index=r++,o=new zy(n),t.fragmentsToRender.push(o),t.fragments.push(o),s[i]=!0);return t.length=t.fragments.length,a}function si(t,e,n){return e?oi(t,n):ui(t)}function oi(t,e){var n;if(!t.length)return e.context=t.keypath,e.index=0,n=new zy(e),t.fragmentsToRender.push(t.fragments[0]=n),t.length=1,!0}function ai(t,e,n,i){var r,s,a,u,c;if(s=o(e)&&0===e.length,a=!1,!o(e)&&h(e)){a=!0;for(c in e){a=!1;break}}return r=n?s||a||!e:e&&!s&&!a,r?t.length?t.length>1?(t.fragmentsToUnrender=t.fragments.splice(1),t.fragmentsToUnrender.forEach(Z),!0):void 0:(i.index=0,u=new zy(i),t.fragmentsToRender.push(t.fragments[0]=u),t.length=1,!0):ui(t)}function ui(t){if(t.length)return t.fragmentsToUnrender=t.fragments.splice(0,t.fragments.length).filter(hi),t.fragmentsToUnrender.forEach(Z),t.length=t.fragmentsToRender.length=0,!0}function hi(t){return t.rendered}function ci(t){t.rebind("","")}function li(t){var e,n,i;for(e="",n=0,i=this.length,n=0;n<i;n+=1)e+=this.fragments[n].toString(t);return e}function fi(){var t=this;this.fragments.forEach(Z),this.fragmentsToRender.forEach(function(e){return I(t.fragments,e)}),this.fragmentsToRender=[],yd.call(this),this.length=0,this.unbound=!0}function di(t){this.fragments.forEach(t?pi:mi),this.renderedFragments=[],this.rendered=!1}function pi(t){t.unrender(!0)}function mi(t){t.unrender(!1)}function vi(){var t,e,n,i,r,s,o;for(n=this.renderedFragments;t=this.fragmentsToUnrender.pop();)t.unrender(!0),n.splice(n.indexOf(t),1);for(;t=this.fragmentsToRender.shift();)t.render();for(this.rendered&&(r=this.parentFragment.getNode()),o=this.fragments.length,s=0;s<o;s+=1)t=this.fragments[s],(e=n.indexOf(t,s))!==s?(this.docFrag.appendChild(t.detach()),-1!==e&&n.splice(e,1),n.splice(s,0,t)):this.docFrag.childNodes.length&&(i=t.firstNode(),r.insertBefore(this.docFrag,i));this.rendered&&this.docFrag.childNodes.length&&(i=this.parentFragment.findNextNode(this),r.insertBefore(this.docFrag,i)),this.renderedFragments=this.fragments.slice()}function gi(){var t,e;if(this.docFrag){for(t=this.nodes.length,e=0;e<t;e+=1)this.docFrag.appendChild(this.nodes[e]);return this.docFrag}}function yi(t){var e,n,i,r;for(n=this.nodes.length,e=0;e<n;e+=1)if(1===(i=this.nodes[e]).nodeType){if(ca(i,t))return i;if(r=i.querySelector(t))return r}return null}function bi(t,e){var n,i,r,s,o,a;for(i=this.nodes.length,n=0;n<i;n+=1)if(1===(r=this.nodes[n]).nodeType&&(ca(r,t)&&e.push(r),s=r.querySelectorAll(t)))for(o=s.length,a=0;a<o;a+=1)e.push(s[a])}function wi(){return this.rendered&&this.nodes[0]?this.nodes[0]:this.parentFragment.findNextNode(this)}function xi(t){return fp[t]||(fp[t]=ha(t))}function ki(t){var e,n,i;t&&"select"===t.name&&t.binding&&(e=L(t.node.options).filter(_i),t.getAttribute("multiple")?i=e.map(function(t){return t.value}):(n=e[0])&&(i=n.value),void 0!==i&&t.binding.setValue(i),t.bubble())}function _i(t){return t.selected}function Ei(){if(this.rendered)throw new Error("Attempted to render an item that was already rendered");return this.docFrag=document.createDocumentFragment(),this.nodes=dp(this.value,this.parentFragment.getNode(),this.docFrag),pp(this.pElement),this.rendered=!0,this.docFrag}function Ai(t){var e;(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),t!==this.value&&(this.value=t,this.parentFragment.bubble(),this.rendered&&hu.addView(this))}function Si(){return void 0!=this.value?Ee(""+this.value):""}function Ci(t){this.rendered&&t&&(this.nodes.forEach(e),this.rendered=!1)}function Oi(){var t,e;if(this.rendered){for(;this.nodes&&this.nodes.length;)(t=this.nodes.pop()).parentNode.removeChild(t);e=this.parentFragment.getNode(),this.nodes=dp(this.value,e,this.docFrag),e.insertBefore(this.docFrag,this.parentFragment.findNextNode(this)),pp(this.pElement)}}function Pi(){var t,e=this.node;if(e)return(t=e.parentNode)&&t.removeChild(e),e}function Ti(){return null}function Fi(){return this.node}function Ri(t){if(this.attributes&&this.attributes[t])return this.attributes[t].value}function ji(){var t=this.useProperty||!this.rendered?this.fragment.getValue():this.fragment.toString();a(t,this.value)||("id"===this.name&&this.value&&delete this.root.nodes[this.value],this.value=t,"value"===this.name&&this.node&&(this.node._ractive.value=t),this.rendered&&hu.addView(this))}function Ni(t){var e=t.fragment.items;if(1===e.length)return e[0].type===Ih?e[0]:void 0}function Di(t){this.type=$h,this.element=t.element,this.root=t.root,Up(this,t.name),this.isBoolean=ol.test(this.name),t.value&&"string"!=typeof t.value?(this.parentFragment=this.element.parentFragment,this.fragment=new zy({template:t.value,root:this.root,owner:this}),this.value=this.fragment.getValue(),this.interpolator=Wp(this),this.isBindable=!!this.interpolator&&!this.interpolator.isStatic,this.ready=!0):this.value=!!this.isBoolean||(t.value||"")}function Ii(t,e){this.fragment&&this.fragment.rebind(t,e)}function Li(t){var e;this.node=t,t.namespaceURI&&t.namespaceURI!==ia.html||(void 0!==t[e=$p[this.name]||this.name]&&(this.propertyName=e),(this.isBoolean||this.isTwoway)&&(this.useProperty=!0),"value"===e&&(t._ractive.value=this.value)),this.rendered=!0,this.update()}function Vi(){var t=this,e=t.name,n=t.namespacePrefix,i=t.value,r=t.interpolator,s=t.fragment;if(("value"!==e||"select"!==this.element.name&&"textarea"!==this.element.name)&&("value"!==e||void 0===this.element.getAttribute("contenteditable"))){if("name"===e&&"input"===this.element.name&&r)return"name={{"+(r.keypath.str||r.ref)+"}}";if(this.isBoolean)return i?e:"";if(s){if(1===s.items.length&&null==s.items[0].value)return"";i=s.toString()}return n&&(e=n+":"+e),i?e+'="'+Mi(i)+'"':e}}function Mi(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Ui(){this.fragment&&this.fragment.unbind(),"id"===this.name&&delete this.root.nodes[this.value]}function Wi(){var t,e,n,i=this.value;if(!this.locked)for(this.node._ractive.value=i,n=(t=this.node.options).length;n--;)if(e=t[n],(e._ractive?e._ractive.value:e.value)==i){e.selected=!0;break}}function zi(){var t,e,n,i,r=this.value;for(s(r)||(r=[r]),e=(t=this.node.options).length;e--;)i=(n=t[e])._ractive?n._ractive.value:n.value,n.selected=R(r,i)}function Bi(){var t=this,e=t.node,n=t.value;e.checked=n==e._ractive.value}function qi(){var t,e,n,i,r=this.node;if(t=r.checked,r.value=this.element.getAttribute("value"),r.checked=this.element.getAttribute("value")===this.element.getAttribute("name"),t&&!r.checked&&this.element.binding&&(n=this.element.binding.siblings,i=n.length)){for(;i--;){if(!(e=n[i]).element.node)return;if(e.element.node.checked)return hu.addRactive(e.root),e.handleChange()}this.root.viewmodel.set(e.keypath,void 0)}}function $i(){var t,e,n=this,i=n.element,r=n.node,o=n.value,a=i.binding;if(t=i.getAttribute("value"),s(o)){for(e=o.length;e--;)if(t==o[e])return void(a.isChecked=r.checked=!0);a.isChecked=r.checked=!1}else a.isChecked=r.checked=o==t}function Qi(){this.node.className=n(this.value)}function Zi(){var t=this,e=t.node,n=t.value;this.root.nodes[n]=e,e.id=n}function Hi(){var t,e;t=this.node,void 0===(e=this.value)&&(e=""),t.style.setAttribute("cssText",e)}function Ki(){var t=this.value;void 0===t&&(t=""),this.locked||(this.node.innerHTML=t)}function Gi(){var t=this,e=t.node,n=t.value;e._ractive.value=n,this.locked||(e.value=void 0==n?"":n)}function Yi(){this.locked||(this.node[this.propertyName]=this.value)}function Ji(){var t=this,e=t.node,n=t.namespace,i=t.name,r=t.value,s=t.fragment;n?e.setAttributeNS(n,i,(s||r).toString()):this.isBoolean?r?e.setAttribute(i,""):e.removeAttribute(i):null==r?e.removeAttribute(i):e.setAttribute(i,(s||r).toString())}function Xi(){var t,e,n=this,i=n.name,r=n.element,s=n.node;"id"===i?e=tm:"value"===i?"select"===r.name&&"value"===i?e=r.getAttribute("multiple")?Kp:Hp:"textarea"===r.name?e=im:null!=r.getAttribute("contenteditable")?e=nm:"input"===r.name&&(e="file"===(t=r.getAttribute("type"))?Ca:"radio"===t&&r.binding&&"name"===r.binding.name?Yp:im):this.isTwoway&&"name"===i?"radio"===s.type?e=Gp:"checkbox"===s.type&&(e=Jp):"style"===i&&s.style.setAttribute?e=em:"class"!==i||s.namespaceURI&&s.namespaceURI!==ia.html?this.useProperty&&(e=rm):e=Xp,e||(e=sm),this.update=e,this.update()}function tr(t,e){var n=e?"svg":"div";return um.innerHTML="<"+n+" "+t+"></"+n+">",L(um.childNodes[0].attributes)}function er(t,e){for(var n=t.length;n--;)if(t[n].name===e.name)return!1;return!0}function nr(t){for(;t=t.parent;)if("form"===t.name)return t}function ir(){this._ractive.binding.handleChange()}function rr(){var t;gm.call(this),t=this._ractive.root.viewmodel.get(this._ractive.binding.keypath),this.value=void 0==t?"":t}function sr(){var t=this._ractive.binding,e=this;t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(function(){t.rendered&&gm.call(e),t._timeout=void 0},t.element.lazy)}function or(t,e,n){var i=t+e+n;return xm[i]||(xm[i]=[])}function ar(t){return t.isChecked}function ur(t){return t.element.getAttribute("value")}function hr(t){var e,n,i,r,s,o=t.attributes;if(t.binding&&(t.binding.teardown(),t.binding=null),(t.getAttribute("contenteditable")||o.contenteditable&&cr(o.contenteditable))&&cr(o.value)?n=bm:"input"===t.name?"radio"===(e=t.getAttribute("type"))||"checkbox"===e?(i=cr(o.name),r=cr(o.checked),i&&r&&m("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root}),i?n="radio"===e?_m:Em:r&&(n="radio"===e?km:Am)):"file"===e&&cr(o.value)?n=Om:cr(o.value)&&(n="number"===e||"range"===e?Pm:ym):"select"===t.name&&cr(o.value)?n=t.getAttribute("multiple")?Cm:Sm:"textarea"===t.name&&cr(o.value)&&(n=ym),n&&(s=new n(t))&&s.keypath)return s}function cr(t){return t&&t.isBindable}function lr(){var t=this.getAction();t&&!this.hasListener?this.listen():!t&&this.hasListener&&this.unrender()}function fr(t){Nu(this.root,this.getAction(),{event:t})}function dr(){return this.action.toString().trim()}function pr(t,e,n){var i,r,s=this;this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.name=e,-1!==e.indexOf("*")&&(l('Only component proxy-events may contain "*" wildcards, <%s on-%s="..."/> is not valid',t.name,e),this.invalid=!0),n.m?(r=n.a.r,this.method=n.m,this.keypaths=[],this.fn=Td(n.a.s,r.length),this.parentFragment=t.parentFragment,this.root,this.refResolvers=[],r.forEach(function(t,e){var n=void 0;(n=Dm.exec(t))?s.keypaths[e]={eventObject:!0,refinements:n[1]?n[1].split("."):[]}:s.refResolvers.push(Pd(s,t,function(t){return s.resolve(e,t)}))}),this.fire=mr):("string"!=typeof(i=n.n||n)&&(i=new zy({template:i,root:this.root,owner:this})),this.action=i,n.d?(this.dynamicParams=new zy({template:n.d,root:this.root,owner:this.element}),this.fire=gr):n.a&&(this.params=n.a,this.fire=vr))}function mr(t){var e,n,i;if("function"!=typeof(e=this.root)[this.method])throw new Error('Attempted to call a non-existent method ("'+this.method+'")');n=this.keypaths.map(function(n){var i,r,s;if(void 0!==n){if(n.eventObject){if(i=t,r=n.refinements.length)for(s=0;s<r;s+=1)i=i[n.refinements[s]]}else i=e.viewmodel.get(n);return i}}),ju.enqueue(e,t),i=this.fn.apply(null,n),e[this.method].apply(e,i),ju.dequeue(e)}function vr(t){Nu(this.root,this.getAction(),{event:t,args:this.params})}function gr(t){var e=this.dynamicParams.getArgsList();"string"==typeof e&&(e=e.substr(1,e.length-2)),Nu(this.root,this.getAction(),{event:t,args:e})}function yr(t){var e,n,i,r={};n=(e=this._ractive).events[t.type],(i=Cd(n.element.parentFragment))&&(r=Cd.resolve(i)),n.fire({node:this,original:t,index:r,keypath:e.keypath.str,context:e.root.viewmodel.get(e.keypath)})}function br(){var t,e=this.name;if(!this.invalid){if(t=g("events",this.root,e))this.custom=t(this.node,wr(e));else{if(!("on"+e in this.node||window&&"on"+e in window||ta))return void(Mm[e]||v(Fa(e,"event"),{node:this.node}));this.node.addEventListener(e,Im,!1)}this.hasListener=!0}}function wr(t){return Vm[t]||(Vm[t]=function(e){var n=e.node._ractive;e.index=n.index,e.keypath=n.keypath.str,e.context=n.root.viewmodel.get(n.keypath),n.events[t].fire(e)}),Vm[t]}function xr(t,e){function n(n){n&&n.rebind(t,e)}if(this.method)return this.element.parentFragment,void this.refResolvers.forEach(n);"string"!=typeof this.action&&n(this.action),this.dynamicParams&&n(this.dynamicParams)}function kr(){this.node=this.element.node,this.node._ractive.events[this.name]=this,(this.method||this.getAction())&&this.listen()}function _r(t,e){this.keypaths[t]=e}function Er(){this.method?this.refResolvers.forEach(Z):("string"!=typeof this.action&&this.action.unbind(),this.dynamicParams&&this.dynamicParams.unbind())}function Ar(){this.custom?this.custom.teardown():this.node.removeEventListener(this.name,Im,!1),this.hasListener=!1}function Sr(){var t=this;this.dirty||(this.dirty=!0,hu.scheduleTask(function(){Cr(t),t.dirty=!1})),this.parentFragment.bubble()}function Cr(t){var e,n,i,r,s;(e=t.node)&&(r=L(e.options),n=t.getAttribute("value"),i=t.getAttribute("multiple"),void 0!==n?(r.forEach(function(t){var e,r;e=t._ractive?t._ractive.value:t.value,(r=i?Or(n,e):n==e)&&(s=!0),t.selected=r}),s||(r[0]&&(r[0].selected=!0),t.binding&&t.binding.forceUpdate())):t.binding&&t.binding.forceUpdate())}function Or(t,e){for(var n=t.length;n--;)if(t[n]==e)return!0}function Pr(t,e){t.select=Fr(t.parent),t.select&&(t.select.options.push(t),e.a||(e.a={}),void 0!==e.a.value||e.a.hasOwnProperty("disabled")||(e.a.value=e.f),"selected"in e.a&&void 0!==t.select.getAttribute("value")&&delete e.a.selected)}function Tr(t){t.select&&I(t.select.options,t)}function Fr(t){if(t)do{if("select"===t.name)return t}while(t=t.parent)}function Rr(t){var e,n,i,r,s,o;this.type=Wh,e=this.parentFragment=t.parentFragment,n=this.template=t.template,this.parent=t.pElement||e.pElement,this.root=i=e.root,this.index=t.index,this.key=t.key,this.name=Mp(n.e),"option"===this.name&&Pr(this,n),"select"===this.name&&(this.options=[],this.bubble=Sr),"form"===this.name&&(this.formBindings=[]),o=Lp(this,n),this.attributes=cm(this,n.a),this.conditionalAttributes=dm(this,n.m),n.f&&(this.fragment=new zy({template:n.f,root:i,owner:this,pElement:this,cssIds:null})),s=i.twoway,!1===o.twoway?s=!1:!0===o.twoway&&(s=!0),this.twoway=s,this.lazy=o.lazy,s&&(r=Tm(this,n.a))&&(this.binding=r,(this.root._twowayBindings[r.keypath.str]||(this.root._twowayBindings[r.keypath.str]=[])).push(r)),n.v&&(this.eventHandlers=Zm(this,n.v)),n.o&&(this.decorator=new Jm(this,n.o)),this.intro=n.t0||n.t1,this.outro=n.t0||n.t2}function jr(t,e){function n(n){n.rebind(t,e)}var i,r,s;if(this.attributes&&this.attributes.forEach(n),this.conditionalAttributes&&this.conditionalAttributes.forEach(n),this.eventHandlers&&this.eventHandlers.forEach(n),this.decorator&&n(this.decorator),this.fragment&&n(this.fragment),s=this.liveQueries)for(this.root,i=s.length;i--;)s[i]._makeDirty();this.node&&(r=this.node._ractive)&&k(r,"keypath",t,e)}function Nr(t){var e;(t.attributes.width||t.attributes.height)&&t.node.addEventListener("load",e=function(){var n=t.getAttribute("width"),i=t.getAttribute("height");void 0!==n&&t.node.setAttribute("width",n),void 0!==i&&t.node.setAttribute("height",i),t.node.removeEventListener("load",e,!1)},!1)}function Dr(t){t.node.addEventListener("reset",Lr,!1)}function Ir(t){t.node.removeEventListener("reset",Lr,!1)}function Lr(){var t=this._ractive.proxy;hu.start(),t.formBindings.forEach(Vr),hu.end()}function Vr(t){t.root.viewmodel.set(t.keypath,t.resetValue)}function Mr(t,e,n){var i,r,s;this.element=t,this.root=i=t.root,this.isIntro=n,"string"!=typeof(r=e.n||e)&&(s=new zy({template:r,root:i,owner:t}),r=s.toString(),s.unbind(),""===r)||(this.name=r,e.a?this.params=e.a:e.d&&(s=new zy({template:e.d,root:i,owner:t}),this.params=s.getArgsList(),s.unbind()),this._fn=g("transitions",i,r),this._fn||v(Fa(r,"transition"),{ractive:this.root}))}function Ur(t){return t}function Wr(){Ov.hidden=document[Ev]}function zr(){Ov.hidden=!0}function Br(){Ov.hidden=!1}function qr(){var t,e,n,i=this;t=this.node=this.element.node,e=t.getAttribute("style"),this.complete=function(r){n||(!r&&i.isIntro&&$r(t,e),t._ractive.transition=null,i._manager.remove(i),n=!0)},this._fn?this._fn.apply(this.root,[this].concat(this.params)):this.complete()}function $r(t,e){e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"))}function Qr(){var t,e,n,i=this,r=this.root;return t=Zr(this),e=this.node=ha(this.name,t),this.parentFragment.cssIds&&this.node.setAttribute("data-ractive-css",this.parentFragment.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),ba(this.node,"_ractive",{value:{proxy:this,keypath:eu(this.parentFragment),events:ya(null),root:r}}),this.attributes.forEach(function(t){return t.render(e)}),this.conditionalAttributes.forEach(function(t){return t.render(e)}),this.fragment&&("script"===this.name?(this.bubble=Mv,this.node.text=this.fragment.toString(!1),this.fragment.unrender=Ca):"style"===this.name?(this.bubble=Vv,this.bubble(),this.fragment.unrender=Ca):this.binding&&this.getAttribute("contenteditable")?this.fragment.unrender=Ca:this.node.appendChild(this.fragment.render())),this.binding&&(this.binding.render(),this.node._ractive.binding=this.binding),this.eventHandlers&&this.eventHandlers.forEach(function(t){return t.render()}),"option"===this.name&&Hr(this),"img"===this.name?Nr(this):"form"===this.name?Dr(this):"input"===this.name||"textarea"===this.name?this.node.defaultValue=this.node.value:"option"===this.name&&(this.node.defaultSelected=this.node.selected),this.decorator&&this.decorator.fn&&hu.scheduleTask(function(){i.decorator.torndown||i.decorator.init()},!0),r.transitionsEnabled&&this.intro&&(n=new Uv(this,this.intro,!0),hu.registerTransition(n),hu.scheduleTask(function(){return n.start()},!0),this.transition=n),this.node.autofocus&&hu.scheduleTask(function(){return i.node.focus()},!0),Kr(this),this.node}function Zr(t){var e,n;return(e=t.getAttribute("xmlns"))?e:"svg"===t.name?ia.svg:(n=t.parent)?"foreignObject"===n.name?ia.html:n.node.namespaceURI:t.root.el.namespaceURI}function Hr(t){var e,n,i;if(t.select&&void 0!==(n=t.select.getAttribute("value")))if(e=t.getAttribute("value"),t.select.node.multiple&&s(n)){for(i=n.length;i--;)if(e==n[i]){t.node.selected=!0;break}}else t.node.selected=e==n}function Kr(t){var e,n,i,r;e=t.root;do{for(i=(n=e._liveQueries).length;i--;)(r=n["_"+n[i]])._test(t)&&(t.liveQueries||(t.liveQueries=[])).push(r)}while(e=e.parent)}function Gr(t){var e,n,i;if(void 0===(e=t.getAttribute("value"))||!t.select)return!1;if((n=t.select.getAttribute("value"))==e)return!0;if(t.select.getAttribute("multiple")&&s(n))for(i=n.length;i--;)if(n[i]==e)return!0}function Yr(t){var e,n,i,r;if(e=t.attributes,n=e.type,i=e.value,r=e.name,n&&"radio"===n.value&&i&&r.interpolator)return i.value===r.interpolator.value||void 0}function Jr(t){var e=t.toString();return e?" "+e:""}function Xr(){this.fragment&&this.fragment.unbind(),this.binding&&this.binding.unbind(),this.eventHandlers&&this.eventHandlers.forEach(Z),"option"===this.name&&Tr(this),this.attributes.forEach(Z),this.conditionalAttributes.forEach(Z)}function ts(t){var e,n,i;(i=this.transition)&&i.complete(),"option"===this.name?this.detach():t&&hu.detachWhenReady(this),this.fragment&&this.fragment.unrender(!1),(e=this.binding)&&(this.binding.unrender(),this.node._ractive.binding=null,(n=this.root._twowayBindings[e.keypath.str]).splice(n.indexOf(e),1)),this.eventHandlers&&this.eventHandlers.forEach(H),this.decorator&&hu.registerDecorator(this.decorator),this.root.transitionsEnabled&&this.outro&&(i=new Uv(this,this.outro,!1),hu.registerTransition(i),hu.scheduleTask(function(){return i.start()})),this.liveQueries&&es(this),"form"===this.name&&Ir(this)}function es(t){var e,n;for(n=t.liveQueries.length;n--;)(e=t.liveQueries[n]).selector,e._remove(t.node)}function ns(t,e){var n=Hv.exec(e)[0];return null===t||n.length<t.length?n:t}function is(t,e,n){var i;if(i=rs(t,e,n||{}))return i;if(i=$f.fromId(e,{noThrow:!0})){i=Kv(i);var r=$f.parse(i,$f.getParseOptions(t));return t.partials[e]=r.t}}function rs(t,e,n){var i=void 0,r=as(e,n.owner);if(r)return r;var s=y("partials",t,e);if(s){if("function"==typeof(r=s.partials[e])&&((i=r.bind(s)).isOwner=s.partials.hasOwnProperty(e),r=i.call(t,$f)),r||""===r){if(!$f.isParsed(r)){var o=$f.parse(r,$f.getParseOptions(s));o.p&&m("Partials ({{>%s}}) cannot contain nested inline partials",e,{ractive:t}),(i?s:ss(s,e)).partials[e]=r=o.t}return i&&(r._fn=i),r.v?r.t:r}m(Ta,e,"partial","partial",{ractive:t})}}function ss(t,e){return t.partials.hasOwnProperty(e)?t:os(t.constructor,e)}function os(t,e){if(t)return t.partials.hasOwnProperty(e)?t:os(t._Parent,e)}function as(t,e){if(e){if(e.template&&e.template.p&&e.template.p[t])return e.template.p[t];if(e.parentFragment&&e.parentFragment.owner)return as(t,e.parentFragment.owner)}}function us(t,e){var n,i=y("components",t,e);if(i&&!(n=i.components[e])._Parent){var r=n.bind(i);if(r.isOwner=i.components.hasOwnProperty(e),!(n=r()))return void m(Ta,e,"component","component",{ractive:t});"string"==typeof n&&(n=us(t,n)),n._fn=r,i.components[e]=n}return n}function hs(){var t=this.instance.fragment.detach();return rg.fire(this.instance),t}function cs(t){return this.instance.fragment.find(t)}function ls(t,e){return this.instance.fragment.findAll(t,e)}function fs(t,e){e._test(this,!0),this.instance.fragment&&this.instance.fragment.findAllComponents(t,e)}function ds(t){return t&&t!==this.name?this.instance.fragment?this.instance.fragment.findComponent(t):null:this.instance}function ps(){return this.parentFragment.findNextNode(this)}function ms(){return this.rendered?this.instance.fragment.firstNode():null}function vs(t,e,n){function i(t){var n,i;t.value=e,t.updating||(i=t.ractive,n=t.keypath,t.updating=!0,hu.start(i),i.viewmodel.mark(n),hu.end(),t.updating=!1)}var r,s,o,a,u,h;if(r=t.obj,s=t.prop,n&&!n.configurable){if("length"===s)return;throw new Error('Cannot use magic mode with property "'+s+'" - object is not configurable')}n&&(o=n.get,a=n.set),u=o||function(){return e},(h=function(t){a&&a(t),e=o?o():t,h._ractiveWrappers.forEach(i)})._ractiveWrappers=[t],Object.defineProperty(r,s,{get:u,set:h,enumerable:!0,configurable:!0})}function gs(t,e){var n,i,r,s;if(this.adaptors)for(n=this.adaptors.length,i=0;i<n;i+=1)if((r=this.adaptors[i]).filter(e,t,this.ractive))return s=this.wrapped[t]=r.wrap(this.ractive,e,t,bs(t)),void(s.value=e)}function ys(t,e){var n,i={};if(!e)return t;e+=".";for(n in t)t.hasOwnProperty(n)&&(i[e+n]=t[n]);return i}function bs(t){var e;return Og[t]||(e=t?t+".":"",Og[t]=function(n,i){var r;return"string"==typeof n?(r={},r[e+n]=i,r):"object"===(void 0===n?"undefined":_typeof(n))?e?ys(n,t):n:void 0}),Og[t]}function ws(t){var e,n,i=[Wa];for(e=t.length;e--;)for(n=t[e].parent;n&&!n.isRoot;)-1===t.indexOf(n)&&F(i,n),n=n.parent;return i}function xs(t,e,n){_s(t,e),n||e.wildcardMatches().forEach(function(n){ks(t,n,e)})}function ks(t,e,n){var i,r,s;e=e.str||e,(r=(i=t.depsMap.patternObservers)&&i[e])&&r.forEach(function(e){s=n.join(e.lastKey),_s(t,s),ks(t,e,s)})}function _s(t,e){t.patternObservers.forEach(function(t){t.regex.test(e.str)&&t.update(e)})}function Es(){function t(t){var i=t.key;t.viewmodel===o?(o.clearCache(i.str),t.invalidate(),n.push(i),e(i)):t.viewmodel.mark(i)}function e(n){var i,r;o.noCascade.hasOwnProperty(n.str)||((r=o.deps.computed[n.str])&&r.forEach(t),(i=o.depsMap.computed[n.str])&&i.forEach(e))}var n,i,r,s=this,o=this,a={};if((n=this.changes).length)return n.slice().forEach(e),(i=Pg(n)).forEach(function(e){var i;-1===n.indexOf(e)&&(i=o.deps.computed[e.str])&&i.forEach(t)}),this.changes=[],this.patternObservers.length&&(i.forEach(function(t){return Tg(s,t,!0)}),n.forEach(function(t){return Tg(s,t)})),this.deps.observers&&(i.forEach(function(t){return As(s,null,t,"observers")}),Cs(this,n,"observers")),this.deps.default&&(r=[],i.forEach(function(t){return As(s,r,t,"default")}),r.length&&Ss(this,r,n),Cs(this,n,"default")),n.forEach(function(t){a[t.str]=s.get(t)}),this.implicitChanges={},this.noCascade={},a}function As(t,e,n,i){var r,s;(r=Os(t,n,i))&&(s=t.get(n),r.forEach(function(t){e&&t.refineValue?e.push(t):t.setValue(s)}))}function Ss(t,e,n){e.forEach(function(e){for(var i=!1,r=0,s=n.length,o=[];r<s;){var a=n[r];if(a===e.keypath){i=!0;break}a.slice(0,e.keypath.length)===e.keypath&&o.push(a),r++}i&&e.setValue(t.get(e.keypath)),o.length&&e.refineValue(o)})}function Cs(t,e,n){function i(t){t.forEach(r),t.forEach(s)}function r(e){var i=Os(t,e,n);i&&a.push({keypath:e,deps:i})}function s(e){var r;(r=t.depsMap[n][e.str])&&i(r)}function o(e){var n=t.get(e.keypath);e.deps.forEach(function(t){return t.setValue(n)})}var a=[];i(e),a.forEach(o)}function Os(t,e,n){var i=t.deps[n];return i?i[e.str]:null}function Ps(){this.captureGroups.push([])}function Ts(t,e){var n,i;if(e||(i=this.wrapped[t])&&!1!==i.teardown()&&(this.wrapped[t]=null),this.cache[t]=void 0,n=this.cacheMap[t])for(;n.length;)this.clearCache(n.pop())}function Fs(t,e){var n=e.firstKey;return!(n in t.data||n in t.computations||n in t.mappings)}function Rs(t,e){var n=new Lg(t,e);return this.ready&&n.init(this),this.computations[t.str]=n}function js(t,e){var n,i,r,s,o,a=this.cache,u=t.str;if((e=e||Wg).capture&&(s=D(this.captureGroups))&&(~s.indexOf(t)||s.push(t)),Ea.call(this.mappings,t.firstKey))return this.mappings[t.firstKey].get(t,e);if(t.isSpecial)return t.value;if(void 0===a[u]?((i=this.computations[u])&&!i.bypass?(n=i.get(),this.adapt(u,n)):(r=this.wrapped[u])?n=r.value:t.isRoot?(this.adapt("",this.data),n=this.data):n=Ns(this,t),a[u]=n):n=a[u],!e.noUnwrap&&(r=this.wrapped[u])&&(n=r.get()),t.isRoot&&e.fullRootGet)for(o in this.mappings)n[o]=this.mappings[o].getValue();return n===Mg?void 0:n}function Ns(t,e){var n,i,r,s;if(n=t.get(e.parent),(s=t.wrapped[e.parent.str])&&(n=s.get()),null!==n&&void 0!==n)return(i=t.cacheMap[e.parent.str])?-1===i.indexOf(e.str)&&i.push(e.str):t.cacheMap[e.parent.str]=[e.str],"object"!==(void 0===n?"undefined":_typeof(n))||e.lastKey in n?(r=n[e.lastKey],t.adapt(e.str,r,!1),t.cache[e.str]=r,r):t.cache[e.str]=Mg}function Ds(){var t;for(t in this.computations)this.computations[t].init(this)}function Is(t,e){var n=this.mappings[t.str]=new qg(t,e);return n.initViewmodel(this),n}function Ls(t,e){var n,i=t.str;e&&(e.implicit&&(this.implicitChanges[i]=!0),e.noCascade&&(this.noCascade[i]=!0)),(n=this.computations[i])&&n.invalidate(),-1===this.changes.indexOf(t)&&this.changes.push(t);var r=!!e&&e.keepExistingWrapper;this.clearCache(i,r),this.ready&&this.onchange()}function Vs(t,e,n,i){var r,s,o,a;if(this.mark(t),i&&i.compare){o=Us(i.compare);try{r=e.map(o),s=n.map(o)}catch(i){m('merge(): "%s" comparison failed. Falling back to identity checking',t),r=e,s=n}}else r=e,s=n;a=Qg(r,s),this.smartUpdate(t,n,a,e.length!==n.length)}function Ms(t){return JSON.stringify(t)}function Us(t){if(!0===t)return Ms;if("string"==typeof t)return Hg[t]||(Hg[t]=function(e){return e[t]}),Hg[t];if("function"==typeof t)return t;throw new Error("The `compare` option must be a function, or a string representing an identifying field (or `true` to use JSON.stringify)")}function Ws(t,e){var n,i,r=void 0===arguments[2]?"default":arguments[2];e.isStatic||((n=this.mappings[t.firstKey])?n.register(t,e,r):(((i=this.deps[r]||(this.deps[r]={}))[t.str]||(i[t.str]=[])).push(e),this.depsMap[r]||(this.depsMap[r]={}),t.isRoot||zs(this,t,r)))}function zs(t,e,n){for(var i,r,s;!e.isRoot;)void 0===(r=(i=t.depsMap[n])[e.parent.str]||(i[e.parent.str]=[]))["_"+(s=e.str)]&&(r["_"+s]=0,r.push(e)),r["_"+s]+=1,e=e.parent}function Bs(){return this.captureGroups.pop()}function qs(t){this.data=t,this.clearCache("")}function $s(t,e){var n,i,r,s,o=void 0===arguments[2]?{}:arguments[2];if(!o.noMapping&&(n=this.mappings[t.firstKey]))return n.set(t,e);if(i=this.computations[t.str]){if(i.setting)return;i.set(e),e=i.get()}a(this.cache[t.str],e)||((r=this.wrapped[t.str])&&r.reset&&(s=!1!==r.reset(e))&&(e=r.get()),i||s||Qs(this,t,e),o.silent?this.clearCache(t.str):this.mark(t))}function Qs(t,e,n){var i,r,s,o;s=function(){i.set?i.set(e.lastKey,n):(r=i.get(),o())},o=function(){r||(r=kg(e.lastKey),t.set(e.parent,r,{silent:!0})),r[e.lastKey]=n},(i=t.wrapped[e.parent.str])?s():(r=t.get(e.parent),(i=t.wrapped[e.parent.str])?s():o())}function Zs(t,e,n){var i,r,s,o=this;if(r=n.length,n.forEach(function(e,n){-1===e&&o.mark(t.join(n),ey)}),this.set(t,e,{silent:!0}),(i=this.deps.default[t.str])&&i.filter(Hs).forEach(function(t){return t.shuffle(n,e)}),r!==e.length){for(this.mark(t.join("length"),ty),s=n.touchedFrom;s<e.length;s+=1)this.mark(t.join(s));for(s=e.length;s<r;s+=1)this.mark(t.join(s),ey)}}function Hs(t){return"function"==typeof t.shuffle}function Ks(){var t,e=this;for(Object.keys(this.cache).forEach(function(t){return e.clearCache(t)});t=this.unresolvedImplicitDependencies.pop();)t.teardown()}function Gs(t,e){var n,i,r,s=void 0===arguments[2]?"default":arguments[2];if(!e.isStatic){if(n=this.mappings[t.firstKey])return n.unregister(t,e,s);if(i=this.deps[s][t.str],-1===(r=i.indexOf(e)))throw new Error("Attempted to remove a dependant that was no longer registered! This should not happen. If you are seeing this bug in development please raise an issue at https://github.com/RactiveJS/Ractive/issues - thanks");i.splice(r,1),t.isRoot||Ys(this,t,s)}}function Ys(t,e,n){for(var i;!e.isRoot;)(i=t.depsMap[n][e.parent.str])["_"+e.str]-=1,i["_"+e.str]||(I(i,e),i["_"+e.str]=void 0),e=e.parent}function Js(t){this.hook=new Ga(t),this.inProcess={},this.queue={}}function Xs(t,e){return t[e._guid]||(t[e._guid]=[])}function to(t,e){var n=Xs(t.queue,e);for(t.hook.fire(e);n.length;)to(t,n.shift());delete t.queue[e._guid]}function eo(t,e){var n,i={};for(n in e)i[n]=no(t,n,e[n]);return i}function no(t,e,n){var i,r;return"function"==typeof n&&(i=ro(n,t)),"string"==typeof n&&(i=io(t,n)),"object"===(void 0===n?"undefined":_typeof(n))&&("string"==typeof n.get?i=io(t,n.get):"function"==typeof n.get?i=ro(n.get,t):l("`%s` computation must have a `get()` method",e),"function"==typeof n.set&&(r=ro(n.set,t))),{getter:i,setter:r}}function io(t,e){var n,i,r;return n="return ("+e.replace(uy,function(t,e){return i=!0,'__ractive.get("'+e+'")'})+");",i&&(n="var __ractive = this; "+n),r=new Function(n),i?r.bind(t):r}function ro(t,e){return/this/.test(t.toString())?t.bind(e):t}function so(e){var n,r,s=void 0===arguments[1]?{}:arguments[1],o=void 0===arguments[2]?{}:arguments[2];if(fb.DEBUG&&_a(),uo(e,o),ba(e,"data",{get:ho}),hy.fire(e,s),dy.forEach(function(t){e[t]=i(ya(e.constructor[t]||null),s[t])}),r=new sy({adapt:oo(e,e.adapt,s),data:Th.init(e.constructor,e,s),computed:ay(e,i(ya(e.constructor.prototype.computed),s.computed)),mappings:o.mappings,ractive:e,onchange:function(){return hu.addRactive(e)}}),e.viewmodel=r,r.init(),nd.init(e.constructor,e,s),cy.fire(e),ly.begin(e),e.template){var a=void 0;(o.cssIds||e.cssId)&&(a=o.cssIds?o.cssIds.slice():[],e.cssId&&a.push(e.cssId)),e.fragment=new zy({template:e.template,root:e,owner:e,cssIds:a})}if(ly.end(e),n=t(e.el)){var u=e.render(n,e.append);fb.DEBUG_PROMISES&&u.catch(function(t){throw v("Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\n  Ractive.DEBUG_PROMISES = false;"),m("An error happened during rendering",{ractive:e}),t.stack&&f(t.stack),t})}}function oo(t,e,n){function i(e){return"string"==typeof e&&((e=g("adaptors",t,e))||l(Fa(e,"adaptor"))),e}var r,s,o;if(e=e.map(i),r=N(n.adapt).map(i),r=ao(e,r),s="magic"in n?n.magic:t.magic,o="modifyArrays"in n?n.modifyArrays:t.modifyArrays,s){if(!na)throw new Error("Getters and setters (magic mode) are not supported in this browser");o&&r.push(Sg),r.push(Ag)}return o&&r.push(wg),r}function ao(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function uo(t,e){t._guid="r-"+fy++,t._subs=ya(null),t._config={},t._twowayBindings=ya(null),t._animations=[],t.nodes={},t._liveQueries=[],t._liveComponentQueries=[],t._boundFunctions=[],t._observers=[],e.component?(t.parent=e.parent,t.container=e.container||null,t.root=t.parent.root,t.component=e.component,e.component.instance=t,t._inlinePartials=e.inlinePartials):(t.root=t,t.parent=t.container=null)}function ho(){throw new Error("Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead")}function co(t,e,n){this.parentFragment=t.parentFragment,this.callback=n,this.fragment=new zy({template:e,root:t.root,owner:this}),this.update()}function lo(t,e,n){var i;return e.r?i=Pd(t,e.r,n):e.x?i=new jd(t,t.parentFragment,e.x,n):e.rx&&(i=new Ld(t,e.rx,n)),i}function fo(t){return 1===t.length&&t[0].t===Ih}function po(t,e){var n;for(n in e)e.hasOwnProperty(n)&&mo(t.instance,t.root,n,e[n])}function mo(t,e,n,i){"string"!=typeof i&&l("Components currently only support simple events - you cannot include arguments. Sorry!"),t.on(n,function(){var t,n;return arguments.length&&arguments[0]&&arguments[0].node&&(t=Array.prototype.shift.call(arguments)),n=Array.prototype.slice.call(arguments),Nu(e,i,{event:t,args:n}),!1})}function vo(t,e){var n;if(!e)throw new Error('Component "'+this.name+'" not found');n=(this.parentFragment=t.parentFragment).root,this.root=n,this.type=Zh,this.name=t.template.e,this.index=t.index,this.indexRefBindings={},this.yielders={},this.resolvers=[],vy(this,e,t.template.a,t.template.f,t.template.p),gy(this,t.template.v),(t.template.t0||t.template.t1||t.template.t2||t.template.o)&&m('The "intro", "outro" and "decorator" directives have no effect on components',{ractive:this.instance}),yy(this)}function go(t,e){function n(n){n.rebind(t,e)}var i;this.resolvers.forEach(n);for(var r in this.yielders)this.yielders[r][0]&&n(this.yielders[r][0]);(i=this.root._liveComponentQueries["_"+this.name])&&i._makeDirty()}function yo(){var t=this.instance;return t.render(this.parentFragment.getNode()),this.rendered=!0,t.fragment.detach()}function bo(){return this.instance.fragment.toString()}function wo(){var t=this.instance;this.resolvers.forEach(Z),xo(this),t._observers.forEach(K),t.fragment.unbind(),t.viewmodel.teardown(),t.fragment.rendered&&t.el.__ractive_instances__&&I(t.el.__ractive_instances__,t),Ey.fire(t)}function xo(t){var e,n;e=t.root;do{(n=e._liveComponentQueries["_"+t.name])&&n._remove(t)}while(e=e.parent)}function ko(t){this.shouldDestroy=t,this.instance.unrender()}function _o(t){var e=this;this.owner=t.owner,this.parent=this.owner.parentFragment,this.root=t.root,this.pElement=t.pElement,this.context=t.context,this.index=t.index,this.key=t.key,this.registeredIndexRefs=[],this.cssIds="cssIds"in t?t.cssIds:this.parent?this.parent.cssIds:null,this.items=t.template.map(function(n,i){return Eo({parentFragment:e,pElement:t.pElement,template:n,index:i})}),this.value=this.argsList=null,this.dirtyArgs=this.dirtyValue=!0,this.bound=!0}function Eo(t){if("string"==typeof t.template)return new gd(t);switch(t.template.t){case Hh:return new Fy(t);case Ih:return new Wd(t);case Vh:return new ap(t);case Lh:return new Ap(t);case Wh:var e=void 0;return(e=ng(t.parentFragment.root,t.template.e))?new Cy(t,e):new Qv(t);case zh:return new eg(t);case Bh:return new Py(t);case Gh:return new jy(t);default:throw new Error("Something very strange happened. Please file an issue at https://github.com/ractivejs/ractive/issues. Thanks!")}}function Ao(t,e){this.owner&&!this.owner.hasContext||k(this,"context",t,e),this.items.forEach(function(n){n.rebind&&n.rebind(t,e)})}function So(){var t;return 1===this.items.length?t=this.items[0].render():(t=document.createDocumentFragment(),this.items.forEach(function(e){t.appendChild(e.render())})),this.rendered=!0,t}function Co(t){return this.items?this.items.map(t?Po:Oo).join(""):""}function Oo(t){return t.toString()}function Po(t){return t.toString(!0)}function To(){this.bound&&(this.items.forEach(Fo),this.bound=!1)}function Fo(t){t.unbind&&t.unbind()}function Ro(t){if(!this.rendered)throw new Error("Attempted to unrender a fragment that was not rendered");this.items.forEach(function(e){return e.unrender(t)}),this.rendered=!1}function jo(t){var e,n,i,r,s;if(t=t||{},"object"!==(void 0===t?"undefined":_typeof(t)))throw new Error("The reset method takes either no arguments, or an object containing new data");for((n=this.viewmodel.wrapped[""])&&n.reset?!1===n.reset(t)&&this.viewmodel.reset(t):this.viewmodel.reset(t),r=(i=nd.reset(this)).length;r--;)if(qy.indexOf(i[r])>-1){s=!0;break}if(s){var o=void 0;this.viewmodel.mark(Wa),(o=this.component)&&(o.shouldDestroy=!0),this.unrender(),o&&(o.shouldDestroy=!1),this.fragment.template!==this.template&&(this.fragment.unbind(),this.fragment=new zy({template:this.template,root:this,owner:this})),e=this.render(this.el,this.anchor)}else e=hu.start(this,!0),this.viewmodel.mark(Wa),hu.end();return $y.fire(this,t),e}function No(t){var e,n;Qf.init(null,this,{template:t}),e=this.transitionsEnabled,this.transitionsEnabled=!1,(n=this.component)&&(n.shouldDestroy=!0),this.unrender(),n&&(n.shouldDestroy=!1),this.fragment.unbind(),this.fragment=new zy({template:this.template,root:this,owner:this}),this.render(this.el,this.anchor),this.transitionsEnabled=e}function Do(t,e){var n,i;if(i=hu.start(this,!0),h(t)){n=t;for(t in n)n.hasOwnProperty(t)&&Io(this,t,e=n[t])}else Io(this,t,e);return hu.end(),i}function Io(t,e,n){(e=E(C(e))).isPattern?A(t,e).forEach(function(e){t.viewmodel.set(e,n)}):t.viewmodel.set(e,n)}function Lo(t,e){return za(this,t,void 0===e?-1:-e)}function Vo(){var t;return this.fragment.unbind(),this.viewmodel.teardown(),this._observers.forEach(K),this.fragment.rendered&&this.el.__ractive_instances__&&I(this.el.__ractive_instances__,this),this.shouldDestroy=!0,t=this.fragment.rendered?this.unrender():tu.resolve(),eb.fire(this),this._boundFunctions.forEach(Mo),t}function Mo(t){delete t.fn[t.prop]}function Uo(t){var e=this;if("string"!=typeof t)throw new TypeError(Pa);var n=void 0;return/\*/.test(t)?(n={},A(this,E(C(t))).forEach(function(t){n[t.str]=!e.viewmodel.get(t)}),this.set(n)):this.set(t,!this.get(t))}function Wo(){return this.fragment.toString(!0)}function zo(){var t,e;if(!this.fragment.rendered)return m("ractive.unrender() was called on a Ractive instance that was not rendered"),tu.resolve();for(t=hu.start(this,!0),e=!this.component||this.component.shouldDestroy||this.shouldDestroy;this._animations[0];)this._animations[0].stop();return this.fragment.unrender(e),I(this.el.__ractive_instances__,this),sb.fire(this),hu.end(),t}function Bo(t){var e;return t=E(t)||Wa,e=hu.start(this,!0),this.viewmodel.mark(t),hu.end(),ub.fire(this,t),e}function qo(t,e){var n,i,r;if("string"!=typeof t||e){r=[];for(i in this._twowayBindings)t&&!E(i).equalsOrStartsWith(t)||r.push.apply(r,this._twowayBindings[i])}else r=this._twowayBindings[t];return n=$o(this,r),this.set(n)}function $o(t,e){var n={},i=[];return e.forEach(function(t){var e,r;t.radioName&&!t.element.node.checked||(t.checkboxName?i[t.keypath.str]||t.changed()||(i.push(t.keypath),i[t.keypath.str]=t):j(e=t.attribute.value,r=t.getValue())||a(e,r)||(n[t.keypath.str]=r))}),i.length&&i.forEach(function(t){var e,r;j((e=i[t.str]).attribute.value,r=e.getValue())||(n[t.str]=r)}),n}function Qo(t,e){return"function"==typeof e&&/_super/.test(t)}function Zo(t){for(var e={};t;)Ho(t,e),Go(t,e),t=t._Parent!==fb&&t._Parent;return e}function Ho(t,e){Xf.forEach(function(n){Ko(n.useDefaults?t.prototype:t,e,n.name)})}function Ko(t,e,n){var i,r=Object.keys(t[n]);r.length&&((i=e[n])||(i=e[n]={}),r.filter(function(t){return!(t in i)}).forEach(function(e){return i[e]=t[n][e]}))}function Go(t,e){Object.keys(t.prototype).forEach(function(n){if("computed"!==n){var i=t.prototype[n];if(n in e){if("function"==typeof e[n]&&"function"==typeof i&&e[n]._method){var r=void 0,s=i._method;s&&(i=i._method),r=cb(e[n]._method,i),s&&(r._method=r),e[n]=r}}else e[n]=i._method?i._method:i}})}function Yo(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length?e.reduce(Jo,this):Jo(this)}function Jo(t){var e,n,r=void 0===arguments[1]?{}:arguments[1];return r.prototype instanceof fb&&(r=lb(r)),e=function(t){if(!(this instanceof e))return new e(t);py(this,t)},n=ya(t.prototype),n.constructor=e,wa(e,{defaults:{value:n},extend:{value:Yo,writable:!0,configurable:!0},_Parent:{value:t}}),nd.extend(t,n,r),Th.extend(t,n,r),r.computed&&(n.computed=i(ya(t.prototype.computed),r.computed)),e.prototype=n,e}var Xo,ta,ea,na,ia,ra,sa,oa=3,aa={el:void 0,append:!1,template:{v:oa,t:[]},preserveWhitespace:!1,sanitize:!1,stripComments:!0,delimiters:["{{","}}"],tripleDelimiters:["{{{","}}}"],interpolate:!1,data:{},computed:{},magic:!1,modifyArrays:!0,adapt:[],isolated:!1,twoway:!0,lazy:!1,noIntro:!1,transitionsEnabled:!0,complete:void 0,css:null,noCssTransform:!1},ua={linear:function(t){return t},easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)}};Xo="object"===("undefined"==typeof document?"undefined":_typeof(document)),ta="undefined"!=typeof navigator&&/jsDom/.test(navigator.appName),ea="undefined"!=typeof console&&"function"==typeof console.warn&&"function"==typeof console.warn.apply;try{Object.defineProperty({},"test",{value:0}),na=!0}catch(t){na=!1}ia={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ra="undefined"!=typeof document&&(document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),sa=["o","ms","moz","webkit"];var ha,ca,la,fa,da,pa,ma,va,ga;if(ha=ra?function(t,e){return e&&e!==ia.html?document.createElementNS(e,t):document.createElement(t)}:function(t,e){if(e&&e!==ia.html)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information";return document.createElement(t)},Xo){for(la=ha("div"),ga=function(t){return function(e,n){return e[t](n)}},ma=(fa=["matches","matchesSelector"]).length;ma--&&!ca;)if(da=fa[ma],la[da])ca=ga(da);else for(va=sa.length;va--;)if(pa=sa[ma]+da.substr(0,1).toUpperCase()+da.substring(1),la[pa]){ca=ga(pa);break}ca||(ca=function(t,e){var n,i,r;for((i=t.parentNode)||(la.innerHTML="",i=la,t=t.cloneNode(),la.appendChild(t)),r=(n=i.querySelectorAll(e)).length;r--;)if(n[r]===t)return!0;return!1})}else ca=null;var ya,ba,wa;try{Object.defineProperty({},"test",{value:0}),Xo&&Object.defineProperty(document.createElement("div"),"test",{value:0}),ba=Object.defineProperty}catch(t){ba=function(t,e,n){t[e]=n.value}}try{try{Object.defineProperties({},{test:{value:0}})}catch(t){throw t}Xo&&Object.defineProperties(ha("div"),{test:{value:0}}),wa=Object.defineProperties}catch(t){wa=function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&ba(t,n,e[n])}}try{Object.create(null),ya=Object.create}catch(t){ya=function(){var t=function(){};return function(e,n){var i;return null===e?{}:(t.prototype=e,i=new t,n&&Object.defineProperties(i,n),i)}}()}var xa,ka,_a,Ea=Object.prototype.hasOwnProperty,Aa=Object.prototype.toString,Sa=/^\[object (?:Array|FileList)\]$/,Ca=function(){},Oa={};ea?function(){var t=["%cRactive.js %c0.7.3 %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"];_a=function(){var e=!!console.groupCollapsed;console[e?"groupCollapsed":"log"].apply(console,t),console.log("You're running Ractive 0.7.3 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n"),e&&console.groupEnd(t),_a=Ca},ka=function(t,e){if(_a(),"object"===_typeof(e[e.length-1])){var n=e.pop(),i=n?n.ractive:null;if(i){var r=void 0;i.component&&(r=i.component.name)&&(t="<"+r+"> "+t);var s=void 0;(s=n.node||i.fragment&&i.fragment.rendered&&i.find("*"))&&e.push(s)}}console.warn.apply(console,["%cRactive.js: %c"+t,"color: rgb(114, 157, 52);","color: rgb(85, 85, 85);"].concat(e))},xa=function(){console.log.apply(console,arguments)}}():ka=xa=_a=Ca;var Pa="Bad arguments",Ta='A function was specified for "%s" %s, but no %s was returned',Fa=function(t,e){return'Missing "'+t+'" '+e+" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#"+e+"s"},Ra=function(t,e,n,i){if(t===e)return b(e);if(i){var r=g("interpolators",n,i);if(r)return r(t,e)||b(e);l(Fa(i,"interpolator"))}return ja.number(t,e)||ja.array(t,e)||ja.object(t,e)||b(e)},ja={number:function(t,e){var n;return u(t)&&u(e)?(t=+t,e=+e,n=e-t,n?function(e){return t+e*n}:function(){return t}):null},array:function(t,e){var n,i,r,o;if(!s(t)||!s(e))return null;for(n=[],i=[],o=r=Math.min(t.length,e.length);o--;)i[o]=Ra(t[o],e[o]);for(o=r;o<t.length;o+=1)n[o]=t[o];for(o=r;o<e.length;o+=1)n[o]=e[o];return function(t){for(var e=r;e--;)n[e]=i[e](t);return n}},object:function(t,e){var n,i,r,s,o;if(!h(t)||!h(e))return null;n=[],s={},r={};for(o in t)Ea.call(t,o)&&(Ea.call(e,o)?(n.push(o),r[o]=Ra(t[o],e[o])):s[o]=t[o]);for(o in e)Ea.call(e,o)&&!Ea.call(t,o)&&(s[o]=e[o]);return i=n.length,function(t){for(var e,o=i;o--;)e=n[o],s[e]=r[e](t);return s}}},Na=w,Da={},Ia=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g,La=/\*/,Va={},Ma=function(t){var e=t.split(".");this.str=t,"@"===t[0]&&(this.isSpecial=!0,this.value=_(t)),this.firstKey=e[0],this.lastKey=e.pop(),this.isPattern=La.test(t),this.parent=""===t?null:E(e.join(".")),this.isRoot=!t};Ma.prototype={equalsOrStartsWith:function(t){return t===this||this.startsWith(t)},join:function(t){return E(this.isRoot?String(t):this.str+"."+t)},replace:function(t,e){return this===t?e:this.startsWith(t)?null===e?e:E(this.str.replace(t.str+".",e.str+".")):void 0},startsWith:function(t){return!!t&&(t&&this.str.substr(0,t.str.length+1)===t.str+".")},toString:function(){throw new Error("Bad coercion")},valueOf:function(){throw new Error("Bad coercion")},wildcardMatches:function(){return this._wildcardMatches||(this._wildcardMatches=Na(this.str))}};var Ua,Wa=E(""),za=O,Ba="Cannot add to a non-numeric value",qa=P;"undefined"==typeof window?Ua=null:(!function(t,e,n){var i,r;if(!n.requestAnimationFrame){for(i=0;i<t.length&&!n.requestAnimationFrame;++i)n.requestAnimationFrame=n[t[i]+"RequestAnimationFrame"];n.requestAnimationFrame||(r=n.setTimeout,n.requestAnimationFrame=function(t){var n,i,s;return n=Date.now(),i=Math.max(0,16-(n-e)),s=r(function(){t(n+i)},i),e=n+i,s})}}(sa,0,window),Ua=window.requestAnimationFrame);var $a,Qa=Ua,Za=$a="undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?function(){return window.performance.now()}:function(){return Date.now()},Ha={construct:{deprecated:"beforeInit",replacement:"onconstruct"},render:{deprecated:"init",message:'The "init" method has been deprecated and will likely be removed in a future release. You can either use the "oninit" method which will fire only once prior to, and regardless of, any eventual ractive instance being rendered, or if you need to access the rendered DOM, use "onrender" instead. See http://docs.ractivejs.org/latest/migrating for more information.'},complete:{deprecated:"complete",replacement:"oncomplete"}};T.prototype.fire=function(t,e){function n(n){if(t[n])return e?t[n](e):t[n](),!0}n(this.method),!t[this.method]&&this.deprecate&&n(this.deprecate.deprecated)&&(this.deprecate.message?m(this.deprecate.message):m('The method "%s" has been deprecated in favor of "%s" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.',this.deprecate.deprecated,this.deprecate.replacement)),e?t.fire(this.event,e):t.fire(this.event)};var Ka,Ga=T,Ya={},Ja={},Xa={};"function"==typeof Promise?Ka=Promise:((Ka=function(t){var e,n,i,r,s,o,a=[],u=[],h=Ya;r=(i=function(t){return function(i){h===Ya&&(e=i,V(n=M((h=t)===Ja?a:u,e)))}})(Ja),s=i(Xa);try{t(r,s)}catch(t){s(t)}return o={then:function(t,e){var i=new Ka(function(r,s){var o=function(t,e,n){"function"==typeof t?e.push(function(e){var n;try{n=t(e),U(i,n,r,s)}catch(t){s(t)}}):e.push(n)};o(t,a,r),o(e,u,s),h!==Ya&&V(n)});return i}},o.catch=function(t){return this.then(null,t)},o}).all=function(t){return new Ka(function(e,n){var i,r,s,o=[];if(t.length)for(s=function(t,r){t&&"function"==typeof t.then?t.then(function(t){o[r]=t,--i||e(o)},n):(o[r]=t,--i||e(o))},i=r=t.length;r--;)s(t[r],r);else e(o)})},Ka.resolve=function(t){return new Ka(function(e){e(t)})},Ka.reject=function(t){return new Ka(function(e,n){n(t)})});var tu=Ka,eu=function(t){do{if(void 0!==t.context)return t.context}while(t=t.parent);return Wa},nu=W,iu=function(t,e){this.callback=t,this.parent=e,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.decoratorQueue=[],this.outrosComplete=!1,e&&e.addChild(this)};iu.prototype={addChild:function(t){this.children.push(t),this.totalChildren+=1,this.outroChildren+=1},decrementOutros:function(){this.outroChildren-=1,J(this)},decrementTotal:function(){this.totalChildren-=1,J(this)},add:function(t){(t.isIntro?this.intros:this.outros).push(t)},addDecorator:function(t){this.decoratorQueue.push(t)},remove:function(t){I(t.isIntro?this.intros:this.outros,t),J(this)},init:function(){this.ready=!0,J(this)},detachNodes:function(){this.decoratorQueue.forEach(Q),this.detachQueue.forEach(G),this.children.forEach(Y)}};var ru,su,ou=iu,au=[],uu=new Ga("change"),hu=su={start:function(t,e){var n,i;return e&&(n=new tu(function(t){return i=t})),ru={previousBatch:ru,transitionManager:new ou(i,ru&&ru.transitionManager),views:[],tasks:[],ractives:[],instance:t},t&&ru.ractives.push(t),n},end:function(){X(),ru.transitionManager.init(),!ru.previousBatch&&ru.instance&&(ru.instance.viewmodel.changes=[]),ru=ru.previousBatch},addRactive:function(t){ru&&F(ru.ractives,t)},registerTransition:function(t){t._manager=ru.transitionManager,ru.transitionManager.add(t)},registerDecorator:function(t){ru.transitionManager.addDecorator(t)},addView:function(t){ru.views.push(t)},addUnresolved:function(t){au.push(t)},removeUnresolved:function(t){I(au,t)},detachWhenReady:function(t){ru.transitionManager.detachQueue.push(t)},scheduleTask:function(t,e){var n;if(ru){for(n=ru;e&&n.previousBatch;)n=n.previousBatch;n.tasks.push(t)}else t()}},cu=[],lu={tick:function(){var t,e;for(e=Za(),hu.start(),t=0;t<cu.length;t+=1)cu[t].tick(e)||cu.splice(t--,1);hu.end(),cu.length?Qa(lu.tick):lu.running=!1},add:function(t){cu.push(t),lu.running||(lu.running=!0,Qa(lu.tick))},abort:function(t,e){for(var n,i=cu.length;i--;)(n=cu[i]).root===e&&n.keypath===t&&n.stop()}},fu=lu,du=function(t){var e;this.startTime=Date.now();for(e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.interpolator=Ra(this.from,this.to,this.root,this.interpolator),this.running=!0,this.tick()};du.prototype={tick:function(){var t,e,n,i,r,s;return s=this.keypath,!!this.running&&(i=Date.now(),(t=i-this.startTime)>=this.duration?(null!==s&&(hu.start(this.root),this.root.viewmodel.set(s,this.to),hu.end()),this.step&&this.step(1,this.to),this.complete(this.to),-1===(r=this.root._animations.indexOf(this))&&m("Animation was not found"),this.root._animations.splice(r,1),this.running=!1,!1):(e=this.easing?this.easing(t/this.duration):t/this.duration,null!==s&&(n=this.interpolator(e),hu.start(this.root),this.root.viewmodel.set(s,n),hu.end()),this.step&&this.step(e,n),!0))},stop:function(){var t;this.running=!1,-1===(t=this.root._animations.indexOf(this))&&m("Animation was not found"),this.root._animations.splice(t,1)}};var pu=du,mu=nt,vu={stop:Ca},gu=rt,yu=new Ga("detach"),bu=st,wu=ot,xu=function(){var t,e,n;t=this._root[this._isComponentQuery?"liveComponentQueries":"liveQueries"],e=this.selector,-1!==(n=t.indexOf(e))&&(t.splice(n,1),t[e]=null)},ku=function(t,e){var n,i,r,s,o,a,u,h,c,l;for(n=ut(t.component||t._ractive.proxy),i=ut(e.component||e._ractive.proxy),r=D(n),s=D(i);r&&r===s;)n.pop(),i.pop(),o=r,r=D(n),s=D(i);if(r=r.component||r,s=s.component||s,c=r.parentFragment,l=s.parentFragment,c===l)return a=c.items.indexOf(r),u=l.items.indexOf(s),a-u||n.length-i.length;if(h=o.fragments)return a=h.indexOf(c),u=h.indexOf(l),a-u||n.length-i.length;throw new Error("An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/RactiveJS/Ractive/issues - thanks!")},_u=function(t,e){var n;return t.compareDocumentPosition?(n=t.compareDocumentPosition(e),2&n?1:-1):ku(t,e)},Eu=function(){this.sort(this._isComponentQuery?ku:_u),this._dirty=!1},Au=function(){var t=this;this._dirty||(this._dirty=!0,hu.scheduleTask(function(){t._sort()}))},Su=function(t){var e=this.indexOf(this._isComponentQuery?t.instance:t);-1!==e&&this.splice(e,1)},Cu=ht,Ou=ct,Pu=lt,Tu=ft,Fu=dt,Ru=pt,ju={enqueue:function(t,e){t.event&&(t._eventQueue=t._eventQueue||[],t._eventQueue.push(t.event)),t.event=e},dequeue:function(t){t._eventQueue&&t._eventQueue.length?t.event=t._eventQueue.pop():delete t.event}},Nu=mt,Du=yt,Iu=bt,Lu={capture:!0,noUnwrap:!0,fullRootGet:!0},Vu=wt,Mu=new Ga("insert"),Uu=kt,Wu=function(t,e,n,i){this.root=t,this.keypath=e,this.callback=n,this.defer=i.defer,this.context=i&&i.context?i.context:t};Wu.prototype={init:function(t){this.value=this.root.get(this.keypath.str),!1!==t?this.update():this.oldValue=this.value},setValue:function(t){var e=this;a(t,this.value)||(this.value=t,this.defer&&this.ready?hu.scheduleTask(function(){return e.update()}):this.update())},update:function(){this.updating||(this.updating=!0,this.callback.call(this.context,this.value,this.oldValue,this.keypath.str),this.oldValue=this.value,this.updating=!1)}};var zu,Bu=Wu,qu=_t,$u=Array.prototype.slice;(zu=function(t,e,n,i){this.root=t,this.callback=n,this.defer=i.defer,this.keypath=e,this.regex=new RegExp("^"+e.str.replace(/\./g,"\\.").replace(/\*/g,"([^\\.]+)")+"$"),this.values={},this.defer&&(this.proxies=[]),this.context=i&&i.context?i.context:t}).prototype={init:function(t){var e,n;if(e=qu(this.root,this.keypath),!1!==t)for(n in e)e.hasOwnProperty(n)&&this.update(E(n));else this.values=e},update:function(t){var e,n=this;if(t.isPattern){e=qu(this.root,t);for(t in e)e.hasOwnProperty(t)&&this.update(E(t))}else this.root.viewmodel.implicitChanges[t.str]||(this.defer&&this.ready?hu.scheduleTask(function(){return n.getProxy(t).update()}):this.reallyUpdate(t))},reallyUpdate:function(t){var e,n,i,r;e=t.str,n=this.root.viewmodel.get(t),this.updating?this.values[e]=n:(this.updating=!0,a(n,this.values[e])&&this.ready||(i=$u.call(this.regex.exec(e),1),r=[n,this.values[e],e].concat(i),this.values[e]=n,this.callback.apply(this.context,r)),this.updating=!1)},getProxy:function(t){var e=this;return this.proxies[t.str]||(this.proxies[t.str]={update:function(){return e.reallyUpdate(t)}}),this.proxies[t.str]}};var Qu,Zu,Hu,Ku,Gu,Yu,Ju=zu,Xu=Et,th={},eh=At,nh=St,ih=function(t){return t.trim()},rh=function(t){return""!==t},sh=Ct,oh=Ot,ah=Pt,uh=Tt,hh=Array.prototype,ch=function(t){return function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o,a,u,h=[];if(e=E(C(e)),o=this.viewmodel.get(e),o.length,!s(o))throw new Error("Called ractive."+t+"('"+e.str+"'), but '"+e.str+"' does not refer to an array");return h=uh(o,t,i),u=hh[t].apply(o,i),a=hu.start(this,!0).then(function(){return u}),h?this.viewmodel.smartUpdate(e,o,h):this.viewmodel.mark(e),hu.end(),a}},lh=ch("pop"),fh=ch("push"),dh=[],ph=!1;Xo?((Hu=document.createElement("style")).type="text/css",Ku=document.getElementsByTagName("head")[0],Yu=!1,Gu=Hu.styleSheet,Zu=function(){var t="/* Ractive.js component styles */\n"+dh.map(function(t){return"\n/* {"+t.id+"} */\n"+t.styles}).join("\n");Gu?Gu.cssText=t:Hu.innerHTML=t,Yu||(Ku.appendChild(Hu),Yu=!0)},Qu={add:function(t){dh.push(t),ph=!0},apply:function(){ph&&(Zu(),ph=!1)}}):Qu={add:Ca,apply:Ca};var mh,vh,gh=Qu,yh=Rt,bh=new Ga("render"),wh=new Ga("complete"),xh={extend:function(t,e,n){e.adapt=Nt(e.adapt,N(n.adapt))},init:function(){}},kh=Dt,_h=/(?:^|\})?\s*([^\{\}]+)\s*\{/g,Eh=/\/\*.*?\*\//g,Ah=/((?:(?:\[[^\]+]\])|(?:[^\s\+\>\~:]))+)((?::[^\s\+\>\~\(]+(?:\([^\)]+\))?)?\s*[\s\+\>\~]?)\s*/g,Sh=/^@media/,Ch=/\[data-ractive-css~="\{[a-z0-9-]+\}"]/g,Oh=1,Ph={name:"css",extend:function(t,e,n){if(n.css){var i=Oh++,r=n.noCssTransform?n.css:kh(n.css,i);e.cssId=i,gh.add({id:i,styles:r})}},init:function(){}},Th={name:"data",extend:function(t,e,n){var i=void 0,r=void 0;if(n.data&&h(n.data))for(i in n.data)(r=n.data[i])&&"object"===(void 0===r?"undefined":_typeof(r))&&(h(r)||s(r))&&m("Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }");e.data=Mt(e.data,n.data)},init:function(t,e,n){var i=Mt(t.prototype.data,n.data);return"function"==typeof i&&(i=i.call(e)),i||{}},reset:function(t){var e=this.init(t.constructor,t,t.viewmodel);return t.viewmodel.reset(e),!0}},Fh=/^\s+/;(vh=function(t){this.name="ParseError",this.message=t;try{throw new Error(t)}catch(t){this.stack=t.stack}}).prototype=Error.prototype,(mh=function(t,e){var n,i,r=0;for(this.str=t,this.options=e||{},this.pos=0,this.lines=this.str.split("\n"),this.lineEnds=this.lines.map(function(t){var e=r+t.length+1;return r=e,e},0),this.init&&this.init(t,e),n=[];this.pos<this.str.length&&(i=this.read());)n.push(i);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(n,e):n}).prototype={read:function(t){var e,n,i,r;for(t||(t=this.converters),e=this.pos,i=t.length,n=0;n<i;n+=1)if(this.pos=e,r=t[n](this))return r;return null},getLinePos:function(t){for(var e,n=0,i=0;t>=this.lineEnds[n];)i=this.lineEnds[n],n+=1;return e=t-i,[n+1,e+1,t]},error:function(t){var e=this.getLinePos(this.pos),n=e[0],i=e[1],r=0,s=this.lines[e[0]-1].replace(/\t/g,function(t,n){return n<e[1]&&(r+=1),"  "})+"\n"+new Array(e[1]+r).join(" ")+"^----",o=new vh(t+" at line "+n+" character "+i+":\n"+s);throw o.line=e[0],o.character=e[1],o.shortMessage=t,o},matchString:function(t){if(this.str.substr(this.pos,t.length)===t)return this.pos+=t.length,t},matchPattern:function(t){var e;if(e=t.exec(this.remaining()))return this.pos+=e[0].length,e[1]||e[0]},allowWhitespace:function(){this.matchPattern(Fh)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)}},mh.extend=function(t){var e,n,i=this;(e=function(t,e){mh.call(this,t,e)}).prototype=ya(i.prototype);for(n in t)Ea.call(t,n)&&(e.prototype[n]=t[n]);return e.extend=mh.extend,e};var Rh,jh,Nh,Dh=mh,Ih=2,Lh=3,Vh=4,Mh=5,Uh=6,Wh=7,zh=8,Bh=9,qh=10,$h=13,Qh=14,Zh=15,Hh=16,Kh=17,Gh=18,Yh=20,Jh=21,Xh=22,tc=23,ec=24,nc=25,ic=26,rc=27,sc=30,oc=31,ac=32,uc=33,hc=34,cc=35,lc=36,fc=40,dc=50,pc=51,mc=52,vc=53,gc=54,yc=60,bc=61,wc=zt,xc=/^[^\s=]+/,kc=/^\s+/,_c=Bt,Ec=/^(\/(?:[^\n\r\u2028\u2029/\\[]|\\.|\[(?:[^\n\r\u2028\u2029\]\\]|\\.)*])+\/(?:([gimuy])(?![a-z]*\2))*(?![a-zA-Z_$0-9]))/,Ac=qt,Sc={t:qh,exclude:!0},Cc="Expected a JavaScript expression",Oc="Expected closing paren",Pc=Qt,Tc=/^(?:[+-]?)0*(?:(?:(?:[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,Fc=Zt;Rh=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,jh=/^\\(?:['"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,Nh=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/;var Rc,jc,Nc=function(t){return function(e){var n,i,r;for(e.pos,n='"',i=!1;!i;)(r=e.matchPattern(Rh)||e.matchPattern(jh)||e.matchString(t))?n+='"'===r?'\\"':"\\'"===r?"'":r:(r=e.matchPattern(Nh))?n+="\\u"+("000"+r.charCodeAt(1).toString(16)).slice(-4):i=!0;return n+='"',JSON.parse(n)}},Dc=Nc('"'),Ic=Nc("'"),Lc=function(t){var e,n;return e=t.pos,t.matchString('"')?(n=Ic(t),t.matchString('"')?{t:Jh,v:n}:(t.pos=e,null)):t.matchString("'")?(n=Dc(t),t.matchString("'")?{t:Jh,v:n}:(t.pos=e,null)):null},Vc=/^[a-zA-Z_$][a-zA-Z_$0-9]*/,Mc=Ht,Uc=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,Wc=Kt,zc=Gt,Bc=function(t){var e,n;return e=t.pos,t.allowWhitespace(),t.matchString("{")?(n=zc(t),t.allowWhitespace(),t.matchString("}")?{t:tc,m:n}:(t.pos=e,null)):(t.pos=e,null)},qc=Yt,$c=function(t){var e,n;return e=t.pos,t.allowWhitespace(),t.matchString("[")?(n=qc(t),t.matchString("]")?{t:Xh,m:n}:(t.pos=e,null)):(t.pos=e,null)},Qc=Jt,Zc=Xt,Hc=/^(?:~\/|(?:\.\.\/)+|\.\/(?:\.\.\/)*|\.)/;Rc=/^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null)\b/,jc=/^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;var Kc,Gc,Yc=/^[a-zA-Z$_0-9]+(?:(?:\.[a-zA-Z$_0-9]+)|(?:\[[0-9]+\]))*/,Jc=/^[a-zA-Z_$][-a-zA-Z_$0-9]*/,Xc=te,tl=function(t){return Qc(t)||Zc(t)||Xc(t)},el=ee,nl=function(t){var e,n,i;if(!(e=tl(t)))return null;for(;e;)if(t.pos,n=el(t))e={t:ac,x:e,r:n};else{if(!t.matchString("("))break;t.allowWhitespace(),i=qc(t),t.allowWhitespace(),t.matchString(")")||t.error(Oc),e={t:fc,x:e},i&&(e.o=i)}return e};Gc=function(t,e){return function(n){var i;return(i=e(n))?i:n.matchString(t)?(n.allowWhitespace(),(i=vl(n))||n.error(Cc),{s:t,o:i,t:uc}):null}},function(){var t,e,n,i;for(n="! ~ + - typeof".split(" "),i=nl,t=0,e=n.length;t<e;t+=1)i=Gc(n[t],i);Kc=i}();var il,rl,sl=Kc;rl=function(t,e){return function(n){var i,r,s;if(!(r=e(n)))return null;for(;;){if(i=n.pos,n.allowWhitespace(),!n.matchString(t))return n.pos=i,r;if("in"===t&&/[a-zA-Z_$0-9]/.test(n.remaining().charAt(0)))return n.pos=i,r;if(n.allowWhitespace(),!(s=e(n)))return n.pos=i,r;r={t:lc,s:t,o:[r,s]}}}},function(){var t,e,n,i;for(n="* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||".split(" "),i=sl,t=0,e=n.length;t<e;t+=1)i=rl(n[t],i);il=i}();var ol,al,ul,hl,cl,ll,fl,dl,pl=il,ml=ne,vl=ie,gl=re,yl=oe,bl=/^[0-9][1-9]*$/,wl=ue,xl=he,kl=ce,_l=le,El=fe,Al=de,Sl=pe,Cl=/^yield\s*/,Ol=me,Pl=ve,Tl=/^\s*else\s*/,Fl=ge,Rl=/^\s*elseif\s+/,jl={each:mc,if:dc,"if-with":gc,with:vc,unless:pc},Nl=ye,Dl=/^\s*:\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Il=/^\s*,\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Ll=new RegExp("^("+Object.keys(jl).join("|")+")\\b"),Vl=_e,Ml="\x3c!--",Ul="--\x3e";ol=/^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i,al=/^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i,ul={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},hl=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],cl=new RegExp("&(#?(?:x[\\w\\d]+|\\d+|"+Object.keys(ul).join("|")+"));?","g"),ll=/</g,fl=/>/g,dl=/&/g;var Wl,zl,Bl,ql,$l,Ql,Zl,Hl=/^\s*\r?\n/,Kl=/\r?\n\s*$/,Gl=function(t){var e,n,i,r,s;for(e=1;e<t.length;e+=1)n=t[e],i=t[e-1],r=t[e-2],Ce(n)&&Oe(i)&&Ce(r)&&Kl.test(r)&&Hl.test(n)&&(t[e-2]=r.replace(Kl,"\n"),t[e]=n.replace(Hl,"")),Pe(n)&&Ce(i)&&Kl.test(i)&&Ce(n.f[0])&&Hl.test(n.f[0])&&(t[e-1]=i.replace(Kl,"\n"),n.f[0]=n.f[0].replace(Hl,"")),Ce(n)&&Pe(i)&&Ce(s=D(i.f))&&Kl.test(s)&&Hl.test(n)&&(i.f[i.f.length-1]=s.replace(Kl,"\n"),t[e]=n.replace(Hl,""));return t},Yl=function(t,e,n){var i;e&&"string"==typeof(i=t[0])&&((i=i.replace(e,""))?t[0]=i:t.shift()),n&&"string"==typeof(i=D(t))&&((i=i.replace(n,""))?t[t.length-1]=i:t.pop())},Jl=Te,Xl=/[ \t\f\r\n]+/g,tf=/^(?:pre|script|style|textarea)$/i,ef=/^[ \t\f\r\n]+/,nf=/[ \t\f\r\n]+$/,rf=/^(?:\r\n|\r|\n)/,sf=/(?:\r\n|\r|\n)$/,of=Fe,af=/^([a-zA-Z]{1,}:?[a-zA-Z0-9\-]*)\s*\>/,uf=function(t,e){var n,i,r;for(n=e.length;n--;){if(!(i=t.indexOf(e[n])))return 0;-1!==i&&((!r||i<r)&&(r=i))}return r||-1},hf=Re,cf=/^[^\s"'>\/=]+/,lf=/^[^\s"'=<>`]+/;zl={true:!0,false:!1,undefined:void 0,null:null},Bl=new RegExp("^(?:"+Object.keys(zl).join("|")+")"),ql=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,$l=/\$\{([^\}]+)\}/g,Ql=/^\$\{([^\}]+)\}/,Zl=/^\s*$/,Wl=Dh.extend({init:function(t,e){this.values=e.values,this.allowWhitespace()},postProcess:function(t){return 1===t.length&&Zl.test(this.leftover)?{value:t[0].v}:null},converters:[function(t){var e;return t.values?(e=t.matchPattern(Ql),e&&t.values.hasOwnProperty(e)?{v:t.values[e]}:void 0):null},function(t){var e;if(e=t.matchPattern(Bl))return{v:zl[e]}},function(t){var e;if(e=t.matchPattern(ql))return{v:+e}},function(t){var e,n=Lc(t);return n&&(e=t.values)?{v:n.v.replace($l,function(t,n){return n in e?e[n]:n})}:n},function(t){var e,n;if(!t.matchString("{"))return null;if(e={},t.allowWhitespace(),t.matchString("}"))return{v:e};for(;n=Ve(t);){if(e[n.key]=n.value,t.allowWhitespace(),t.matchString("}"))return{v:e};if(!t.matchString(","))return null}return null},function(t){var e,n;if(!t.matchString("["))return null;if(e=[],t.allowWhitespace(),t.matchString("]"))return{v:e};for(;n=t.read();){if(e.push(n.v),t.allowWhitespace(),t.matchString("]"))return{v:e};if(!t.matchString(","))return null;t.allowWhitespace()}return null}]});var ff,df=function(t,e){return new Wl(t,{values:e}).result},pf=Me,mf=/^([a-zA-Z_$][a-zA-Z_$0-9]*)\(/,vf=/\)\s*$/;ff=Dh.extend({converters:[vl]});var gf,yf=/^[a-zA-Z]{1,}:?[a-zA-Z0-9\-]*/,bf=/^[\s\n\/>]/,wf=/^on/,xf=/^on-([a-zA-Z\\*\\.$_][a-zA-Z\\*\\.$_0-9\-]+)$/,kf=/^(?:change|reset|teardown|update|construct|config|init|render|unrender|detach|insert)$/,_f={"intro-outro":"t0",intro:"t1",outro:"t2",decorator:"o"},Ef={exclude:!0};gf={li:["li"],dt:["dt","dd"],dd:["dt","dd"],p:"address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul".split(" "),rt:["rt","rp"],rp:["rt","rp"],optgroup:["optgroup"],option:["option","optgroup"],thead:["tbody","tfoot"],tbody:["tbody","tfoot"],tfoot:["tbody"],tr:["tr","tbody"],td:["td","th","tr"],th:["td","th","tr"]};var Af,Sf=Be,Cf=/[-/\\^$*+?.()|[\]{}]/g,Of=/^<!--\s*/,Pf=/s*>\s*([a-zA-Z_$][-a-zA-Z_$0-9]*)\s*/,Tf=/\s*-->/,Ff=/^#\s*partial\s+/,Rf=Qe,jf=Ze,Nf=[kl,xl,Nl,Sl,Al,_l],Df=[wl],If=[xl,Nl,Al],Lf=void 0,Vf=[Ac,Vl,Ue,ze],Mf=[qe,$e];Lf=Dh.extend({init:function(t,e){var n=e.tripleDelimiters||["{{{","}}}"],i=e.staticDelimiters||["[[","]]"],r=e.staticTripleDelimiters||["[[[","]]]"];this.standardDelimiters=e.delimiters||["{{","}}"],this.tags=[{isStatic:!1,isTriple:!1,open:this.standardDelimiters[0],close:this.standardDelimiters[1],readers:Nf},{isStatic:!1,isTriple:!0,open:n[0],close:n[1],readers:Df},{isStatic:!0,isTriple:!1,open:i[0],close:i[1],readers:If},{isStatic:!0,isTriple:!0,open:r[0],close:r[1],readers:Df}],this.sortMustacheTags(),this.sectionDepth=0,this.elementStack=[],this.interpolate={script:!e.interpolate||!1!==e.interpolate.script,style:!e.interpolate||!1!==e.interpolate.style},!0===e.sanitize&&(e.sanitize={elements:"applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title".split(" "),eventAttributes:!0}),this.stripComments=!1!==e.stripComments,this.preserveWhitespace=e.preserveWhitespace,this.sanitizeElements=e.sanitize&&e.sanitize.elements,this.sanitizeEventAttributes=e.sanitize&&e.sanitize.eventAttributes,this.includeLinePositions=e.includeLinePositions},postProcess:function(t){return t.length?(this.sectionDepth>0&&this.error("A section was left open"),Jl(t[0].t,this.stripComments,this.preserveWhitespace,!this.preserveWhitespace,!this.preserveWhitespace),t[0]):{t:[],v:oa}},converters:[Rf],sortMustacheTags:function(){this.tags.sort(function(t,e){return e.open.length-t.open.length})}});var Uf,Wf,zf,Bf=["preserveWhitespace","sanitize","stripComments","delimiters","tripleDelimiters","interpolate"],qf={fromId:Ge,isHashedId:Ye,isParsed:Je,getParseOptions:Xe,createHelper:He,parse:Ke},$f=qf,Qf={name:"template",extend:function(t,e,n){var i;"template"in n&&(i=n.template,e.template="function"==typeof i?i:rn(i,e))},init:function(t,e,n){var i,r;"function"==typeof(i="template"in n?n.template:t.prototype.template)&&(i=en(e,r=i),e._config.template={fn:r,result:i}),i=rn(i,e),e.template=i.t,i.p&&sn(e.partials,i.p)},reset:function(t){var e,n=tn(t);if(n)return e=rn(n,t),t.template=e.t,sn(t.partials,e.p,!0),!0}};Uf=["adaptors","components","computed","decorators","easing","events","interpolators","partials","transitions"],(Wf=function(t,e){this.name=t,this.useDefaults=e}).prototype={constructor:Wf,extend:function(t,e,n){this.configure(this.useDefaults?t.defaults:t,this.useDefaults?e:e.constructor,n)},init:function(){},configure:function(t,e,n){var i,r=this.name,s=n[r];i=ya(t[r]);for(var o in s)i[o]=s[o];e[r]=i},reset:function(t){var e=t[this.name],n=!1;return Object.keys(e).forEach(function(t){var i=e[t];i._fn&&(i._fn.isOwner?e[t]=i._fn:delete e[t],n=!0)}),n}};var Zf,Hf,Kf,Gf,Yf,Jf,Xf=zf=Uf.map(function(t){return new Wf(t,"computed"===t)}),td=on,ed=cn;Gf={adapt:xh,css:Ph,data:Th,template:Qf},Kf=Object.keys(aa),Jf=dn(Kf.filter(function(t){return!Gf[t]})),Yf=dn(Kf.concat(Xf.map(function(t){return t.name})));var nd=Zf={extend:function(t,e,n){return ln("extend",t,e,n)},init:function(t,e,n){return ln("init",t,e,n)},reset:function(t){return Hf.filter(function(e){return e.reset&&e.reset(t)}).map(function(t){return t.name})},order:Hf=[].concat(Kf.filter(function(t){return!Xf[t]&&!Gf[t]}),Xf,Gf.data,Gf.template,Gf.css)},id=pn,rd=mn,sd=vn,od=gn,ad=yn,ud=bn,hd=wn,cd=xn,ld=kn,fd=_n,dd=En,pd=An,md=function(){return e(this.node)},vd=function(t){this.type=1,this.text=t.template};vd.prototype={detach:md,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createTextNode(this.text)),this.node},toString:function(t){return t?Se(this.text):this.text},unrender:function(t){if(t)return this.detach()}};var gd=vd,yd=Sn,bd=Cn,wd=function(t,e,n){var i;this.ref=e,this.resolved=!1,this.root=t.root,this.parentFragment=t.parentFragment,this.callback=n,void 0!=(i=nu(t.root,e,t.parentFragment))?this.resolve(i):hu.addUnresolved(this)};wd.prototype={resolve:function(t){this.keypath&&!t&&hu.addUnresolved(this),this.resolved=!0,this.keypath=t,this.callback(t)},forceResolution:function(){this.resolve(E(this.ref))},rebind:function(t,e){var n;void 0!=this.keypath&&void 0!==(n=this.keypath.replace(t,e))&&this.resolve(n)},unbind:function(){this.resolved||hu.removeUnresolved(this)}};var xd=wd,kd=function(t,e,n){this.parentFragment=t.parentFragment,this.ref=e,this.callback=n,this.rebind()},_d={"@keypath":{prefix:"c",prop:["context"]},"@index":{prefix:"i",prop:["index"]},"@key":{prefix:"k",prop:["key","index"]}};kd.prototype={rebind:function(){var t,e=this.ref,n=this.parentFragment,i=_d[e];if(!i)throw new Error('Unknown special reference "'+e+'" - valid references are @index, @key and @keypath');if(this.cached)return this.callback(E("@"+i.prefix+On(this.cached,i)));if(-1!==i.prop.indexOf("index")||-1!==i.prop.indexOf("key"))for(;n;){if(n.owner.currentSubtype===mc&&void 0!==(t=On(n,i)))return this.cached=n,n.registerIndexRef(this),this.callback(E("@"+i.prefix+t));n=!n.parent&&n.owner&&n.owner.component&&n.owner.component.parentFragment&&!n.owner.component.instance.isolated?n.owner.component.parentFragment:n.parent}else for(;n;){if(void 0!==(t=On(n,i)))return this.callback(E("@"+i.prefix+t.str));n=n.parent}},unbind:function(){this.cached&&this.cached.unregisterIndexRef(this)}};var Ed=kd,Ad=function(t,e,n){this.parentFragment=t.parentFragment,this.ref=e,this.callback=n,e.ref.fragment.registerIndexRef(this),this.rebind()};Ad.prototype={rebind:function(){var t,e=this.ref.ref;void 0!==(t="k"===e.ref.t?"k"+e.fragment.key:"i"+e.fragment.index)&&this.callback(E("@"+t))},unbind:function(){this.ref.ref.fragment.unregisterIndexRef(this)}};var Sd=Ad,Cd=Pn;Pn.resolve=function(t){var e,n,i={};for(e in t.refs)i[(n=t.refs[e]).ref.n]="k"===n.ref.t?n.fragment.key:n.fragment.index;return i};var Od,Pd=Tn,Td=Fn,Fd={},Rd=Function.prototype.bind;(Od=function(t,e,n,i){var r,s=this;r=t.root,this.root=r,this.parentFragment=e,this.callback=i,this.owner=t,this.str=n.s,this.keypaths=[],this.pending=n.r.length,this.refResolvers=n.r.map(function(t,e){return Pd(s,t,function(t){s.resolve(e,t)})}),this.ready=!0,this.bubble()}).prototype={bubble:function(){this.ready&&(this.uniqueString=jn(this.str,this.keypaths),this.keypath=Nn(this.uniqueString),this.createEvaluator(),this.callback(this.keypath))},unbind:function(){for(var t;t=this.refResolvers.pop();)t.unbind()},resolve:function(t,e){this.keypaths[t]=e,this.bubble()},createEvaluator:function(){var t,e,n,i,r=this;n=this.keypath,this.root.viewmodel.computations[n.str]?this.root.viewmodel.mark(n):(i=Td(this.str,this.refResolvers.length),t=this.keypaths.map(function(t){var e;return"undefined"===t?function(){}:t.isSpecial?(e=t.value,function(){return e}):function(){var e=r.root.viewmodel.get(t,{noUnwrap:!0,fullRootGet:!0});return"function"==typeof e&&(e=In(e,r.root)),e}}),e={deps:this.keypaths.filter(Dn),getter:function(){var e=t.map(Rn);return i.apply(null,e)}},this.root.viewmodel.compute(n,e))},rebind:function(t,e){this.refResolvers.forEach(function(n){return n.rebind(t,e)})}};var jd=Od,Nd=function(t,e,n){var i=this;this.resolver=e,this.root=e.root,this.parentFragment=n,this.viewmodel=e.root.viewmodel,"string"==typeof t?this.value=t:t.t===sc?this.refResolver=Pd(this,t.n,function(t){i.resolve(t)}):new jd(e,n,t,function(t){i.resolve(t)})};Nd.prototype={resolve:function(t){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.keypath=t,this.value=this.viewmodel.get(t),this.bind(),this.resolver.bubble()},bind:function(){this.viewmodel.register(this.keypath,this)},rebind:function(t,e){this.refResolver&&this.refResolver.rebind(t,e)},setValue:function(t){this.value=t,this.resolver.bubble()},unbind:function(){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.refResolver&&this.refResolver.unbind()},forceResolution:function(){this.refResolver&&this.refResolver.forceResolution()}};var Dd=Nd,Id=function(t,e,n){var i,r,s,o,a=this;this.parentFragment=o=t.parentFragment,this.root=i=t.root,this.mustache=t,this.ref=r=e.r,this.callback=n,this.unresolved=[],(s=nu(i,r,o))?this.base=s:this.baseResolver=new xd(this,r,function(t){a.base=t,a.baseResolver=null,a.bubble()}),this.members=e.m.map(function(t){return new Dd(t,a,o)}),this.ready=!0,this.bubble()};Id.prototype={getKeypath:function(){var t=this.members.map(Ln);return!t.every(Vn)||this.baseResolver?null:this.base.join(t.join("."))},bubble:function(){this.ready&&!this.baseResolver&&this.callback(this.getKeypath())},unbind:function(){this.members.forEach(Z)},rebind:function(t,e){var n;if(this.base){var i=this.base.replace(t,e);i&&i!==this.base&&(this.base=i,n=!0)}this.members.forEach(function(i){i.rebind(t,e)&&(n=!0)}),n&&this.bubble()},forceResolution:function(){this.baseResolver&&(this.base=E(this.ref),this.baseResolver.unbind(),this.baseResolver=null),this.members.forEach(Mn),this.bubble()}};var Ld=Id,Vd=zn,Md={getValue:bd,init:Un,resolve:Wn,rebind:Vd},Ud=function(t){this.type=Ih,Md.init(this,t)};Ud.prototype={update:function(){this.node.data=void 0==this.value?"":this.value},resolve:Md.resolve,rebind:Md.rebind,detach:md,unbind:yd,render:function(){return this.node||(this.node=document.createTextNode(n(this.value))),this.node},unrender:function(t){t&&e(this.node)},getValue:Md.getValue,setValue:function(t){var e;this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),a(t,this.value)||(this.value=t,this.parentFragment.bubble(),this.node&&hu.addView(this))},firstNode:function(){return this.node},toString:function(t){var e=""+n(this.value);return t?Se(e):e}};var Wd=Ud,zd=Bn,Bd=qn,qd=$n,$d=Qn,Qd=Zn,Zd=Hn,Hd=Kn,Kd=Gn,Gd=Yn,Yd=function(t,e){Md.rebind.call(this,t,e)},Jd=Xn,Xd=ti,tp=li,ep=fi,np=di,ip=vi,rp=function(t){this.type=Vh,this.subtype=this.currentSubtype=t.template.n,this.inverted=this.subtype===pc,this.pElement=t.pElement,this.fragments=[],this.fragmentsToCreate=[],this.fragmentsToRender=[],this.fragmentsToUnrender=[],t.template.i&&(this.indexRefs=t.template.i.split(",").map(function(t,e){return{n:t,t:0===e?"k":"i"}})),this.renderedFragments=[],this.length=0,Md.init(this,t)};rp.prototype={bubble:zd,detach:Bd,find:qd,findAll:$d,findAllComponents:Qd,findComponent:Zd,findNextNode:Hd,firstNode:Kd,getIndexRef:function(t){if(this.indexRefs)for(var e=this.indexRefs.length;e--;){var n=this.indexRefs[e];if(n.n===t)return n}},getValue:Md.getValue,shuffle:Gd,rebind:Yd,render:Jd,resolve:Md.resolve,setValue:Xd,toString:tp,unbind:ep,unrender:np,update:ip};var sp,op,ap=rp,up=gi,hp=yi,cp=bi,lp=wi,fp={};try{ha("table").innerHTML="foo"}catch(t){sp=!0,op={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}var dp=function(t,e,n){var i,r,s,o,a,u=[];if(null!=t&&""!==t){for(sp&&(r=op[e.tagName])?((i=xi("DIV")).innerHTML=r[0]+t+r[1],"SELECT"===(i=i.querySelector(".x")).tagName&&(s=i.options[i.selectedIndex])):e.namespaceURI===ia.svg?((i=xi("DIV")).innerHTML='<svg class="x">'+t+"</svg>",i=i.querySelector(".x")):((i=xi(e.tagName)).innerHTML=t,"SELECT"===i.tagName&&(s=i.options[i.selectedIndex]));o=i.firstChild;)u.push(o),n.appendChild(o);if("SELECT"===e.tagName)for(a=u.length;a--;)u[a]!==s&&(u[a].selected=!1)}return u},pp=ki,mp=Ei,vp=Ai,gp=Si,yp=Ci,bp=Oi,wp=function(t){this.type=Lh,Md.init(this,t)};wp.prototype={detach:up,find:hp,findAll:cp,firstNode:lp,getValue:Md.getValue,rebind:Md.rebind,render:mp,resolve:Md.resolve,setValue:vp,toString:gp,unbind:yd,unrender:yp,update:bp};var xp,kp,_p,Ep,Ap=wp,Sp=function(){this.parentFragment.bubble()},Cp=Pi,Op=function(t){return this.node?ca(this.node,t)?this.node:this.fragment&&this.fragment.find?this.fragment.find(t):void 0:null},Pp=function(t,e){e._test(this,!0)&&e.live&&(this.liveQueries||(this.liveQueries=[])).push(e),this.fragment&&this.fragment.findAll(t,e)},Tp=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},Fp=function(t){if(this.fragment)return this.fragment.findComponent(t)},Rp=Ti,jp=Fi,Np=Ri,Dp=/^true|on|yes|1$/i,Ip=/^[0-9]+$/,Lp=function(t,e){var n,i,r;return r=e.a||{},i={},void 0!==(n=r.twoway)&&(i.twoway=0===n||Dp.test(n)),void 0!==(n=r.lazy)&&(0!==n&&Ip.test(n)?i.lazy=parseInt(n):i.lazy=0===n||Dp.test(n)),i},Vp=ji;xp="altGlyph altGlyphDef altGlyphItem animateColor animateMotion animateTransform clipPath feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence foreignObject glyphRef linearGradient radialGradient textPath vkern".split(" "),kp="attributeName attributeType baseFrequency baseProfile calcMode clipPathUnits contentScriptType contentStyleType diffuseConstant edgeMode externalResourcesRequired filterRes filterUnits glyphRef gradientTransform gradientUnits kernelMatrix kernelUnitLength keyPoints keySplines keyTimes lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY repeatCount repeatDur requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox viewTarget xChannelSelector yChannelSelector zoomAndPan".split(" "),_p=function(t){for(var e={},n=t.length;n--;)e[t[n].toLowerCase()]=t[n];return e},Ep=_p(xp.concat(kp));var Mp=function(t){var e=t.toLowerCase();return Ep[e]||e},Up=function(t,e){var n,i;if(-1===(n=e.indexOf(":"))||"xmlns"===(i=e.substr(0,n)))t.name=t.element.namespace!==ia.html?Mp(e):e;else if(e=e.substring(n+1),t.name=Mp(e),t.namespace=ia[i.toLowerCase()],t.namespacePrefix=i,!t.namespace)throw'Unknown namespace ("'+i+'")'},Wp=Ni,zp=Di,Bp=Ii,qp=Li,$p={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor",class:"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",dirname:"dirName",for:"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},Qp=Vi,Zp=Ui,Hp=Wi,Kp=zi,Gp=Bi,Yp=qi,Jp=$i,Xp=Qi,tm=Zi,em=Hi,nm=Ki,im=Gi,rm=Yi,sm=Ji,om=Xi,am=function(t){this.init(t)};am.prototype={bubble:Vp,init:zp,rebind:Bp,render:qp,toString:Qp,unbind:Zp,update:om};var um,hm=am,cm=function(t,e){var n,i,r=[];for(n in e)"twoway"!==n&&"lazy"!==n&&e.hasOwnProperty(n)&&(i=new hm({element:t,name:n,value:e[n],root:t.root}),r[n]=i,"value"!==n&&r.push(i));return(i=r.value)&&r.push(i),r};"undefined"!=typeof document&&(um=ha("div"));var lm=function(t,e){this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.attributes=[],this.fragment=new zy({root:t.root,owner:this,template:[e]})};lm.prototype={bubble:function(){this.node&&this.update(),this.element.bubble()},rebind:function(t,e){this.fragment.rebind(t,e)},render:function(t){this.node=t,this.isSvg=t.namespaceURI===ia.svg,this.update()},unbind:function(){this.fragment.unbind()},update:function(){var t,e,n=this;t=this.fragment.toString(),e=tr(t,this.isSvg),this.attributes.filter(function(t){return er(e,t)}).forEach(function(t){n.node.removeAttribute(t.name)}),e.forEach(function(t){n.node.setAttribute(t.name,t.value)}),this.attributes=e},toString:function(){return this.fragment.toString()}};var fm=lm,dm=function(t,e){return e?e.map(function(e){return new fm(t,e)}):[]},pm=function(t){var e,n,i,r;if(this.element=t,this.root=t.root,this.attribute=t.attributes[this.name||"value"],e=this.attribute.interpolator,e.twowayBinding=this,n=e.keypath){if("}"===n.str.slice(-1))return v("Two-way binding does not work with expressions (`%s` on <%s>)",e.resolver.uniqueString,t.name,{ractive:this.root}),!1;if(n.isSpecial)return v("Two-way binding does not work with %s",e.resolver.ref,{ractive:this.root}),!1}else m("The %s being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity",e.template.r?"'"+e.template.r+"' reference":"expression",{ractive:this.root}),e.resolver.forceResolution(),n=e.keypath;this.attribute.isTwoway=!0,this.keypath=n,void 0===(i=this.root.viewmodel.get(n))&&this.getInitialValue&&void 0!==(i=this.getInitialValue())&&this.root.viewmodel.set(n,i),(r=nr(t))&&(this.resetValue=i,r.formBindings.push(this))};pm.prototype={handleChange:function(){var t=this;hu.start(this.root),this.attribute.locked=!0,this.root.viewmodel.set(this.keypath,this.getValue()),hu.scheduleTask(function(){return t.attribute.locked=!1}),hu.end()},rebound:function(){var t,e;(t=this.keypath)!==(e=this.attribute.interpolator.keypath)&&(I(this.root._twowayBindings[t.str],this),this.keypath=e,(this.root._twowayBindings[e.str]||(this.root._twowayBindings[e.str]=[])).push(this))},unbind:function(){}},pm.extend=function(t){var e,n=this;return e=function(t){pm.call(this,t),this.init&&this.init()},e.prototype=ya(n.prototype),i(e.prototype,t),e.extend=pm.extend,e};var mm,vm=pm,gm=ir,ym=mm=vm.extend({getInitialValue:function(){return""},getValue:function(){return this.element.node.value},render:function(){var t,e=this.element.node,n=!1;this.rendered=!0,t=this.root.lazy,!0===this.element.lazy?t=!0:!1===this.element.lazy?t=!1:u(this.element.lazy)?(t=!1,n=+this.element.lazy):u(t||"")&&(n=+t,t=!1,this.element.lazy=n),this.handler=n?sr:gm,e.addEventListener("change",gm,!1),t||(e.addEventListener("input",this.handler,!1),e.attachEvent&&e.addEventListener("keyup",this.handler,!1)),e.addEventListener("blur",rr,!1)},unrender:function(){var t=this.element.node;this.rendered=!1,t.removeEventListener("change",gm,!1),t.removeEventListener("input",this.handler,!1),t.removeEventListener("keyup",this.handler,!1),t.removeEventListener("blur",rr,!1)}}),bm=ym.extend({getInitialValue:function(){return this.element.fragment?this.element.fragment.toString():""},getValue:function(){return this.element.node.innerHTML}}),wm=or,xm={},km=vm.extend({name:"checked",init:function(){this.siblings=wm(this.root._guid,"radio",this.element.getAttribute("name")),this.siblings.push(this)},render:function(){var t=this.element.node;t.addEventListener("change",gm,!1),t.attachEvent&&t.addEventListener("click",gm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",gm,!1),t.removeEventListener("click",gm,!1)},handleChange:function(){hu.start(this.root),this.siblings.forEach(function(t){t.root.viewmodel.set(t.keypath,t.getValue())}),hu.end()},getValue:function(){return this.element.node.checked},unbind:function(){I(this.siblings,this)}}),_m=vm.extend({name:"name",init:function(){this.siblings=wm(this.root._guid,"radioname",this.keypath.str),this.siblings.push(this),this.radioName=!0},getInitialValue:function(){if(this.element.getAttribute("checked"))return this.element.getAttribute("value")},render:function(){var t=this.element.node;t.name="{{"+this.keypath.str+"}}",t.checked=this.root.viewmodel.get(this.keypath)==this.element.getAttribute("value"),t.addEventListener("change",gm,!1),t.attachEvent&&t.addEventListener("click",gm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",gm,!1),t.removeEventListener("click",gm,!1)},getValue:function(){var t=this.element.node;return t._ractive?t._ractive.value:t.value},handleChange:function(){this.element.node.checked&&vm.prototype.handleChange.call(this)},rebound:function(t,e){var n;vm.prototype.rebound.call(this,t,e),(n=this.element.node)&&(n.name="{{"+this.keypath.str+"}}")},unbind:function(){I(this.siblings,this)}}),Em=vm.extend({name:"name",getInitialValue:function(){return this.noInitialValue=!0,[]},init:function(){var t,e;this.checkboxName=!0,this.siblings=wm(this.root._guid,"checkboxes",this.keypath.str),this.siblings.push(this),this.noInitialValue&&(this.siblings.noInitialValue=!0),this.siblings.noInitialValue&&this.element.getAttribute("checked")&&(t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),t.push(e))},unbind:function(){I(this.siblings,this)},render:function(){var t,e,n=this.element.node;t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),s(t)?this.isChecked=R(t,e):this.isChecked=t==e,n.name="{{"+this.keypath.str+"}}",n.checked=this.isChecked,n.addEventListener("change",gm,!1),n.attachEvent&&n.addEventListener("click",gm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",gm,!1),t.removeEventListener("click",gm,!1)},changed:function(){var t=!!this.isChecked;return this.isChecked=this.element.node.checked,this.isChecked===t},handleChange:function(){this.isChecked=this.element.node.checked,vm.prototype.handleChange.call(this)},getValue:function(){return this.siblings.filter(ar).map(ur)}}),Am=vm.extend({name:"checked",render:function(){var t=this.element.node;t.addEventListener("change",gm,!1),t.attachEvent&&t.addEventListener("click",gm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",gm,!1),t.removeEventListener("click",gm,!1)},getValue:function(){return this.element.node.checked}}),Sm=vm.extend({getInitialValue:function(){var t,e,n,i,r=this.element.options;if(void 0===this.element.getAttribute("value")&&(e=t=r.length,t)){for(;e--;)if(r[e].getAttribute("selected")){n=r[e].getAttribute("value"),i=!0;break}if(!i)for(;++e<t;)if(!r[e].getAttribute("disabled")){n=r[e].getAttribute("value");break}return void 0!==n&&(this.element.attributes.value.value=n),n}},render:function(){this.element.node.addEventListener("change",gm,!1)},unrender:function(){this.element.node.removeEventListener("change",gm,!1)},setValue:function(t){this.root.viewmodel.set(this.keypath,t)},getValue:function(){var t,e,n,i;for(n=(t=this.element.node.options).length,e=0;e<n;e+=1)if(i=t[e],t[e].selected)return i._ractive?i._ractive.value:i.value},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,hu.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))}}),Cm=Sm.extend({getInitialValue:function(){return this.element.options.filter(function(t){return t.getAttribute("selected")}).map(function(t){return t.getAttribute("value")})},render:function(){this.element.node.addEventListener("change",gm,!1),void 0===this.root.viewmodel.get(this.keypath)&&this.handleChange()},unrender:function(){this.element.node.removeEventListener("change",gm,!1)},setValue:function(){throw new Error("TODO not implemented yet")},getValue:function(){var t,e,n,i,r,s;for(t=[],i=(e=this.element.node.options).length,n=0;n<i;n+=1)(r=e[n]).selected&&(s=r._ractive?r._ractive.value:r.value,t.push(s));return t},handleChange:function(){var t,e,n;return t=this.attribute,e=t.value,n=this.getValue(),void 0!==e&&j(n,e)||Sm.prototype.handleChange.call(this),this},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,hu.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))},updateModel:function(){void 0!==this.attribute.value&&this.attribute.value.length||this.root.viewmodel.set(this.keypath,this.initialValue)}}),Om=vm.extend({render:function(){this.element.node.addEventListener("change",gm,!1)},unrender:function(){this.element.node.removeEventListener("change",gm,!1)},getValue:function(){return this.element.node.files}}),Pm=ym.extend({getInitialValue:function(){},getValue:function(){var t=parseFloat(this.element.node.value);return isNaN(t)?void 0:t}}),Tm=hr,Fm=lr,Rm=fr,jm=dr,Nm=pr,Dm=/^event(?:\.(.+))?/,Im=yr,Lm=br,Vm={},Mm={touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,touchleave:!0},Um=xr,Wm=kr,zm=_r,Bm=Er,qm=Ar,$m=function(t,e,n){this.init(t,e,n)};$m.prototype={bubble:Fm,fire:Rm,getAction:jm,init:Nm,listen:Lm,rebind:Um,render:Wm,resolve:zm,unbind:Bm,unrender:qm};var Qm=$m,Zm=function(t,e){var n,i,r,s,o=[];for(i in e)if(e.hasOwnProperty(i))for(n=(r=i.split("-")).length;n--;)s=new Qm(t,r[n],e[i]),o.push(s);return o},Hm=function(t,e){var n,i,r,s=this;this.element=t,this.root=n=t.root,"string"!=typeof(i=e.n||e)&&(r=new zy({template:i,root:n,owner:t}),i=r.toString(),r.unbind(),""===i)||(e.a?this.params=e.a:e.d&&(this.fragment=new zy({template:e.d,root:n,owner:t}),this.params=this.fragment.getArgsList(),this.fragment.bubble=function(){this.dirtyArgs=this.dirtyValue=!0,s.params=this.getArgsList(),s.ready&&s.update()}),this.fn=g("decorators",n,i),this.fn||l(Fa(i,"decorator")))};Hm.prototype={init:function(){var t,e,n;if(t=this.element.node,this.params?(n=[t].concat(this.params),e=this.fn.apply(this.root,n)):e=this.fn.call(this.root,t),!e||!e.teardown)throw new Error("Decorator definition must return an object with a teardown method");this.actual=e,this.ready=!0},update:function(){this.actual.update?this.actual.update.apply(this.root,this.params):(this.actual.teardown(!0),this.init())},rebind:function(t,e){this.fragment&&this.fragment.rebind(t,e)},teardown:function(t){this.torndown=!0,this.ready&&this.actual.teardown(),!t&&this.fragment&&this.fragment.unbind()}};var Km,Gm,Ym,Jm=Hm,Xm=Rr,tv=jr,ev=Mr,nv=function(t){return t.replace(/-([a-zA-Z])/g,function(t,e){return e.toUpperCase()})};Xo?(Gm={},Ym=ha("div").style,Km=function(t){var e,n,i;if(t=nv(t),!Gm[t])if(void 0!==Ym[t])Gm[t]=t;else for(i=t.charAt(0).toUpperCase()+t.substring(1),e=sa.length;e--;)if(n=sa[e],void 0!==Ym[n+i]){Gm[t]=n+i;break}return Gm[t]}):Km=null;var iv,rv,sv=Km;Xo?(rv=window.getComputedStyle||null.getComputedStyle,iv=function(t){var e,n,i,r,o;if(e=rv(this.node),"string"==typeof t)return"0px"===(o=e[sv(t)])&&(o=0),o;if(!s(t))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(n={},i=t.length;i--;)r=t[i],"0px"===(o=e[sv(r)])&&(o=0),n[r]=o;return n}):iv=null;var ov=iv,av=function(t,e){var n;if("string"==typeof t)this.node.style[sv(t)]=e;else for(n in t)t.hasOwnProperty(n)&&(this.node.style[sv(n)]=t[n]);return this},uv=function(t){var e;this.duration=t.duration,this.step=t.step,this.complete=t.complete,"string"==typeof t.easing?(e=t.root.easing[t.easing])||(v(Fa(t.easing,"easing")),e=Ur):e="function"==typeof t.easing?t.easing:Ur,this.easing=e,this.start=Za(),this.end=this.start+this.duration,this.running=!0,fu.add(this)};uv.prototype={tick:function(t){var e,n;return!!this.running&&(t>this.end?(this.step&&this.step(1),this.complete&&this.complete(1),!1):(e=t-this.start,n=this.easing(e/this.duration),this.step&&this.step(n),!0))},stop:function(){this.abort&&this.abort(),this.running=!1}};var hv,cv,lv,fv,dv,pv,mv,vv,gv=uv,yv=new RegExp("^-(?:"+sa.join("|")+")-"),bv=function(t){return t.replace(yv,"")},wv=new RegExp("^(?:"+sa.join("|")+")([A-Z])"),xv=function(t){return t?(wv.test(t)&&(t="-"+t),t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})):""},kv={},_v={};Xo?(cv=ha("div").style,function(){void 0!==cv.transition?(lv="transition",fv="transitionend",dv=!0):void 0!==cv.webkitTransition?(lv="webkitTransition",fv="webkitTransitionEnd",dv=!0):dv=!1}(),lv&&(pv=lv+"Duration",mv=lv+"Property",vv=lv+"TimingFunction"),hv=function(t,e,n,i,r){setTimeout(function(){var s,o,a,u,h;u=function(){o&&a&&(t.root.fire(t.name+":end",t.node,t.isIntro),r())},s=(t.node.namespaceURI||"")+t.node.tagName,t.node.style[mv]=i.map(sv).map(xv).join(","),t.node.style[vv]=xv(n.easing||"linear"),t.node.style[pv]=n.duration/1e3+"s",h=function(e){var n;-1!==(n=i.indexOf(nv(bv(e.propertyName))))&&i.splice(n,1),i.length||(t.node.removeEventListener(fv,h,!1),a=!0,u())},t.node.addEventListener(fv,h,!1),setTimeout(function(){for(var r,c,l,f,d,p=i.length,v=[];p--;)f=i[p],r=s+f,dv&&!_v[r]&&(t.node.style[sv(f)]=e[f],kv[r]||(c=t.getStyle(f),kv[r]=t.getStyle(f)!=e[f],_v[r]=!kv[r],_v[r]&&(t.node.style[sv(f)]=c))),dv&&!_v[r]||(void 0===c&&(c=t.getStyle(f)),-1===(l=i.indexOf(f))?m("Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!",{node:t.node}):i.splice(l,1),d=/[^\d]*$/.exec(e[f])[0],v.push({name:sv(f),interpolator:Ra(parseFloat(c),parseFloat(e[f])),suffix:d}));v.length?new gv({root:t.root,duration:n.duration,easing:nv(n.easing||""),step:function(e){var n,i;for(i=v.length;i--;)n=v[i],t.node.style[n.name]=n.interpolator(e)+n.suffix},complete:function(){o=!0,u()}}):o=!0,i.length||(t.node.removeEventListener(fv,h,!1),a=!0,u())},0)},n.delay||0)}):hv=null;var Ev,Av,Sv,Cv,Ov,Pv=hv;if("undefined"!=typeof document){if(Ev="hidden",Ov={},Ev in document)Sv="";else for(Cv=sa.length;Cv--;)Av=sa[Cv],(Ev=Av+"Hidden")in document&&(Sv=Av);void 0!==Sv?(document.addEventListener(Sv+"visibilitychange",Wr),Wr()):("onfocusout"in document?(document.addEventListener("focusout",zr),document.addEventListener("focusin",Br)):(window.addEventListener("pagehide",zr),window.addEventListener("blur",zr),window.addEventListener("pageshow",Br),window.addEventListener("focus",Br)),Ov.hidden=!1)}var Tv,Fv,Rv,jv=Ov;Xo?(Fv=window.getComputedStyle||null.getComputedStyle,Tv=function(t,e,n){var i,r=this;if(4===arguments.length)throw new Error("t.animateStyle() returns a promise - use .then() instead of passing a callback");return jv.hidden?(this.setStyle(t,e),Rv||(Rv=tu.resolve())):("string"==typeof t?(i={})[t]=e:(i=t,n=e),n||(v('The "%s" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340',this.name),n=this),new tu(function(t){var e,s,o,a,u,h;if(!n.duration)return r.setStyle(i),void t();for(e=Object.keys(i),s=[],o=Fv(r.node),{},u=e.length;u--;)h=e[u],"0px"===(a=o[sv(h)])&&(a=0),a!=i[h]&&(s.push(h),r.node.style[sv(h)]=a);s.length?Pv(r,i,n,s,t):t()}))}):Tv=null;var Nv=Tv,Dv=function(t,e){return"number"==typeof t?t={duration:t}:"string"==typeof t?t="slow"===t?{duration:600}:"fast"===t?{duration:200}:{duration:400}:t||(t={}),r({})},Iv=qr,Lv=function(t,e,n){this.init(t,e,n)};Lv.prototype={init:ev,start:Iv,getStyle:ov,setStyle:av,animateStyle:Nv,processParams:Dv};var Vv,Mv,Uv=Lv,Wv=Qr;Vv=function(){var t=this.node,e=this.fragment.toString(!1);if(window&&window.appearsToBeIELessEqual8&&(t.type="text/css"),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},Mv=function(){this.node.type&&"text/javascript"!==this.node.type||m("Script tag was updated. This does not cause the code to be re-evaluated!",{ractive:this.root}),this.node.text=this.fragment.toString(!1)};var zv=function(){var t,e;return this.template.y?"<!DOCTYPE"+this.template.dd+">":(t="<"+this.template.e,t+=this.attributes.map(Jr).join("")+this.conditionalAttributes.map(Jr).join(""),"option"===this.name&&Gr(this)&&(t+=" selected"),"input"===this.name&&Yr(this)&&(t+=" checked"),t+=">","textarea"===this.name&&void 0!==this.getAttribute("value")?t+=Se(this.getAttribute("value")):void 0!==this.getAttribute("contenteditable")&&(t+=this.getAttribute("value")||""),this.fragment&&(e="script"!==this.name&&"style"!==this.name,t+=this.fragment.toString(e)),al.test(this.template.e)||(t+="</"+this.template.e+">"),t)},Bv=Xr,qv=ts,$v=function(t){this.init(t)};$v.prototype={bubble:Sp,detach:Cp,find:Op,findAll:Pp,findAllComponents:Tp,findComponent:Fp,findNextNode:Rp,firstNode:jp,getAttribute:Np,init:Xm,rebind:tv,render:Wv,toString:zv,unbind:Bv,unrender:qv};var Qv=$v,Zv=/^\s*$/,Hv=/^\s*/,Kv=function(t){var e,n,i,r;return e=t.split("\n"),void 0!==(n=e[0])&&Zv.test(n)&&e.shift(),void 0!==(i=D(e))&&Zv.test(i)&&e.pop(),(r=e.reduce(ns,null))&&(t=e.map(function(t){return t.replace(r,"")}).join("\n")),t},Gv=is,Yv=function(t,e){return e?t.split("\n").map(function(t,n){return n?e+t:t}).join("\n"):t},Jv=function(t){var e,n;e=this.parentFragment=t.parentFragment,this.root=e.root,this.type=zh,this.index=t.index,this.name=t.template.r,this.rendered=!1,this.fragment=this.fragmentToRender=this.fragmentToUnrender=null,Md.init(this,t),this.keypath||((n=Gv(this.root,this.name,e))?(yd.call(this),this.isNamed=!0,this.setTemplate(n)):v('Could not find template for partial "%s"',this.name))};Jv.prototype={bubble:function(){this.parentFragment.bubble()},detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},firstNode:function(){return this.fragment.firstNode()},findNextNode:function(){return this.parentFragment.findNextNode(this)},getPartialName:function(){return this.isNamed&&this.name?this.name:void 0===this.value?this.name:this.value},getValue:function(){return this.fragment.getValue()},rebind:function(t,e){this.isNamed||Vd.call(this,t,e),this.fragment&&this.fragment.rebind(t,e)},render:function(){return this.docFrag=document.createDocumentFragment(),this.update(),this.rendered=!0,this.docFrag},resolve:Md.resolve,setValue:function(t){var e;void 0!==t&&t===this.value||(void 0!==t&&(e=Gv(this.root,""+t,this.parentFragment)),!e&&this.name&&(e=Gv(this.root,this.name,this.parentFragment))&&(yd.call(this),this.isNamed=!0),e||v('Could not find template for partial "%s"',this.name,{ractive:this.root}),this.value=t,this.setTemplate(e||[]),this.bubble(),this.rendered&&hu.addView(this))},setTemplate:function(t){this.fragment&&(this.fragment.unbind(),this.rendered&&(this.fragmentToUnrender=this.fragment)),this.fragment=new zy({template:t,root:this.root,owner:this,pElement:this.parentFragment.pElement}),this.fragmentToRender=this.fragment},toString:function(t){var e,n,i,r;return e=this.fragment.toString(t),(n=this.parentFragment.items[this.index-1])&&1===n.type?(i=n.text.split("\n").pop(),(r=/^\s+$/.exec(i))?Yv(e,r[0]):e):e},unbind:function(){this.isNamed||yd.call(this),this.fragment&&this.fragment.unbind()},unrender:function(t){this.rendered&&(this.fragment&&this.fragment.unrender(t),this.rendered=!1)},update:function(){var t,e;this.fragmentToUnrender&&(this.fragmentToUnrender.unrender(!0),this.fragmentToUnrender=null),this.fragmentToRender&&(this.docFrag.appendChild(this.fragmentToRender.render()),this.fragmentToRender=null),this.rendered&&(t=this.parentFragment.getNode(),e=this.parentFragment.findNextNode(this),t.insertBefore(this.docFrag,e))}};var Xv,tg,eg=Jv,ng=us,ig=hs,rg=new Ga("detach"),sg=cs,og=ls,ag=fs,ug=ds,hg=ps,cg=ms,lg=function(t,e,n,i){var r=t.root,s=t.keypath;i?r.viewmodel.smartUpdate(s,e,i):r.viewmodel.mark(s)},fg=[],dg=["pop","push","reverse","shift","sort","splice","unshift"];dg.forEach(function(t){ba(fg,t,{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r,s,o,a;for(r=uh(this,t,n),s=Array.prototype[t].apply(this,arguments),hu.start(),this._ractive.setting=!0,a=this._ractive.wrappers.length;a--;)o=this._ractive.wrappers[a],hu.addRactive(o.root),lg(o,this,0,r);return hu.end(),this._ractive.setting=!1,s}})}),{}.__proto__?(Xv=function(t){t.__proto__=fg},tg=function(t){t.__proto__=Array.prototype}):(Xv=function(t){var e,n;for(e=dg.length;e--;)n=dg[e],ba(t,n,{value:fg[n],configurable:!0})},tg=function(t){var e;for(e=dg.length;e--;)delete t[dg[e]]}),Xv.unpatch=tg;var pg,mg,vg,gg=Xv;pg={filter:function(t){return s(t)&&(!t._ractive||!t._ractive.setting)},wrap:function(t,e,n){return new mg(t,e,n)}},(mg=function(t,e,n){this.root=t,this.value=e,this.keypath=E(n),e._ractive||(ba(e,"_ractive",{value:{wrappers:[],instances:[],setting:!1},configurable:!0}),gg(e)),e._ractive.instances[t._guid]||(e._ractive.instances[t._guid]=0,e._ractive.instances.push(t)),e._ractive.instances[t._guid]+=1,e._ractive.wrappers.push(this)}).prototype={get:function(){return this.value},teardown:function(){var t,e,n,i,r;if(t=this.value,e=t._ractive,n=e.wrappers,i=e.instances,e.setting)return!1;if(-1===(r=n.indexOf(this)))throw new Error(vg);if(n.splice(r,1),n.length){if(i[this.root._guid]-=1,!i[this.root._guid]){if(-1===(r=i.indexOf(this.root)))throw new Error(vg);i.splice(r,1)}}else delete t._ractive,gg.unpatch(this.value)}},vg="Something went wrong in a rather interesting way";var yg,bg,wg=pg,xg=/^\s*[0-9]+\s*$/,kg=function(t){return xg.test(t)?[]:{}};try{Object.defineProperty({},"test",{value:0}),yg={filter:function(t,e,n){var i,r;return!!e&&(e=E(e),!((i=n.viewmodel.wrapped[e.parent.str])&&!i.magic)&&(r=n.viewmodel.get(e.parent),(!s(r)||!/^[0-9]+$/.test(e.lastKey))&&(r&&("object"===(void 0===r?"undefined":_typeof(r))||"function"==typeof r))))},wrap:function(t,e,n){return new bg(t,e,n)}},(bg=function(t,e,n){var i,r,s;n=E(n),this.magic=!0,this.ractive=t,this.keypath=n,this.value=e,this.prop=n.lastKey,i=n.parent,this.obj=i.isRoot?t.viewmodel.data:t.viewmodel.get(i),(r=this.originalDescriptor=Object.getOwnPropertyDescriptor(this.obj,this.prop))&&r.set&&(s=r.set._ractiveWrappers)?-1===s.indexOf(this)&&s.push(this):vs(this,e,r)}).prototype={get:function(){return this.value},reset:function(t){if(!this.updating)return this.updating=!0,this.obj[this.prop]=t,hu.addRactive(this.ractive),this.ractive.viewmodel.mark(this.keypath,{keepExistingWrapper:!0}),this.updating=!1,!0},set:function(t,e){this.updating||(this.obj[this.prop]||(this.updating=!0,this.obj[this.prop]=kg(t),this.updating=!1),this.obj[this.prop][t]=e)},teardown:function(){var t,e,n,i,r;if(this.updating)return!1;(e=(t=Object.getOwnPropertyDescriptor(this.obj,this.prop))&&t.set)&&(-1!==(r=(i=e._ractiveWrappers).indexOf(this))&&i.splice(r,1),i.length||(n=this.obj[this.prop],Object.defineProperty(this.obj,this.prop,this.originalDescriptor||{writable:!0,enumerable:!0,configurable:!0}),this.obj[this.prop]=n))}}}catch(t){yg=!1}var _g,Eg,Ag=yg;Ag&&(_g={filter:function(t,e,n){return Ag.filter(t,e,n)&&wg.filter(t)},wrap:function(t,e,n){return new Eg(t,e,n)}},(Eg=function(t,e,n){this.value=e,this.magic=!0,this.magicWrapper=Ag.wrap(t,e,n),this.arrayWrapper=wg.wrap(t,e,n)}).prototype={get:function(){return this.value},teardown:function(){this.arrayWrapper.teardown(),this.magicWrapper.teardown()},reset:function(t){return this.magicWrapper.reset(t)}});var Sg=_g,Cg=gs,Og={},Pg=ws,Tg=xs,Fg=Es,Rg=Ps,jg=Ts,Ng=function(t,e){this.computation=t,this.viewmodel=t.viewmodel,this.ref=e,this.root=this.viewmodel.ractive,this.parentFragment=this.root.component&&this.root.component.parentFragment};Ng.prototype={resolve:function(t){this.computation.softDeps.push(t),this.computation.unresolvedDeps[t.str]=null,this.viewmodel.register(t,this.computation,"computed")}};var Dg=Ng,Ig=function(t,e){this.key=t,this.getter=e.getter,this.setter=e.setter,this.hardDeps=e.deps||[],this.softDeps=[],this.unresolvedDeps={},this.depValues={},this._dirty=this._firstRun=!0};Ig.prototype={constructor:Ig,init:function(t){var e,n=this;this.viewmodel=t,this.bypass=!0,e=t.get(this.key),t.clearCache(this.key.str),this.bypass=!1,this.setter&&void 0!==e&&this.set(e),this.hardDeps&&this.hardDeps.forEach(function(e){return t.register(e,n,"computed")})},invalidate:function(){this._dirty=!0},get:function(){var t,e=this,n=!1;if(this.getting)return p("The "+this.key.str+" computation indirectly called itself. This probably indicates a bug in the computation. It is commonly caused by `array.sort(...)` - if that's the case, clone the array first with `array.slice().sort(...)`"),this.value;if(this.getting=!0,this._dirty){if(this._firstRun||!this.hardDeps.length&&!this.softDeps.length?n=!0:[this.hardDeps,this.softDeps].forEach(function(t){var i,r,s;if(!n)for(s=t.length;s--;)if(i=t[s],r=e.viewmodel.get(i),!a(r,e.depValues[i.str]))return e.depValues[i.str]=r,void(n=!0)}),n){this.viewmodel.capture();try{this.value=this.getter()}catch(t){m('Failed to compute "%s"',this.key.str),f(t.stack||t),this.value=void 0}t=this.viewmodel.release(),this.updateDependencies(t)&&[this.hardDeps,this.softDeps].forEach(function(t){t.forEach(function(t){e.depValues[t.str]=e.viewmodel.get(t)})})}this._dirty=!1}return this.getting=this._firstRun=!1,this.value},set:function(t){if(this.setting)this.value=t;else{if(!this.setter)throw new Error("Computed properties without setters are read-only. (This may change in a future version of Ractive!)");this.setter(t)}},updateDependencies:function(t){var e,n,i,r,s;for(e=(n=this.softDeps).length;e--;)i=n[e],-1===t.indexOf(i)&&(r=!0,this.viewmodel.unregister(i,this,"computed"));for(e=t.length;e--;)i=t[e],-1!==n.indexOf(i)||this.hardDeps&&-1!==this.hardDeps.indexOf(i)||(r=!0,Fs(this.viewmodel,i)&&!this.unresolvedDeps[i.str]?(s=new Dg(this,i.str),t.splice(e,1),this.unresolvedDeps[i.str]=s,hu.addUnresolved(s)):this.viewmodel.register(i,this,"computed"));return r&&(this.softDeps=t.slice()),r}};var Lg=Ig,Vg=Rs,Mg={FAILED_LOOKUP:!0},Ug=js,Wg={},zg=Ds,Bg=Is,qg=function(t,e){this.localKey=t,this.keypath=e.keypath,this.origin=e.origin,this.deps=[],this.unresolved=[],this.resolved=!1};qg.prototype={forceResolution:function(){this.keypath=this.localKey,this.setup()},get:function(t,e){if(this.resolved)return this.origin.get(this.map(t),e)},getValue:function(){if(this.keypath)return this.origin.get(this.keypath)},initViewmodel:function(t){this.local=t,this.setup()},map:function(t){return void 0===_typeof(this.keypath)?this.localKey:t.replace(this.localKey,this.keypath)},register:function(t,e,n){this.deps.push({keypath:t,dep:e,group:n}),this.resolved&&this.origin.register(this.map(t),e,n)},resolve:function(t){void 0!==this.keypath&&this.unbind(!0),this.keypath=t,this.setup()},set:function(t,e){this.resolved||this.forceResolution(),this.origin.set(this.map(t),e)},setup:function(){var t=this;void 0!==this.keypath&&(this.resolved=!0,this.deps.length&&(this.deps.forEach(function(e){var n=t.map(e.keypath);if(t.origin.register(n,e.dep,e.group),e.dep.setValue)e.dep.setValue(t.origin.get(n));else{if(!e.dep.invalidate)throw new Error("An unexpected error occurred. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");e.dep.invalidate()}}),this.origin.mark(this.keypath)))},setValue:function(t){if(!this.keypath)throw new Error("Mapping does not have keypath, cannot set value. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");this.origin.set(this.keypath,t)},unbind:function(t){var e=this;t||delete this.local.mappings[this.localKey],this.resolved&&(this.deps.forEach(function(t){e.origin.unregister(e.map(t.keypath),t.dep,t.group)}),this.tracker&&this.origin.unregister(this.keypath,this.tracker))},unregister:function(t,e,n){var i,r;if(this.resolved){for(r=(i=this.deps).length;r--;)if(i[r].dep===e){i.splice(r,1);break}this.origin.unregister(this.map(t),e,n)}}};var $g=Ls,Qg=function(t,e){var n,i,r;return n={},i=0,t.map(function(t,s){var o,a,u;a=i,u=e.length;do{if(-1===(o=e.indexOf(t,a)))return r=!0,-1;a=o+1}while(n[o]&&a<u);return o===i&&(i+=1),o!==s&&(r=!0),n[o]=!0,o})},Zg=Vs,Hg={},Kg=Ws,Gg=Bs,Yg=qs,Jg=$s,Xg=Zs,ty={implicit:!0},ey={noCascade:!0},ny=Ks,iy=Gs,ry=function(t){var e,n,i=t.adapt,r=t.data,s=t.ractive,o=t.computed,a=t.mappings;this.ractive=s,this.adaptors=i,this.onchange=t.onchange,this.cache={},this.cacheMap=ya(null),this.deps={computed:ya(null),default:ya(null)},this.depsMap={computed:ya(null),default:ya(null)},this.patternObservers=[],this.specials=ya(null),this.wrapped=ya(null),this.computations=ya(null),this.captureGroups=[],this.unresolvedImplicitDependencies=[],this.changes=[],this.implicitChanges={},this.noCascade={},this.data=r,this.mappings=ya(null);for(e in a)this.map(E(e),a[e]);if(r)for(e in r)(n=this.mappings[e])&&void 0===n.getValue()&&n.setValue(r[e]);for(e in o)a&&e in a&&l("Cannot map to a computed property ('%s')",e),this.compute(E(e),o[e]);this.ready=!0};ry.prototype={adapt:Cg,applyChanges:Fg,capture:Rg,clearCache:jg,compute:Vg,get:Ug,init:zg,map:Bg,mark:$g,merge:Zg,register:Kg,release:Gg,reset:Yg,set:Jg,smartUpdate:Xg,teardown:ny,unregister:iy};var sy=ry;Js.prototype={constructor:Js,begin:function(t){this.inProcess[t._guid]=!0},end:function(t){var e=t.parent;e&&this.inProcess[e._guid]?Xs(this.queue,e).push(t):to(this,t),delete this.inProcess[t._guid]}};var oy=Js,ay=eo,uy=/\$\{([^\}]+)\}/g,hy=new Ga("construct"),cy=new Ga("config"),ly=new oy("init"),fy=0,dy=["adaptors","components","decorators","easing","events","interpolators","partials","transitions"],py=so,my=co;co.prototype={bubble:function(){this.dirty||(this.dirty=!0,hu.addView(this))},update:function(){this.callback(this.fragment.getValue()),this.dirty=!1},rebind:function(t,e){this.fragment.rebind(t,e)},unbind:function(){this.fragment.unbind()}};var vy=function(t,e,n,r,o){var a,u,h,c,l,f,d={},p={},v={},g=[];for(u=t.parentFragment,h=t.root,i(d,o=o||{}),o.content=r||[],d[""]=o.content,e.defaults.el&&m("The <%s/> component has a default `el` property; it has been disregarded",t.name),c=u;c;){if(c.owner.type===Hh){l=c.owner.container;break}c=c.parent}return n&&Object.keys(n).forEach(function(e){var i,r,o=n[e];if("string"==typeof o)i=df(o),p[e]=i?i.value:o;else if(0===o)p[e]=!0;else{if(!s(o))throw new Error("erm wut");fo(o)?(v[e]={origin:t.root.viewmodel,keypath:void 0},r=lo(t,o[0],function(t){t.isSpecial?f?a.set(e,t.value):(p[e]=t.value,delete v[e]):f?a.viewmodel.mappings[e].resolve(t):v[e].keypath=t})):r=new my(t,o,function(t){f?a.set(e,t):p[e]=t}),g.push(r)}}),a=ya(e.prototype),py(a,{el:null,append:!0,data:p,partials:o,magic:h.magic||e.defaults.magic,modifyArrays:h.modifyArrays,adapt:h.adapt},{parent:h,component:t,container:l,mappings:v,inlinePartials:d,cssIds:u.cssIds}),f=!0,t.resolvers=g,a},gy=po,yy=function(t){var e,n;for(e=t.root;e;)(n=e._liveComponentQueries["_"+t.name])&&n.push(t.instance),e=e.parent},by=vo,wy=go,xy=yo,ky=bo,_y=wo,Ey=new Ga("teardown"),Ay=ko,Sy=function(t,e){this.init(t,e)};Sy.prototype={detach:ig,find:sg,findAll:og,findAllComponents:ag,findComponent:ug,findNextNode:hg,firstNode:cg,init:by,rebind:wy,render:xy,toString:ky,unbind:_y,unrender:Ay};var Cy=Sy,Oy=function(t){this.type=Bh,this.value=t.template.c};Oy.prototype={detach:md,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createComment(this.value)),this.node},toString:function(){return"\x3c!--"+this.value+"--\x3e"},unrender:function(t){t&&this.node.parentNode.removeChild(this.node)}};var Py=Oy,Ty=function(t){var e,n;this.type=Hh,this.container=e=t.parentFragment.root,this.component=n=e.component,this.container=e,this.containerFragment=t.parentFragment,this.parentFragment=n.parentFragment;var i=this.name=t.template.n||"",r=e._inlinePartials[i];r||(m('Could not find template for partial "'+i+'"',{ractive:t.root}),r=[]),this.fragment=new zy({owner:this,root:e.parent,template:r,pElement:this.containerFragment.pElement}),s(n.yielders[i])?n.yielders[i].push(this):n.yielders[i]=[this],hu.scheduleTask(function(){if(n.yielders[i].length>1)throw new Error("A component template can only have one {{yield"+(i?" "+i:"")+"}} declaration at a time")})};Ty.prototype={detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},findNextNode:function(){return this.containerFragment.findNextNode(this)},firstNode:function(){return this.fragment.firstNode()},getValue:function(t){return this.fragment.getValue(t)},render:function(){return this.fragment.render()},unbind:function(){this.fragment.unbind()},unrender:function(t){this.fragment.unrender(t),I(this.component.yielders[this.name],this)},rebind:function(t,e){this.fragment.rebind(t,e)},toString:function(){return this.fragment.toString()}};var Fy=Ty,Ry=function(t){this.declaration=t.template.a};Ry.prototype={init:Ca,render:Ca,unrender:Ca,teardown:Ca,toString:function(){return"<!DOCTYPE"+this.declaration+">"}};var jy=Ry,Ny=_o,Dy=Ao,Iy=So,Ly=Co,Vy=To,My=Ro,Uy=function(t){this.init(t)};Uy.prototype={bubble:id,detach:rd,find:sd,findAll:od,findAllComponents:ad,findComponent:ud,findNextNode:hd,firstNode:cd,getArgsList:fd,getNode:dd,getValue:pd,init:Ny,rebind:Dy,registerIndexRef:function(t){var e=this.registeredIndexRefs;-1===e.indexOf(t)&&e.push(t)},render:Iy,toString:Ly,unbind:Vy,unregisterIndexRef:function(t){var e=this.registeredIndexRefs;e.splice(e.indexOf(t),1)},unrender:My};var Wy,zy=Uy,By=jo,qy=["template","partials","components","decorators","events"],$y=new Ga("reset"),Qy=function(t,e){function n(e,i,r){r&&r.partials[t]||e.forEach(function(e){e.type===zh&&e.getPartialName()===t&&i.push(e),e.fragment&&n(e.fragment.items,i,r),s(e.fragments)?n(e.fragments,i,r):s(e.items)?n(e.items,i,r):e.type===Zh&&e.instance&&n(e.instance.fragment.items,i,e.instance),e.type===Wh&&(s(e.attributes)&&n(e.attributes,i,r),s(e.conditionalAttributes)&&n(e.conditionalAttributes,i,r))})}var i,r=[];return n(this.fragment.items,r),this.partials[t]=e,i=hu.start(this,!0),r.forEach(function(e){e.value=void 0,e.setValue(t)}),hu.end(),i},Zy=No,Hy=ch("reverse"),Ky=Do,Gy=ch("shift"),Yy=ch("sort"),Jy=ch("splice"),Xy=Lo,tb=Vo,eb=new Ga("teardown"),nb=Uo,ib=Wo,rb=zo,sb=new Ga("unrender"),ob=ch("unshift"),ab=Bo,ub=new Ga("update"),hb={add:qa,animate:mu,detach:gu,find:bu,findAll:Ou,findAllComponents:Pu,findComponent:Tu,findContainer:Fu,findParent:Ru,fire:Du,get:Iu,insert:Vu,merge:Uu,observe:eh,observeOnce:nh,off:sh,on:oh,once:ah,pop:lh,push:fh,render:yh,reset:By,resetPartial:Qy,resetTemplate:Zy,reverse:Hy,set:Ky,shift:Gy,sort:Yy,splice:Jy,subtract:Xy,teardown:tb,toggle:nb,toHTML:ib,toHtml:ib,unrender:rb,unshift:ob,update:ab,updateModel:qo},cb=function(t,e,n){return n||Qo(t,e)?function(){var n,i="_super"in this,r=this._super;return this._super=e,n=t.apply(this,arguments),i&&(this._super=r),n}:t},lb=Zo;wa(Wy=function(t){if(!(this instanceof Wy))return new Wy(t);py(this,t)},{DEBUG:{writable:!0,value:!0},DEBUG_PROMISES:{writable:!0,value:!0},extend:{value:Yo},getNodeInfo:{value:function(t){var e,n,i={};return t&&(e=t._ractive)?(i.ractive=e.root,i.keypath=e.keypath.str,i.index={},(n=Cd(e.proxy.parentFragment))&&(i.index=Cd.resolve(n)),i):i}},parse:{value:jf},Promise:{value:tu},svg:{value:ra},magic:{value:na},VERSION:{value:"0.7.3"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:ua},events:{writable:!0,value:{}},interpolators:{writable:!0,value:ja},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}}}),Wy.prototype=i(hb,aa),Wy.prototype.constructor=Wy,Wy.defaults=Wy.prototype;if("function"!==_typeof(Date.now)||"function"!==_typeof(String.prototype.trim)||"function"!==_typeof(Object.keys)||"function"!==_typeof(Array.prototype.indexOf)||"function"!==_typeof(Array.prototype.forEach)||"function"!==_typeof(Array.prototype.map)||"function"!==_typeof(Array.prototype.filter)||"undefined"!=typeof window&&"function"!==_typeof(window.addEventListener))throw new Error("It looks like you're attempting to use Ractive.js in an older browser. You'll need to use one of the 'legacy builds' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.");var fb=Wy;return fb});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/ractive-decorators-sortable.js */
!function(e,t){"use strict";if("undefined"!=typeof module&&module.exports&&"function"==typeof require)t(require("Ractive"));else if("function"==typeof define&&define.amd)define(["Ractive"],t);else{if(!e.Ractive)throw new Error("Could not find Ractive! It must be loaded before the Ractive-decorators-sortable plugin");t(e.Ractive)}}("undefined"!=typeof window?window:this,function(e){"use strict";var t,r,n,s,a,o,i,d,f,v,u,c,l;(t=function(e){return e.draggable=!0,l=$(e).find(".drag-handle"),e.addEventListener("dragstart",o,!1),e.addEventListener("dragenter",i,!1),e.addEventListener("dragleave",d,!1),e.addEventListener("drop",d,!1),e.addEventListener("dragover",f,!1),e.addEventListener("mousedown",u,!1),{teardown:function(){e.removeEventListener("mousedown",u,!1),e.removeEventListener("dragstart",o,!1),e.removeEventListener("dragenter",i,!1),e.removeEventListener("dragleave",d,!1),e.removeEventListener("drop",d,!1),e.removeEventListener("dragover",f,!1)}}}).targetClass="droptarget",v="The sortable decorator only works with elements that correspond to array members",u=function(e){c=e.target},o=function(e){if(l[0].isEqualNode(c)){var t,o=this._ractive;if(n=o.keypath,-1===(t=n.str.lastIndexOf(".")))throw new Error(v);if(s=n.str.substr(0,t),a=+n.str.substring(t+1),isNaN(a))throw new Error(v);e.dataTransfer.setData("foo",!0),r=o.root}else e.preventDefault()},i=function(){var e,n,o,i,d,f;if(this._ractive.root===r){if(e=this._ractive.keypath,-1===(n=e.str.lastIndexOf(".")))throw new Error(v);o=e.str.substr(0,n),i=+e.str.substring(n+1),o===s&&(i!==a?(f=(d=r.get(s)).splice(a,1)[0],a=i,d.splice(a,0,f)):this.classList.add(t.targetClass))}},d=function(){this.classList.remove(t.targetClass)},f=function(e){e.preventDefault()},e.decorators.sortable=t});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/ractive-events-tap.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Ractive.events.tap=n()}(this,function(){"use strict";function e(e,n){return new s(e,n)}function n(e){this.__tap_handler__.mousedown(e)}function t(e){this.__tap_handler__.touchdown(e)}function o(){this.addEventListener("keydown",r,!1),this.addEventListener("blur",i,!1)}function i(){this.removeEventListener("keydown",r,!1),this.removeEventListener("blur",i,!1)}function r(e){32===e.which&&this.__tap_handler__.fire()}var d=e,s=function(e,n){this.node=e,this.callback=n,this.preventMousedownEvents=!1,this.bind(e)};return s.prototype={bind:function(e){window.navigator.pointerEnabled?e.addEventListener("pointerdown",n,!1):window.navigator.msPointerEnabled?e.addEventListener("MSPointerDown",n,!1):e.addEventListener("mousedown",n,!1),e.addEventListener("touchstart",t,!1),"BUTTON"!==e.tagName&&"button"!==e.type||e.addEventListener("focus",o,!1),e.__tap_handler__=this},fire:function(e,n,t){this.callback({node:this.node,original:e,x:n,y:t})},mousedown:function(e){var n=this;if(!this.preventMousedownEvents&&(void 0===e.which||1===e.which)){var t=e.clientX,o=e.clientY,i=e.pointerId,r=function(e){e.pointerId==i&&(n.fire(e,t,o),s())},d=function(e){e.pointerId==i&&(Math.abs(e.clientX-t)>=5||Math.abs(e.clientY-o)>=5)&&s()},s=function e(){n.node.removeEventListener("MSPointerUp",r,!1),document.removeEventListener("MSPointerMove",d,!1),document.removeEventListener("MSPointerCancel",e,!1),n.node.removeEventListener("pointerup",r,!1),document.removeEventListener("pointermove",d,!1),document.removeEventListener("pointercancel",e,!1),n.node.removeEventListener("click",r,!1),document.removeEventListener("mousemove",d,!1)};window.navigator.pointerEnabled?(this.node.addEventListener("pointerup",r,!1),document.addEventListener("pointermove",d,!1),document.addEventListener("pointercancel",s,!1)):window.navigator.msPointerEnabled?(this.node.addEventListener("MSPointerUp",r,!1),document.addEventListener("MSPointerMove",d,!1),document.addEventListener("MSPointerCancel",s,!1)):(this.node.addEventListener("click",r,!1),document.addEventListener("mousemove",d,!1)),setTimeout(s,400)}},touchdown:function(){var e=this,n=event.touches[0],t=n.clientX,o=n.clientY,i=n.identifier,r=function(n){n.changedTouches[0].identifier===i?(n.preventDefault(),e.preventMousedownEvents=!0,clearTimeout(e.preventMousedownTimeout),e.preventMousedownTimeout=setTimeout(function(){e.preventMousedownEvents=!1},400),e.fire(n,t,o),s()):s()},d=function(e){var n;1===e.touches.length&&e.touches[0].identifier===i||s(),n=e.touches[0],(Math.abs(n.clientX-t)>=5||Math.abs(n.clientY-o)>=5)&&s()},s=function n(){e.node.removeEventListener("touchend",r,!1),window.removeEventListener("touchmove",d,!1),window.removeEventListener("touchcancel",n,!1)};this.node.addEventListener("touchend",r,!1),window.addEventListener("touchmove",d,!1),window.addEventListener("touchcancel",s,!1),setTimeout(s,400)},teardown:function(){var e=this.node;e.removeEventListener("pointerdown",n,!1),e.removeEventListener("MSPointerDown",n,!1),e.removeEventListener("mousedown",n,!1),e.removeEventListener("touchstart",t,!1),e.removeEventListener("focus",o,!1)}},d});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/leaflet-sidebar.js */
L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,initialize:function(t,s){var i,a;for(L.setOptions(this,s),this._sidebar=L.DomUtil.get(t),L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch"),i=this._sidebar.children.length-1;i>=0;i--)"UL"==(a=this._sidebar.children[i]).tagName&&L.DomUtil.hasClass(a,"sidebar-tabs")?this._tabs=a:"DIV"==a.tagName&&L.DomUtil.hasClass(a,"sidebar-content")&&(this._container=a);for(this._tabitems=[],i=this._tabs.children.length-1;i>=0;i--)"LI"==(a=this._tabs.children[i]).tagName&&(this._tabitems.push(a),a._sidebar=this);for(this._panes=[],i=this._container.children.length-1;i>=0;i--)"DIV"==(a=this._container.children[i]).tagName&&L.DomUtil.hasClass(a,"sidebar-pane")&&this._panes.push(a);this._hasTouchStart=L.Browser.touch&&"ontouchstart"in document.documentElement},addTo:function(t){this._map=t;for(var s=this._hasTouchStart?"touchstart":"click",i=this._tabitems.length-1;i>=0;i--){var a=this._tabitems[i];L.DomEvent.on(a.firstChild,s,this._onClick,a)}return this},removeFrom:function(t){this._map=null;for(var s=this._hasTouchStart?"touchstart":"click",i=this._tabitems.length-1;i>=0;i--){var a=this._tabitems[i];L.DomEvent.off(a.firstChild,s,this._onClick)}return this},open:function(t){var s,i;for(s=this._panes.length-1;s>=0;s--)(i=this._panes[s]).id==t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");for(s=this._tabitems.length-1;s>=0;s--)(i=this._tabitems[s]).firstChild.hash=="#"+t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");return this.fire("content",{id:t}),L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed")),this},close:function(){for(var t=this._tabitems.length-1;t>=0;t--){var s=this._tabitems[t];L.DomUtil.hasClass(s,"active")&&L.DomUtil.removeClass(s,"active")}return L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed")),this},_onClick:function(t){L.DomUtil.hasClass(this,"active")?this._sidebar.close():this._sidebar.open(this.firstChild.hash.slice(1))}}),L.control.sidebar=function(t,s){return new L.Control.Sidebar(t,s)};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/leaflet-pip.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.leafletPip=n()}}(function(){return function n(t,o,e){function r(i,s){if(!o[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=o[i]={exports:{}};t[i][0].call(c.exports,function(n){var o=t[i][1][n];return r(o||n)},c,c.exports,n,t,o,e)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<e.length;i++)r(e[i]);return r}({1:[function(n,t,o){var e=n("geojson-utils"),r={bassackwards:!1,pointInLayer:function(n,t,o){"use strict";n instanceof L.LatLng?n=[n.lng,n.lat]:r.bassackwards&&n.reverse();var a=[];return t.eachLayer(function(t){o&&a.length||(t instanceof L.MultiPolygon||t instanceof L.Polygon)&&e.pointInPolygon({type:"Point",coordinates:n},t.toGeoJSON().geometry)&&a.push(t)}),a}};t.exports=r},{"geojson-utils":2}],2:[function(n,t,o){!function(){function n(n){for(var t=[],o=[],e=0;e<n[0].length;e++)t.push(n[0][e][1]),o.push(n[0][e][0]);return t=t.sort(function(n,t){return n-t}),o=o.sort(function(n,t){return n-t}),[[t[0],o[0]],[t[t.length-1],o[o.length-1]]]}function o(n,t,o){for(var e=[[0,0]],r=0;r<o.length;r++){for(i=0;i<o[r].length;i++)e.push(o[r][i]);e.push(o[r][0]),e.push([0,0])}for(var a=!1,r=0,i=e.length-1;r<e.length;i=r++)e[r][0]>t!=e[i][0]>t&&n<(e[i][1]-e[r][1])*(t-e[r][0])/(e[i][0]-e[r][0])+e[r][1]&&(a=!a);return a}var e=this.gju={};void 0!==t&&t.exports&&(t.exports=e),e.lineStringsIntersect=function(n,t){for(var o=[],e=0;e<=n.coordinates.length-2;++e)for(var r=0;r<=t.coordinates.length-2;++r){var a={x:n.coordinates[e][1],y:n.coordinates[e][0]},i={x:n.coordinates[e+1][1],y:n.coordinates[e+1][0]},s={x:t.coordinates[r][1],y:t.coordinates[r][0]},u={x:t.coordinates[r+1][1],y:t.coordinates[r+1][0]},c=(u.x-s.x)*(a.y-s.y)-(u.y-s.y)*(a.x-s.x),f=(i.x-a.x)*(a.y-s.y)-(i.y-a.y)*(a.x-s.x),l=(u.y-s.y)*(i.x-a.x)-(u.x-s.x)*(i.y-a.y);if(0!=l){var d=c/l,h=f/l;0<=d&&d<=1&&0<=h&&h<=1&&o.push({type:"Point",coordinates:[a.x+d*(i.x-a.x),a.y+d*(i.y-a.y)]})}}return 0==o.length&&(o=!1),o},e.pointInBoundingBox=function(n,t){return!(n.coordinates[1]<t[0][0]||n.coordinates[1]>t[1][0]||n.coordinates[0]<t[0][1]||n.coordinates[0]>t[1][1])},e.pointInPolygon=function(t,r){for(var a="Polygon"==r.type?[r.coordinates]:r.coordinates,i=!1,s=0;s<a.length;s++)e.pointInBoundingBox(t,n(a[s]))&&(i=!0);if(!i)return!1;for(var u=!1,s=0;s<a.length;s++)o(t.coordinates[1],t.coordinates[0],a[s])&&(u=!0);return u},e.pointInMultiPolygon=function(t,r){for(var a="MultiPolygon"==r.type?[r.coordinates]:r.coordinates,i=!1,s=!1,u=0;u<a.length;u++){for(var c=a[u],f=0;f<c.length;f++)i||e.pointInBoundingBox(t,n(c[f]))&&(i=!0);if(!i)return!1;for(f=0;f<c.length;f++)s||o(t.coordinates[1],t.coordinates[0],c[f])&&(s=!0)}return s},e.numberToRadius=function(n){return n*Math.PI/180},e.numberToDegree=function(n){return 180*n/Math.PI},e.drawCircle=function(n,t,o){for(var r=[t.coordinates[1],t.coordinates[0]],a=n/1e3/6371,i=[e.numberToRadius(r[0]),e.numberToRadius(r[1])],o=o||15,s=[[r[0],r[1]]],u=0;u<o;u++){var c=2*Math.PI*u/o,f=Math.asin(Math.sin(i[0])*Math.cos(a)+Math.cos(i[0])*Math.sin(a)*Math.cos(c)),l=i[1]+Math.atan2(Math.sin(c)*Math.sin(a)*Math.cos(i[0]),Math.cos(a)-Math.sin(i[0])*Math.sin(f));s[u]=[],s[u][1]=e.numberToDegree(f),s[u][0]=e.numberToDegree(l)}return{type:"Polygon",coordinates:[s]}},e.rectangleCentroid=function(n){var t=n.coordinates[0],o=t[0][0],e=t[0][1];return{type:"Point",coordinates:[o+(t[2][0]-o)/2,e+(t[2][1]-e)/2]}},e.pointDistance=function(n,t){var o=n.coordinates[0],r=n.coordinates[1],a=t.coordinates[0],i=t.coordinates[1],s=e.numberToRadius(i-r),u=e.numberToRadius(a-o),c=Math.pow(Math.sin(s/2),2)+Math.cos(e.numberToRadius(r))*Math.cos(e.numberToRadius(i))*Math.pow(Math.sin(u/2),2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))*1e3},e.geometryWithinRadius=function(n,t,o){if("Point"==n.type)return e.pointDistance(n,t)<=o;if("LineString"==n.type||"Polygon"==n.type){var r,a={};r="Polygon"==n.type?n.coordinates[0]:n.coordinates;for(var i in r)if(a.coordinates=r[i],e.pointDistance(a,t)>o)return!1}return!0},e.area=function(n){for(var t=0,o=n.coordinates[0],e=o.length-1,r=0;r<o.length;e=r++){var a={x:o[r][1],y:o[r][0]},i={x:o[e][1],y:o[e][0]};t+=a.x*i.y,t-=a.y*i.x}return t/=2},e.centroid=function(n){for(var t,o=0,r=0,a=n.coordinates[0],i=a.length-1,s=0;s<a.length;i=s++){var u={x:a[s][1],y:a[s][0]},c={x:a[i][1],y:a[i][0]};t=u.x*c.y-c.x*u.y,o+=(u.x+c.x)*t,r+=(u.y+c.y)*t}return t=6*e.area(n),{type:"Point",coordinates:[r/t,o/t]}},e.simplify=function(n,t){t=t||20,n=n.map(function(n){return{lng:n.coordinates[0],lat:n.coordinates[1]}});var o,e,r,a,i,s,u,c,f,l,d,h,y,p,g,M,x,v,b=Math.PI/180*.5,m=new Array,P=new Array,I=new Array;if(n.length<3)return n;for(o=n.length,f=360*t/(2*Math.PI*6378137),f*=f,r=0,P[0]=0,I[0]=o-1,e=1;e>0;)if(a=P[e-1],i=I[e-1],e--,i-a>1){for(l=n[i].lng()-n[a].lng(),d=n[i].lat()-n[a].lat(),Math.abs(l)>180&&(l=360-Math.abs(l)),h=(l*=Math.cos(b*(n[i].lat()+n[a].lat())))*l+d*d,T=a+1,s=a,c=-1;T<i;T++)y=n[T].lng()-n[a].lng(),p=n[T].lat()-n[a].lat(),Math.abs(y)>180&&(y=360-Math.abs(y)),g=(y*=Math.cos(b*(n[T].lat()+n[a].lat())))*y+p*p,M=n[T].lng()-n[i].lng(),x=n[T].lat()-n[i].lat(),Math.abs(M)>180&&(M=360-Math.abs(M)),(u=g>=h+(v=(M*=Math.cos(b*(n[T].lat()+n[i].lat())))*M+x*x)?v:v>=h+g?g:(y*d-p*l)*(y*d-p*l)/h)>c&&(s=T,c=u);c<f?(m[r]=a,r++):(P[++e-1]=s,I[e-1]=i,P[++e-1]=a,I[e-1]=s)}else m[r]=a,r++;m[r]=o-1,r++;for(var w=new Array,T=0;T<r;T++)w.push(n[m[T]]);return w.map(function(n){return{type:"Point",coordinates:[n.lng,n.lat]}})},e.destinationPoint=function(n,t,o){o/=6371,t=e.numberToRadius(t);var r=e.numberToRadius(n.coordinates[0]),a=e.numberToRadius(n.coordinates[1]),i=Math.asin(Math.sin(a)*Math.cos(o)+Math.cos(a)*Math.sin(o)*Math.cos(t)),s=r+Math.atan2(Math.sin(t)*Math.sin(o)*Math.cos(a),Math.cos(o)-Math.sin(a)*Math.sin(i));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,{type:"Point",coordinates:[e.numberToDegree(s),e.numberToDegree(i)]}}}()},{}]},{},[1])(1)});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/topojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(){function t(n,t){function r(t){var r,e=n.arcs[t<0?~t:t],o=e[0];return n.transform?(r=[0,0],e.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=e[e.length-1],t<0?[r,o]:[o,r]}function e(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[n<0?~n:n]=1}),f.push(e)}}var o={},i={},u={},f=[],c=-1;return t.forEach(function(r,e){var o,i=n.arcs[r<0?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++c],t[c]=r,t[e]=o)}),t.forEach(function(n){var t,e,o=r(n),f=o[0],c=o[1];if(t=u[f])if(delete u[t.end],t.push(n),t.end=c,e=i[c]){delete i[e.start];var a=e===t?t:t.concat(e);i[a.start=t.start]=u[a.end=e.end]=a}else i[t.start]=u[t.end]=t;else if(t=i[c])if(delete i[t.start],t.unshift(n),t.start=f,e=u[f]){delete u[e.end];var s=e===t?t:e.concat(t);i[s.start=e.start]=u[s.end=t.end]=s}else i[t.start]=u[t.end]=t;else i[(t=[n]).start=f]=u[t.end=c]=t}),e(u,i),e(i,u),t.forEach(function(n){o[n<0?~n:n]||f.push([n])}),f}function r(n,r,e){var o=[];if(arguments.length>1){var i,u=function(n){var t=n<0?~n:n;(a[t]||(a[t]=[])).push({i:n,g:i})},f=function(n){n.forEach(u)},c=function(n){n.forEach(f)},a=[],s={LineString:f,MultiLineString:c,Polygon:c,MultiPolygon:function(n){n.forEach(c)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in s&&(i=t,s[t.type](t.arcs))}(r),a.forEach(arguments.length<3?function(n){o.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&o.push(n[0].i)})}else for(var l=0,p=n.arcs.length;l<p;++l)o.push(l);return{type:"MultiLineString",arcs:t(n,o)}}function e(r,e){function o(n){n.forEach(function(t){t.forEach(function(t){(f[t=t<0?~t:t]||(f[t]=[])).push(n)})}),c.push(n)}function i(n){return l(u(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var f={},c=[],a=[];return e.forEach(function(n){"Polygon"===n.type?o(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(o)}),c.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,a.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),c.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:a.map(function(e){var o=[];if(e.forEach(function(n){n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].length<2&&o.push(n)})})}),o=t(r,o),(n=o.length)>1)for(var u,c=i(e[0][0]),a=0;a<n;++a)if(c===i(o[a])){u=o[0],o[0]=o[a],o[a]=u;break}return o})}}function o(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(n,t)};return null==t.id&&delete r.id,r}function u(n,t){function r(n,t){t.length&&t.pop();for(var r,e=s[n<0?~n:n],o=0,i=e.length;o<i;++o)t.push(r=e[o].slice()),a(r,o);n<0&&f(t,i)}function e(n){return n=n.slice(),a(n,0),n}function o(n){for(var t=[],e=0,o=n.length;e<o;++e)r(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=o(n);t.length<4;)t.push(t[0].slice());return t}function u(n){return n.map(i)}function c(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(c)}:t in l?{type:t,coordinates:l[t](n)}:null}var a=y(n.transform),s=n.arcs,l={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return o(n.arcs)},MultiLineString:function(n){return n.arcs.map(o)},Polygon:function(n){return u(n.arcs)},MultiPolygon:function(n){return n.arcs.map(u)}};return c(t)}function f(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}function c(n,t){for(var r=0,e=n.length;r<e;){var o=r+e>>>1;n[o]<t?r=o+1:e=o}return r}function a(n){function t(n,t){n.forEach(function(n){n<0&&(n=~n);var r=o[n];r?r.push(t):o[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function e(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,t)}):n.type in u&&u[n.type](n.arcs,t)}var o={},i=n.map(function(){return[]}),u={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(e);for(var f in o)for(var a=o[f],s=a.length,l=0;l<s;++l)for(var p=l+1;p<s;++p){var h,v=a[l],y=a[p];(h=i[v])[f=c(h,y)]!==y&&h.splice(f,0,y),(h=i[y])[f=c(h,v)]!==v&&h.splice(f,0,v)}return i}function s(n,t){function r(n){i.remove(n),n[1][2]=t(n),i.push(n)}var e=y(n.transform),o=g(n.transform),i=v();return t||(t=p),n.arcs.forEach(function(n){for(var u,f,c=[],a=0,s=0,l=n.length;s<l;++s)f=n[s],e(n[s]=[f[0],f[1],1/0],s);for(var s=1,l=n.length-1;s<l;++s)(u=n.slice(s-1,s+2))[1][2]=t(u),c.push(u),i.push(u);for(var s=0,l=c.length;s<l;++s)(u=c[s]).previous=c[s-1],u.next=c[s+1];for(;u=i.pop();){var p=u.previous,h=u.next;u[1][2]<a?u[1][2]=a:a=u[1][2],p&&(p.next=h,p[2]=u[2],r(p)),h&&(h.previous=p,h[0]=u[0],r(h))}n.forEach(o)}),n}function l(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return.5*i}function p(n){var t=n[0],r=n[1],e=n[2];return Math.abs((t[0]-e[0])*(r[1]-t[1])-(t[0]-r[0])*(e[1]-t[1]))}function h(n,t){return n[1][2]-t[1][2]}function v(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,o=e[r];if(h(n,o)>=0)break;e[o._=t]=o,e[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,f=e[u];if(i<o&&h(e[i],f)<0&&(f=e[u=i]),r<o&&h(e[r],f)<0&&(f=e[u=r]),u===t)break;e[f._=t]=f,e[n._=t=u]=n}}var r={},e=[],o=0;return r.push=function(t){return n(e[t._=o]=t,o++),o},r.pop=function(){if(!(o<=0)){var n,r=e[0];return--o>0&&(n=e[o],t(e[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(e[u]===r)return u!==--o&&(i=e[o],(h(i,r)<0?n:t)(e[i._=u]=i,u)),u},r}function y(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0),n[0]=(t+=n[0])*e+i,n[1]=(r+=n[1])*o+u}}function g(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0);var c=(n[0]-i)/e|0,a=(n[1]-u)/o|0;n[0]=c-t,n[1]=a-r,t=c,r=a}}function m(){}var d={version:"1.6.19",mesh:function(n){return u(n,r.apply(this,arguments))},meshArcs:r,merge:function(n){return u(n,e.apply(this,arguments))},mergeArcs:e,feature:o,neighbors:a,presimplify:s};"function"==typeof define&&define.amd?define(d):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=d:this.topojson=d}();
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/ractive-tooltip.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.RactiveTooltip=t():e.RactiveTooltip=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function o(e,t,n){var o={x:e.pageX,y:e.pageY},r=o.y-n.offsetHeight-5,a=o.x+n.offsetWidth-i.innerWidth,s=e.pageY-n.offsetHeight-5,f=e.pageX-5;a>0&&(f-=a-5),0>r&&(s+=2*n.offsetHeight-5),n.style.left=f+"px",n.style.top=s+"px"}function r(e,t){var n,r,i;r={mouseenter:function(r){t&&0!==t.length&&(n||(n=a.createElement("div"),n.className="ractive-tooltip",n.textContent=t),o(r,e,n),a.body.appendChild(n))},mousemove:function(t){n&&o(t,e,n)},mouseleave:function(){n&&n.parentNode&&n.parentNode.removeChild(n)}};for(i in r)r.hasOwnProperty(i)&&e.addEventListener(i,r[i],!1);return{update:function(e){t=e,n&&(n.textContent=t),t&&0!==t.length||!n||!n.parentNode||n.parentNode.removeChild(n)},teardown:function(){n&&n.parentNode&&(n.parentNode.removeChild(n),n=null);for(i in r)r.hasOwnProperty(i)&&e.removeEventListener(i,r[i],!1)}}}n(1);var i=window,a=i.document;e.exports=r},function(e,t,n){var o=n(2);"string"==typeof o&&(o=[[e.id,o,""]]),n(4)(o,{}),o.placeholders&&(e.exports=o.placeholders)},function(e,t,n){(e.exports=n(3)()).push([e.id,".ractive-tooltip{position:absolute;display:table;padding:.5em;color:#fff;background:#000;box-shadow:0 2px 2px rgba(0,0,0,.1);border-radius:5px;white-space:nowrap;z-index:99999;font-style:normal;text-transform:none;pointer-events:none}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function o(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=d[o.id];if(r){r.refs++;for(a=0;a<r.parts.length;a++)r.parts[a](o.parts[a]);for(;a<o.parts.length;a++)r.parts.push(s(o.parts[a],t))}else{for(var i=[],a=0;a<o.parts.length;a++)i.push(s(o.parts[a],t));d[o.id]={id:o.id,refs:1,parts:i}}}}function r(e){for(var t=[],n={},o=0;o<e.length;o++){var r=e[o],i=r[0],a={css:r[1],media:r[2],sourceMap:r[3]};n[i]?n[i].parts.push(a):t.push(n[i]={id:i,parts:[a]})}return t}function i(){var e=document.createElement("style"),t=h();return e.type="text/css",t.appendChild(e),e}function a(){var e=document.createElement("link"),t=h();return e.rel="stylesheet",t.appendChild(e),e}function s(e,t){var n,o,r;if(t.singleton){var s=m++;n=v||(v=i()),o=f.bind(null,n,s,!1),r=f.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=a(),o=u.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),o=p.bind(null,n),r=function(){n.parentNode.removeChild(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}function f(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function p(e,t){var n=t.css,o=t.media;if(t.sourceMap,o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function u(e,t){var n=t.css,o=(t.media,t.sourceMap);o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(JSON.stringify(o))+" */");var r=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var d={},c=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},l=c(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=c(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,m=0;e.exports=function(e,t){void 0===(t=t||{}).singleton&&(t.singleton=l());var n=r(e);return o(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var s=n[a];(f=d[s.id]).refs--,i.push(f)}e&&o(r(e),t);for(a=0;a<i.length;a++){var f=i[a];if(0===f.refs){for(var p=0;p<f.parts.length;p++)f.parts[p]();delete d[f.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/path-data-polyfill.js */
SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var e={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},t=function(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},s=-1!==window.navigator.userAgent.indexOf("MSIE ");t.prototype={parseSegment:function(){var t=this._string[this._currentIndex],s=e[t]?e[t]:null;if(null===s){if(null===this._prevCommand)return null;if(null===(s=("+"===t||"-"===t||"."===t||t>="0"&&t<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;this._prevCommand=s;var r=null,a=s.toUpperCase();return"H"===a||"V"===a?r=[this._parseNumber()]:"M"===a||"L"===a||"T"===a?r=[this._parseNumber(),this._parseNumber()]:"S"===a||"Q"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===a&&(this._skipOptionalSpaces(),r=[]),null===r||r.indexOf(null)>=0?null:{type:s,values:r}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var t=this._string[this._currentIndex];return e[t]?e[t]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var e=0,t=0,s=1,r=0,a=1,n=1,i=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,a=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var u=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==u)for(var h=this._currentIndex-1,l=1;h>=u;)t+=l*(this._string[h]-"0"),h-=1,l*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)r+=(this._string[this._currentIndex]-"0")*(s*=.1),this._currentIndex+=1}if(this._currentIndex!==i&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,n=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)e*=10,e+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var v=t+r;return v*=a,e&&(v*=Math.pow(10,n*e)),i===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),v)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=!1,t=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===t)e=!1;else{if("1"!==t)return null;e=!0}return this._skipOptionalSpacesOrDelimiter(),e}};var r,a=function(e){if(!e||0===e.length)return[];var s=new t(e),r=[];if(s.initialCommandIsMoveTo())for(;s.hasMoreData();){var a=s.parseSegment();if(null===a)break;r.push(a)}return r},n=SVGPathElement.prototype.setAttribute,i=SVGPathElement.prototype.removeAttribute;r=window.Symbol?{cachedPathData:Symbol(),cachedNormalizedPathData:Symbol()}:{cachedPathData:"__cachedPathData",cachedNormalizedPathData:"__cachedNormalizedPathData"};var u=function e(t,s,r,a,n,i,u,h,l,v){var p,c,_,d,o=function(e,t,s){return{x:e*Math.cos(s)-t*Math.sin(s),y:e*Math.sin(s)+t*Math.cos(s)}},I=function(e){return Math.PI*e/180}(u),x=[];if(v)p=v[0],c=v[1],_=v[2],d=v[3];else{var f=o(t,s,-I);t=f.x,s=f.y;var m=o(r,a,-I),y=(t-(r=m.x))/2,g=(s-(a=m.y))/2,M=y*y/(n*n)+g*g/(i*i);M>1&&(n*=M=Math.sqrt(M),i*=M);var P,S=n*n,b=i*i,D=S*b-S*g*g-b*y*y,C=S*g*g+b*y*y,N=(P=h===l?-1:1)*Math.sqrt(Math.abs(D/C));_=N*n*g/i+(t+r)/2,d=N*-i*y/n+(s+a)/2,p=Math.asin(((s-d)/i).toFixed(9)),c=Math.asin(((a-d)/i).toFixed(9)),t<_&&(p=Math.PI-p),r<_&&(c=Math.PI-c),p<0&&(p=2*Math.PI+p),c<0&&(c=2*Math.PI+c),l&&p>c&&(p-=2*Math.PI),!l&&c>p&&(c-=2*Math.PI)}var A=c-p;if(Math.abs(A)>120*Math.PI/180){var V=c,E=r,O=a;c=l&&c>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,r=_+n*Math.cos(c),a=d+i*Math.sin(c),x=e(r,a,E,O,n,i,u,0,l,[c,V,_,d])}A=c-p;var k=Math.cos(p),T=Math.sin(p),z=Math.cos(c),L=Math.sin(c),G=Math.tan(A/4),Q=4/3*n*G,Z=4/3*i*G,H=[t,s],w=[t+Q*T,s-Z*k],q=[r+Q*L,a-Z*z],F=[r,a];if(w[0]=2*H[0]-w[0],w[1]=2*H[1]-w[1],v)return[w,q,F].concat(x);var j=[],U=[];return(x=[w,q,F].concat(x).join().split(",")).forEach(function(e,t){t%2?U.push(o(x[t-1],x[t],I).y):U.push(o(x[t],x[t+1],I).x),6===U.length&&(j.push(U),U=[])}),j},h=function(e){return e.map(function(e){return{type:e.type,values:Array.prototype.slice.call(e.values)}})},l=function(e){var t=[],s=null,r=null,a=null,n=null;return e.forEach(function(e){var i=e.type;if("M"===i){var u=e.values[0],h=e.values[1];t.push({type:"M",values:[u,h]}),a=u,n=h,s=u,r=h}else if("m"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"M",values:[u,h]}),a=u,n=h,s=u,r=h}else if("L"===i){var u=e.values[0],h=e.values[1];t.push({type:"L",values:[u,h]}),s=u,r=h}else if("l"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"L",values:[u,h]}),s=u,r=h}else if("C"===i){var l=e.values[0],v=e.values[1],p=e.values[2],c=e.values[3],u=e.values[4],h=e.values[5];t.push({type:"C",values:[l,v,p,c,u,h]}),s=u,r=h}else if("c"===i){var l=s+e.values[0],v=r+e.values[1],p=s+e.values[2],c=r+e.values[3],u=s+e.values[4],h=r+e.values[5];t.push({type:"C",values:[l,v,p,c,u,h]}),s=u,r=h}else if("Q"===i){var l=e.values[0],v=e.values[1],u=e.values[2],h=e.values[3];t.push({type:"Q",values:[l,v,u,h]}),s=u,r=h}else if("q"===i){var l=s+e.values[0],v=r+e.values[1],u=s+e.values[2],h=r+e.values[3];t.push({type:"Q",values:[l,v,u,h]}),s=u,r=h}else if("A"===i){var u=e.values[5],h=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],u,h]}),s=u,r=h}else if("a"===i){var u=s+e.values[5],h=r+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],u,h]}),s=u,r=h}else if("H"===i){u=e.values[0];t.push({type:"H",values:[u]}),s=u}else if("h"===i){u=s+e.values[0];t.push({type:"H",values:[u]}),s=u}else if("V"===i){h=e.values[0];t.push({type:"V",values:[h]}),r=h}else if("v"===i){h=r+e.values[0];t.push({type:"V",values:[h]}),r=h}else if("S"===i){var p=e.values[0],c=e.values[1],u=e.values[2],h=e.values[3];t.push({type:"S",values:[p,c,u,h]}),s=u,r=h}else if("s"===i){var p=s+e.values[0],c=r+e.values[1],u=s+e.values[2],h=r+e.values[3];t.push({type:"S",values:[p,c,u,h]}),s=u,r=h}else if("T"===i){var u=e.values[0],h=e.values[1];t.push({type:"T",values:[u,h]}),s=u,r=h}else if("t"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"T",values:[u,h]}),s=u,r=h}else"Z"!==i&&"z"!==i||(t.push({type:"Z",values:[]}),s=a,r=n)}),t},v=function(e){var t=[],s=null,r=null,a=null,n=null,i=null,h=null,l=null;return e.forEach(function(e){if("M"===e.type){var v=e.values[0],p=e.values[1];t.push({type:"M",values:[v,p]}),h=v,l=p,n=v,i=p}else if("C"===e.type){var c=e.values[0],_=e.values[1],d=e.values[2],o=e.values[3],v=e.values[4],p=e.values[5];t.push({type:"C",values:[c,_,d,o,v,p]}),r=d,a=o,n=v,i=p}else if("L"===e.type){var v=e.values[0],p=e.values[1];t.push({type:"L",values:[v,p]}),n=v,i=p}else if("H"===e.type){v=e.values[0];t.push({type:"L",values:[v,i]}),n=v}else if("V"===e.type){p=e.values[0];t.push({type:"L",values:[n,p]}),i=p}else if("S"===e.type){var d=e.values[0],o=e.values[1],v=e.values[2],p=e.values[3];"C"===s||"S"===s?(I=n+(n-r),x=i+(i-a)):(I=n,x=i),t.push({type:"C",values:[I,x,d,o,v,p]}),r=d,a=o,n=v,i=p}else if("T"===e.type){var v=e.values[0],p=e.values[1];"Q"===s||"T"===s?(c=n+(n-r),_=i+(i-a)):(c=n,_=i);var I=n+2*(c-n)/3,x=i+2*(_-i)/3,f=v+2*(c-v)/3,m=p+2*(_-p)/3;t.push({type:"C",values:[I,x,f,m,v,p]}),r=c,a=_,n=v,i=p}else if("Q"===e.type){var c=e.values[0],_=e.values[1],v=e.values[2],p=e.values[3],I=n+2*(c-n)/3,x=i+2*(_-i)/3,f=v+2*(c-v)/3,m=p+2*(_-p)/3;t.push({type:"C",values:[I,x,f,m,v,p]}),r=c,a=_,n=v,i=p}else if("A"===e.type){var y=e.values[0],g=e.values[1],M=e.values[2],P=e.values[3],S=e.values[4],v=e.values[5],p=e.values[6];0===y||0===g?(t.push({type:"C",values:[n,i,v,p,v,p]}),n=v,i=p):n===v&&i===p||u(n,i,v,p,y,g,M,P,S).forEach(function(e){t.push({type:"C",values:e}),n=v,i=p})}else"Z"===e.type&&(t.push(e),n=h,i=l);s=e.type}),t};SVGPathElement.prototype.setAttribute=function(e,t){"d"===e&&(this[r.cachedPathData]=null,this[r.cachedNormalizedPathData]=null),n.call(this,e,t)},SVGPathElement.prototype.removeAttribute=function(e,t){"d"===e&&(this[r.cachedPathData]=null,this[r.cachedNormalizedPathData]=null),i.call(this,e)},SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){if(this[r.cachedNormalizedPathData])return h(this[r.cachedNormalizedPathData]);this[r.cachedPathData]?s=h(this[r.cachedPathData]):(s=a(this.getAttribute("d")||""),this[r.cachedPathData]=h(s));var t=v(l(s));return this[r.cachedNormalizedPathData]=h(t),t}if(this[r.cachedPathData])return h(this[r.cachedPathData]);var s=a(this.getAttribute("d")||"");return this[r.cachedPathData]=h(s),s},SVGPathElement.prototype.setPathData=function(e){if(0===e.length)s?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",r=0,a=e.length;r<a;r+=1){var n=e[r];r>0&&(t+=" "),t+=n.type,n.values&&(t+=" "+n.values.join(" "))}this.setAttribute("d",t)}}}();
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/togeojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},toGeoJSON=function(){"use strict";function e(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function t(e,t){return e.getElementsByTagName(t)}function r(e,t){return e.getAttribute(t)}function n(e,t){return parseFloat(r(e,t))}function o(e,r){var n=t(e,r);return n.length?n[0]:null}function i(e){return e.normalize&&e.normalize(),e}function a(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function s(e){return e&&i(e),e&&e.textContent||""}function l(e,t){var r,n,i={};for(n=0;n<t.length;n++)(r=o(e,t[n]))&&(i[t[n]]=s(r));return i}function u(e,t){for(var r in t)e[r]=t[r]}function f(e){return a(e.replace(y,"").split(","))}function p(e){for(var t=e.replace(m,"").split(d),r=[],n=0;n<t.length;n++)r.push(f(t[n]));return r}function c(e){var t,r=[n(e,"lon"),n(e,"lat")],i=o(e,"ele"),a=o(e,"gpxtpx:hr")||o(e,"hr"),l=o(e,"time");return i&&(t=parseFloat(s(i)),isNaN(t)||r.push(t)),{coordinates:r,time:l?s(l):null,heartRate:a?parseFloat(s(a)):null}}function h(e){return void 0!==e.xml?e.xml:g.serializeToString(e)}var g,y=/\s*/g,m=/^\s*|\s*$/g,d=/\s+/;return"undefined"!=typeof XMLSerializer?g=new XMLSerializer:"object"!==("undefined"==typeof exports?"undefined":_typeof(exports))||"object"!==("undefined"==typeof process?"undefined":_typeof(process))||process.browser||(g=new(require("xmldom").XMLSerializer)),{kml:function(n){function i(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function l(e){return a(e.split(" "))}function u(e){var r=t(e,"coord","gx"),n=[],o=[];0===r.length&&(r=t(e,"gx:coord"));for(var i=0;i<r.length;i++)n.push(l(s(r[i])));for(var a=t(e,"when"),u=0;u<a.length;u++)o.push(s(a[u]));return{coords:n,times:o}}function c(e){var r,n,i,a,l,h=[],g=[];if(o(e,"MultiGeometry"))return c(o(e,"MultiGeometry"));if(o(e,"MultiTrack"))return c(o(e,"MultiTrack"));if(o(e,"gx:MultiTrack"))return c(o(e,"gx:MultiTrack"));for(i=0;i<v.length;i++)if(n=t(e,v[i]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===v[i])h.push({type:"Point",coordinates:f(s(o(r,"coordinates")))});else if("LineString"===v[i])h.push({type:"LineString",coordinates:p(s(o(r,"coordinates")))});else if("Polygon"===v[i]){var y=t(r,"LinearRing"),m=[];for(l=0;l<y.length;l++)m.push(p(s(o(y[l],"coordinates"))));h.push({type:"Polygon",coordinates:m})}else if("Track"===v[i]||"gx:Track"===v[i]){var d=u(r);h.push({type:"LineString",coordinates:d.coords}),d.times.length&&g.push(d.times)}return{geoms:h,coordTimes:g}}for(var g={type:"FeatureCollection",features:[]},y={},m={},d={},v=["Polygon","LineString","Point","Track","gx:Track"],S=t(n,"Placemark"),k=t(n,"Style"),b=t(n,"StyleMap"),x=0;x<k.length;x++){var T=e(h(k[x])).toString(16);y["#"+r(k[x],"id")]=T,m[T]=k[x]}for(var N=0;N<b.length;N++){y["#"+r(b[N],"id")]=e(h(b[N])).toString(16);for(var F=t(b[N],"Pair"),L={},M=0;M<F.length;M++)L[s(o(F[M],"key"))]=s(o(F[M],"styleUrl"));d["#"+r(b[N],"id")]=L}for(var w=0;w<S.length;w++)g.features=g.features.concat(function(e){var n,a=c(e),l={},u=s(o(e,"name")),f=s(o(e,"address")),p=s(o(e,"styleUrl")),h=s(o(e,"description")),g=o(e,"TimeSpan"),v=o(e,"TimeStamp"),S=o(e,"ExtendedData"),k=o(e,"LineStyle"),b=o(e,"PolyStyle"),x=o(e,"visibility");if(!a.geoms.length)return[];if(u&&(l.name=u),f&&(l.address=f),p){"#"!==p[0]&&(p="#"+p),l.styleUrl=p,y[p]&&(l.styleHash=y[p]),d[p]&&(l.styleMapHash=d[p],l.styleHash=y[d[p].normal]);var T=m[l.styleHash];T&&(k||(k=o(T,"LineStyle")),b||(b=o(T,"PolyStyle")))}if(h&&(l.description=h),g){var N=s(o(g,"begin")),F=s(o(g,"end"));l.timespan={begin:N,end:F}}if(v&&(l.timestamp=s(o(v,"when"))),k){var L=i(s(o(k,"color"))),M=L[0],w=L[1],P=parseFloat(s(o(k,"width")));M&&(l.stroke=M),isNaN(w)||(l["stroke-opacity"]=w),isNaN(P)||(l["stroke-width"]=P)}if(b){var R=i(s(o(b,"color"))),z=R[0],C=R[1],G=s(o(b,"fill")),A=s(o(b,"outline"));z&&(l.fill=z),isNaN(C)||(l["fill-opacity"]=C),G&&(l["fill-opacity"]="1"===G?l["fill-opacity"]||1:0),A&&(l["stroke-opacity"]="1"===A?l["stroke-opacity"]||1:0)}if(S){var H=t(S,"Data"),D=t(S,"SimpleData");for(n=0;n<H.length;n++)l[H[n].getAttribute("name")]=s(o(H[n],"value"));for(n=0;n<D.length;n++)l[D[n].getAttribute("name")]=s(D[n])}x&&(l.visibility=s(x)),a.coordTimes.length&&(l.coordTimes=1===a.coordTimes.length?a.coordTimes[0]:a.coordTimes);var U={type:"Feature",geometry:1===a.geoms.length?a.geoms[0]:{type:"GeometryCollection",geometries:a.geoms},properties:l};return r(e,"id")&&(U.id=r(e,"id")),[U]}(S[w]));return g},gpx:function(e){function n(e,r){var n=t(e,r),o=[],i=[],a=[],s=n.length;if(s<2)return{};for(var l=0;l<s;l++){var u=c(n[l]);o.push(u.coordinates),u.time&&i.push(u.time),u.heartRate&&a.push(u.heartRate)}return{line:o,times:i,heartRates:a}}function i(e){var t={};if(e){var r=o(e,"line");if(r){var n=s(o(r,"color")),i=parseFloat(s(o(r,"opacity"))),a=parseFloat(s(o(r,"width")));n&&(t.stroke=n),isNaN(i)||(t["stroke-opacity"]=i),isNaN(a)||(t["stroke-width"]=96*a/25.4)}}return t}function a(e){var n=l(e,["name","cmt","desc","type","time","keywords"]),o=t(e,"link");o.length&&(n.links=[]);for(var i,a=0;a<o.length;a++)u(i={href:r(o[a],"href")},l(o[a],["text","type"])),n.links.push(i);return n}var f,p,h=t(e,"trk"),g=t(e,"rte"),y=t(e,"wpt"),m={type:"FeatureCollection",features:[]};for(f=0;f<h.length;f++)(p=function(e){for(var r,s=t(e,"trkseg"),l=[],f=[],p=[],c=0;c<s.length;c++)(r=n(s[c],"trkpt"))&&(r.line&&l.push(r.line),r.times&&r.times.length&&f.push(r.times),r.heartRates&&r.heartRates.length&&p.push(r.heartRates));if(0!==l.length){var h=a(e);return u(h,i(o(e,"extensions"))),f.length&&(h.coordTimes=1===l.length?f[0]:f),p.length&&(h.heartRates=1===l.length?p[0]:p),{type:"Feature",properties:h,geometry:{type:1===l.length?"LineString":"MultiLineString",coordinates:1===l.length?l[0]:l}}}}(h[f]))&&m.features.push(p);for(f=0;f<g.length;f++)(p=function(e){var t=n(e,"rtept");if(t.line){var r=a(e);return u(r,i(o(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}(g[f]))&&m.features.push(p);for(f=0;f<y.length;f++)m.features.push(function(e){var t=a(e);return u(t,l(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:c(e).coordinates}}}(y[f]));return m}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
</script>

    <!-- THIS NEEDS TO BE FIRST -->
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/polyfills.js */
"function"!=typeof Object.assign&&(Object.assign=function(n,t){"use strict";if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),e=1;e<arguments.length;e++){var o=arguments[e];if(null!=o)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])}return r});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/config.js */
function stringify(e){function n(e){return _.isObject(e)?_.sortBy(_.map(_.pairs(e),function(e){return[e[0],n(e[1])]}),function(e){return e[0]}):e}return JSON.stringify(n(e))}var getParameterByName=function(e){if("undefined"!=typeof window){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}return null},Config={defaults:{"bounding-box":[-73.50821,42.886778,-69.858861,41.187053]},skip_cdn:"disable"===getParameterByName("cdn")};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/layer_info.js */
var GEOSERVER="http://geoserver.nescaum-ccsc-dataservices.com/geoserver",API_SERVER="http://api.nescaum-ccsc-dataservices.com/",CDN=function(e){var a;if(Config.skip_cdn)a=e;else{var s=new URI(e),t=s.hostname();t.match(/geoserver.nescaum-ccsc-dataservices.com/)?(s.hostname("d3dfsz5phlpu8l.cloudfront.net"),s.port(null),s.scheme("https")):t.match(/api.nescaum-ccsc-dataservices.com/)?(s.hostname("d2749s27r5h52i.cloudfront.net"),s.port(null),s.scheme("https")):console.warn("Hostname not in a CDN",t),a=s.toString()}return a},available_layers=[{id:"example_esri_layer",folder:"DEV Examples",name:"Esri Layer",sectors:[]},{id:"example_wms_layer",folder:"DEV Examples",name:"WMS Layer",sectors:[]},{id:"example_esri_feature_layer",folder:"DEV Examples",name:"Esri Feature Layer",sectors:[]},{id:"boundary_counties",folder:"Boundaries",name:"Counties",sectors:[]},{id:"boundary_huc8",folder:"Boundaries",name:"Watersheds",sectors:[]},{id:"soils",folder:"Land Cover",name:"Soils",sectors:[]},{id:"nfhl",folder:"Public Safety",name:"Flood Hazard",description:"FEMA National Flood Hazard Layer",source:"FEMA",source_url:"http://www.fema.gov/",sectors:["Water Resources"],download_url:"http://www.hazards.fema.gov/gis/nfhl/rest/services/public/NFHL/MapServer",metadata_url:"http://www.hazards.fema.gov/gis/nfhl/rest/services/public/NFHL/MapServer"},{id:"barrier_beaches",folder:"Coastal Zones",name:"Barrier Beaches",description:"The state barrier beach data layer was compiled by the Resource Mapping Project staff at the University of Massachusetts, Amherst for the Massachusetts Coastal Zone Management Program.",source:"Massachusetts Coastal Zone Management Program",source_url:"http://www.mass.gov/eea/agencies/czm/",sectors:["Ecosystems"],download_url:"http://wsgw.mass.gov/data/gispub/shape/state/barrb.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/state-designated-barrier-beaches-.html"},{id:"hurricane_surge",folder:"Coastal Zones",name:"Hurricane Surge",description:"The state barrier beach data layer was compiled by the Resource Mapping Project staff at the University of Massachusetts, Amherst for the Massachusetts Coastal Zone Management Program.",source:"Massachusetts Coastal Zone Management Program",source_url:"http://www.mass.gov/eea/agencies/czm/",sectors:["Ecosystems"],download_url:"http://wsgw.mass.gov/data/gispub/shape/state/barrb.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/state-designated-barrier-beaches-.html"},{id:"wind_power",folder:"Renewables",name:"Wind Power Density at 50m",description:"This data layer is a vector version of the AWS Truewind, LLC, Massachusetts Technology Collaborative 50 meter elevation wind power density raster layer. The raster layer work was jointly funded by the Connecticut Clean Energy Fund, the Massachusetts Technological Collaborative, and Northeast Utilities System.  The raster data were re-classified (AWS_CLASS) in accordance with the 8 classes used by Mass. Tech et al. The data were then converted from raster to polygon using the GRIDPOLY command. The PWRDENSITY field was created to show the power density range (watts/sq. meters) for each class. The data were then transformed from WGS1984 to NAD83 SPC using NAD1983toWGS1984 transform 5 (United States) and clipped to the extent of the WINDSPEEDGRID_POLY layer created by MassGIS and AWS Truewind, LLC. Processing of this polygon layer was completed by the Massachusetts Water Resources Authority (MWRA) GIS program and provided to MassGIS for distribution.",source:"Massachusetts Technology Collaborative",source_url:"http://www.masstech.org/",sectors:["Ecosystems"],download_url:"http://wsgw.mass.gov/data/gispub/shape/state/windpower.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/wind-power-density-at-50m.html"},{id:"prime_forest",folder:"Agriculture/Forestry",name:"Prime Forest Land",description:"Using primarily the NRCS/MassGIS Soils data, the basic procedure was to classify potentially forested land into nine different categories based on potential average timber productivity of white pine and red oak “…per acre per year at culmination of mean annual increment. Site index values are at age 50.” Other data sets were used to refine this classification, including aspect, land cover, riparian, slope position, wetlands, hydrologic soil association and unique areas.  With the January 2013 update the dataset is complete statewide.",source:"DCR, Bureau of Forestry, Management Forestry Program",source_url:"http://www.mass.gov/eea/agencies/dcr/conservation/forestry-and-fire-control/forestry.html",sectors:["Ecosystems"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/primeforest.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/primeforest.html"},{id:"tree_atlas",folder:"Agriculture/Forestry",name:"USFS Climate Change Atlas - Tree Species",description:"Modeled importance value (IV) of 20 Massachussetts native tree species for three climate conditions: 1) current climate (1961-1990 average); 2) future climate (2071-2100 average) with IPCC scenario B1 (significant conservation and reduction of CO2 emissions); and 3) future climate (2071-2100 average) with IPCC scenario A1FI (high emissions, no modification in current emission trends). Importance Value measures the dominance of a tree species in a forest, based on the relative frequency, density, and basal area of the species. For more information on the models and to explore more tree species and climate scenarios, visit the US Forest Service Climate Change Atlas: http://www.fs.fed.us/nrs/atlas/",source:"USDA Forest Service Northern Research Station",source_url:"http://www.fs.fed.us/nrs/atlas/",sectors:["Ecosystems"],download_url:null,metadata_url:null}],desired_active_on_load=[];
</script>

    <!-- Add all the javascript libs here -->
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/lodash.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};(function(){function n(n,t){if(n!==t){var r=null===n,e=n===b,u=n===n,o=null===t,i=t===b,f=t===t;if(n>t&&!o||!u||r&&!i&&f||e&&f)return 1;if(n<t&&!r||!f||o&&!e&&u||i&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return s(n,r);r-=1;for(var e=n.length;++r<e;)if(n[r]===t)return r;return-1}function e(n){return"function"==typeof n||!1}function u(n){return null==n?"":n+""}function o(n,t){for(var r=-1,e=n.length;++r<e&&-1<t.indexOf(n.charAt(r)););return r}function i(n,t){for(var r=n.length;r--&&-1<t.indexOf(n.charAt(r)););return r}function f(t,r){return n(t.a,r.a)||t.b-r.b}function c(n){return Nn[n]}function a(n){return Tn[n]}function l(n,t,r){return t?n=Bn[n]:r&&(n=Dn[n]),"\\"+n}function p(n){return"\\"+Dn[n]}function s(n,t,r){var e=n.length;for(t+=r?0:-1;r?t--:++t<e;){var u=n[t];if(u!==u)return t}return-1}function h(n){return!!n&&"object"==(void 0===n?"undefined":_typeof(n))}function _(n){return 160>=n&&9<=n&&13>=n||32==n||160==n||5760==n||6158==n||8192<=n&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n)}function v(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;)n[r]===t&&(n[r]=z,o[++u]=r);return o}function g(n){for(var t=-1,r=n.length;++t<r&&_(n.charCodeAt(t)););return t}function y(n){for(var t=n.length;t--&&_(n.charCodeAt(t)););return t}function d(n){return Ln[n]}function w(_){function Nn(n){if(h(n)&&!(Oo(n)||n instanceof zn)){if(n instanceof Ln)return n;if(nu.call(n,"__chain__")&&nu.call(n,"__wrapped__"))return Mr(n)}return new Ln(n)}function Tn(){}function Ln(n,t,r){this.__wrapped__=n,this.__actions__=r||[],this.__chain__=!!t}function zn(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ru,this.__views__=[]}function Bn(){this.__data__={}}function Dn(n){var t=n?n.length:0;for(this.data={hash:gu(null),set:new lu};t--;)this.push(n[t])}function Mn(n,t){var r=n.data;return("string"==typeof t||ge(t)?r.set.has(t):r.hash[t])?0:-1}function qn(n,t){var r=-1,e=n.length;for(t||(t=Be(e));++r<e;)t[r]=n[r];return t}function Pn(n,t){for(var r=-1,e=n.length;++r<e&&!1!==t(n[r],r,n););return n}function Kn(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function Vn(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;){var i=n[r];t(i,r,n)&&(o[++u]=i)}return o}function Gn(n,t){for(var r=-1,e=n.length,u=Be(e);++r<e;)u[r]=t(n[r],r,n);return u}function Jn(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function Xn(n,t,r,e){var u=-1,o=n.length;for(e&&o&&(r=n[++u]);++u<o;)r=t(r,n[u],u,n);return r}function Hn(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function Qn(n,t,r,e){return n!==b&&nu.call(e,r)?n:t}function nt(n,t,r){for(var e=-1,u=zo(t),o=u.length;++e<o;){var i=u[e],f=n[i],c=r(f,t[i],i,n,t);(c===c?c===f:f!==f)&&(f!==b||i in n)||(n[i]=c)}return n}function tt(n,t){return null==t?n:et(t,zo(t),n)}function rt(n,t){for(var r=-1,e=null==n,u=!e&&Er(n),o=u?n.length:0,i=t.length,f=Be(i);++r<i;){var c=t[r];f[r]=u?Cr(c,o)?n[c]:b:e?b:n[c]}return f}function et(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var o=t[e];r[o]=n[o]}return r}function ut(n,t,r){var e=void 0===n?"undefined":_typeof(n);return"function"==e?t===b?n:Bt(n,t,r):null==n?Fe:"object"==e?xt(n):t===b?ze(n):mt(n,t)}function ot(n,t,r,e,u,o,i){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==b)return f;if(!ge(n))return n;if(e=Oo(n)){if(f=kr(n),!t)return qn(n,f)}else{var c=ru.call(n),a=c==K;if(c!=Z&&c!=B&&(!a||u))return Fn[c]?Rr(n,c,t):u?n:{};if(f=Ir(a?{}:n),!t)return tt(f,n)}for(o||(o=[]),i||(i=[]),u=o.length;u--;)if(o[u]==n)return i[u];return o.push(n),i.push(f),(e?Pn:_t)(n,function(e,u){f[u]=ot(e,t,r,u,n,o,i)}),f}function it(n,t,r){if("function"!=typeof n)throw new Ge(L);return pu(function(){n.apply(b,r)},t)}function ft(n,t){var e=n?n.length:0,u=[];if(!e)return u;var o=-1,i=mr(),f=i===r,c=f&&t.length>=F&&gu&&lu?new Dn(t):null,a=t.length;c&&(i=Mn,f=!1,t=c);n:for(;++o<e;)if(c=n[o],f&&c===c){for(var l=a;l--;)if(t[l]===c)continue n;u.push(c)}else 0>i(t,c,0)&&u.push(c);return u}function ct(n,t){var r=!0;return $u(n,function(n,e,u){return r=!!t(n,e,u)}),r}function at(n,t,r,e){var u=e,o=u;return $u(n,function(n,i,f){i=+t(n,i,f),(r(i,u)||i===e&&i===o)&&(u=i,o=n)}),o}function lt(n,t){var r=[];return $u(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function pt(n,t,r,e){var u;return r(n,function(n,r,o){return t(n,r,o)?(u=e?r:n,!1):void 0}),u}function st(n,t,r,e){e||(e=[]);for(var u=-1,o=n.length;++u<o;){var i=n[u];h(i)&&Er(i)&&(r||Oo(i)||se(i))?t?st(i,t,r,e):Jn(e,i):r||(e[e.length]=i)}return e}function ht(n,t){Nu(n,t,Re)}function _t(n,t){return Nu(n,t,zo)}function vt(n,t){return Tu(n,t,zo)}function gt(n,t){for(var r=-1,e=t.length,u=-1,o=[];++r<e;){var i=t[r];ve(n[i])&&(o[++u]=i)}return o}function yt(n,t,r){if(null!=n){r!==b&&r in Br(n)&&(t=[r]),r=0;for(var e=t.length;null!=n&&r<e;)n=n[t[r++]];return r&&r==e?n:b}}function dt(n,t,r,e,u,o){if(n===t)n=!0;else if(null==n||null==t||!ge(n)&&!h(t))n=n!==n&&t!==t;else n:{var i=dt,f=Oo(n),c=Oo(t),a=D,l=D;f||(a=ru.call(n),a==B?a=Z:a!=Z&&(f=me(n))),c||(l=ru.call(t),l==B?l=Z:l!=Z&&me(t));var p=a==Z,c=l==Z;if(!(l=a==l)||f||p){if(!e&&(a=p&&nu.call(n,"__wrapped__"),c=c&&nu.call(t,"__wrapped__"),a||c)){n=i(a?n.value():n,c?t.value():t,r,e,u,o);break n}if(l){for(u||(u=[]),o||(o=[]),a=u.length;a--;)if(u[a]==n){n=o[a]==t;break n}u.push(n),o.push(t),n=(f?yr:wr)(n,t,i,r,e,u,o),u.pop(),o.pop()}else n=!1}else n=dr(n,t,a)}return n}function wt(n,t,r){var e=t.length,u=e,o=!r;if(null==n)return!u;for(n=Br(n);e--;){var i=t[e];if(o&&i[2]?i[1]!==n[i[0]]:!(i[0]in n))return!1}for(;++e<u;){var f=(i=t[e])[0],c=n[f],a=i[1];if(o&&i[2]){if(c===b&&!(f in n))return!1}else if(i=r?r(c,a,f):b,i===b?!dt(a,c,r,!0):!i)return!1}return!0}function bt(n,t){var r=-1,e=Er(n)?Be(n.length):[];return $u(n,function(n,u,o){e[++r]=t(n,u,o)}),e}function xt(n){var t=Ar(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null!=n&&(n[r]===e&&(e!==b||r in Br(n)))}}return function(n){return wt(n,t)}}function mt(n,t){var r=Oo(n),e=Ur(n)&&t===t&&!ge(t),u=n+"";return n=Dr(n),function(o){if(null==o)return!1;var i=u;if(o=Br(o),!(!r&&e||i in o)){if(null==(o=1==n.length?o:yt(o,Et(n,0,-1))))return!1;i=Zr(n),o=Br(o)}return o[i]===t?t!==b||i in o:dt(t,o[i],b,!0)}}function At(n,t,r,e,u){if(!ge(n))return n;var o=Er(t)&&(Oo(t)||me(t)),i=o?b:zo(t);return Pn(i||t,function(f,c){if(i&&(c=f,f=t[c]),h(f)){e||(e=[]),u||(u=[]);n:{for(var a=c,l=e,p=u,s=l.length,_=t[a];s--;)if(l[s]==_){n[a]=p[s];break n}var s=n[a],v=r?r(s,_,a,n,t):b,g=v===b;g&&(v=_,Er(_)&&(Oo(_)||me(_))?v=Oo(s)?s:Er(s)?qn(s):[]:we(_)||se(_)?v=se(s)?ke(s):we(s)?s:{}:g=!1),l.push(_),p.push(v),g?n[a]=At(v,_,r,l,p):(v===v?v!==s:s===s)&&(n[a]=v)}}else a=n[c],l=r?r(a,f,c,n,t):b,(p=l===b)&&(l=f),l===b&&(!o||c in n)||!p&&(l===l?l===a:a!==a)||(n[c]=l)}),n}function jt(n){return function(t){return null==t?b:t[n]}}function kt(n){var t=n+"";return n=Dr(n),function(r){return yt(r,n,t)}}function It(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Cr(e)){var u=e;su.call(n,e,1)}}}function Rt(n,t){return n+yu(ku()*(t-n+1))}function Ot(n,t,r,e,u){return u(n,function(n,u,o){r=e?(e=!1,n):t(r,n,u,o)}),r}function Et(n,t,r){var e=-1,u=n.length;for(0>(t=null==t?0:+t||0)&&(t=-t>u?0:u+t),0>(r=r===b||r>u?u:+r||0)&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Be(u);++e<u;)r[e]=n[e+t];return r}function Ct(n,t){var r;return $u(n,function(n,e,u){return!(r=t(n,e,u))}),!!r}function St(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function Ut(t,r,e){var u=br(),o=-1;return r=Gn(r,function(n){return u(n)}),t=bt(t,function(n){return{a:Gn(r,function(t){return t(n)}),b:++o,c:n}}),St(t,function(t,r){var u;n:{for(var o=-1,i=t.a,f=r.a,c=i.length,a=e.length;++o<c;)if(u=n(i[o],f[o])){if(o>=a)break n;u*="asc"===(o=e[o])||!0===o?1:-1;break n}u=t.b-r.b}return u})}function Wt(n,t){var r=0;return $u(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function $t(n,t){var e=-1,u=mr(),o=n.length,i=u===r,f=i&&o>=F,c=f&&gu&&lu?new Dn(void 0):null,a=[];c?(u=Mn,i=!1):(f=!1,c=t?[]:a);n:for(;++e<o;){var l=n[e],p=t?t(l,e,n):l;if(i&&l===l){for(var s=c.length;s--;)if(c[s]===p)continue n;t&&c.push(p),a.push(l)}else 0>u(c,p,0)&&((t||f)&&c.push(p),a.push(l))}return a}function Ft(n,t){for(var r=-1,e=t.length,u=Be(e);++r<e;)u[r]=n[t[r]];return u}function Nt(n,t,r,e){for(var u=n.length,o=e?u:-1;(e?o--:++o<u)&&t(n[o],o,n););return r?Et(n,e?0:o,e?o+1:u):Et(n,e?o+1:0,e?u:o)}function Tt(n,t){(o=n)instanceof zn&&(o=o.value());for(var r=-1,e=t.length;++r<e;)var u=t[r],o=u.func.apply(u.thisArg,Jn([o],u.args));return o}function Lt(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&u<=Eu){for(;e<u;){var o=e+u>>>1,i=n[o];(r?i<=t:i<t)&&null!==i?e=o+1:u=o}return u}return zt(n,t,Fe,r)}function zt(n,t,r,e){t=r(t);for(var u=0,o=n?n.length:0,i=t!==t,f=null===t,c=t===b;u<o;){var a=yu((u+o)/2),l=r(n[a]),p=l!==b,s=l===l;(i?s||e:f?s&&p&&(e||null!=l):c?s&&(e||p):null==l?0:e?l<=t:l<t)?u=a+1:o=a}return mu(o,Ou)}function Bt(n,t,r){if("function"!=typeof n)return Fe;if(t===b)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,o){return n.call(t,r,e,u,o)};case 5:return function(r,e,u,o,i){return n.call(t,r,e,u,o,i)}}return function(){return n.apply(t,arguments)}}function Dt(n){var t=new ou(n.byteLength);return new hu(t).set(new hu(n)),t}function Mt(n,t,r){for(var e=r.length,u=-1,o=xu(n.length-e,0),i=-1,f=t.length,c=Be(f+o);++i<f;)c[i]=t[i];for(;++u<e;)c[r[u]]=n[u];for(;o--;)c[i++]=n[u++];return c}function qt(n,t,r){for(var e=-1,u=r.length,o=-1,i=xu(n.length-u,0),f=-1,c=t.length,a=Be(i+c);++o<i;)a[o]=n[o];for(i=o;++f<c;)a[i+f]=t[f];for(;++e<u;)a[i+r[e]]=n[o++];return a}function Pt(n,t){return function(r,e,u){var o=t?t():{};if(e=br(e,u,3),Oo(r)){u=-1;for(var i=r.length;++u<i;){var f=r[u];n(o,f,e(f,u,r),r)}}else $u(r,function(t,r,u){n(o,t,e(t,r,u),u)});return o}}function Kt(n){return le(function(t,r){var e=-1,u=null==t?0:r.length,o=2<u?r[u-2]:b,i=2<u?r[2]:b,f=1<u?r[u-1]:b;for("function"==typeof o?(o=Bt(o,f,5),u-=2):(o="function"==typeof f?f:b,u-=o?1:0),i&&Sr(r[0],r[1],i)&&(o=3>u?b:o,u=1);++e<u;)(i=r[e])&&n(t,i,o);return t})}function Vt(n,t){return function(r,e){var u=r?Bu(r):0;if(!$r(u))return n(r,e);for(var o=t?u:-1,i=Br(r);(t?o--:++o<u)&&!1!==e(i[o],o,i););return r}}function Zt(n){return function(t,r,e){for(var u=Br(t),o=(e=e(t)).length,i=n?o:-1;n?i--:++i<o;){var f=e[i];if(!1===r(u[f],f,u))break}return t}}function Yt(n,t){function r(){return(this&&this!==Zn&&this instanceof r?e:n).apply(t,arguments)}var e=Jt(n);return r}function Gt(n){return function(t){for(var r=-1,e=(t=We(Ce(t))).length,u="";++r<e;)u=n(u,t[r],r);return u}}function Jt(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Wu(n.prototype);return ge(t=n.apply(r,t))?t:r}}function Xt(n){function t(r,e,u){return u&&Sr(r,e,u)&&(e=b),r=gr(r,n,b,b,b,b,b,e),r.placeholder=t.placeholder,r}return t}function Ht(n,t){return le(function(r){var e=r[0];return null==e?e:(r.push(t),n.apply(b,r))})}function Qt(n,t){return function(r,e,u){if(u&&Sr(r,e,u)&&(e=b),1==(e=br(e,u,3)).length){for(var o=e,i=-1,f=(u=r=Oo(r)?r:zr(r)).length,c=t,a=c;++i<f;){var l=u[i],p=+o(l);n(p,c)&&(c=p,a=l)}if(u=a,!r.length||u!==t)return u}return at(r,e,n,t)}}function nr(n,r){return function(e,u,o){return u=br(u,o,3),Oo(e)?(u=t(e,u,r),-1<u?e[u]:b):pt(e,u,n)}}function tr(n){return function(r,e,u){return r&&r.length?(e=br(e,u,3),t(r,e,n)):-1}}function rr(n){return function(t,r,e){return r=br(r,e,3),pt(t,r,n,!0)}}function er(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,o=Be(r);n?e--:++e<r;){if("function"!=typeof(i=o[u++]=arguments[e]))throw new Ge(L);!t&&Ln.prototype.thru&&"wrapper"==xr(i)&&(t=new Ln([],!0))}for(e=t?-1:r;++e<r;){var i=o[e],f="wrapper"==(u=xr(i))?zu(i):b;t=f&&Wr(f[0])&&f[1]==(E|k|R|C)&&!f[4].length&&1==f[9]?t[xr(f[0])].apply(t,f[3]):1==i.length&&Wr(i)?t[u]():t.thru(i)}return function(){var n=(u=arguments)[0];if(t&&1==u.length&&Oo(n)&&n.length>=F)return t.plant(n).value();for(var e=0,u=r?o[e].apply(this,u):n;++e<r;)u=o[e].call(this,u);return u}}}function ur(n,t){return function(r,e,u){return"function"==typeof e&&u===b&&Oo(r)?n(r,e):t(r,Bt(e,u,3))}}function or(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=Bt(r,e,3)),n(t,r,Re)}}function ir(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=Bt(r,e,3)),n(t,r)}}function fr(n){return function(t,r,e){var u={};return r=br(r,e,3),_t(t,function(t,e,o){o=r(t,e,o),e=n?o:e,t=n?t:o,u[e]=t}),u}}function cr(n){return function(t,r,e){return t=u(t),(n?t:"")+sr(t,r,e)+(n?"":t)}}function ar(n){var t=le(function(r,e){var u=v(e,t.placeholder);return gr(r,n,b,e,u)});return t}function lr(n,t){return function(r,e,u,o){var i=3>arguments.length;return"function"==typeof e&&o===b&&Oo(r)?n(r,e,u,i):Ot(r,br(e,o,4),u,i,t)}}function pr(n,t,r,e,u,o,i,f,c,a){function l(){for(var w=k=arguments.length,x=Be(k);w--;)x[w]=arguments[w];if(e&&(x=Mt(x,e,u)),o&&(x=qt(x,o,i)),(_||y)&&(k=k-(E=v(x,w=l.placeholder)).length)<a){var j=f?qn(f):b,k=xu(a-k,0),I=_?E:b,E=_?b:E,C=_?x:b,x=_?b:x;return t|=_?R:O,t&=~(_?O:R),g||(t&=~(m|A)),x=[n,t,r,C,I,x,E,j,c,k],j=pr.apply(b,x),Wr(n)&&Du(j,x),j.placeholder=w,j}if(w=s?r:this,j=h?w[n]:n,f)for(k=x.length,I=mu(f.length,k),E=qn(x);I--;)C=f[I],x[I]=Cr(C,k)?E[C]:b;return p&&c<x.length&&(x.length=c),this&&this!==Zn&&this instanceof l&&(j=d||Jt(n)),j.apply(w,x)}var p=t&E,s=t&m,h=t&A,_=t&k,g=t&j,y=t&I,d=h?b:Jt(n);return l}function sr(n,t,r){return n=n.length,t=+t,n<t&&wu(t)?(t-=n,r=null==r?" ":r+"",Se(r,vu(t/r.length)).slice(0,t)):""}function hr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,c=-1,a=e.length,l=Be(a+f);++c<a;)l[c]=e[c];for(;f--;)l[c++]=arguments[++t];return(this&&this!==Zn&&this instanceof u?i:n).apply(o?r:this,l)}var o=t&m,i=Jt(n);return u}function _r(n){var t=Pe[n];return function(n,r){return(r=r===b?0:+r||0)?(r=cu(10,r),t(n*r)/r):t(n)}}function vr(n){return function(t,r,e,u){var o=br(e);return null==e&&o===ut?Lt(t,r,n):zt(t,r,o(e,u,1),n)}}function gr(n,t,r,e,u,o,i,f){var c=t&A;if(!c&&"function"!=typeof n)throw new Ge(L);var a=e?e.length:0;if(a||(t&=~(R|O),e=u=b),a-=u?u.length:0,t&O){var l=e,p=u;e=u=b}var s=c?b:zu(n);return r=[n,t,r,e,u,l,p,o,i,f],s&&(e=r[1],t=s[1],f=e|t,u=t==E&&e==k||t==E&&e==C&&r[7].length<=s[8]||t==(E|C)&&e==k,(f<E||u)&&(t&m&&(r[2]=s[2],f|=e&m?0:j),(e=s[3])&&(u=r[3],r[3]=u?Mt(u,e,s[4]):qn(e),r[4]=u?v(r[3],z):qn(s[4])),(e=s[5])&&(u=r[5],r[5]=u?qt(u,e,s[6]):qn(e),r[6]=u?v(r[5],z):qn(s[6])),(e=s[7])&&(r[7]=qn(e)),t&E&&(r[8]=null==r[8]?s[8]:mu(r[8],s[8])),null==r[9]&&(r[9]=s[9]),r[0]=s[0],r[1]=f),t=r[1],f=r[9]),r[9]=null==f?c?0:n.length:xu(f-a,0)||0,(s?Lu:Du)(t==m?Yt(r[0],r[2]):t!=R&&t!=(m|R)||r[4].length?pr.apply(b,r):hr.apply(b,r),r)}function yr(n,t,r,e,u,o,i){var f=-1,c=n.length;if(c!=(l=t.length)&&(!u||l<=c))return!1;for(;++f<c;){var a=n[f],l=t[f],p=e?e(u?l:a,u?a:l,f):b;if(p!==b){if(p)continue;return!1}if(u){if(!Hn(t,function(n){return a===n||r(a,n,e,u,o,i)}))return!1}else if(a!==l&&!r(a,l,e,u,o,i))return!1}return!0}function dr(n,t,r){switch(r){case M:case q:return+n==+t;case P:return n.name==t.name&&n.message==t.message;case V:return n!=+n?t!=+t:n==+t;case Y:case G:return n==t+""}return!1}function wr(n,t,r,e,u,o,i){var f=zo(n),c=f.length,a=zo(t).length;if(c!=a&&!u)return!1;for(a=c;a--;){var l=f[a];if(!(u?l in t:nu.call(t,l)))return!1}for(var p=u;++a<c;){var s=n[l=f[a]],h=t[l],_=e?e(u?h:s,u?s:h,l):b;if(_===b?!r(s,h,e,u,o,i):!_)return!1;p||(p="constructor"==l)}return!(!p&&(r=n.constructor,e=t.constructor,r!=e&&"constructor"in n&&"constructor"in t&&!("function"==typeof r&&r instanceof r&&"function"==typeof e&&e instanceof e)))}function br(n,t,r){var e=(e=Nn.callback||$e)===$e?ut:e;return r?e(n,t,r):e}function xr(n){for(var t=n.name+"",r=Uu[t],e=r?r.length:0;e--;){var u=r[e],o=u.func;if(null==o||o==n)return u.name}return t}function mr(n,t,e){var u=(u=Nn.indexOf||Vr)===Vr?r:u;return n?u(n,t,e):u}function Ar(n){for(var t=(n=Oe(n)).length;t--;){var r=n[t][1];n[t][2]=r===r&&!ge(r)}return n}function jr(n,t){var r=null==n?b:n[t];return ye(r)?r:b}function kr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&nu.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Ir(n){return"function"==typeof(n=n.constructor)&&n instanceof n||(n=Ve),new n}function Rr(n,t,r){var e=n.constructor;switch(t){case J:return Dt(n);case M:case q:return new e(+n);case X:case H:case Q:case nn:case tn:case rn:case en:case un:case on:return t=n.buffer,new e(r?Dt(t):t,n.byteOffset,n.length);case V:case G:return new e(n);case Y:var u=new e(n.source,kn.exec(n));u.lastIndex=n.lastIndex}return u}function Or(n,t,r){return null==n||Ur(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),t=Zr(t)),t=null==n?n:n[t],null==t?b:t.apply(n,r)}function Er(n){return null!=n&&$r(Bu(n))}function Cr(n,t){return n="number"==typeof n||On.test(n)?+n:-1,t=null==t?Cu:t,-1<n&&0==n%1&&n<t}function Sr(n,t,r){if(!ge(r))return!1;var e=void 0===t?"undefined":_typeof(t);return!!("number"==e?Er(r)&&Cr(t,r.length):"string"==e&&t in r)&&(t=r[t],n===n?n===t:t!==t)}function Ur(n,t){var r=void 0===n?"undefined":_typeof(n);return!!("string"==r&&dn.test(n)||"number"==r)||!Oo(n)&&(!yn.test(n)||null!=t&&n in Br(t))}function Wr(n){var t=xr(n),r=Nn[t];return"function"==typeof r&&t in zn.prototype&&(n===r||!!(t=zu(r))&&n===t[0])}function $r(n){return"number"==typeof n&&-1<n&&0==n%1&&n<=Cu}function Fr(n,t){return n===b?t:Eo(n,t,Fr)}function Nr(n,t){n=Br(n);for(var r=-1,e=t.length,u={};++r<e;){var o=t[r];o in n&&(u[o]=n[o])}return u}function Tr(n,t){var r={};return ht(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function Lr(n){for(var t=Re(n),r=t.length,e=r&&n.length,u=!!e&&$r(e)&&(Oo(n)||se(n)),o=-1,i=[];++o<r;){var f=t[o];(u&&Cr(f,e)||nu.call(n,f))&&i.push(f)}return i}function zr(n){return null==n?[]:Er(n)?ge(n)?n:Ve(n):Ee(n)}function Br(n){return ge(n)?n:Ve(n)}function Dr(n){if(Oo(n))return n;var t=[];return u(n).replace(wn,function(n,r,e,u){t.push(e?u.replace(An,"$1"):r||n)}),t}function Mr(n){return n instanceof zn?n.clone():new Ln(n.__wrapped__,n.__chain__,qn(n.__actions__))}function qr(n,t,r){return n&&n.length?((r?Sr(n,t,r):null==t)&&(t=1),Et(n,0>t?0:t)):[]}function Pr(n,t,r){var e=n?n.length:0;return e?((r?Sr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0,0>t?0:t)):[]}function Kr(n){return n?n[0]:b}function Vr(n,t,e){var u=n?n.length:0;if(!u)return-1;if("number"==typeof e)e=0>e?xu(u+e,0):e;else if(e)return e=Lt(n,t),e<u&&(t===t?t===n[e]:n[e]!==n[e])?e:-1;return r(n,t,e||0)}function Zr(n){var t=n?n.length:0;return t?n[t-1]:b}function Yr(n){return qr(n,1)}function Gr(n,t,e,u){if(!n||!n.length)return[];null!=t&&"boolean"!=typeof t&&(u=e,e=Sr(n,t,u)?b:t,t=!1);i=br();if((null!=e||i!==ut)&&(e=i(e,u,3)),t&&mr()===r){t=e;var o;e=-1,u=n.length;for(var i=-1,f=[];++e<u;){var c=n[e],a=t?t(c,e,n):c;e&&o===a||(o=a,f[++i]=c)}n=f}else n=$t(n,e);return n}function Jr(n){if(!n||!n.length)return[];var t=-1,r=0;n=Vn(n,function(n){return Er(n)?(r=xu(n.length,r),!0):void 0});for(var e=Be(r);++t<r;)e[t]=Gn(n,jt(t));return e}function Xr(n,t,r){return n&&n.length?(n=Jr(n),null==t?n:(t=Bt(t,r,4),Gn(n,function(n){return Xn(n,t,b,!0)}))):[]}function Hr(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Oo(n[0])||(t=[]);++r<e;){var o=n[r];t?u[o]=t[r]:o&&(u[o[0]]=o[1])}return u}function Qr(n){return n=Nn(n),n.__chain__=!0,n}function ne(n,t,r){return t.call(r,n)}function te(n,t,r){var e=Oo(n)?Kn:ct;return r&&Sr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=br(t,r,3)),e(n,t)}function re(n,t,r){var e=Oo(n)?Vn:lt;return t=br(t,r,3),e(n,t)}function ee(n,t,r,e){var u=n?Bu(n):0;return $r(u)||(n=Ee(n),u=n.length),r="number"!=typeof r||e&&Sr(t,r,e)?0:0>r?xu(u+r,0):r||0,"string"==typeof n||!Oo(n)&&xe(n)?r<=u&&-1<n.indexOf(t,r):!!u&&-1<mr(n,t,r)}function ue(n,t,r){var e=Oo(n)?Gn:bt;return t=br(t,r,3),e(n,t)}function oe(n,t,r){if(r?Sr(n,t,r):null==t)return 0<(e=(n=zr(n)).length)?n[Rt(0,e-1)]:b;r=-1;var e=(n=je(n)).length,u=e-1;for(t=mu(0>t?0:+t||0,e);++r<t;){var o=n[e=Rt(r,u)];n[e]=n[r],n[r]=o}return n.length=t,n}function ie(n,t,r){var e=Oo(n)?Hn:Ct;return r&&Sr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=br(t,r,3)),e(n,t)}function fe(n,t){var r;if("function"!=typeof t){if("function"!=typeof n)throw new Ge(L);var e=n;n=t,t=e}return function(){return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=b),r}}function ce(n,t,r){function e(t,r){r&&iu(r),c=s=h=b,t&&(_=ho(),a=n.apply(p,f),s||c||(f=p=b))}function u(){var n=t-(ho()-l);0>=n||n>t?e(h,c):s=pu(u,n)}function o(){e(g,s)}function i(){if(f=arguments,l=ho(),p=this,h=g&&(s||!y),!1===v)var r=y&&!s;else{c||y||(_=l);var e=v-(l-_),i=0>=e||e>v;i?(c&&(c=iu(c)),_=l,a=n.apply(p,f)):c||(c=pu(o,e))}return i&&s?s=iu(s):s||t===v||(s=pu(u,t)),r&&(i=!0,a=n.apply(p,f)),!i||s||c||(f=p=b),a}var f,c,a,l,p,s,h,_=0,v=!1,g=!0;if("function"!=typeof n)throw new Ge(L);if(t=0>t?0:+t||0,!0===r)var y=!0,g=!1;else ge(r)&&(y=!!r.leading,v="maxWait"in r&&xu(+r.maxWait||0,t),g="trailing"in r?!!r.trailing:g);return i.cancel=function(){s&&iu(s),c&&iu(c),_=0,c=s=h=b},i}function ae(n,t){function r(){var e=arguments,u=t?t.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=n.apply(this,e),r.cache=o.set(u,e),e)}if("function"!=typeof n||t&&"function"!=typeof t)throw new Ge(L);return r.cache=new ae.Cache,r}function le(n,t){if("function"!=typeof n)throw new Ge(L);return t=xu(t===b?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=xu(r.length-t,0),o=Be(u);++e<u;)o[e]=r[t+e];switch(t){case 0:return n.call(this,o);case 1:return n.call(this,r[0],o);case 2:return n.call(this,r[0],r[1],o)}for(u=Be(t+1),e=-1;++e<t;)u[e]=r[e];return u[t]=o,n.apply(this,u)}}function pe(n,t){return n>t}function se(n){return h(n)&&Er(n)&&nu.call(n,"callee")&&!au.call(n,"callee")}function he(n,t,r,e){return e=(r="function"==typeof r?Bt(r,e,3):b)?r(n,t):b,e===b?dt(n,t,r):!!e}function _e(n){return h(n)&&"string"==typeof n.message&&ru.call(n)==P}function ve(n){return ge(n)&&ru.call(n)==K}function ge(n){var t=void 0===n?"undefined":_typeof(n);return!!n&&("object"==t||"function"==t)}function ye(n){return null!=n&&(ve(n)?uu.test(Qe.call(n)):h(n)&&Rn.test(n))}function de(n){return"number"==typeof n||h(n)&&ru.call(n)==V}function we(n){var t;if(!h(n)||ru.call(n)!=Z||se(n)||!(nu.call(n,"constructor")||"function"!=typeof(t=n.constructor)||t instanceof t))return!1;var r;return ht(n,function(n,t){r=t}),r===b||nu.call(n,r)}function be(n){return ge(n)&&ru.call(n)==Y}function xe(n){return"string"==typeof n||h(n)&&ru.call(n)==G}function me(n){return h(n)&&$r(n.length)&&!!$n[ru.call(n)]}function Ae(n,t){return n<t}function je(n){var t=n?Bu(n):0;return $r(t)?t?qn(n):[]:Ee(n)}function ke(n){return et(n,Re(n))}function Ie(n){return gt(n,Re(n))}function Re(n){if(null==n)return[];ge(n)||(n=Ve(n));for(var t=(t=n.length)&&$r(t)&&(Oo(n)||se(n))&&t||0,r=-1,e="function"==typeof(e=n.constructor)&&e.prototype===n,u=Be(t),o=0<t;++r<t;)u[r]=r+"";for(var i in n)o&&Cr(i,t)||"constructor"==i&&(e||!nu.call(n,i))||u.push(i);return u}function Oe(n){n=Br(n);for(var t=-1,r=zo(n),e=r.length,u=Be(e);++t<e;){var o=r[t];u[t]=[o,n[o]]}return u}function Ee(n){return Ft(n,zo(n))}function Ce(n){return(n=u(n))&&n.replace(En,c).replace(mn,"")}function Se(n,t){var r="";if(n=u(n),1>(t=+t)||!n||!wu(t))return r;do{t%2&&(r+=n),t=yu(t/2),n+=n}while(t);return r}function Ue(n,t,r){var e=n;return(n=u(n))?(r?Sr(e,t,r):null==t)?n.slice(g(n),y(n)+1):(t+="",n.slice(o(n,t),i(n,t)+1)):n}function We(n,t,r){return r&&Sr(n,t,r)&&(t=b),(n=u(n)).match(t||Un)||[]}function $e(n,t,r){return r&&Sr(n,t,r)&&(t=b),h(n)?Ne(n):ut(n,t)}function Fe(n){return n}function Ne(n){return xt(ot(n,!0))}function Te(n,t,r){if(null==r){var e=(o=ge(t))?zo(t):b;((e=e&&e.length?gt(t,e):b)?e.length:o)||(e=!1,r=t,t=n,n=this)}e||(e=gt(t,zo(t)));var u=!0,o=-1,i=ve(n),f=e.length;!1===r?u=!1:ge(r)&&"chain"in r&&(u=r.chain);for(;++o<f;){var c=t[r=e[o]];n[r]=c,i&&(n.prototype[r]=function(t){return function(){var r=this.__chain__;if(u||r){var e=n(this.__wrapped__);return(e.__actions__=qn(this.__actions__)).push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return t.apply(n,Jn([this.value()],arguments))}}(c))}return n}function Le(){}function ze(n){return Ur(n)?jt(n):kt(n)}var Be=(_=_?Yn.defaults(Zn.Object(),_,Yn.pick(Zn,Wn)):Zn).Array,De=_.Date,Me=_.Error,qe=_.Function,Pe=_.Math,Ke=_.Number,Ve=_.Object,Ze=_.RegExp,Ye=_.String,Ge=_.TypeError,Je=Be.prototype,Xe=Ve.prototype,He=Ye.prototype,Qe=qe.prototype.toString,nu=Xe.hasOwnProperty,tu=0,ru=Xe.toString,eu=Zn._,uu=Ze("^"+Qe.call(nu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ou=_.ArrayBuffer,iu=_.clearTimeout,fu=_.parseFloat,cu=Pe.pow,au=Xe.propertyIsEnumerable,lu=jr(_,"Set"),pu=_.setTimeout,su=Je.splice,hu=_.Uint8Array,_u=jr(_,"WeakMap"),vu=Pe.ceil,gu=jr(Ve,"create"),yu=Pe.floor,du=jr(Be,"isArray"),wu=_.isFinite,bu=jr(Ve,"keys"),xu=Pe.max,mu=Pe.min,Au=jr(De,"now"),ju=_.parseInt,ku=Pe.random,Iu=Ke.NEGATIVE_INFINITY,Ru=Ke.POSITIVE_INFINITY,Ou=4294967294,Eu=2147483647,Cu=9007199254740991,Su=_u&&new _u,Uu={};Nn.support={},Nn.templateSettings={escape:_n,evaluate:vn,interpolate:gn,variable:"",imports:{_:Nn}};var Wu=function(){function n(){}return function(t){if(ge(t)){n.prototype=t;var r=new n;n.prototype=b}return r||{}}}(),$u=Vt(_t),Fu=Vt(vt,!0),Nu=Zt(),Tu=Zt(!0),Lu=Su?function(n,t){return Su.set(n,t),n}:Fe,zu=Su?function(n){return Su.get(n)}:Le,Bu=jt("length"),Du=function(){var n=0,t=0;return function(r,e){var u=ho(),o=$-(u-t);if(t=u,0<o){if(++n>=W)return r}else n=0;return Lu(r,e)}}(),Mu=le(function(n,t){return h(n)&&Er(n)?ft(n,st(t,!1,!0)):[]}),qu=tr(),Pu=tr(!0),Ku=le(function(n){for(var t=n.length,e=t,u=Be(l),o=mr(),i=o===r,f=[];e--;){var c=n[e]=Er(c=n[e])?c:[];u[e]=i&&120<=c.length&&gu&&lu?new Dn(e&&c):null}var a=-1,l=(i=n[0])?i.length:0,p=u[0];n:for(;++a<l;)if(c=i[a],0>(p?Mn(p,c):o(f,c,0))){for(e=t;--e;){var s=u[e];if(0>(s?Mn(s,c):o(n[e],c,0)))continue n}p&&p.push(c),f.push(c)}return f}),Vu=le(function(t,r){var e=rt(t,r=st(r));return It(t,r.sort(n)),e}),Zu=vr(),Yu=vr(!0),Gu=le(function(n){return $t(st(n,!1,!0))}),Ju=le(function(n,t){return Er(n)?ft(n,t):[]}),Xu=le(Jr),Hu=le(function(n){var t=n.length,r=2<t?n[t-2]:b,e=1<t?n[t-1]:b;return 2<t&&"function"==typeof r?t-=2:(r=1<t&&"function"==typeof e?(--t,e):b,e=b),n.length=t,Xr(n,r,e)}),Qu=le(function(n){return n=st(n),this.thru(function(t){t=Oo(t)?t:[Br(t)];for(var r=n,e=-1,u=t.length,o=-1,i=r.length,f=Be(u+i);++e<u;)f[e]=t[e];for(;++o<i;)f[e++]=r[o];return f})}),no=le(function(n,t){return rt(n,st(t))}),to=Pt(function(n,t,r){nu.call(n,r)?++n[r]:n[r]=1}),ro=nr($u),eo=nr(Fu,!0),uo=ur(Pn,$u),oo=ur(function(n,t){for(var r=n.length;r--&&!1!==t(n[r],r,n););return n},Fu),io=Pt(function(n,t,r){nu.call(n,r)?n[r].push(t):n[r]=[t]}),fo=Pt(function(n,t,r){n[r]=t}),co=le(function(n,t,r){var e=-1,u="function"==typeof t,o=Ur(t),i=Er(n)?Be(n.length):[];return $u(n,function(n){var f=u?t:o&&null!=n?n[t]:b;i[++e]=f?f.apply(n,r):Or(n,t,r)}),i}),ao=Pt(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),lo=lr(Xn,$u),po=lr(function(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r},Fu),so=le(function(n,t){if(null==n)return[];var r=t[2];return r&&Sr(t[0],t[1],r)&&(t.length=1),Ut(n,st(t),[])}),ho=Au||function(){return(new De).getTime()},_o=le(function(n,t,r){u=m;if(r.length)var e=v(r,_o.placeholder),u=u|R;return gr(n,u,t,r,e)}),vo=le(function(n,t){for(var r=-1,e=(t=t.length?st(t):Ie(n)).length;++r<e;){var u=t[r];n[u]=gr(n[u],m,n)}return n}),go=le(function(n,t,r){u=m|A;if(r.length)var e=v(r,go.placeholder),u=u|R;return gr(t,u,n,r,e)}),yo=Xt(k),wo=Xt(I),bo=le(function(n,t){return it(n,1,t)}),xo=le(function(n,t,r){return it(n,t,r)}),mo=er(),Ao=er(!0),jo=le(function(n,t){if(t=st(t),"function"!=typeof n||!Kn(t,e))throw new Ge(L);var r=t.length;return le(function(e){for(var u=mu(e.length,r);u--;)e[u]=t[u](e[u]);return n.apply(this,e)})}),ko=ar(R),Io=ar(O),Ro=le(function(n,t){return gr(n,C,b,b,b,st(t))}),Oo=du||function(n){return h(n)&&$r(n.length)&&ru.call(n)==D},Eo=Kt(At),Co=Kt(function(n,t,r){return r?nt(n,t,r):tt(n,t)}),So=Ht(Co,function(n,t){return n===b?t:n}),Uo=Ht(Eo,Fr),Wo=rr(_t),$o=rr(vt),Fo=or(Nu),No=or(Tu),To=ir(_t),Lo=ir(vt),zo=bu?function(n){var t=null==n?b:n.constructor;return"function"==typeof t&&t.prototype===n||"function"!=typeof n&&Er(n)?Lr(n):ge(n)?bu(n):[]}:Lr,Bo=fr(!0),Do=fr(),Mo=le(function(n,t){if(null==n)return{};if("function"!=typeof t[0])return t=Gn(st(t),Ye),Nr(n,ft(Re(n),t));var r=Bt(t[0],t[1],3);return Tr(n,function(n,t,e){return!r(n,t,e)})}),qo=le(function(n,t){return null==n?{}:"function"==typeof t[0]?Tr(n,Bt(t[0],t[1],3)):Nr(n,st(t))}),Po=Gt(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Ko=Gt(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Vo=cr(),Zo=cr(!0),Yo=Gt(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Go=Gt(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Jo=le(function(n,t){try{return n.apply(b,t)}catch(n){return _e(n)?n:new Me(n)}}),Xo=le(function(n,t){return function(r){return Or(r,n,t)}}),Ho=le(function(n,t){return function(r){return Or(n,r,t)}}),Qo=_r("ceil"),ni=_r("floor"),ti=Qt(pe,Iu),ri=Qt(Ae,Ru),ei=_r("round");return Nn.prototype=Tn.prototype,Ln.prototype=Wu(Tn.prototype),Ln.prototype.constructor=Ln,zn.prototype=Wu(Tn.prototype),zn.prototype.constructor=zn,Bn.prototype.delete=function(n){return this.has(n)&&delete this.__data__[n]},Bn.prototype.get=function(n){return"__proto__"==n?b:this.__data__[n]},Bn.prototype.has=function(n){return"__proto__"!=n&&nu.call(this.__data__,n)},Bn.prototype.set=function(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this},Dn.prototype.push=function(n){var t=this.data;"string"==typeof n||ge(n)?t.set.add(n):t.hash[n]=!0},ae.Cache=Bn,Nn.after=function(n,t){if("function"!=typeof t){if("function"!=typeof n)throw new Ge(L);var r=n;n=t,t=r}return n=wu(n=+n)?n:0,function(){return 1>--n?t.apply(this,arguments):void 0}},Nn.ary=function(n,t,r){return r&&Sr(n,t,r)&&(t=b),t=n&&null==t?n.length:xu(+t||0,0),gr(n,E,b,b,b,b,t)},Nn.assign=Co,Nn.at=no,Nn.before=fe,Nn.bind=_o,Nn.bindAll=vo,Nn.bindKey=go,Nn.callback=$e,Nn.chain=Qr,Nn.chunk=function(n,t,r){t=(r?Sr(n,t,r):null==t)?1:xu(yu(t)||1,1),r=0;for(var e=n?n.length:0,u=-1,o=Be(vu(e/t));r<e;)o[++u]=Et(n,r,r+=t);return o},Nn.compact=function(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var o=n[t];o&&(u[++e]=o)}return u},Nn.constant=function(n){return function(){return n}},Nn.countBy=to,Nn.create=function(n,t,r){var e=Wu(n);return r&&Sr(n,t,r)&&(t=b),t?tt(e,t):e},Nn.curry=yo,Nn.curryRight=wo,Nn.debounce=ce,Nn.defaults=So,Nn.defaultsDeep=Uo,Nn.defer=bo,Nn.delay=xo,Nn.difference=Mu,Nn.drop=qr,Nn.dropRight=Pr,Nn.dropRightWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!0,!0):[]},Nn.dropWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!0):[]},Nn.fill=function(n,t,r,e){var u=n?n.length:0;if(!u)return[];for(r&&"number"!=typeof r&&Sr(n,t,r)&&(r=0,e=u),u=n.length,0>(r=null==r?0:+r||0)&&(r=-r>u?0:u+r),0>(e=e===b||e>u?u:+e||0)&&(e+=u),u=r>e?0:e>>>0,r>>>=0;r<u;)n[r++]=t;return n},Nn.filter=re,Nn.flatten=function(n,t,r){var e=n?n.length:0;return r&&Sr(n,t,r)&&(t=!1),e?st(n,t):[]},Nn.flattenDeep=function(n){return n&&n.length?st(n,!0):[]},Nn.flow=mo,Nn.flowRight=Ao,Nn.forEach=uo,Nn.forEachRight=oo,Nn.forIn=Fo,Nn.forInRight=No,Nn.forOwn=To,Nn.forOwnRight=Lo,Nn.functions=Ie,Nn.groupBy=io,Nn.indexBy=fo,Nn.initial=function(n){return Pr(n,1)},Nn.intersection=Ku,Nn.invert=function(n,t,r){r&&Sr(n,t,r)&&(t=b),r=-1;for(var e=zo(n),u=e.length,o={};++r<u;){var i=e[r],f=n[i];t?nu.call(o,f)?o[f].push(i):o[f]=[i]:o[f]=i}return o},Nn.invoke=co,Nn.keys=zo,Nn.keysIn=Re,Nn.map=ue,Nn.mapKeys=Bo,Nn.mapValues=Do,Nn.matches=Ne,Nn.matchesProperty=function(n,t){return mt(n,ot(t,!0))},Nn.memoize=ae,Nn.merge=Eo,Nn.method=Xo,Nn.methodOf=Ho,Nn.mixin=Te,Nn.modArgs=jo,Nn.negate=function(n){if("function"!=typeof n)throw new Ge(L);return function(){return!n.apply(this,arguments)}},Nn.omit=Mo,Nn.once=function(n){return fe(2,n)},Nn.pairs=Oe,Nn.partial=ko,Nn.partialRight=Io,Nn.partition=ao,Nn.pick=qo,Nn.pluck=function(n,t){return ue(n,ze(t))},Nn.property=ze,Nn.propertyOf=function(n){return function(t){return yt(n,Dr(t),t+"")}},Nn.pull=function(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=mr(),u=n.length;++r<u;)for(var o=0,i=n[r];-1<(o=e(t,i,o));)su.call(t,o,1);return t},Nn.pullAt=Vu,Nn.range=function(n,t,r){r&&Sr(n,t,r)&&(t=r=b),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;var e=-1;t=xu(vu((t-n)/(r||1)),0);for(var u=Be(t);++e<t;)u[e]=n,n+=r;return u},Nn.rearg=Ro,Nn.reject=function(n,t,r){var e=Oo(n)?Vn:lt;return t=br(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})},Nn.remove=function(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,o=[],i=n.length;for(t=br(t,r,3);++u<i;)t(r=n[u],u,n)&&(e.push(r),o.push(u));return It(n,o),e},Nn.rest=Yr,Nn.restParam=le,Nn.set=function(n,t,r){if(null==n)return n;t=null!=n[e=t+""]||Ur(t,n)?[e]:Dr(t);for(var e=-1,u=t.length,o=u-1,i=n;null!=i&&++e<u;){var f=t[e];ge(i)&&(e==o?i[f]=r:null==i[f]&&(i[f]=Cr(t[e+1])?[]:{})),i=i[f]}return n},Nn.shuffle=function(n){return oe(n,Ru)},Nn.slice=function(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Sr(n,t,r)&&(t=0,r=e),Et(n,t,r)):[]},Nn.sortBy=function(n,t,r){if(null==n)return[];r&&Sr(n,t,r)&&(t=b);var e=-1;return t=br(t,r,3),n=bt(n,function(n,r,u){return{a:t(n,r,u),b:++e,c:n}}),St(n,f)},Nn.sortByAll=so,Nn.sortByOrder=function(n,t,r,e){return null==n?[]:(e&&Sr(t,r,e)&&(r=b),Oo(t)||(t=null==t?[]:[t]),Oo(r)||(r=null==r?[]:[r]),Ut(n,t,r))},Nn.spread=function(n){if("function"!=typeof n)throw new Ge(L);return function(t){return n.apply(this,t)}},Nn.take=function(n,t,r){return n&&n.length?((r?Sr(n,t,r):null==t)&&(t=1),Et(n,0,0>t?0:t)):[]},Nn.takeRight=function(n,t,r){var e=n?n.length:0;return e?((r?Sr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0>t?0:t)):[]},Nn.takeRightWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!1,!0):[]},Nn.takeWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3)):[]},Nn.tap=function(n,t,r){return t.call(r,n),n},Nn.throttle=function(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new Ge(L);return!1===r?e=!1:ge(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),ce(n,t,{leading:e,maxWait:+t,trailing:u})},Nn.thru=ne,Nn.times=function(n,t,r){if(1>(n=yu(n))||!wu(n))return[];var e=-1,u=Be(mu(n,4294967295));for(t=Bt(t,r,1);++e<n;)4294967295>e?u[e]=t(e):t(e);return u},Nn.toArray=je,Nn.toPlainObject=ke,Nn.transform=function(n,t,r,e){var u=Oo(n)||me(n);return t=br(t,e,4),null==r&&(u||ge(n)?(e=n.constructor,r=u?Oo(n)?new e:[]:Wu(ve(e)?e.prototype:b)):r={}),(u?Pn:_t)(n,function(n,e,u){return t(r,n,e,u)}),r},Nn.union=Gu,Nn.uniq=Gr,Nn.unzip=Jr,Nn.unzipWith=Xr,Nn.values=Ee,Nn.valuesIn=function(n){return Ft(n,Re(n))},Nn.where=function(n,t){return re(n,xt(t))},Nn.without=Ju,Nn.wrap=function(n,t){return t=null==t?Fe:t,gr(t,R,b,[n],[])},Nn.xor=function(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Er(r))var e=e?Jn(ft(e,r),ft(r,e)):r}return e?$t(e):[]},Nn.zip=Xu,Nn.zipObject=Hr,Nn.zipWith=Hu,Nn.backflow=Ao,Nn.collect=ue,Nn.compose=Ao,Nn.each=uo,Nn.eachRight=oo,Nn.extend=Co,Nn.iteratee=$e,Nn.methods=Ie,Nn.object=Hr,Nn.select=re,Nn.tail=Yr,Nn.unique=Gr,Te(Nn,Nn),Nn.add=function(n,t){return(+n||0)+(+t||0)},Nn.attempt=Jo,Nn.camelCase=Po,Nn.capitalize=function(n){return(n=u(n))&&n.charAt(0).toUpperCase()+n.slice(1)},Nn.ceil=Qo,Nn.clone=function(n,t,r,e){return t&&"boolean"!=typeof t&&Sr(n,t,r)?t=!1:"function"==typeof t&&(e=r,r=t,t=!1),"function"==typeof r?ot(n,t,Bt(r,e,3)):ot(n,t)},Nn.cloneDeep=function(n,t,r){return"function"==typeof t?ot(n,!0,Bt(t,r,3)):ot(n,!0)},Nn.deburr=Ce,Nn.endsWith=function(n,t,r){t+="";var e=(n=u(n)).length;return r=r===b?e:mu(0>r?0:+r||0,e),0<=(r-=t.length)&&n.indexOf(t,r)==r},Nn.escape=function(n){return(n=u(n))&&hn.test(n)?n.replace(pn,a):n},Nn.escapeRegExp=function(n){return(n=u(n))&&xn.test(n)?n.replace(bn,l):n||"(?:)"},Nn.every=te,Nn.find=ro,Nn.findIndex=qu,Nn.findKey=Wo,Nn.findLast=eo,Nn.findLastIndex=Pu,Nn.findLastKey=$o,Nn.findWhere=function(n,t){return ro(n,xt(t))},Nn.first=Kr,Nn.floor=ni,Nn.get=function(n,t,r){return n=null==n?b:yt(n,Dr(t),t+""),n===b?r:n},Nn.gt=pe,Nn.gte=function(n,t){return n>=t},Nn.has=function(n,t){if(null==n)return!1;var r=nu.call(n,t);if(!r&&!Ur(t)){if(t=Dr(t),null==(n=1==t.length?n:yt(n,Et(t,0,-1))))return!1;t=Zr(t),r=nu.call(n,t)}return r||$r(n.length)&&Cr(t,n.length)&&(Oo(n)||se(n))},Nn.identity=Fe,Nn.includes=ee,Nn.indexOf=Vr,Nn.inRange=function(n,t,r){return t=+t||0,r===b?(r=t,t=0):r=+r||0,n>=mu(t,r)&&n<xu(t,r)},Nn.isArguments=se,Nn.isArray=Oo,Nn.isBoolean=function(n){return!0===n||!1===n||h(n)&&ru.call(n)==M},Nn.isDate=function(n){return h(n)&&ru.call(n)==q},Nn.isElement=function(n){return!!n&&1===n.nodeType&&h(n)&&!we(n)},Nn.isEmpty=function(n){return null==n||(Er(n)&&(Oo(n)||xe(n)||se(n)||h(n)&&ve(n.splice))?!n.length:!zo(n).length)},Nn.isEqual=he,Nn.isError=_e,Nn.isFinite=function(n){return"number"==typeof n&&wu(n)},Nn.isFunction=ve,Nn.isMatch=function(n,t,r,e){return r="function"==typeof r?Bt(r,e,3):b,wt(n,Ar(t),r)},Nn.isNaN=function(n){return de(n)&&n!=+n},Nn.isNative=ye,Nn.isNull=function(n){return null===n},Nn.isNumber=de,Nn.isObject=ge,Nn.isPlainObject=we,Nn.isRegExp=be,Nn.isString=xe,Nn.isTypedArray=me,Nn.isUndefined=function(n){return n===b},Nn.kebabCase=Ko,Nn.last=Zr,Nn.lastIndexOf=function(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if("number"==typeof r)u=(0>r?xu(e+r,0):mu(r||0,e-1))+1;else if(r)return u=Lt(n,t,!0)-1,n=n[u],(t===t?t===n:n!==n)?u:-1;if(t!==t)return s(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1},Nn.lt=Ae,Nn.lte=function(n,t){return n<=t},Nn.max=ti,Nn.min=ri,Nn.noConflict=function(){return Zn._=eu,this},Nn.noop=Le,Nn.now=ho,Nn.pad=function(n,t,r){t=+t;var e=(n=u(n)).length;return e<t&&wu(t)?(e=(t-e)/2,t=yu(e),e=vu(e),(r=sr("",e,r)).slice(0,t)+n+r):n},Nn.padLeft=Vo,Nn.padRight=Zo,Nn.parseInt=function(n,t,r){return(r?Sr(n,t,r):null==t)?t=0:t&&(t=+t),n=Ue(n),ju(n,t||(In.test(n)?16:10))},Nn.random=function(n,t,r){r&&Sr(n,t,r)&&(t=r=b);var e=null==n,u=null==t;return null==r&&(u&&"boolean"==typeof n?(r=n,n=1):"boolean"==typeof t&&(r=t,u=!0)),e&&u&&(t=1,u=!1),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1?(r=ku(),mu(n+r*(t-n+fu("1e-"+((r+"").length-1))),t)):Rt(n,t)},Nn.reduce=lo,Nn.reduceRight=po,Nn.repeat=Se,Nn.result=function(n,t,r){var e=null==n?b:n[t];return e===b&&(null==n||Ur(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),e=null==n?b:n[Zr(t)]),e=e===b?r:e),ve(e)?e.call(n):e},Nn.round=ei,Nn.runInContext=w,Nn.size=function(n){var t=n?Bu(n):0;return $r(t)?t:zo(n).length},Nn.snakeCase=Yo,Nn.some=ie,Nn.sortedIndex=Zu,Nn.sortedLastIndex=Yu,Nn.startCase=Go,Nn.startsWith=function(n,t,r){return n=u(n),r=null==r?0:mu(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r},Nn.sum=function(n,t,r){if(r&&Sr(n,t,r)&&(t=b),1==(t=br(t,r,3)).length){r=(n=Oo(n)?n:zr(n)).length;for(var e=0;r--;)e+=+t(n[r])||0;n=e}else n=Wt(n,t);return n},Nn.template=function(n,t,r){var e=Nn.templateSettings;r&&Sr(n,t,r)&&(t=r=b),n=u(n),r=nt(tt({},(t=nt(tt({},r||t),e,Qn)).imports),e.imports,Qn);var o,i,f=zo(r),c=Ft(r,f),a=0;r=t.interpolate||Cn;var l="__p+='";r=Ze((t.escape||Cn).source+"|"+r.source+"|"+(r===gn?jn:Cn).source+"|"+(t.evaluate||Cn).source+"|$","g");var s="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";if(n.replace(r,function(t,r,e,u,f,c){return e||(e=u),l+=n.slice(a,c).replace(Sn,p),r&&(o=!0,l+="'+__e("+r+")+'"),f&&(i=!0,l+="';"+f+";\n__p+='"),e&&(l+="'+((__t=("+e+"))==null?'':__t)+'"),a=c+t.length,t}),l+="';",(t=t.variable)||(l="with(obj){"+l+"}"),l=(i?l.replace(fn,""):l).replace(cn,"$1").replace(an,"$1;"),l="function("+(t||"obj")+"){"+(t?"":"obj||(obj={});")+"var __t,__p=''"+(o?",__e=_.escape":"")+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+l+"return __p}",t=Jo(function(){return qe(f,s+"return "+l).apply(b,c)}),t.source=l,_e(t))throw t;return t},Nn.trim=Ue,Nn.trimLeft=function(n,t,r){var e=n;return(n=u(n))?n.slice((r?Sr(e,t,r):null==t)?g(n):o(n,t+"")):n},Nn.trimRight=function(n,t,r){var e=n;return(n=u(n))?(r?Sr(e,t,r):null==t)?n.slice(0,y(n)+1):n.slice(0,i(n,t+"")+1):n},Nn.trunc=function(n,t,r){r&&Sr(n,t,r)&&(t=b);o=S;if(r=U,null!=t)if(ge(t)){var e="separator"in t?t.separator:e,o="length"in t?+t.length||0:o;r="omission"in t?u(t.omission):r}else o=+t||0;if(n=u(n),o>=n.length)return n;if(1>(o-=r.length))return r;if(t=n.slice(0,o),null==e)return t+r;if(be(e)){if(n.slice(o).search(e)){var i,f=n.slice(0,o);for(e.global||(e=Ze(e.source,(kn.exec(e)||"")+"g")),e.lastIndex=0;n=e.exec(f);)i=n.index;t=t.slice(0,null==i?o:i)}}else n.indexOf(e,o)!=o&&-1<(e=t.lastIndexOf(e))&&(t=t.slice(0,e));return t+r},Nn.unescape=function(n){return(n=u(n))&&sn.test(n)?n.replace(ln,d):n},Nn.uniqueId=function(n){var t=++tu;return u(n)+t},Nn.words=We,Nn.all=te,Nn.any=ie,Nn.contains=ee,Nn.eq=he,Nn.detect=ro,Nn.foldl=lo,Nn.foldr=po,Nn.head=Kr,Nn.include=ee,Nn.inject=lo,Te(Nn,function(){var n={};return _t(Nn,function(t,r){Nn.prototype[r]||(n[r]=t)}),n}(),!1),Nn.sample=oe,Nn.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return oe(t,n)}):oe(this.value())},Nn.VERSION=x,Pn("bind bindKey curry curryRight partial partialRight".split(" "),function(n){Nn[n].placeholder=Nn}),Pn(["drop","take"],function(n,t){zn.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new zn(this);r=null==r?1:xu(yu(r)||0,0);var u=this.clone();return e?u.__takeCount__=mu(u.__takeCount__,r):u.__views__.push({size:r,type:n+(0>u.__dir__?"Right":"")}),u},zn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),Pn(["filter","map","takeWhile"],function(n,t){var r=t+1,e=r!=T;zn.prototype[n]=function(n,t){var u=this.clone();return u.__iteratees__.push({iteratee:br(n,t,1),type:r}),u.__filtered__=u.__filtered__||e,u}}),Pn(["first","last"],function(n,t){var r="take"+(t?"Right":"");zn.prototype[n]=function(){return this[r](1).value()[0]}}),Pn(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");zn.prototype[n]=function(){return this.__filtered__?new zn(this):this[r](1)}}),Pn(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?xt:ze;zn.prototype[n]=function(n){return this[r](e(n))}}),zn.prototype.compact=function(){return this.filter(Fe)},zn.prototype.reject=function(n,t){return n=br(n,t,1),this.filter(function(t){return!n(t)})},zn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return r.__filtered__&&(0<n||0>t)?new zn(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==b&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r)},zn.prototype.takeRightWhile=function(n,t){return this.reverse().takeWhile(n,t).reverse()},zn.prototype.toArray=function(){return this.take(Ru)},_t(zn.prototype,function(n,t){var r=/^(?:filter|map|reject)|While$/.test(t),e=/^(?:first|last)$/.test(t),u=Nn[e?"take"+("last"==t?"Right":""):t];u&&(Nn.prototype[t]=function(){function t(n){return e&&i?u(n,1)[0]:u.apply(b,Jn([n],o))}var o=e?[1]:arguments,i=this.__chain__,f=this.__wrapped__,c=!!this.__actions__.length,a=f instanceof zn,l=o[0],p=a||Oo(f);return p&&r&&"function"==typeof l&&1!=l.length&&(a=p=!1),l={func:ne,args:[t],thisArg:b},c=a&&!c,e&&!i?c?((f=f.clone()).__actions__.push(l),n.call(f)):u.call(b,this.value())[0]:!e&&p?(f=c?f:new zn(this),(f=n.apply(f,o)).__actions__.push(l),new Ln(f,i)):this.thru(t)})}),Pn("join pop push replace shift sort splice split unshift".split(" "),function(n){var t=(/^(?:replace|split)$/.test(n)?He:Je)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);Nn.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),_t(zn.prototype,function(n,t){var r=Nn[t];if(r){var e=r.name+"";(Uu[e]||(Uu[e]=[])).push({name:t,func:r})}}),Uu[pr(b,A).name]=[{name:"wrapper",func:b}],zn.prototype.clone=function(){var n=new zn(this.__wrapped__);return n.__actions__=qn(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=qn(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=qn(this.__views__),n},zn.prototype.reverse=function(){if(this.__filtered__){var n=new zn(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n},zn.prototype.value=function(){var n,t=this.__wrapped__.value(),r=this.__dir__,e=Oo(t),u=0>r,o=e?t.length:0;n=o;for(var i=this.__views__,f=0,c=-1,a=i.length;++c<a;){var l=i[c],p=l.size;switch(l.type){case"drop":f+=p;break;case"dropRight":n-=p;break;case"take":n=mu(n,f+p);break;case"takeRight":f=xu(f,n-p)}}if(n={start:f,end:n},i=n.start,f=n.end,n=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,c=0,a=mu(n,this.__takeCount__),!e||o<F||o==n&&a==n)return Tt(t,this.__actions__);e=[];n:for(;n--&&c<a;){for(o=-1,l=t[u+=r];++o<f;){var p=(s=i[o]).type,s=s.iteratee(l);if(p==T)l=s;else if(!s){if(p==N)continue n;break n}}e[c++]=l}return e},Nn.prototype.chain=function(){return Qr(this)},Nn.prototype.commit=function(){return new Ln(this.value(),this.__chain__)},Nn.prototype.concat=Qu,Nn.prototype.plant=function(n){for(var t,r=this;r instanceof Tn;){var e=Mr(r);t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},Nn.prototype.reverse=function(){function n(n){return n.reverse()}var t=this.__wrapped__;return t instanceof zn?(this.__actions__.length&&(t=new zn(this)),(t=t.reverse()).__actions__.push({func:ne,args:[n],thisArg:b}),new Ln(t,this.__chain__)):this.thru(n)},Nn.prototype.toString=function(){return this.value()+""},Nn.prototype.run=Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){return Tt(this.__wrapped__,this.__actions__)},Nn.prototype.collect=Nn.prototype.map,Nn.prototype.head=Nn.prototype.first,Nn.prototype.select=Nn.prototype.filter,Nn.prototype.tail=Nn.prototype.rest,Nn}var b,x="3.10.1",m=1,A=2,j=4,k=8,I=16,R=32,O=64,E=128,C=256,S=30,U="...",W=150,$=16,F=200,N=1,T=2,L="Expected a function",z="__lodash_placeholder__",B="[object Arguments]",D="[object Array]",M="[object Boolean]",q="[object Date]",P="[object Error]",K="[object Function]",V="[object Number]",Z="[object Object]",Y="[object RegExp]",G="[object String]",J="[object ArrayBuffer]",X="[object Float32Array]",H="[object Float64Array]",Q="[object Int8Array]",nn="[object Int16Array]",tn="[object Int32Array]",rn="[object Uint8Array]",en="[object Uint8ClampedArray]",un="[object Uint16Array]",on="[object Uint32Array]",fn=/\b__p\+='';/g,cn=/\b(__p\+=)''\+/g,an=/(__e\(.*?\)|\b__t\))\+'';/g,ln=/&(?:amp|lt|gt|quot|#39|#96);/g,pn=/[&<>"'`]/g,sn=RegExp(ln.source),hn=RegExp(pn.source),_n=/<%-([\s\S]+?)%>/g,vn=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,yn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,dn=/^\w*$/,wn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,bn=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,xn=RegExp(bn.source),mn=/[\u0300-\u036f\ufe20-\ufe23]/g,An=/\\(\\)?/g,jn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kn=/\w*$/,In=/^0[xX]/,Rn=/^\[object .+?Constructor\]$/,On=/^\d+$/,En=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Cn=/($^)/,Sn=/['\n\r\u2028\u2029\\]/g,Un=RegExp("[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?=[A-Z\\xc0-\\xd6\\xd8-\\xde][a-z\\xdf-\\xf6\\xf8-\\xff]+)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|[0-9]+","g"),Wn="Array ArrayBuffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Math Number Object RegExp Set String _ clearTimeout isFinite parseFloat parseInt setTimeout TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap".split(" "),$n={};$n[X]=$n[H]=$n[Q]=$n[nn]=$n[tn]=$n[rn]=$n[en]=$n[un]=$n[on]=!0,$n[B]=$n[D]=$n[J]=$n[M]=$n[q]=$n[P]=$n[K]=$n["[object Map]"]=$n[V]=$n[Z]=$n[Y]=$n["[object Set]"]=$n[G]=$n["[object WeakMap]"]=!1;var Fn={};Fn[B]=Fn[D]=Fn[J]=Fn[M]=Fn[q]=Fn[X]=Fn[H]=Fn[Q]=Fn[nn]=Fn[tn]=Fn[V]=Fn[Z]=Fn[Y]=Fn[G]=Fn[rn]=Fn[en]=Fn[un]=Fn[on]=!0,Fn[P]=Fn[K]=Fn["[object Map]"]=Fn["[object Set]"]=Fn["[object WeakMap]"]=!1;var Nn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Tn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ln={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},zn={function:!0,object:!0},Bn={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Dn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Mn=zn["undefined"==typeof exports?"undefined":_typeof(exports)]&&exports&&!exports.nodeType&&exports,qn=zn["undefined"==typeof module?"undefined":_typeof(module)]&&module&&!module.nodeType&&module,Pn=zn["undefined"==typeof self?"undefined":_typeof(self)]&&self&&self.Object&&self,Kn=zn["undefined"==typeof window?"undefined":_typeof(window)]&&window&&window.Object&&window,Vn=qn&&qn.exports===Mn&&Mn,Zn=Mn&&qn&&"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global&&global.Object&&global||Kn!==(this&&this.window)&&Kn||Pn||this,Yn=w();"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd?(Zn._=Yn,define(function(){return Yn})):Mn&&qn?Vn?(qn.exports=Yn)._=Yn:Mn._=Yn:Zn._=Yn}).call(this);
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/vendor/hoops.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n){"use strict";var t={};t.getIn=function(n,t,e){var o,r;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),r=t.length,o=0;r>o;o++){if(!(t[o]in n))return e;n=n[t[o]]}return n},t.isIn=function(n,t){var e,o;if(void 0===t)return!1;for(t instanceof Array||(t=(""+t).split(".")),o=t.length,e=0;o>e;e++){if(!(t[e]in n))return!1;n=n[t[e]]}return!0},t.invokeIn=function(n,e){var o,r,i;if(void 0===e)return n;if("function"!=typeof(r=t.getIn(n,e)))return n;if(i=[],arguments.length>2)for(o=2;o<arguments.length;o++)i.push(arguments[o]);return r.apply(null,i),n},t.updateIn=function(n,t,e){var o,r,i;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),i=n,r=t.length,o=0;r>o;o++){if(!(t[o]in i))return n;r-1>o&&(i=i[t[o]])}return i[t[o-1]]=e,n},t.setIn=function(n,t,e){var o,r,i;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),i=n,r=t.length,o=0;r>o;o++)"object"!=_typeof(i[t[o]])&&(i[t[o]]={}),r-1>o&&(i=i[t[o]]);return i[t[o-1]]=e,n},"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports?module.exports=t:exports.hoops=t),"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd&&define("hoops",[],function(){return t}),n._&&n._.mixin?n._.mixin(t):n.hoops=t}(this);
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/api_handler.js */
var API_Handler={parse_query_string:function(r){var a={};return r.split("&").forEach(function(r){if(r){var e=r.split("="),n=e[0],i=decodeURIComponent(e[1]),l=n.indexOf("[");if(-1===l)a[n]=i;else{var t=n.indexOf("]"),s=n.substring(l+1,t);n=n.substring(0,l),a[n]||(a[n]=[]),s?a[n][s]=i:a[n].push(i)}}}),a},parameter_error:function(r){console.error(r)},validate_parameters:function(r,a){var e=_.merge(Config.defaults,{"active-layers":[],"available-layers":a});if(r["bounding-box"])try{var n=r["bounding-box"].split(",",4),i=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];i[0]<-90||i[0]>90||i[2]<-90||i[2]>90||i[1]<-180||i[1]>180||i[3]<-180||i[3]>180?API_Handler.parameter_error("Error parsing bounding-box: is out of bounds (+-90, +- 180, +-90, +-180) ["+i+"]"):e["bounding-box"]=i}catch(r){API_Handler.parameter_error("Error parsing bounding-box: "+r+" \nDefaulting to : "+JSON.stringify(e["bounding-box"]))}if(r["available-layers"])try{var l=_.remove(r["available-layers"].split(","),function(r){return r}),t=_.intersection(a,l);(s=_.difference(l,t)).length>0&&API_Handler.parameter_error("Error parsing available-layers: DROPPING layers ["+s.join(",")+"]"),e["available-layers"]=t}catch(r){API_Handler.parameter_error("Error parsing available-layser: "+r+" \nDefaulting to : "+JSON.stringify(e["available-layers"]))}if(r["active-layers"]||""===r["active-layers"])try{var l=_.remove(r["active-layers"].split(","),function(r){return r}),t=_.intersection(l,a),s=_.difference(l,t);s.length>0&&API_Handler.parameter_error("Error parsing active-layers: DROPPING layers ["+s.join(",")+"]"),e["active-layers"]=t}catch(r){API_Handler.parameter_error("Error parsing available-layser: "+r+" \nDefaulting to : "+JSON.stringify(e["available-layers"]))}var o=_.difference(e["active-layers"],e["available-layers"]);return o.length>0&&(e["available-layers"]=_.union(e["available-layers"],o)),e},get_parameters:function(r,a){var e=API_Handler.parse_query_string(r);return API_Handler.validate_parameters(e,a)}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/base_layers.js */
var BASELAYER_PANE="baselayers",BaseLayers=[{name:"Terrain",data:L.tileLayer("http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}.png",{maxZoom:19,attribution:'Basemap Courtesy of <a href="http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer" target="_blank">ESRI</a>',pane:BASELAYER_PANE})},{name:"Street Map",data:L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'})},{name:"Imagery",data:L.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:18,attribution:"Esri, DigitalGlobe, Earthstar Geographics, CNES/Airbus DS, GeoEye, USDA FSA, USGS, Getmapping, Aerogrid, IGN, IGP, and the GIS User Community"})},{name:"Watercolor",data:L.tileLayer("http://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:1,maxZoom:16,ext:"png"})},{name:"Toner",data:L.tileLayer("http://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:1,maxZoom:16,ext:"png"})},{name:"None",data:{Empty:L.tileLayer(""),OpenStreetMap:L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Map data &copy; OpenStreetMap contributors"})}}];
</script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/utils.js */
var _slicedToArray=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RendererTemplates={},Renderers={opacity:function(e){return e.is_hidden?0:!1===e.parameters.opacity?100:e.parameters.opacity/100},find_geojson_polygon_by_point:function(e,t){var r={type:"Point",coordinates:[e.latlng.lng,e.latlng.lat]};return _.find(t._layers,function(e){return gju.pointInPolygon(r,e.feature.geometry)})},update_legend:function(e){return function(t){"string"==typeof e.update_legend?t.legend_url=e.update_legend:e.update_legend?"object"===_typeof(e.update_legend)?(t.legend_url=e.update_legend.url,t.legend_url_text=e.update_legend.text):e.update_legend?e.update_legend(t):t.legend_url=null:t.legend_url=null}},geojson_add_to_map:function(e,t,r){r.addTo(e),t.leaflet_layer_ids=[r._leaflet_id],Views.ControlPanel.fire("tile-layer-loaded",t)},add_layer_error:function(e){Views.ControlPanel.fire("tile-layer-loading-error",e)},random:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},update_templates:function(e,t){if(!e.templates){e.templates={};var r=Renderers.random();t.legend_template&&!Ractive.partials[r]&&(Ractive.partials[r]=t.legend_template,e.templates.legend=r);var n=Renderers.random();t.info_template&&!Ractive.partials[n]&&(Ractive.partials[n]=t.info_template,e.templates.info=n);var a=Renderers.random();t.wizard_template&&!Ractive.partials[a]&&(Ractive.partials[a]=t.wizard_template,e.templates.wizard=a)}},create_leaflet_layer:function(e,t,r,n){if(!Renderers.get_leaflet_layer(e,t,r)){var a=n();a.addTo(e),Renderers.save_leaflet_layer(t,a._leaflet_id,r)}},save_leaflet_layer:function(e,t,r){e.leaflet_layer_ids.push(Object.assign({},{id:stringify(r)},{leaflet_id:t}))},get_all_leaflet_layers:function(e,t){var r=_.pluck(t.leaflet_layer_ids,"leaflet_id");return Renderers.lookup_layers(e,r)},get_leaflet_layer:function(e,t,r){var n,a=_.find(t.leaflet_layer_ids,{id:stringify(r)});return a&&(n=Renderers.lookup_layers(e,[a.leaflet_id])[0]),n},get_layer:function(e,t,r){var n=[];return e.eachLayer(function(e){e._leaflet_id===r.id&&_.contains(leaflet_layer_ids,e._leaflet_id)&&n.push(e)}),n},lookup_layers:function(e,t,r){var n=[];return e.eachLayer(function(e){_.contains(t,e._leaflet_id)&&n.push(e)}),n},layer_to_pane_name:function(e){return e.id.replace(/\W/,".")},remove:function(e,t){var r=Renderers.get_all_leaflet_layers(e,t);_.each(r,function(t){e.hasLayer(t)&&e.removeLayer(t)})},render:function(e,t,r){var n=Renderers[t.renderer_id],a=Renderers.layer_to_pane_name(t),o=e.getPane(a);o||((o=e.createPane(a)).style.pointerEvents="none"),o.style.zIndex=r;var l=Renderers.opacity(t);o.style.opacity=l,n.render(e,t,o)},zoom_to:function(e,t){Views.ControlPanel.fire("map-set-view",e,t)},zoom_to_bounding_box:function(e){var t=e.split(",").map(parseFloat),r=_slicedToArray(t,4);west=r[0],south=r[1],east=r[2],north=r[3],Views.ControlPanel.fire("map-set-bbox",west,south,east,north)},utils:{zoom_to_location_link:function(e){return"Point"===e.type?"<a href='#' onclick='Renderers.zoom_to(["+e.coordinates[1]+","+e.coordinates[0]+"], 15);'>Zoom to feature</a>":e._northEast?"<a href='#' onclick='Renderers.zoom_to_bounding_box(\""+e.toBBoxString()+"\");'>Zoom to feature</a>":void 0}}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/base.js */
RendererTemplates.base=function(e,r,_){var a=Object.assign({},{pickle:function(e){e.leaflet_layer_ids=[]},clone_layer_name:r.clone_layer_name,parameters:r.parameters,get_feature_info_xml_url:r.get_feature_info_xml_url,get_feature_info_url:r.get_feature_info_url},r,_);return a.render=function(e,a,n){Renderers.update_templates(a,r),_.render(e,a,n)},a};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/geojson_points.js */
RendererTemplates.geojson_points=function(e,n){var a={pickle:function(e){delete e.legend_url,e.leaflet_layer_ids=[]},update_legend:Renderers.update_legend(n),create_leaflet_layers:function(e,a){_.isEmpty(a.leaflet_layer_ids)&&(a.leaflet_layer_ids=["loading-so-we-avoid-race-conditions"],$.ajax({cache:!0,dataType:"json",url:n.url,success:function(r){var t=new L.GeoJSON(r,{pointToLayer:n.pointToLayer,onEachFeature:n.onEachFeature||function(e,a){n.popupContents&&a.bindPopup(n.popupContents(e))}});Renderers.geojson_add_to_map(e,a,t)},error:function(e){200!==e.status&&Renderers.add_layer_error(a)}}))}};a.render=function(e,r,t){alert("This is not converted"),a.update_legend(r),a.create_leaflet_layers(e,r);var o=Renderers.opacity(r),l=r.leaflet_layer_ids,s=Renderers.lookup_layers(e,l);_.each(s,function(e){e.setZIndex(t),_.each(e._layers,function(e){e.setOpacity(o),n.each_point&&n.each_point(e)})})},Renderers[e]=a};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/geojson_lines.js */
RendererTemplates.geojson_lines=function(e,n){var a={pickle:function(e){delete e.legend_url,e.leaflet_layer_ids=[]},update_legend:Renderers.update_legend(n),create_leaflet_layers:function(e,a){_.isEmpty(a.leaflet_layer_ids)&&(a.leaflet_layer_ids=["loading-so-we-avoid-race-conditions"],$.ajax({cache:!0,dataType:"json",url:n.url,success:function(r){var t=new L.GeoJSON(r,{pointToLayer:n.pointToLayer,onEachFeature:n.onEachFeature||function(e,a){n.popupContents&&a.bindPopup(n.popupContents(e))}});Renderers.geojson_add_to_map(e,a,t)},error:function(e){200!==e.status&&Renderers.add_layer_error(a)}}))}};a.render=function(e,r,t){alert("This is not converted"),a.update_legend(r),a.create_leaflet_layers(e,r);var o=Renderers.opacity(r),l=r.leaflet_layer_ids,s=Renderers.lookup_layers(e,l);_.each(s,function(e){_.each(e._layers,function(e){e.setStyle({opacity:o}),n.each_line&&n.each_line(e)})})},Renderers[e]=a};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/geojson_polygons.js */
RendererTemplates.geojson_polygons=function(e,n){var o={pickle:function(e){delete e.legend_url,e.leaflet_layer_ids=[]},update_legend:Renderers.update_legend(n),create_leaflet_layers:function(e,o){_.isEmpty(o.leaflet_layer_ids)&&(o.leaflet_layer_ids=["loading-so-we-avoid-race-conditions"],$.ajax({cache:!0,dataType:"json",url:n.url,success:function(a){var r=new L.GeoJSON(a,{pointToLayer:n.pointToLayer,onEachFeature:n.onEachFeature||function(e,o){n.popupContents&&o.bindPopup(n.popupContents(e))}});Renderers.geojson_add_to_map(e,o,r)},error:function(e){200!==e.status&&Renderers.add_layer_error(o)}}))},find_geo_json:function(e,o,a){var r=[],t=o.leaflet_layer_ids,l=Renderers.lookup_layers(e,t);return _.each(l,function(e){var t=Renderers.find_geojson_polygon_by_point(a,e);if(t&&n.find_geojson_match){var l=n.find_geojson_match(o,t);l&&r.push(l)}}),{features:r,geojson:r.length>0}}};o.render=function(e,a,r){alert("This is not converted"),o.update_legend(a),o.create_leaflet_layers(e,a);var t=Renderers.opacity(a),l=a.leaflet_layer_ids,s=Renderers.lookup_layers(e,l);_.each(s,function(e){_.each(e._layers,function(e){e.setStyle({fillOpacity:t,opacity:t}),n.each_polygon&&n.each_polygon(e)})})},Renderers[e]=o};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/wms.js */
RendererTemplates.wms=function(e,r){function n(e){var n=r.wms_opts;return"function"==typeof r.wms_opts&&(n=r.wms_opts(e)),n}var t=RendererTemplates.base(e,r,{render:function(e,t,l){Renderers.create_leaflet_layer(e,t,n(t),function(){var e=new L.TileLayer.WMS(r.url,_.merge({pane:l},n(t)));return e.on("tileload",function(e){Views.ControlPanel.fire("tile-layer-loaded",t)}),e.on("tileerror",function(e){console.warn("layer_id","WMS Renderer",e),Views.ControlPanel.fire("tile-layer-loading-error",t)}),e});var a=Renderers.opacity(t),o=Renderers.get_all_leaflet_layers(e,t),i=Renderers.get_leaflet_layer(e,t,n(t));_.each(o,function(e){i._leaflet_id===e._leaflet_id?e.setOpacity(a):e.setOpacity(0)})}});Renderers[e]=t};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/esri.js */
RendererTemplates.esri=function(e,r){function n(e){var n=r.esri_opts;return"function"==typeof r.esri_opts&&(n=r.esri_opts(e)),n}var t=RendererTemplates.base(e,r,{render:function(e,r,t){Renderers.create_leaflet_layer(e,r,n(r),function(){var e=L.esri.dynamicMapLayer(_.merge({useCors:!1,pane:t},n(r)));return e.on("requestsuccess",function(e){Views.ControlPanel.fire("tile-layer-loaded",r)}),e.on("requesterror",function(e){Views.ControlPanel.fire("tile-layer-loading-error",r)}),e});var a=Renderers.opacity(r),s=Renderers.get_all_leaflet_layers(e,r),l=Renderers.get_leaflet_layer(e,r,n(r));_.each(s,function(e){l._leaflet_id===e._leaflet_id?e.setOpacity(a):e.setOpacity(0)})}});Renderers[e]=t};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/esri_feature_layer.js */
RendererTemplates.esri_feature_layer=function(e,r){function t(e){var t=r.esri_opts;return"function"==typeof r.esri_opts&&(t=r.esri_opts(e)),t}function n(e,t){if(r.setStyle)return r.setStyle(opacity,t);if(r.parameters.color_buckets){var n=_.find(r.parameters.color_buckets,function(n){var o=r.color_bucket_field;r.color_bucket_field instanceof Function&&(o=r.color_bucket_field(e));var l=_.get(t,o);return _.isArray(n.values)?1==n.values.length?n.values[0]==l:2==n.values.length?n.values[0]<=l&&n.values[1]>l:_.contains(v_.values,l):_.isFunction(n.values)?n.values(l):void console.log("Can't find this: ",t,l,r.parameters.color_buckets)});return n?{stroke:!0,color:n.stroke,weight:n.weight||1,fill:!0,fillColor:n.fill,clickable:!1}:(console.log("Can't find this: ",t,r.parameters.color_buckets),{})}}var o=RendererTemplates.base(e,r,{render:function(e,r,o){Renderers.create_leaflet_layer(e,r,t(r),function(){var e=L.esri.featureLayer(_.merge({useCors:!1,pane:o},t(r)));return e.on("load",function(e){Views.ControlPanel.fire("tile-layer-loaded",r)}),e.on("requesterror",function(e){Renderers.add_layer_error(r)}),e.on("error",function(e){Renderers.add_layer_error(r)}),t(r).pointToLayer||e.on("click",function(e){LeafletMap.fire("click",e,!0)}),e});var l=Renderers.opacity(r),a=Renderers.get_all_leaflet_layers(e,r),i=Renderers.get_leaflet_layer(e,r,t(r));_.each(a,function(e){_.each(a,function(e){i._leaflet_id===e._leaflet_id?e.setStyle(function(e){return Object.assign({},n(r,e),{opacity:l,fillOpacity:l})}):e.setStyle(function(){return{opacity:0,fillOpacity:0}})})})},find_geo_json:function(e,t,n){var o=[],l=t.leaflet_layer_ids,a=Renderers.lookup_layers(e,l);return _.each(a,function(e){var l=Renderers.find_geojson_polygon_by_point(n,e);if(l&&r.find_geojson_match){var a=r.find_geojson_match(t,l);a&&o.push(a)}}),{features:o,geojson:o.length>0}}});Renderers[e]=o};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/esri_feature_layer_points.js */
RendererTemplates.esri_feature_layer_points=function(e,r){function t(e){var t=r.esri_opts;return"function"==typeof r.esri_opts&&(t=r.esri_opts(e)),t}function n(e,n){if(r.setStyle)return r.setStyle(opacity,n);if(r.parameters.color_buckets){var o=_.find(r.parameters.color_buckets,function(t){var o=r.color_bucket_field;r.color_bucket_field instanceof Function&&(o=r.color_bucket_field(e));var a=_.get(n,o);return _.isArray(t.values)?1==t.values.length?t.values[0]==a:2==t.values.length?t.values[0]<=a&&t.values[1]>a:_.contains(v_.values,a):_.isFunction(t.values)?t.values(a):void console.log("Can't find this: ",n,a,r.parameters.color_buckets)});return o?{stroke:!0,color:o.stroke,weight:o.weight||1,fill:!0,fillColor:o.fill,clickable:!!t(e).pointToLayer}:(console.log("Can't find this: ",n,r.parameters.color_buckets),{})}}var o=RendererTemplates.base(e,r,{render:function(e,o,a){Renderers.create_leaflet_layer(e,o,t(o),function(){var e=_.merge({useCors:!1,pane:a},{pointToLayer:function(e,t){return r.marker(o,e,t,{pane:Renderers.layer_to_pane_name(o)})},onEachFeature:r.popup_content?function(e,t){t.bindPopup(r.popup_content(o,e,t))}:null},t(o)),n=L.esri.featureLayer(e);return n.on("load",function(e){Views.ControlPanel.fire("tile-layer-loaded",o)}),n.on("requesterror",function(e){Renderers.add_layer_error(o)}),n.on("error",function(e){Renderers.add_layer_error(o)}),n});var l=Renderers.get_all_leaflet_layers(e,o),i=Renderers.opacity(o),s=Renderers.get_leaflet_layer(e,o,t(o));_.each(l,function(e){_.each(l,function(e){s._leaflet_id===e._leaflet_id?e.setStyle(function(e){return Object.assign({},n(o,e),{opacity:i,fillOpacity:i})}):e.setStyle(function(){return{opacity:0,fillOpacity:0}})})})}});Renderers[e]=o};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderer_templates/imported_geojson.js */
RendererTemplates.imported_geojson=function(e,r){var t={templates:{},parameters:{opacity:100},update_legend:Renderers.update_legend(r),create_leaflet_layers:function(e,r){Renderers.geojson_add_to_map(e,r,layer)}};t.render=function(e,t,l){Renderers.create_leaflet_layer(e,t,t.id,function(){console.log("Creating...",t,l);var e=new L.GeoJSON(r.data,{pane:l,style:{stroke:!0,color:"#000",fillColor:"rgba(0,102,51,0.8)",weight:2},onEachFeature:function(e,t){t.bindPopup("<h5>"+r.name+"</h5>\n                <pre>"+JSON.stringify(e.properties,null,2)+"</pre>\n                <br/>\n                "+Renderers.utils.zoom_to_location_link(t.getBounds())+"\n                ")}});return Views.ControlPanel.fire("tile-layer-loaded",t),e});Renderers.opacity(t);var n=Renderers.get_all_leaflet_layers(e,t),a=Renderers.get_leaflet_layer(e,t,t.id);_.each(n,function(e){a._leaflet_id===e._leaflet_id?e.setStyle({opacity:100,fillOpacity:100}):e.setStyle({opacity:0,fillOpacity:0})})},Renderers[e]=t};
</script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/example_wms_layer.js */
RendererTemplates.wms("example_wms_layer",{parameters:{opacity:70,year:2e3,options:{}},clone_layer_name:function(e){return e.name+" Year:"+e.parameters.year},url:CDN("http://sedac.ciesin.columbia.edu/geoserver/wms"),wms_opts:function(e){return{layers:"anthromes:anthromes-anthropogenic-biomes-world-v2-"+e.parameters.year,format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var a=e.parameters.year;return CDN("http://sedac.ciesin.columbia.edu/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=anthromes:anthromes-anthropogenic-biomes-world-v2-"+a+"&QUERY_LAYERS=anthromes:anthromes-anthropogenic-biomes-world-v2-"+a+"&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:'\n      <div class=\'detail-block show-confidence\'>\n        <label> Model Year: </label>\n        <input type="radio" name=\'{{parameters.year}}\' value="1800"> 1800\n        <input type="radio" name=\'{{parameters.year}}\' value="1900"> 1900\n        <input type="radio" name=\'{{parameters.year}}\' value="2000"> 2000\n        <img src=\'{{CDN("http://sedac.ciesin.columbia.edu/geoserver/wms?request=GetLegendGraphic&LAYER=anthromes:anthromes-anthropogenic-biomes-world-v2-1700&format=image/png")}}\'/>\n      </div>\n  ',info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Value: {{properties.GRAY_INDEX}}\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/example_esri_feature_layer.js */
RendererTemplates.esri_feature_layer_points("example_esri_feature_layer",{parameters:{opacity:!1,color_buckets:[{fill:"rgba(56,168,0, 200)",stroke:"rgba(56,168,0,255)",label:"0%",values:[0]},{fill:"rgba(121,201,0,200)",stroke:"rgba(121,201,0,255)",label:"1% - 15%",values:[.001,.15]},{fill:"rgba(206,237,0,200)",stroke:"rgba(206,237,0,255)",label:"16% - 30%",values:[.15,.3]},{fill:"rgba(255,204,0,200)",stroke:"rgba(255,204,0,255)",label:"31% - 50%",values:[.3,.5]},{fill:"rgba(255,102,0, 200)",stroke:"rgba(255,102,0, 255)",label:"51% - 75%",values:[.5,.75]},{fill:"rgba(255,0,0, 200)",stroke:"rgba(255,0,0, 255)",label:"76% - 100%",values:[.75,2]}]},color_bucket_field:"properties.Percent_Low_or_High_Alert",legend_template:'\n    <div class=\'detail-block legend\'>\n      {{#parameters.color_buckets}}\n        <div class=\'color-block\' style="width: {{100.0 / parameters.color_buckets.length}}%;">\n              <svg width="100" height="100">\n                <rect height="100" width="100" style="fill: {{fill}}; stroke: {{stroke}}; opacity:1; "/>\n              </svg>\n              <label>{{label}}</label>\n        </div>\n      {{/parameters.color_buckets}}\n    </div>\n  ',esri_opts:{url:CDN("https://services.arcgis.com/YKJ5JtnaPQ2jDbX8/arcgis/rest/services/Cyanobacteria_2013_to_Present_Summary/FeatureServer/0")},marker:function(e,r,t,l){return L.circleMarker(t,_.merge(l,{radius:5}))},popup_content:function(e,r,t){return"<strong>"+r.properties.Station+"</strong></br>Report Frequency:"+r.properties.Report_Frequency+"<br/>Total Observations:"+r.properties.Total_Routine_Observations+"<br/>High/Low/Safe Observations:"+r.properties.High_Alert_Observations+" / "+r.properties.Low_Alert_Observations+" / "+r.properties.Generally_Safe_Observations+"<br/><br/>"+Renderers.utils.zoom_to_location_link(r.geometry)}});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/example_esri_layer.js */
RendererTemplates.esri("example_esri_layer",{parameters:{opacity:70,species:5,scenario:0,options:{species:{4:"Red Maple",5:"Sugar Maple",7:"Yellow Birch",10:"Pignut Hickory",14:"American Beech",15:"White Ash",28:"Red Spruce",35:"Eastern White Pine",40:"Quaking Aspen",41:"Black Cherry",42:"White Oak",49:"Northern Red Oak",55:"Eastern Hemlock"},scenarios:{0:"Current",56:"Low",112:"High"}}},legend_template:"\n    <div class='detail-block show-confidence'>\n      <label decorator='tooltip:Choose a tree species'> Species: </label>\n\n      <select value='{{parameters.species}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.species)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.species)}}\n      </select>\n    </div>\n    <div class='detail-block show-confidence'>\n      <label decorator='tooltip:Choose a tree species'> Scenario: </label>\n      <select value='{{parameters.scenario}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n      </select>\n    </div>\n\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/taccimo.jpg\">\n    </div>\n  ",clone_layer_name:function(e){var s=e.parameters,a=s.options.scenarios[s.scenario],r=s.options.species[s.species];return e.name+" "+r+" : "+a},esri_opts:function(e){var s=e.parameters.scenario,a=e.parameters.species;return{layers:[Number(s)+Number(a)],url:CDN("http://wassimap.sgcp.ncsu.edu:8399/arcgis/rest/services/taccimo/treeatlas_high/MapServer"),attribution:"USFS",f:"image",clickable:!1}}});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/boundary_counties.js */
RendererTemplates.wms("boundary_counties",{parameters:{opacity:70,options:{}},clone_layer_name:function(n){return n.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(n){return{layers:"ma:county_boundary",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(n){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:county_boundary&QUERY_LAYERS=ma:county_boundary&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:county_boundary&format=image/png'/> County Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} County\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/boundary_huc8.js */
RendererTemplates.wms("boundary_huc8",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:huc8",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:huc8&QUERY_LAYERS=ma:huc8&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:huc8&format=image/png'/> HUC8 Watershed Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} Watershed\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/barrier_beaches.js */
RendererTemplates.wms("barrier_beaches",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:"http://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms/",wms_opts:function(e){return{layers:"ma:GISDATA.BARRIERB_POLY",format:"image/png",opacity:0,transparent:!0}},get_feature_info_url:function(e){return"http://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms/?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:GISDATA.BARRIERB_POLY&QUERY_LAYERS=ma:GISDATA.BARRIERB_POLY&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"http://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.BARRIERB_POLY&format=image/png\")}}'/> Barrier Beaches\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Barrier Beach ID: {{properties.BBNAME}}\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/tree_atlas.js */
RendererTemplates.esri("tree_atlas",{parameters:{opacity:70,species:5,scenario:0,options:{species:{4:"Red Maple",5:"Sugar Maple",7:"Yellow Birch",10:"Pignut Hickory",14:"American Beech",15:"White Ash",28:"Red Spruce",35:"Eastern White Pine",40:"Quaking Aspen",41:"Black Cherry",42:"White Oak",49:"Northern Red Oak",55:"Eastern Hemlock"},scenarios:{0:"Current",56:"Low",112:"High"}}},legend_template:"\n    <div class='detail-block show-confidence'>\n      <label decorator='tooltip:Choose a tree species'> Species: </label>\n\n      <select value='{{parameters.species}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.species)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.species)}}\n      </select>\n    </div>\n    <div class='detail-block show-confidence'>\n      <label decorator='tooltip:Choose a tree species'> Scenario: </label>\n      <select value='{{parameters.scenario}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n      </select>\n    </div>\n\n    <div class='detail-block legend tree_atlas '>\n      <label> Legend </label>\n      <img  src=\"img/tree_atlas.jpg\"> Species Importance Value\n    </div>\n  ",clone_layer_name:function(e){var s=e.parameters,a=s.options.scenarios[s.scenario],r=s.options.species[s.species];return e.name+" "+r+" : "+a},esri_opts:function(e){var s=e.parameters.scenario,a=e.parameters.species;return{layers:[Number(s)+Number(a)],url:CDN("http://wassimap.sgcp.ncsu.edu:8399/arcgis/rest/services/taccimo/treeatlas_high/MapServer"),attribution:"USFS",f:"image",clickable:!1}}});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/prime_forest.js */
RendererTemplates.wms("prime_forest",{parameters:{min_zoom:12,max_zoom:20,opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.PRIMEFOREST_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.PRIMEFOREST_POLY&QUERY_LAYERS=massgis:GISDATA.PRIMEFOREST_POLY&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"http://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.PRIMEFOREST_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Forest Type: {{properties.PRIME}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/nfhl.js */
RendererTemplates.esri("nfhl",{parameters:{opacity:85,options:{}},legend_template:"\n    <div class='detail-block show-confidence'>\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/nfhlLegend.png\">\n    </div>\n  ",clone_layer_name:function(e){return e.name+" copy"},esri_opts:function(e){return{url:CDN("http://www.hazards.fema.gov/gis/nfhl/rest/services/public/NFHL/MapServer"),layers:[0,16,28],attribution:"FEMA",f:"image",clickable:!1}}});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/wind_power.js */
RendererTemplates.wms("wind_power",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.WINDPOWERGRID50_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.WINDPOWERGRID50_POLY&QUERY_LAYERS=massgis:GISDATA.WINDPOWERGRID50_POLY&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"http://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.WINDPOWERGRID50_POLY&format=image/png\")}}'/> \n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Power Density: {{properties.PWRDENSITY}} Watts per square Meter\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/hurricane_surge.js */
RendererTemplates.esri("hurricane_surge",{parameters:{min_zoom:10,max_zoom:20,opacity:85,options:{}},legend_template:"\n    <div class='detail-block show-confidence'>\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/nfhlLegend.png\">\n    </div>\n  ",clone_layer_name:function(e){return e.name+" copy"},esri_opts:function(e){return{url:CDN("http://tiles3.arcgis.com/tiles/hGdibHYSPO59RG1h/arcgis/rest/services/Hurr_Surge_Inun_Zones/MapServer"),layers:[0],attribution:"unkn",f:"image",clickable:!1}}});
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/renderers/soils.js */
RendererTemplates.wms("soils",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.SOILS_POLY_SV_MUNAME",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("http://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.SOILS_POLY_SV_MUNAME&QUERY_LAYERS=massgis:GISDATA.SOILS_POLY_SV_MUNAME&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"http://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.SOILS_POLY_SV_MUNAME&format=image/png\")}}'/> Soil Polygon\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Map Unit: {{properties.MAPUNIT_NAME}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n  "});
</script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/geometry_loader.js */
var GeometryLoader={load:function(e,o,a){var t={county:CDN(GEOSERVER+"/vt/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=vt:county_boundary&maxFeatures=50&outputFormat=application%2Fjson"),basin:CDN("http://api.nescaum-ccsc-dataservices.com/basin.topojson")};GeometryLoader.cache[e]?o(null,GeometryLoader.cache[e]):d3.json(t[e],function(a,t){a?o(a,null):("Topology"===t.type&&(t=topojson.feature(t,t.objects[e])),GeometryLoader.cache[e]=t,o(null,GeometryLoader.cache[e]))})},cache:{}};
</script>

    <script> var Controllers = {}; </script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/controllers/layer_import.js */
Controllers.LayerImport={import_layer:function(e,r){e.set("layer_import.import_file_processing",!0);var t=new FileReader;t.addEventListener("loadend",function(){var o=t.result;Controllers.Layers.add_imported_layer(e,r.name,o),e.set("layer_import.import_file",null),e.set("layer_import.import_file_processing",!1),e.set("layer_import.show_modal",!1)}),t.readAsText(r)}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/controllers/search.js */
Controllers.Search={execute_search:function(e,a){$.getJSON("http://api.geonames.org/searchJSON?username=frontierspatial&featureClass=P&maxRows=5&country=US&adminCode1=MA&name_startsWith="+encodeURIComponent(e)+"&callback=?",function(n,t,o){a(e,n.geonames)})}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/controllers/layers.js */
Controllers.Layers={test_pickler:function(){_.each(Renderers,function(e){e.pickle&&e.pickle({leaflet_layer_ids:[],parameters:{}})})},update_layers_parameters:function(e,r){var a=_.findIndex(e.get("layers.active"),{id:r.id});e.update("layers.active."+a+".parameters")},mark_layer_as_loaded:function(e,r,a,t){var l=e.get("layers_loading_states."+r.layer_default_id)||{loaded:0,errors:0};if(0===l.loaded||!a||t){a?l.loaded=l.loaded+1:l.errors=l.errors+1,e.set("layers_loading_states."+r.layer_default_id,l);var s=_.findIndex(e.get("layers.active"),{id:r.id});e.set("layers.active."+s,r)}},sort_active_layers:function(e){return _.sortBy(e,function(r){var a=_.findIndex(e,r),t="";return r.sort_key?t=sort_key.toString():r.parameters.no_sorting?t="A"+r.name:(t="Z",t+=_.padLeft(a,25,"0")),t})},is_active_layer:function(e,r){return!!_.find(e,{layer_default_id:r,copied_source:null})},counter:0,new_active_layer:function(e,r){var a=Renderers[r.renderer_id||r.id];Controllers.Layers.counter=Controllers.Layers.counter+1;var t=Object.assign({},a.parameters||{},r.parameters||{});return{id:"layer:"+Controllers.Layers.counter,layer_default_id:r.id,parameters:t,renderer_id:r.id,leaflet_layer_ids:[],is_collapsed:!1,is_hidden:!1,name:r.name,legend_url:null,copied_source:null}},pickle_active_layer:function(e){var r=_.cloneDeep(e);r.leaflet_layer_ids=[];var a=Renderers[r.renderer_id];return a&&a.pickle(r),r.legend_url&&(r.legend_url=null),r},add_imported_layer:function(e,r,a){_.cloneDeep(e.get("layers.active"));Controllers.Layers.counter=Controllers.Layers.counter+1;var t="imported_layer:"+Controllers.Layers.counter;Controllers.Layers.counter=Controllers.Layers.counter+1,e.push("layers.defaults",{folder:"User Imports",id:t,name:r}),e.push("layers.available_ids",t),RendererTemplates.imported_geojson(t,{templates:{},name:r,data:JSON.parse(a)}),Controllers.Layers.toggle_layer_active(e,t)},add_cloned_layer:function(e,r,a){var t=_.cloneDeep(e.get("layers.active")),l=_.cloneDeep(r);Controllers.Layers.counter=Controllers.Layers.counter+1,l.id="cloned_layer:"+Controllers.Layers.counter,l.leaflet_layer_ids=[],l.copied_source=r.id,l.name=Renderers[r.renderer_id].clone_layer_name(r),l.is_collapsed=!0,t.unshift(l),e.set("layers.active",Controllers.Layers.sort_active_layers(t))},remove_active:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.remove(a,{id:r.context.id}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},visible_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_hidden=!1}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},hide_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_hidden=!0}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},expand_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_collapsed=!1}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},collapse_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_collapsed=!0}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},toggle_active_collapsed:function(e,r){var a=_.cloneDeep(e.get("layers.active")),t=_.find(a,"id",r.context.id);t.is_collapsed=!t.is_collapsed,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},make_active_hidden:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.find(a,"id",r.context.id).is_hidden=!0,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},make_active_visible:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.find(a,"id",r.context.id).is_hidden=!1,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},move_active_to_top:function(e,r){var a=_.cloneDeep(e.get("layers.active")),t=_.find(a,{id:r.context.id});_.remove(a,{id:r.context.id}),a.unshift(t),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},toggle_layer_active:function(e,r){var a=e.get("layers.defaults"),t=_.cloneDeep(e.get("layers.active")),l=_.find(t,{layer_default_id:r,copied_source:null});if(l)_.remove(t,l);else{var s=Controllers.Layers.new_active_layer(e.get("map"),_.find(a,"id",r));t.unshift(s)}e.set("layers.active",Controllers.Layers.sort_active_layers(t)),e.set("active_layers_added_count",e.get("active_layers_added_count")+1)},force_layers_active:function(e,r){var a=e.get("layers.defaults"),t=_.map(r,function(r){var t=_.find(e.get("layers.active"),{layer_default_id:r,copied_source:null});return t||(t=Controllers.Layers.new_active_layer(e.get("map"),_.find(a,"id",r))),t});e.set("layers.active",Controllers.Layers.sort_active_layers(t))},set_available_layer_ids:function(e,r){var a=e.get("layers.defaults");_.filter(r,function(e){return _.find(a,"id",e)});e.set("layers.available_ids",r)},ensure_active_are_available:function(e){var r=e.get("layers.active")||[],a=e.get("layers.available_ids");e.set("layers.active",_.filter(r,function(e){return _.contains(a,e.id)}))},add_tree_node:function(e,r,a,t,l){if(0===a.length)r.children=r.children.concat(t);else{var s=a.shift(),n=_.find(r.children,function(e){return e.folder_name===s});n||(n={folder_name:s,is_expanded:l,children:[]},r.children=r.children.concat(n)),Controllers.Layers.add_tree_node(e,n,a,t,l)}return r.children=_.sortBy(r.children,function(r){var a=_.find(e,"id",r);return a?"A"+a.name:"Z"+r.folder_name}),r},update_layer_tree:function(e){var r={folder_name:null,is_expanded:!0,children:[]},a=e.get("layers.available_ids"),t=e.get("layers.defaults"),l=e.get("layers.search_string").toLowerCase(),s=e.get("sectors.selected");_.each(a,function(e){var a=_.find(t,"id",e);if(a){var n=null,i=!1;_.isEmpty(l)?n=!0:i=n=_.includes((a.name||"").toLowerCase(),l)||_.includes((a.description||"").toLowerCase(),l)||a.id.toLowerCase()===l,n&&s.length>0&&(n=_.intersection(a.sectors,s).length>0),n&&(r=Controllers.Layers.add_tree_node(t,r,a.folder.split("."),e,i))}}),e.set("layers.tree",r)},deactivate_all:function(e){e.set("layers.active",[])}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/controllers/sharing.js */
Controllers.Sharing={version:1,get_save_data:function(a){return{version:Controllers.Sharing.version,active_layers:_.map(a.get("layers.active"),function(a){return Controllers.Layers.pickle_active_layer(a)}),map_state:a.get("map_state")}},open_sharing:function(a,e){a.set("sharing_modal.open",!0),a.set("sharing_modal.token",null),a.set("sharing_modal.copied",!1)},sharing_url:function(a){var e=URI(window.location.href);return e.removeSearch("map_state_token"),e.addSearch("map_state_token",a),e.toString()},add_token_copy:function(a){var e=$("#sharing_copy_button");new ZeroClipboard(e).on("copy",function(e){a.set("sharing_modal.copied",!0),e.clipboardData.setData("text/plain",Controllers.Sharing.sharing_url(a.get("sharing_modal.token"))),setTimeout(function(){a.set("sharing_modal.copied",!1)},3e3)})},hide_sharing:function(a,e){a.set("sharing_modal.open",!1)},load_active_layers:function(a,e){var t=JSON.parse(e);t.version!==Controllers.Sharing.version?alert("This data is not the correct version. Sorry!"):(a.set("layers.active",t.data),a.set("sharing_modal.open",!1))},save_state:function(a,e){$.ajax({url:CDN("http://52.2.5.122/api/v1/savemap.php"),method:"POST",data:{data:JSON.stringify(a)},success:function(a){e(a)}})},load_state:function(a,e,t){e.set("sharing_modal_loading",!0),$.ajax({url:CDN("http://52.2.5.122/api/v1/getmap.php"),data:{token:a},success:function(a){var n=JSON.parse(JSON.parse(a)[0].data);n.version!=Controllers.Sharing.version?alert("Ack! We can't load this saved map!"):(e.set("layers.active",n.active_layers),t.setView(n.map_state.center,n.map_state.zoom)),t.invalidateSize(),setTimeout(function(){e.set("sharing_modal_loading",!1)},1500)}})}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/controllers/feature_info.js */
Controllers.FeatureInfo={get_gfi_url:function(e,t,r){var n={xmin:r.getBounds().getWest(),xmax:r.getBounds().getEast(),ymin:r.getBounds().getSouth(),ymax:r.getBounds().getNorth(),bbox:_.map([r.getBounds().getWest(),r.getBounds().getSouth(),r.getBounds().getEast(),r.getBounds().getNorth()],function(e){return e.toFixed(6)}).join(","),width:r.getSize().x,height:r.getSize().y,lat:t.latlng.lat,lng:t.latlng.lng,x:Math.round(r.layerPointToContainerPoint(t.layerPoint).x),y:Math.round(r.layerPointToContainerPoint(t.layerPoint).y)};return _.template(e)(n)},are_feature_info_layers_active:function(e){return _.filter(e,function(e){return Renderers[e.renderer_id].get_feature_info_url}).length>0},layer_has_click_info:function(e){return!(!e||!Renderers[e.renderer_id])&&!!(Renderers[e.renderer_id].find_geo_json||Renderers[e.renderer_id].get_feature_info_xml_url||Renderers[e.renderer_id].get_feature_info_url)},get_details:function(e,t){var r=e.get("layers.active"),n=e.get("map"),a=_.filter(r,function(e){return!e.is_hidden&&Controllers.FeatureInfo.layer_has_click_info(e)});a.length>0&&(e.set("map_details.feature_info_responses",{}),e.set("map_details.feature_info_requests",[]),e.set("map_details.location",t.latlng),_.each(a,function(r){var a=Renderers[r.renderer_id],o=_.cloneDeep(e.get("map_details.feature_info_requests")),i=r.id+"-"+Date.now();if(o.push({name:r.name,active_layer:r,response_id:i}),e.set("map_details.feature_info_requests",_.sortBy(o,"name")),a.get_feature_info_url){var s=a.get_feature_info_url(r),l=Controllers.FeatureInfo.get_gfi_url(s,t,n);$.ajax(l,{dataType:"json",success:function(n){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+i,{active_layer:r,json:n})},error:function(n){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+i,{active_layer:r,error:n.responseText})}})}else if(a.get_feature_info_xml_url){var s=a.get_feature_info_xml_url(r),l=Controllers.FeatureInfo.get_gfi_url(s,t,n);$.ajax(l,{dataType:"xml",success:function(n){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+i,{active_layer:r,xml:n})},error:function(n){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+i,{active_layer:r,error:n.responseText})}})}else if(a.find_geo_json){var u=a.find_geo_json(n,r,t);e.set("map_details.feature_info_responses."+i,{active_layer:r,geojson:u})}}))}};
</script>

    <script> var Views = {}; </script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/views/utils.js */
var ViewUtils={to_sorted_values_from_hash:function(r){var e=_.reduce(r,function(r,e,t){return r.push([t,e]),r},[]);return _.map(_.sortBy(e,function(r){return r[1]}),function(r){return{key:r[0],value:r[1]}})},to_month_name:function(r){return{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}[parseInt(r,10)]},shorten_string:function(r,e,t){for(var n=[" ","/","&"],u=.8*e,r=(t=void 0!==t&&t)?r.split("").reverse().join(""):r,i="",o=0;o<e-1&&(i+=r[o],!(o>=u&&n.indexOf(r[o])>=0));o++);return t?i.split("").reverse().join(""):i},shorten_url:function(r,e){var t=(e=void 0!==e?e:50)/2;return r&&r.length>0?(r=r.replace("http://","").replace("https://","")).length<=e?r:ViewUtils.shorten_string(r,t,!1)+".."+ViewUtils.shorten_string(r,t,!0):r}};
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/views/map.js */
var LeafletMap=L.map("map",{zoomControl:!1}),z_indexes={base:0,layers:1e3};L.control.scale().addTo(LeafletMap),LeafletMap.on("zoomend",function(e){Views.ControlPanel.set("map_state.zoom",LeafletMap.getZoom())}),LeafletMap.on("moveend",function(e){Views.ControlPanel.set("map_state.center",LeafletMap.getCenter())}),LeafletMap.on("click",function(e){Controllers.FeatureInfo.get_details(Views.ControlPanel,e)}),LeafletMap.createPane(BASELAYER_PANE);
</script>
    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/views/control_panel.js */
Views.ControlPanel=new Ractive({template:"#control_panel_template",el:"control_panel_root",data:{u:ViewUtils,CDN:CDN,sharing_url:function(e){return Controllers.Sharing.sharing_url(e)},out_of_view_layers:function(e,n){return _.select(e,function(e){var o=e.parameters.min_zoom||-1,t=e.parameters.max_zoom||100;return!e.is_hidden&&(n<o||n>t)})},all_active_hidden:function(e){return!0===_.uniq(_.pluck(e,"is_hidden"))[0]},layer_load_state_error_count:function(e,n){return(e[n]?e[n].errors:0)+" Errors"},fixed_precision:function(e,n){return e?e.toFixed(n):e},layer_load_state:function(e,n){var o="",t=e[n]?e[n].errors:0,r=e[n]?e[n].loaded:0;return t>0&&0===r?o="danger":t>0&&r>0?o="warning":0===t&&r>0&&(o="success"),o},all_active_collapsed:function(e){return!0===_.uniq(_.pluck(e,"is_collapsed"))[0]},able_to_copy:function(e){return!!(e&&Renderers[e.renderer_id]&&Renderers[e.renderer_id].clone_layer_name)},layer_has_standalone_wizard:function(e){return!!e&&!(!e.templates||!e.templates.wizard)},layer_has_click_info:function(e){return Controllers.FeatureInfo.layer_has_click_info(e)},get_layer_defaults:function(e,n){return _.find(e,"id",n)||{}},is_active_layer:function(e,n){return Controllers.Layers.is_active_layer(e,n)},is_sector_selected:function(e,n){return _.contains(e,n)},selected_sectors_text:function(e){return 0===e.length?"All Sectors":e.join(", ")},sectors:{all:[],selected:[]},layers:{defaults:[],available_ids:[],active:[],tree:[]},map:LeafletMap,has_geolocation:!!navigator.geolocation,layer_controls:{current_layer_info:null,active_tab:"layers",search_string:"",search_results:[],tray:{open:!0}},layers_loading_states:{},map_state:{zoom:null,center:null},zoom_max:16,parameters:{},base_layers:[],active_base_layer:null,map_controls:{active_base_layer:null,base_layer_control_open:!1},map_details:{feature_info_requests:null,location:null},sharing_modal:{open:!1},wizard:{adding_layers_popup:!1,open:!1,current_step:0,steps:["welcome","sidebar_intro","base_layers","adding_things","find_more_info","order_layers","using_legends_tab","printing","advanced_layer_controls"]}},decorators:{tooltip:RactiveTooltip}}),Views.ControlPanel.on({"remove-layer-add-notice":function(e){e.original.stopPropagation(),e.original.preventDefault(),Views.ControlPanel.set("wizard.adding_layers_popup",!1)},"show-layers-control":function(e){var n=Views.ControlPanel;"layers"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","layers"))},"show-details-control":function(e){var n=Views.ControlPanel;"details"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","details"))},"show-search-control":function(e){var n=Views.ControlPanel;"search"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","search"))},"map-zoom-in":function(e){Views.ControlPanel.get("map").zoomIn()},"map-zoom-out":function(e){Views.ControlPanel.get("map").zoomOut()},"map-set-view":function(e,n){Views.ControlPanel.get("map").setView(e,n)},"map-set-bbox":function(e,n,o,t){Views.ControlPanel.get("map").fitBounds(new L.LatLngBounds(new L.LatLng(n,e),new L.LatLng(t,o)))},"map-zoom-home":function(e){var n=Views.ControlPanel.get("map"),o=Views.ControlPanel.get("parameters.bounding-box");o?n.fitBounds(new L.LatLngBounds(new L.LatLng(o[1],o[0]),new L.LatLng(o[3],o[2]))):n.setView([42.4,-76],6)},"map-zoom-me":function(e){var n=Views.ControlPanel.get("map");navigator.geolocation.getCurrentPosition(function(e){n.setView({lat:e.coords.latitude,lng:e.coords.longitude},14)},function(){console.log("Failed to geo-locate")},{enableHighAccuracy:!0,timeout:5e3,maximumAge:72e4})},"update-layers-parameters":function(e){var n=Views.ControlPanel;Controllers.Layers.update_layers_parameters(n,e)},"tile-layer-loaded":function(e,n){var o=Views.ControlPanel;Controllers.Layers.mark_layer_as_loaded(o,e,!0,n)},"tile-layer-loading-error":function(e){var n=Views.ControlPanel;Controllers.Layers.mark_layer_as_loaded(n,e,!1)},"activate-base-layer":function(e){Views.ControlPanel.set("map_controls.active_base_layer",e.context.name)},"toggle-base-layer-control":function(e){var n=Views.ControlPanel;n.set("map_controls.base_layer_control_open",!n.get("map_controls.base_layer_control_open"))},"toggle-layer-active":function(e){var n=Views.ControlPanel;Controllers.Layers.toggle_layer_active(n,e.context),"true"!==document.cookie.replace(/(?:(?:^|.*;\s*)seen_adding_layers_popup\s*\=\s*([^;]*).*$)|^.*$/,"$1")&&Views.ControlPanel.set("wizard.adding_layers_popup",!0),document.cookie="seen_adding_layers_popup=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"},"move-active-to-top":function(e){var n=Views.ControlPanel;Controllers.Layers.move_active_to_top(n,e)},"make-active-hidden":function(e){var n=Views.ControlPanel;Controllers.Layers.make_active_hidden(n,e)},"make-active-visible":function(e){var n=Views.ControlPanel;Controllers.Layers.make_active_visible(n,e)},"expand-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.expand_all_layers(n,e)},"visible-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.visible_all_layers(n,e)},"hide-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.hide_all_layers(n,e)},"collapse-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.collapse_all_layers(n,e)},"toggle-active-collapsed":function(e){var n=Views.ControlPanel;Controllers.Layers.toggle_active_collapsed(n,e)},"remove-active":function(e){var n=Views.ControlPanel;Controllers.Layers.remove_active(n,e)},"toggle-layer-group-collapse":function(e){var n=Views.ControlPanel;e.context.is_expanded=!e.context.is_expanded,n.update(e.keypath)},"show-layer-info":function(e){var n=Views.ControlPanel;e.original.stopPropagation(),e.original.preventDefault(),n.set("layer_controls.current_layer_info",e.context)},"show-active-layer-info":function(e){Views.ControlPanel.set("layer_controls.current_layer_info",e.context.layer_default_id),e.original.stopPropagation(),e.original.preventDefault()},"hide-feature-info-modal":function(e){Views.ControlPanel.set("map_details.location",null)},"hide-layer-info-modal":function(e){Views.ControlPanel.set("layer_controls.current_layer_info",null)},"deactivate-all-layers":function(e){Controllers.Layers.deactivate_all(Views.ControlPanel)},"zoom-to-search-result":function(e){Views.ControlPanel.get("map").setView([e.context.lat,e.context.lng],16)},"print-map":function(e){var n=Views.ControlPanel,o=n.get("layer_controls.tray.open");n.set("layer_controls.tray.open",!1),window.print(),n.set("layer_controls.tray.open",o)},"clear-layers-search-query":function(e){Views.ControlPanel.set("layers.search_string",""),$("#layers_search_input").focus()},"clear-search-query":function(e){Views.ControlPanel.set("layer_controls.search_string",""),$("#search_input").focus()},"clone-active-layer":function(e){var n=Views.ControlPanel;Controllers.Layers.add_cloned_layer(n,e.context,"testly")},"open-sharing-modal":function(e){var n=Views.ControlPanel;Controllers.Sharing.open_sharing(n,e)},"request-share-link-token":function(e){Views.ControlPanel.set("sharing_modal.token","loading"),Controllers.Sharing.save_state(Controllers.Sharing.get_save_data(Views.ControlPanel),function(e){Views.ControlPanel.set("sharing_modal.token",e),Controllers.Sharing.add_token_copy(Views.ControlPanel)})},"hide-sharing-modal":function(e){var n=Views.ControlPanel;Controllers.Sharing.hide_sharing(n,e)},"show-wizard":function(e){var n=Views.ControlPanel;n.get("wizard.current_step")&&n.set("wizard.current_step",0),n.set("wizard.open",!0)},"next-wizard":function(e){var n=Views.ControlPanel;n.set("wizard.current_step",(1+n.get("wizard.current_step"))%n.get("wizard.steps").length)},"wizard-sidebar-intro":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"sidebar_intro"===e}))},"wizard-base-layers":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"base_layers"===e}))},"wizard-adding-things":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"adding_things"===e}))},"wizard-find-more-info":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"find_more_info"===e}))},"wizard-order-layers":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"order_layers"===e}))},"wizard-using-legends-tab":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"using_legends_tab"===e}))},"wizard-printing":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"printing"===e}))},"wizard-advanced-layer-controls":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"advanced_layer_controls"===e}))},"prev-wizard":function(e){var n=Views.ControlPanel,o=n.get("wizard.current_step"),t=n.get("wizard.steps").length,r=o-1;r<0&&(r+=t),n.set("wizard.current_step",r)},"show-standalone-wizard":function(e){Views.ControlPanel.set("wizard.standalone",e.context)},"close-standalone-wizard":function(e){Views.ControlPanel.set("wizard.standalone",null)},"close-wizard":function(e){Views.ControlPanel.set("wizard.open",!1)},"toggle-show-feature-info-response-details":function(e){var n=Views.ControlPanel;e.context.show_error_details=!e.context.show_error_details,n.update(e.keypath)},"zoom-to-view-layer":function(e){var n=Views.ControlPanel,o=Views.ControlPanel.get("map"),t=n.get("map_state.zoom"),r=e.context.parameters.min_zoom,a=e.context.parameters.max_zoom;r&&t<r?o.setZoom(r):a&&t>a&&o.setZoom(a)},"toggle-sector-dropdown":function(e){var n=Views.ControlPanel;n.set("sectors.show_dropdown",!n.get("sectors.show_dropdown"))},"toggle-sector-selection":function(e){var n=Views.ControlPanel,o="sectors.selected",t=n.get(o);_.contains(t,e.context)?n.set(o,_.without(t,e.context)):n.set(o,t.concat(e.context))},"clear-sector-dropdown":function(e){var n=Views.ControlPanel;n.get("sectors.selected");n.set("sectors.selected",[]),n.set("sectors.show_dropdown",!1)},"open-layer-import-modal":function(e){Views.ControlPanel.set("layer_import.show_modal",!0),e.original.stopPropagation(),e.original.preventDefault()},"close-layer-import-modal":function(e){Views.ControlPanel.set("layer_import.show_modal",!1),e.original.stopPropagation(),e.original.preventDefault()},"upload-layer-import-file":function(e){var n=Views.ControlPanel;Controllers.LayerImport.import_layer(n,e.context.layer_import.import_file[0]),e.original.stopPropagation(),e.original.preventDefault()}}),Views.ControlPanel.observe("layer_controls.search_string",function(e){var n=Views.ControlPanel;e.length>1?Controllers.Search.execute_search(e,function(e,o){n.get("layer_controls.search_string")===e&&n.set("layer_controls.search_results",o)}):n.set("layer_controls.search_results",[])}),Views.ControlPanel.observe("parameters.bounding-box",function(e){var n=Views.ControlPanel.get("map");if(e){var o=new L.LatLng(e[1],e[0]),t=new L.LatLng(e[3],e[2]);n.fitBounds(new L.LatLngBounds(o,t))}}),Views.ControlPanel.observe("parameters.available-layers",function(e){if(e){var n=Views.ControlPanel;Controllers.Layers.set_available_layer_ids(n,e)}}),Views.ControlPanel.observe("parameters.active-layers",function(e){var n=Views.ControlPanel;e&&Controllers.Layers.force_layers_active(n,e)}),Views.ControlPanel.observe("map_controls.active_base_layer",function(e){var n=Views.ControlPanel.get("map"),o=Views.ControlPanel.get("base_layers"),t=_.find(o,function(n){return n.name===e}),r=_.reject(o,t);t&&(_.each(r,function(e){n.hasLayer(e.data)&&n.removeLayer(e.data)}),"None"===t.name||(n.addLayer(t.data),t.data.setZIndex(z_indexes.base)))}),Views.ControlPanel.observe("layers.defaults",function(e){if(e)var n=Views.ControlPanel;n.set("sectors.all",_.uniq(_.compact(_.flatten(_.pluck(e,"sectors")))).sort())}),Views.ControlPanel.observe("layers.available_ids",function(e){if(e){var n=Views.ControlPanel;Controllers.Layers.ensure_active_are_available(n),Controllers.Layers.update_layer_tree(n)}}),Views.ControlPanel.observe("sectors.selected",function(e){var n=Views.ControlPanel;Controllers.Layers.update_layer_tree(n)}),Views.ControlPanel.observe("layers.search_string",function(e){var n=Views.ControlPanel;Controllers.Layers.update_layer_tree(n)}),Views.ControlPanel.observe("layers.active",function(e,n){var o=Views.ControlPanel.get("map"),t=Views.ControlPanel;_.each(n,function(n){_.find(e,"id",n.id)||Renderers.remove(o,n)}),_.map(e,function(n){var t=_.findIndex(_.cloneDeep(e).reverse(),"id",n.id),r=z_indexes.layers+t;Renderers.render(o,n,r)}),t.update("layers.active")}),Views.ControlPanel.observe("map_details.location",function(e){var n=Views.ControlPanel.get("map"),o=Views.ControlPanel,t=o.get("map_details.location_marker");e?(t&&t.getLatLng()!==e&&(n.removeLayer(t),t=null,o.set("map_details.location_marker",t)),t||(t=new L.marker(e),o.set("map_details.location_marker",t),t.addTo(n))):t&&(n.removeLayer(t),t=null,o.set("map_details.location_marker",t))}),Views.ControlPanel.observe("base_layers",function(e){!Views.ControlPanel.get("map_controls.active_base_layer")&&e.length>0&&Views.ControlPanel.set("map_controls.active_base_layer",e[0].name)}),Views.ControlPanel.observe("layer_controls.tray.open",function(e){$("#map").toggleClass("tray-open",e);var n=Views.ControlPanel.get("map");n&&n.invalidateSize()});
</script>

    <script> /* /home/cfitzhugh/working/ma-ccsc-map/src/js/init.js */
var all_layer_ids=_.pluck(available_layers,"id"),parameters=API_Handler.get_parameters(window.location.search.substr(1),all_layer_ids);Views.ControlPanel.set({base_layers:BaseLayers}),Views.ControlPanel.set("layers.defaults",available_layers),Views.ControlPanel.set({parameters:parameters});var params=URI.parseQuery(window.location.search);if(params.map_state_token&&Controllers.Sharing.load_state(params.map_state_token,Views.ControlPanel,LeafletMap),params.sectors&&Views.ControlPanel.set("sectors.selected",params.sectors.split(",")),"true"!==document.cookie.replace(/(?:(?:^|.*;\s*)show_welcome_modal_to_new_users\s*\=\s*([^;]*).*$)|^.*$/,"$1")&&(Views.ControlPanel.fire("show-wizard"),document.cookie="show_welcome_modal_to_new_users=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"),desired_active_on_load.length>0){var already_active_layers=_.pluck(Views.ControlPanel.get("layers.active"),"layer_default_id");Controllers.Layers.force_layers_active(Views.ControlPanel,already_active_layers.concat(desired_active_layer_ids))}
</script>
</body>
</html>
