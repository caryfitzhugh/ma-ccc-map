<!DOCTYPE html>
<html >
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MA CCSC Map Viewer</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="all">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.8.1/bootstrap-table.min.css">
  <link rel='stylesheet prefetch' href='./vendor/leaflet-1.0.3/dist/leaflet.css'>
  <style>
@import url(https://fonts.googleapis.com/css?family=Raleway:300,400,700);html,body,#container{height:100%;width:100%;overflow:hidden}body{padding-top:0}input[type=radio],input[type=checkbox]{margin:0}header{height:100px;z-index:99999999999}#map{width:auto;position:absolute;top:100px;bottom:0;right:0;left:0;margin-left:0;cursor:help}#map.tray-open{width:auto;margin-left:400px}#map.vuln-report-showing{margin-right:40%}.layer-controls{position:fixed;z-index:1001;top:100px;left:0;width:400px}.layer-controls .header{padding:10px;text-align:center;background:#fff}.layer-controls .tabs{text-align:center;color:#fff;font-weight:700;padding-top:0}.layer-controls .tabs a .notice-me-banner{position:absolute;z-index:10000;background:#fff;padding:10px;font-size:12px;top:120px;right:8px;left:8px;color:#000;font-weight:400;white-space:normal;box-shadow:0 0 10px rgba(0,0,0,.7)}.arrow_box{position:relative;background:#fff;border:4px solid #063}.arrow_box:after,.arrow_box:before{bottom:100%;left:50%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.arrow_box:after{border-color:rgba(255,255,255,0);border-bottom-color:#fff;border-width:10px;margin-left:-10px}.arrow_box:before{border-color:rgba(0,102,51,0);border-bottom-color:#063;border-width:16px;margin-left:-16px}.layer-controls .tabs a{color:#fff;padding:8px;white-space:nowrap;background:#063;font-size:14px;cursor:pointer;display:inline-block;border-top:2px solid #063;border-left:1px solid #fff;width:22.5%}.layer-controls .tabs a.layers-tab{width:20%}.layer-controls .tabs a.legend-map-controls-tab{width:48%}.layer-controls .tabs a.locations-tab{width:32%}.layer-controls .tabs a.active{color:#063;background:#fff;border-top:1px solid #063;border-left:1px solid #063}.layer-controls .tray.show{bottom:0;max-height:5000px;overflow-y:auto;overflow-x:hidden;border-right:1px solid #aaa}.layer-controls .tray-container.climate-vuln{position:absolute;top:0;left:0;right:0;bottom:200px}.layer-controls .tray{background:#fff;position:fixed;top:137px;left:0;width:400px;overflow:hidden;max-height:0;border-right:1px solid #aaa}.layer-controls .tray .contents{padding:10px}.layer-controls .tray .search-header{margin:0;opacity:1;background:#fff;position:absolute;left:0;right:0;top:0;z-index:1;border-top:1px solid #063;box-shadow:0 1px 5px rgba(0,0,0,.5);border-bottom:1px solid #063}.layer-controls .tray .search-header>.row{border-bottom:1px solid #063}.layer-controls .search-header .sector-select{display:block;height:35px;color:#063;background:#fff;cursor:pointer;border:0;width:100%;font-size:16px;line-height:35px;padding:5px 20px 5px 100px;position:relative}.layer-controls .search-header .sector-select label{display:inline-block;border:0;font-weight:700;position:absolute;left:5px;line-height:24px}.layer-controls .search-header .sector-select label:hover{cursor:default;color:#063}.layer-controls .search-header .sector-select .selected-text-container{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:24px;text-align:right}.layer-controls .search-header .sector-select .fa-caret-down{position:absolute;right:5px;top:10px}.layer-controls .search-header .sector-select .selected{font-size:80%}.layer-controls .search-header .sector-select .sector-selection-dropdown .btn-primary{background:#063;color:#fff;border-radius:0;border:1px solid #063}.layer-controls .search-header .sector-select .sector-selection-dropdown{position:absolute;top:35px;right:10px;left:10px;background:#fff;border:1px solid #000;padding:1em}.layer-controls .tray .search-header input{border:0;width:100%;font-size:20px;padding:5px;padding-right:30px}.layer-controls .tray .search-header .fa-times-circle-o{position:absolute;right:10px;top:0;font-size:20px;line-height:40px}.layer-controls .tray .search-results{position:absolute;top:68px;left:0;right:0;bottom:0;overflow-y:auto}.layer-controls .tray .footer h3{background:#063;color:#fff;padding:5px;margin:0 0 10px}.layer-controls .tray .footer .form-group{padding:5px}.layer-controls .tray .footer .form-group a{font-size:125%;opacity:.7}.layer-controls .tray .footer .form-group a.active{opacity:1}.footer .climate-vuln-report{position:fixed;right:0;top:0;bottom:0;width:40%;box-shadow:0 0 5px #000;background:#fff}.footer .climate-vuln-report .body{width:100%;height:100%;margin:10px}.footer .climate-vuln-report .body iframe{width:100%;height:100%;border:0}.layer-controls .tray .footer{background:#fff;position:absolute;border-top:1px solid #999;bottom:0;left:0;right:0;height:200px}.layer-controls .tray .footer .btn-secondary{background:#ca4d00;color:#fff}.layer-controls .tray .search-results .result{padding:5px;border-bottom:1px solid #999;font-size:16px}.layer-controls .tray .search-results-empty{text-align:center}.layer-controls .tray .search-results-empty .fa-search{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:80px;background:#f6892e;border-radius:40px;height:100px;width:80px;display:inline-block}.layer-controls .tray .active-layers-empty{text-align:center}.layer-controls .tray .active-layers-empty .fa-globe{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:100px;background:#f6892e;border-radius:40px;height:80px;width:80px;display:inline-block}#control_panel_root .active-layer{position:relative}#control_panel_root .active-layer .disable-active-layer-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3)}#control_panel_root .active-layer .disable-active-layer-overlay{padding-top:40px;text-align:center}#control_panel_root .active-layer .disable-active-layer-overlay>label{display:inline;background:#fff;box-shadow:0 0 5px #000;padding:10px 20px}.layer-controls .layer-group:first-child{padding:5px}.layer-controls .layer-group{list-style-type:none;padding-left:10px}.layer-controls .layer-group .info{padding:0 5px}.active-layer .info.warning,.layer-controls .layer-group .info.warning{color:#333;background:#ffc756}.active-layer .name .info{padding:0 5px}.modal-wrapper .response .error{padding:5px 10px}.modal-wrapper .response a{cursor:pointer}.modal-wrapper .response .error,.active-layer .info.danger,.layer-controls .layer-group .info.danger{color:#FFF;background:#D40A0A}.layer-import-modal .input-upload{display:flex;flex-direction:row;justify-content:space-between}.layer-import-modal .drop-target{border:2px dashed #aaa;width:100%;line-height:200px;font-size:20px;text-align:center}.layer-controls .active-layers-wrapper{position:absolute;top:0;left:0;bottom:0;right:0;overflow-y:auto}.layer-controls .bulk{text-align:right;border-top:1px solid #063;border-bottom:1px solid #063;background:#fff;padding:5px}.layer-controls .bulk a{padding:0 5px}.layer-controls .tray .active-layers-empty{text-align:center}.layer-controls .tray .active-layers-empty .fa-globe{margin-top:30px;margin-bottom:30px;color:#fff;font-size:40px;line-height:100px;background:#f6892e;border-radius:40px;height:80px;width:80px;display:inline-block}.modal-wrapper{position:fixed;top:0;left:0;right:0;height:0;overflow:hidden;z-index:5000}.modal-wrapper .wizard-modal .fa-arrow-right,.modal-wrapper .wizard-modal .fa-arrow-left{display:none}.modal-wrapper.open{height:100%}.modal-wrapper.open .wizard-modal .fa-arrow-right,.modal-wrapper.open .wizard-modal .fa-arrow-left{display:inline-block}.modal-wrapper .modal-bg{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:900}.modal-wrapper .modal-content{position:absolute;border-radius:0 0 10px 10px;top:0;left:20%;width:60%;height:auto;background:#fff;z-index:1000;overflow-y:auto;max-height:90%;padding-bottom:20px}.modal-wrapper .fa-close{position:absolute;top:10px;right:20px;color:#fff;background:#5690ca;font-size:15px;padding:10px;border-radius:20px;z-index:1001}.layer-info-modal .legend-img{max-width:60%}.feature-info-modal td{padding:2px 4px}.feature-info-modal .line-chart{white-space:nowrap;height:100px;background:#fff;border:1px solid #000;display:inline-block;padding-bottom:30px;margin:5px;position:relative}.feature-info-modal .line-chart .bar{display:inline-block;height:100%;position:relative;width:20px}.feature-info-modal .line-chart .bar .color{background:#000;width:80%;margin:0 10%;position:absolute;bottom:0}.feature-info-modal .line-chart .bar.current .color{background:red}.feature-info-modal .line-chart .bar .label{opacity:0;transition:.5s all;position:absolute;line-height:20px;font-size:14px;border:1px solid #000;box-shadow:0 0 5px #000;bottom:0;padding:3px 5px;color:#000;text-align:center;z-index:10;background:#fff}.feature-info-modal .line-chart .bar:hover{box-shadow:0 0 5px #efefef}.feature-info-modal .line-chart .bar:hover .label{opacity:1;transition:.5s all}.feature-info-modal .line-chart label{position:absolute;bottom:0;left:0;right:0;text-align:center}.feature-info-modal iframe{width:100%;height:100%;border:0;margin-bottom:15px}.layer-controls .active-layer{border-bottom:1px solid #063;padding:1px 5px}.layer-controls .active-layer{border-bottom:0}.layer-controls .active-layer label{margin-bottom:0}.layer-controls .active-layer .control-bar{margin-top:3px;margin-bottom:5px}.layer-controls .active-layer .active-details{margin-bottom:15px}.active-layer .detail-block.carbon .options{display:inline-block;width:70%}.active-layer .detail-block.carbon .options div{display:block}.active-layer .detail-block{line-height:25px}.active-layer .detail-block.baseline-label{text-align:center;margin-top:-16px}.active-layer .detail-block .labelled-range{position:relative;padding-bottom:15px}.active-layer .detail-block .labelled-range span{position:absolute;top:15px}.active-layer .detail-block .labelled-range span:first-child{left:5px}.active-layer .detail-block .labelled-range span:last-child{right:5px}.active-layer .detail-block .labelled-range input{}.active-layer .detail-block.power_stations img{width:30px}.active-layer .detail-block .legend-label{font-weight:700}.active-layer .detail-block.esri-legend{text-align:left}.active-layer .detail-block.esri-legend .legend-block{display:block}.active-layer .detail-block.esri-legend .legend-block img{display:inline-block;width:25%}.active-layer .detail-block.esri-legend .legend-block span{}.active-layer .detail-block.esri-legend.extreme-precip .legend-block img{width:10%}.active-layer .detail-block.legend .color-block{display:inline-block;min-width:9.08%;margin:0;position:relative}.active-layer .detail-block.legend .color-legend{text-align:center;font-weight:300;font-size:90%;margin-top:-6px}.active-layer .detail-block.legend .color-block .color{width:100%;height:100%}.active-layer .detail-block.legend.quantiled .color-block label{position:relative;left:50%}.active-layer .detail-block.legend .color-block label{text-align:center;width:100%;font-weight:300;vertical-align:text-top}.active-layer .detail-block.legend .color-block svg,.active-layer .detail-block.legend .color-block svg rect{width:100%;height:25px}.detail-block.legend-url-text.spa_surface_water,.detail-block.legend-url-text.spa_ground_water{position:relative}.detail-block.legend-url-text.spa_ground_water span.legend-text,.detail-block.legend-url-text.spa_surface_water span.legend-text{position:absolute;top:-34px;left:130px}.active-layer .detail-block.legend{margin:10px 0}.active-layer .detail-block.legend-url-text{text-align:center;font-weight:300;font-size:90%}.active-layer .detail-block label{display:inline-block;width:25%;border:0}.active-layer .opacity input,.active-layer .plants-and-animals select,.active-layer .extreme-precip select,.active-layer .sea-level input{display:inline-block;width:40%;margin-right:10px}.active-layer .legend img{display:inline-block;max-width:70%}.active-layer .legend.nlcd label,.active-layer .legend.anthromes label,.active-layer .legend.nfhl label,.active-layer .legend.regulated_wells label,.active-layer .legend.lulc_2011 label,.active-layer .legend.lulc_2011 label,.active-layer .legend.lulc_2050 label,.active-layer .legend.gap_lc label{display:none}.active-layer .legend.nlcd img,.active-layer .legend.regulated_wells img,.active-layer .legend.lulc_2011 img,.active-layer .legend.anthromes img,.active-layer .legend.lulc_2050 img,.active-layer .legend.gap_lc img{width:100%;max-width:100%}.active-layer .legend.private_wells img{width:74%;max-width:74%}.active-layer .legend.sovi img{width:50%}.active-layer .legend.nfhl img{width:70%}.active-layer .legend.soils img.soils-0{width:50%;max-width:50%}.active-layer .legend.soils img.soils-1{width:115%;max-width:115%}.layer-controls .active-layer .show-confidence input{width:auto}.layer-controls .active-layer .control-bar .fa{padding:2px 5px}.layer-controls .active-layer .control-bar .fa-trash-o{float:right}.layer-controls label:hover{transform:.5s all;cursor:pointer;color:#000}.layer-controls label{font-size:90%;border-bottom:1px solid #999;display:block}.layer-controls .layer{padding:4px;font-size:90%;clear:both}.layer-controls .layer a.info{float:right;font-size:14px;line-height:18px}.map-controls{position:fixed;z-index:1000;top:90px;right:10px;min-width:100px;color:#666;font-size:16px;padding:5px;padding-right:50px}.map-controls .add-layer{position:relative}.map-controls .add-layer .fa-plus-circle{font-size:75%;top:16px;right:10px;position:absolute;background:#fff}.map-control{float:left;margin:5px;position:relative}.map-control-bg{position:absolute;top:-20px;right:-10000px;width:20000px;height:20000px;background:rgba(0,0,0,.3);z-index:100}.control-details{background:#fff;position:absolute;top:35px;right:0;padding:10px;z-index:150}.control-details a{padding:2px 4px;display:block;white-space:nowrap}.control-details a.active{background:#428bca;text-shadow:1px 1px 2px #333;color:#fff}.zoom-controls{position:absolute;right:0;margin:5px 5px 5px 10px;background:#fff;font-size:18px;font-weight:400;text-align:center;border:1px solid #eaeaea;box-shadow:1px 1px 4px #999}.zoom-controls a:hover,.show-cursor{cursor:pointer;text-decoration:none}.zoom-controls a:hover{background:#428bca;text-shadow:1px 1px 2px #333;color:#fff}.zoom-controls a:last-child{border-bottom:0}.zoom-controls a.disable:hover{cursor:default}.zoom-controls a.disable{color:#bbb}.zoom-controls a{padding:4px 8px;display:block;border-bottom:1px solid #eaeaea}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.leaflet-bottom .leaflet-control-scale{position:fixed;right:0;bottom:25px}.water-well{color:#fff;font-weight:700;width:8px!important;height:8px!important;background:#0000fa;border:1px solid #0000fa}.water-wells-cluster{color:#fff;font-weight:300;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,0,250,.7);border:1px solid #0000fa;text-align:center;font-size:14px}.oil-wells-cluster{color:#000;font-weight:300;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,255,0,.5);border-radius:35px;border:1px solid green;text-align:center;font-size:14px}.other-wells-cluster{color:#000;font-weight:30{{layer_default_id}}0;width:50px!important;height:35px!important;line-height:35px;background:rgba(0,0,255,.5);border-radius:35px;border:1px solid #00f;text-align:center;font-size:14px}.gas-wells-cluster{color:#000;font-weight:700;width:35px!important;height:35px!important;line-height:35px;background:rgba(255,0,0,.5);border-radius:35px;border:1px solid red;text-align:center;font-size:12px}.wellsCluster{color:#000;font-weight:700;width:35px;height:35px;line-height:40px;background:transparent url(img/wellsCluster.png) 0 0 no-repeat scroll;text-align:center;text-indent:-20px;font-size:11px}.sewer_overflowsCluster{color:#000;font-weight:300;width:50px;height:48px;line-height:85px;background:transparent url(img/sewer-overflowsCluster.png) 0 0 no-repeat scroll;text-align:center;text-indent:-20px;font-size:14px}.spdesCluster{color:#000;width:40px;font-weight:700;height:40px;line-height:63px;background:transparent url(img/spdes.png) 0 0 no-repeat scroll;text-align:center;text-indent:0;font-size:14px}.hospitalCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/hospitalCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.damsCluster{color:#000;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/damsCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.bulkstorageCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:35px;background:transparent url(img/bulkstorage.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.ghg_facilitiesCluster{color:#fff;font-weight:700;width:35px;height:35px;line-height:15px;background:transparent url(img/ghg_facilitiesCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:8px;font-size:11px}.alscCluster{color:#000;font-weight:700;width:37px;height:45px;line-height:38px;background:transparent url(img/alscCluster.png) 0 0 no-repeat scroll;text-align:left;text-indent:4px;font-size:1.2em}.out-of-zoom-alerts{position:fixed;bottom:0;left:30%;right:30%;text-align:center;z-index:100001}.out-of-zoom-alerts .alert{width:100%;margin-left:10px;margin-right:10px;display:inline-block;margin-bottom:0;border-bottom:0;border-radius:0}.leaflet-tile-pane,.leaflet-objects-pane,.leaflet-overlay-pane,.leaflet-shadow-pane{z-index:initial!important}.leaflet-marker-pane{z-index:10000}.leaflet-popup-pane{z-index:15000}.leaflet-popup-content{max-height:50vh;max-width:25vw;overflow:auto}@media (max-width:600px){.layer-controls .tray,.layer-controls{right:0;width:auto}.map-controls{top:135px}.print-control{display:none}.modal-wrapper .wizard-modal .fa-arrow-right{top:auto;right:0;bottom:0}.modal-wrapper .wizard-modal .fa-arrow-left{top:auto;left:0;bottom:0}.modal-wrapper .modal-content{width:auto;left:0;right:0}}.printin-legends{display:none}.fa-spin-custom,.glyphicon-spin{-webkit-animation:spin 1000ms infinite linear;animation:spin 1000ms infinite linear}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.modal-wrapper .modal-content.wizard-modal{box-shadow:0 0 5px #333;min-height:200px;height:100%;padding-bottom:0}.wizard-modal .back-to-start{float:right;margin-right:50px;margin-top:13px}.wizard-modal .footer{color:#999;text-align:center;font-size:80%;clear:both;line-height:30px;padding-top:20px}.wizard-modal .container-fluid{overflow-y:auto;height:100%}.wizard-modal .fa-arrow-right,.wizard-modal .fa-arrow-left{position:fixed;padding:25px;font-size:16px;display:inline-block;color:#fff;background:#5690ca}.wizard-modal .fa-arrow-left{top:100px;left:10%}.wizard-modal .fa-arrow-right{top:100px;right:10%}.wizard-modal .fa-arrow-left:hover,.wizard-modal .fa-arrow-right:hover{background:#063;cursor:pointer}.wizard-modal h1{border-bottom:1px solid #000}.wizard-modal img{min-width:300px;min-height:300px;float:right}.wizard-modal img.full-width{display:block;width:100%}.wizard-modal .climate-vulnerability .form-group label{display:block}.wizard-modal .climate-vulnerability .feature-toggler{float:left;margin-right:10px}.tide-guage-slr-icon{width:auto;display:block}.tide-guage-slr-icon{}.tide-guage-slr-icon .likelihood{width:14px;height:100px;position:relative}.tide-guage-slr-icon .likelihood>div.label{position:absolute;bottom:-5px;display:block;width:75px;font-weight:600;text-align:center;font-size:12px;left:-4px;color:#00f;text-shadow:2px 0 0 #fff,-2px 0 0 #fff,0 2px 0 #fff,0 -2px 0 #fff,1px 1px #fff,-1px -1px 0 #fff,1px -1px 0 #fff,-1px 1px 0 #fff}.tide-guage-slr-icon .likelihood>div.bar{position:absolute;bottom:0;min-height:1px;max-height:100px;background:#00f}.climate-vulnerability .table tr,.active-year,.active-scenario,.active-year,.active-season{background-color:rgba(0,102,51,.3)}tr.active-season.active-scenario td.active-year{background-color:rgba(0,102,51,.3)}tr.smaller-header{font-size:90%}th.deltas{background:#000;color:#fff}header{}header .left-side{float:left}header .left-side h1{font-size:4em;letter-spacing:-2px}header .slate-text{color:#113f83;font-weight:300}header .orange-text{color:#ca4d00;font-weight:700}header .gray-text{color:#5e5e5e;font-weight:300}header .left-side img{height:50px;display:inline-block;position:relative;top:-5px}header .left-side h1 a:hover{text-decoration:none}header .left-side h1{font-family:Raleway;display:inline-block;margin:10px 15px;padding:0}header .right-side{float:right}header .right-side .search{padding:12px}header .right-side .search input{padding:15px;width:350px}header .right-side .search button{border-radius:0;position:relative;top:2px;padding:12px;color:#fff;font-size:20px;background:#ca4d00}header .right-side .search .fa-bars{background:#113f83;font-size:20px;color:#fff;padding:10px;margin:5px;position:relative;cursor:pointer}header .right-side .search .fa-bars .menu{display:none;position:absolute;top:40px;z-index:9999000;right:0;background:#fff;border:1px solid #113f83;padding:15px;box-shadow:0 0 5px #333}header .right-side .search .fa-bars .menu ul{padding:0}header .right-side .search .fa-bars .menu.show{display:block}header .right-side .search .fa-bars .menu li{display:block;font-family:Raleway;padding:5px}header .right-side .search .fa-bars .menu li a{white-space:nowrap}@media print{.hide-printing{display:none}#control_panel_root>div{display:none}#control_panel_root>div.printing-legends{position:absolute;display:block;top:100%}#map{top:0}.leaflet-pane,.leaflet-tile,.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-tile-container,.leaflet-pane>svg,.leaflet-pane>canvas,.leaflet-zoom-box,.leaflet-image-layer,.leaflet-layer{left:0;right:0;top:0;bottom:0}#control_panel_root>div.printing-legends .columns{display:flex;flex-direction:row;flex-wrap:wrap;-webkit-column-count:4;-moz-column-count:4;column-count:4;column-gap:1em!important;border:1px solid purple}#control_panel_root>div.printing-legends .columns .active-layer{display:inline-block;position:relative;width:100%;margin:0 0 1em}#control_panel_root>div.printing-legends .columns .active-layer label.layer-name{text-align:center;width:100%;border-bottom:1px solid #000;border-top:1px solid #000}#control_panel_root>div.printing-legends .columns .active-layer .opacity{display:none}#control_panel_root>div.printing-legends .columns .active-layer{width:40%;float:left;margin:10px}.zoom-controls,.layer-controls,.map-controls{display:none}.print-legend-page{display:block;position:absolute;top:100%;page-break-before:always}.print-header{position:absolute;top:0;z-index:990000}html,body{height:100%;display:block}#content{height:50%}#map.tray-open{margin-left:0}body{height:200%;overflow:auto}}
</style>
  <style>
/*! CSS Used from: Embedded */svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-16{width:1em}/*! CSS Used from: Embedded */.orange-text{color:#CA4D00}.slate-text{color:#113f83}.header-wrap .fa-bars{font-weight:300;font-size:2em;color:#113f83;vertical-align:middle;position:relative}.header-wrap .controls{float:right;display:flex;vertical-align:middle;margin-top:2.5em}.header-wrap a:hover,.header-wrap a:active,.header-wrap a:focus,.header-wrap a:visited{text-decoration:none!important}.header{margin-top:1em;display:flex;flex-direction:row;justify-content:space-between;margin-bottom:1em}.header .logo{display:flex;flex-direction:row}.header .logo img{margin-right:1em;width:auto;height:64px}.header .logo .logo-text{font-family:Raleway,sans-serif;display:flex;flex-direction:column}.header .logo .logo-text h1{font-weight:300;margin-bottom:0;font-size:2.4em;margin-top:0}.header .logo .logo-text h1 span{letter-spacing:-2px}.header .logo .logo-text .tagline{font-weight:500}.header .logo .logo-text small{font-weight:400;font-size:1em}.header .logo .logo-text strong{font-weight:700}.header .logo{float:left}.mega-menu-toggle{position:relative;flex-direction:column;text-align:center;display:flex;margin:0;top:-24px}.mega-menu-toggle label{text-transform:uppercase;font-weight:400;position:relative;color:#113f83;font-size:9px;margin-bottom:0}.search-bar{padding:0;float:right;opacity:.85;position:relative;top:0}.search-bar input:focus,.search-bar input{box-shadow:0 0 0}.search-bar input{border:0;top:-6px}.search-bar .fa-search{font-size:100%;position:relative;top:-2px}.search-bar input[type=text]:focus{width:250px;opacity:1;border-color:#113f83}.search-bar input[type=text]{transition:all .5s ease;border-bottom:1px solid transparent;width:70px;font-size:80%;margin:0 10px;padding:0;border-radius:0}/*! CSS Used from: Embedded */*,::before,::after{box-sizing:border-box}h1{margin-top:0;margin-bottom:.5rem}strong{font-weight:bolder}small{font-size:80%}a{color:#C74D00;text-decoration:none;background-color:transparent}a:hover{color:#7b2f00;text-decoration:underline}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}label{display:inline-block;margin-bottom:.5rem}input{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}h1{margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:2.5rem}small{font-size:80%;font-weight:400}.form-control{display:block;width:100%;height:calc(1.5em + 0.75rem + 2px);padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control::-ms-expand{background-color:transparent;border:0}.form-control:focus{color:#495057;background-color:#fff;border-color:#ff8f48;outline:0;box-shadow:0 0 0 .2rem rgba(199,77,0,.25)}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled{background-color:#e9ecef;opacity:1}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.form-control{position:relative;flex:1 1 auto;width:1%;margin-bottom:0}.input-group>.form-control:focus{z-index:3}.input-group>.form-control:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group-sm>.form-control:not(textarea){height:calc(1.5em + 0.5rem + 2px)}.input-group-sm>.form-control{padding:.25rem .5rem;font-size:.875rem;line-height:1.5;border-radius:.2rem}.px-5{padding-right:3rem!important}.px-5{padding-left:3rem!important}@media print{*,::before,::after{text-shadow:none!important;box-shadow:none!important}a:not(.btn){text-decoration:underline}img{page-break-inside:avoid}}/*! CSS Used from: Embedded */*,::before,::after{box-sizing:border-box}h1{margin-top:0;margin-bottom:.5rem}strong{font-weight:bolder}small{font-size:80%}a{color:#C74D00;text-decoration:none;background-color:transparent}a:hover{color:#7b2f00;text-decoration:underline}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}label{display:inline-block;margin-bottom:.5rem}input{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}h1{margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:2.5rem}small{font-size:80%;font-weight:400}.form-control{display:block;width:100%;height:calc(1.5em + 0.75rem + 2px);padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control::-ms-expand{background-color:transparent;border:0}.form-control:focus{color:#495057;background-color:#fff;border-color:#ff8f48;outline:0;box-shadow:0 0 0 .2rem rgba(199,77,0,.25)}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled{background-color:#e9ecef;opacity:1}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.form-control{position:relative;flex:1 1 auto;width:1%;margin-bottom:0}.input-group>.form-control:focus{z-index:3}.input-group>.form-control:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group-sm>.form-control:not(textarea){height:calc(1.5em + 0.5rem + 2px)}.input-group-sm>.form-control{padding:.25rem .5rem;font-size:.875rem;line-height:1.5;border-radius:.2rem}.px-5{padding-right:3rem!important}.px-5{padding-left:3rem!important}@media print{*,::before,::after{text-shadow:none!important;box-shadow:none!important}a:not(.btn){text-decoration:underline}img{page-break-inside:avoid}}/*! CSS Used fontfaces */@font-face{font-family:Raleway;font-style:normal;font-weight:100;src:local('Raleway Thin'),local('Raleway-Thin'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptsg8zYS_SKggPNwE44Q4FqL_KWxWMT.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:100;src:local('Raleway Thin'),local('Raleway-Thin'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptsg8zYS_SKggPNwE44TYFqL_KWxQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Raleway;font-style:normal;font-weight:300;src:local('Raleway Light'),local('Raleway-Light'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwIYqWqhPANqczVsq4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:300;src:local('Raleway Light'),local('Raleway-Light'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwIYqWqZPANqczVs.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Raleway;font-style:normal;font-weight:400;src:local('Raleway'),local('Raleway-Regular'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:400;src:local('Raleway'),local('Raleway-Regular'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Raleway;font-style:normal;font-weight:500;src:local('Raleway Medium'),local('Raleway-Medium'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwN4rWqhPANqczVsq4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:500;src:local('Raleway Medium'),local('Raleway-Medium'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwN4rWqZPANqczVs.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Raleway;font-style:normal;font-weight:700;src:local('Raleway Bold'),local('Raleway-Bold'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwJYtWqhPANqczVsq4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:700;src:local('Raleway Bold'),local('Raleway-Bold'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwJYtWqZPANqczVs.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Raleway;font-style:normal;font-weight:900;src:local('Raleway Black'),local('Raleway-Black'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwK4vWqhPANqczVsq4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Raleway;font-style:normal;font-weight:900;src:local('Raleway Black'),local('Raleway-Black'),url(https://fonts.gstatic.com/s/raleway/v14/1Ptrg8zYS_SKggPNwK4vWqZPANqczVs.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.container{position:relative;margin-left:auto;margin-right:auto;padding-right:15px;padding-left:15px}@media (min-width:576px){.container{padding-right:15px;padding-left:15px}}@media (min-width:768px){.container{padding-right:15px;padding-left:15px}}@media (min-width:992px){.container{padding-right:15px;padding-left:15px}}@media (min-width:1200px){.container{padding-right:15px;padding-left:15px}}@media (min-width:576px){.container{width:540px;max-width:100%}}@media (min-width:768px){.container{width:720px;max-width:100%}}@media (min-width:992px){.container{width:960px;max-width:100%}}@media (min-width:1200px){.container{width:1140px;max-width:100%}}/*! CSS Used from: http://uatclimatechange.org/static/css/main.912c9e39.css */.header-wrap a:active,.header-wrap a:focus,.header-wrap a:hover,.header-wrap a:visited{text-decoration:none!important}.mega-menu{position:absolute;top:86px;left:0;right:0;z-index:101;background:hsla(0,0%,94%,.9);border:1px solid #113f83;padding:1em 4em;z-index:9999}.mega-menu header h1{font-weight:400;color:#113f83;font-size:1.5rem;margin-bottom:1em}.mega-menu .tool-n-data-col{-ms-flex:0 0 12%;flex:0 0 12%;max-width:12%;min-width:130px}.mega-menu .tool-n-data-col h3,.mega-menu .tool-n-data-col h3>a{font-size:1.05em}.mega-menu .take-action-col{-ms-flex:0 0 40%;flex:0 0 40%;max-width:40%}.mega-menu .learn-col{-ms-flex:0 0 46%;flex:0 0 46%;max-width:46%}.mega-menu hr{border-top:5px solid #ca4d00;margin:0 -5px}.mega-menu h2{color:#113f83;font-weight:700;font-size:1em}.mega-menu section.no-pad-r{padding-right:0}.mega-menu h3{margin:10px 0}.mega-menu h3,.mega-menu h3>a{color:#113f83;font-weight:700;font-size:1.15em}.mega-menu li{list-style-type:none;position:relative;padding-left:5px;margin-top:12px;font-size:14px}.mega-menu ul{-webkit-padding-start:8px;-moz-padding-start:8px;padding-inline-start:8px;list-style-type:circle}.mega-menu li:before{content:"\2022";font-size:35px;position:absolute;top:-17px;left:-11px;color:#ca4d00}@media (max-width:1024px){.mega-menu .learn-col,.mega-menu .take-action-col,.mega-menu .tool-n-data-col{width:100%;max-width:100%;min-width:100%}}#menu-show h1 a,.menu-show h1 a:hover{color:#113f83;font-size:24px}#menu-show header{height:auto}.mega-menu .tool-n-data-col{float:left;-ms-flex:0 0 12%;flex:0 0 12%;max-width:12%;min-width:130px}.mega-menu .learn-col{float:left;-ms-flex:0 0 46%;flex:0 0 46%;max-width:46%}.mega-menu .take-action-col{float:left;-ms-flex:0 0 40%;flex:0 0 40%;max-width:40%}.mega-menu li:before{content:"\2022";font-size:35px;position:absolute;top:-17px;left:-11px;color:#ca4d00}.mega-menu li a{text-decoration:none!important;cursor:pointer;color:#113f83;font-weight:400}.up-triangle{font-size:3em;position:absolute;z-index:99999;text-align:center;right:30px;top:90px}.up-triangle .triangle{color:#113f83;border-bottom:15px solid #113f83;border-left:15px solid transparent;border-right:15px solid transparent;border-top:15px solid transparent;width:0;height:0;display:inline-block}
</style>
</head>

<body>
    <header class='hide-printing'>
      <script type='text/javascript'>
        function searchKeydown(e) {
          if (e.key == "Enter") {
            window.location.href = "/search?query=" + encodeURIComponent(event.target.value);
          }
        }
        function toggleMenuShow(e) {
            var element = document.getElementById("menu-show");
            if (element.style.display == 'none') {
              element.style.display = null;
            } else {
              element.style.display = 'none';
            }
        }
      </script>
      <div id='menu-show' style='display: none'>
        <span class="up-triangle"><span class="triangle">&nbsp;</span></span>
        <div class="mega-menu no-select"><div class="container"><div class="row"><header><h1><!-- react-text: 444 --> <!-- /react-text --><a href="/about">Supporting the Commonwealth through up-to-date climate change science: </a></h1></header><nav class="row w-100"><section class="col tool-n-data-col"><h2> Tools &amp; Data</h2><hr><h3><a href="/data/documents">Documents</a></h3><h3><a href="/data/data">Data</a></h3><h3><a href="/data/maps">Maps</a></h3><h3><a href="/search">Resource Clearinghouse</a></h3></section><section class="col learn-col col-xs-12"><h2>Learn</h2><hr><div class="row"><section class="col col-sm-4 no-pad-r"><h3>Explore Sectors:</h3><ul style="padding-left: 8px"><li><a href="/sectors/agriculture">Agriculture</a></li><li><a href="/sectors/coastal-zones">Coastal Zones</a></li><li><a href="/sectors/economy">Economy</a></li><li><a href="/sectors/energy">Energy</a></li><li><a href="/sectors/forestry">Forestry</a></li><li><a href="/sectors/infrastructure">Infrastructure</a></li><li><a href="/sectors/local-government">Local Government</a></li></ul></section><section class="col col-sm-4 no-pad-r"><h3>&nbsp;</h3><ul style="padding-left: 8px"><li><a href="/sectors/natural-resources-habitats">Natural Resources / Habitats</a></li><li><a href="/sectors/public-health">Public Health</a></li><li><a href="/sectors/public-safety-emergency-response">Public Safety / Emergency Response</a></li><li><a href="/sectors/recreation">Recreation</a></li><li><a href="/sectors/transportation">Transportation</a></li><li><a href="/sectors/water-resources">Water Resources</a></li></ul></section><section class="col col-sm-4 no-pad-r"><h3>Identify Changes:</h3><ul style="padding-left: 8px"><li><a href="/changes/sea-level-rise">Sea Level Rise</a></li><li><a href="/changes/extreme-weather">Extreme Weather</a></li><li><a href="/changes/changes-in-precipitation">Changes in Precipitation</a></li><li><a href="/changes/rising-temperatures">Rising Temperatures</a></li></ul></section></div></section><section class="col take-action-col"><h2>Take Action</h2><hr><div class="row"><section class="col col-sm-4 no-pad-r"><h3>MVP Program:</h3><ul style="padding-left: 8px"><li><a href="/mvp">MVP Program Information</a></li></ul></section><section class="col col-sm-4 no-pad-r"><h3>State Hazard Mitigation and Climate Adaptation Plan (SHMCAP):</h3><ul style="padding-left: 8px"><li><a href="/shmcap-portal/index.html">Our Plan </a></li><li><a href="/shmcap-portal/index.html#/action-tracker/">SHMCAP Action Tracker </a></li></ul></section><section class="col col-sm-4 no-pad-r"><h3>Additional Planning Resources:</h3><ul style="padding-left: 8px"><li><a href="/actions/planning">Plan Development</a></li><li><a href="/actions/implementation">Implementation</a></li><li><a href="/actions/outreach-education">Outreach / Education</a></li></ul></section></div></section></nav></div></div></div>
      </div>
      </div>
      <div class=''>
        <div class="header-wrap">
          <div class="px-5 header">
            <a href="/" class="logo">
              <img class="hidden-sm-down" src="img/logo.png" alt="logo">
              <div class="logo-text slate-text">
                <h1>
                  <span class="slate-text">resilient</span>
                  <strong class="orange-text"> MA </strong>
                </h1>
                <small class="tagline slate-text">Climate Change Clearinghouse for the Commonwealth</small>
              </div>
            </a>
            <div class="controls">
              <div class="search-bar ">
                <div class="input-group input-group-sm">
                  <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-w-16 fa fa-search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
                  <input id='search_header_input' onkeydown="searchKeydown(event)" type="text" class="form-control" aria-label="Enter search string for resources and press enter to search" placeholder="SEARCH" value="">
                </div>
              </div>
              <div class="mega-menu-toggle no-select show-cursor" onclick="toggleMenuShow(event)">
                <label> Menu </label>
                <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-w-14 fa fa-bars" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg>
              </div>
            </div>
          </div>
        </div>
    </header>

    <div class='main-header hide-printing'> </div>
    <div id="container">
      <div id='ractive_root'>
        <div id='control_panel_root'></div>
      </div>

      <div id="map" class="sidebar-map" style="background-color:white;"></div>
    </div>

    <div class='print-legend-page visible-print visible-print-block'>
      <!--PRINT PARAMETERS-->
    </div>

<!-- VIEW TEMPLATES -->
<script id='control_panel_template' type="text/ractive">
  {{>map_controls_template}}
  {{>layer_controls_template}}
  {{>layer_info_modal_template}}
  {{>sharing_modal_template}}
  {{>map_details_modal_template}}
  {{>printing_legends_template}}
  {{>wizard_template}}
  {{>wizard_standalone_template}}
  {{>map_out_of_view_layers_template}}
  {{>layer_import_modal_template}}
</script>
<script id='map_color_block_legend_template' type='text/ractive'>
  <div class='detail-block legend {{quantiled ? 'quantiled' : ''}}'>
    <div class='color-legend '>{{{legend}}}</div>
    {{#colors:i}}
      <div class='color-block' style="width: {{100.0 / colors.length}}%;">
        <svg width="100" height="100">
          <rect height="100" width="100" style="fill: {{.}}; opacity:{{(0.7 * parameters.opacity / 100.0) + 0.3}}; "/>
        </svg>
        <label>{{{u.color_range_label(metrics, colors, i, precision, signed, inverted)}}}</label>
      </div>
    {{/colors}}
  </div>
</script>

<script id='map_out_of_view_layers_template' type='text/ractive'>
  {{#if (out_of_view_layers(layers.active, map_state.zoom)).length > 0}}
    <div class='out-of-zoom-alerts'>
      {{#(out_of_view_layers(layers.active, map_state.zoom))}}
        <div class='alert alert-warning'>
          <label>{{{name}}} </label>
          is not visible at this zoom level.
          <a class='btn btn-sm btn-primary' on-tap='zoom-to-view-layer'> Zoom to Layer </a>
        </div>
      {{/(out_of_view_layers(layers.active, map_state.zoom))}}
    </div>
  {{/if (out_of_view_layers(layers.active, map_state.zoom)).length > 0}}
</script>

<script id='wizard_link_template' type='text/ractive'>
  Show a Link Here
</script>

<script id='layer_import_modal_template' type="text/ractive">
  <div class='modal-wrapper {{layer_import.show_modal ? "open" : "closed"}} '>
    <div class='modal-bg' on-tap="close-layer-import-modal"></div>
    <div class='modal-content layer-import-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="close-layer-import-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2> Layer Import </h2>
            <p> This mapper allows you to import and view your own map layer in the browser.  </p>
            <div class='input-upload'>
              <input id='layer_import_file_input' type='file' value='{{layer_import.import_file}}'
                  accept=".zip, .kml, .geojson, .json, .gpx"/>
              {{#if layer_import.import_file}}
                {{#if layer_import.import_file_processing}}
                  Loading ... <span class='fa fa-spinner fa-spin-custom'></span>
                {{else}}
                  <span class='btn btn-primary' on-tap='upload-layer-import-file'> Import </span>
                {{/if layer_import.import_file_processing}}
              {{/if layer_import.import_file}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>


<script id='wizard_standalone_template' type="text/ractive">
  <div class='modal-wrapper {{wizard.standalone ? "open" : "closed"}} '>
    <div class='modal-bg' on-tap="close-standalone-wizard"></div>
    <div class='modal-content wizard-modal'>
      <div class='container-fluid {{wizard.standalone}}'>
        <span class='show-cursor fa fa-close' on-tap="close-standalone-wizard"></span>
        {{#if "climate-vulnerability" === wizard.standalone }}
          <h1> Climate Vulnerability</h1>
          <p>
            Using this tool you can explore the climate change effects on your locality.
          </p>
          <form role='form' on-submit='add-climate-vulnerability-layer'>
            <div class='form-group'>
              <label for='climate_vuln_town'>Pick Your Town: </label>
              <input class='form-control' value='{{climate_vulnerability.town}}' type='text' list='climate_vulnerability_towns'/>
            </div>
            <div class='form-group clearfix'>
              <label for='climate_vuln_features'>Pick Vulnerabilities to Map:</label>

              {{#climate_vulnerability.all_features}}
                <div class='feature-toggler'>
                  <div class="btn {{ u.contains(climate_vulnerability.features, .) ? 'btn-primary' : 'btn-secondary'}}"
                       on-tap='toggle-climate-vulnerability-feature'>
                       {{.}}
                  </div>
                </div>
              {{/climate_vulnerability.all_features}}
            </div>
            <datalist id='climate_vulnerability_towns'>
              {{#climate_vulnerability.towns}}
                <option name={{.}}> {{.}} </option>
              {{/climate_vulnerability.towns}}
            </datalist>

            <hr/>
            <div class='pull-right'>
              {{#(climate_vulnerability.town && u.object_entries_count(climate_vulnerability.features) > 0)}}
                <button class='btn btn-primary' on-tap='add-climate-vulnerability-layer'> View Climate Vulnerability for {{climate_vulnerability.town}} </button>
              {{else}}
                <button class='btn-primary btn' disabled > View Climate Vulnerability</button>
              {{/(climate_vulnerability.town && u.object_entries_count(climate_vulnerability.features) > 0)}}
            </div>
          </form>
        {{/if "climate-vulnerability" === wizard.standalone}}
      </div>
    </div>
  </div>
</script>

<script id='wizard_template' type="text/ractive">
  <div class='modal-wrapper {{wizard.open ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="close-wizard"></div>
    <div class='modal-content wizard-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="close-wizard"></span>
        <span class='fa fa-arrow-right noselect' on-tap="next-wizard"></span>
        <span class='fa fa-arrow-left noselect' on-tap="prev-wizard"></span>
        {{#if "welcome" != wizard.steps[wizard.current_step]}}
          <span class='btn btn-sm btn-primary back-to-start show-cursor' on-tap="show-wizard">Back To Start</span>
        {{/if "welcome" != wizard.steps[wizard.current_step]}}

        {{#if "welcome" === wizard.steps[wizard.current_step]}}
          <h1>Welcome</h1>
          <p>Thanks for visiting the resilient MA Climate Change Mapping Tool; a place to interactively explore data and create maps related to climate change impacts, vulnerability and adaptation across Massachusetts.</p>
          <h2>What's in the Map?</h2>
          <p>Our library of viewable map layers and interactive map functions has been developed by recommendations from state experts in climate change. </p>
          <h2>What's Not in the Map?</h2>
          <p>Our map viewer contains only a portion of the mappable data sources available in the Clearinghouse. </p>
          <h2>Using the viewer</h2>
          <p>Before getting started, scroll through this Map Guide to get familiar with the layout and functions of the interface. Most layers contain multiple data sources that can be explored with map controls. Many layers can be clicked upon in the map to provide more specific local information or data values. You can also share your map digitally or create pdf maps with legends.</p>
          <ul>
            <li> <a class='show-cursor' on-tap='wizard-sidebar-intro'> Learn about the sidebar </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-base-layers'> Moving the map and base layers </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-adding-things'> Adding things to the map </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-find-more-info'> Finding out more about a layer </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-order-layers'> Ordering layers </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-using-legends-tab'> Using Legends Tab </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-printing'> Printing the Map </a> </li>
            <li> <a class='show-cursor' on-tap='wizard-advanced-layer-controls'> Advanced Layer Controls </a> </li>
          </ul>
        {{/if "welcome" === wizard.steps[wizard.current_step]}}
        {{#if "sidebar_intro" === wizard.steps[wizard.current_step]}}
          <h1> Using the sidebar </h1>
          <img src="img/wizard/sidebar_intro.gif">
          <p><strong>Layers</strong>
            tab gives you access to a variety of map layers and data sources organized by sector. You can browse the layers in each sector or use the search box at the top.
          </p>

          <p>
            <strong>Controls & Legends</strong>
            tab provides map legend information, allows you to adjust the layer information and how it is shown in the map.
          </p>

          <p>
            <strong>Quick Zoom</strong>
            tab allows you to search for a location or address in and around Massachusetts. The map will zoom to the location you select from the search results.
          </p>
        {{/if "sidebar_intro" === wizard.steps[wizard.current_step]}}

        {{#if "base_layers" === wizard.steps[wizard.current_step]}}
          <h1> Adjusting your map view and base layer</h1>
          <img src="img/wizard/base_layers.gif">
          <p><strong>Click and drag</strong>
            on the map itself to adjust the map view.
          </p>
          <p>
            Use the controls in the upper right to <strong> zoom in and out </strong>.  You may also double-click on the map, use your mouse scroll wheel, or hold down shift and draw a box with your mouse to zoom.
          </p>

          <p>
            Click the <strong>House</strong> icon (<span class='fa fa-home'></span>) to return to the default view of Massachusetts.
          </p>

          <p>
            Click the <strong>Target</strong> icon (<span class='fa fa-crosshairs'></span>) to zoom to your current location
            <br>
            <em>(note: your browser may request permission to locate you)</em>
          </p>

          <p>
            Click the <strong>Base Map</strong> button to select one of the available base map layers.
          </p>
        {{/if "base_layers" === wizard.steps[wizard.current_step]}}

        {{#if "adding_things" === wizard.steps[wizard.current_step]}}
          <h1> Adding things to the map</h1>
          <img src="img/wizard/adding_things.gif">
          <p>
            You can add layers by clicking on the Layers tab, which will show you all the layers available to be added to the map.
            <br>
            You can also use the search box to find layers.
          </p>
          <p>
            Once you find a layer you are interested in, you can click its name or checkbox to enable it. Once it is loaded it will display on the map. Some layers may take a few moments to load.
          </p>
          <p>
            Use the 'Sectors' filter to find the layers relevant to various sectors.
          </p>
        {{/if "adding_things" === wizard.steps[wizard.current_step]}}

        {{#if "find_more_info" === wizard.steps[wizard.current_step]}}
          <h1> Finding out more about a layer</h1>
          <p>
            Click on the <span class='fa fa-info-circle'></span> to learn more about the layer
            and find a link to its source, where you can often find detailed data descriptions and relevant information.
          </p>
          <p>
            For some layers you can also click <strong>directly on the map</strong> to identify the value at that location.
          </p>
          <img class='full-width' src="img/wizard/find_more_info.gif">
        {{/if "find_more_info" === wizard.steps[wizard.current_step]}}

        {{#if "order_layers" === wizard.steps[wizard.current_step]}}
          <h1> Ordering Layers </h1>
          <p>
            If a layer is active but you cannot see any features, it may be hidden behind other layers.
            Layers are ordered in the sidebar as they are ‘stacked’ in the map view.
          </p>
          <p>
            You can use the <span class='fa fa-angle-double-up'></span> to move layers to the top, or click and drag on the <span class='fa fa-hand-stop-o'></span> to drag layers into the order you prefer.
            Note that some types of layers will always draw on top of other layers - and these will not have the <span class='fa fa-angle-double-up'></span> or <span class='fa fa-hand-stop-o'></span> available.
          </p>
          <p>
            You can always hide (<span class='fa fa-eye'></span>) or remove (<span class='fa fa-trash'></span>) these layers to take them out of the map view.
          </p>
          <img class='full-width' src="img/wizard/order_layers.gif">
        {{/if "order_layers" === wizard.steps[wizard.current_step]}}

        {{#if "using_legends_tab" === wizard.steps[wizard.current_step]}}
          <h1> Using Controls & Legends Tab </h1>
          <p>
            Each layer has a set of buttons that vary depending on the functions available for that layer.
          </p>
          <p>
            All layers have:
              <br>
              <span class='fa fa-angle-double-up'></span> which moves the layer to the top of the map
              <br>
              <span class='fa fa-eye'></span> which hides or shows the layer
              <br>
              <span class='fa fa-info-circle'></span> which provides layer information
              <br>
              <span class='fa fa-trash'></span> which removes the layer from the view
          </p>
          <p>
            Opacity can be adjusted using the slider
          </p>
          <p>
            <strong>Expand / Collapse all </strong> – these buttons change how the legend information is viewed in the sidebar. It does not affect how layers appear in the map view. Each legend can also be opened or closed by clicking on the layer name or the triangle to the left.
            <br>
            <strong>Hide all </strong> – this hides all layers but does not remove them from the map view or change how their legends appear in the sidebar.
            <br>
            <strong>Remove all</strong> – this removes all layers from the map and their legends from the sidebar.
          </p>
          <img class='full-width' src="img/wizard/order_layers.gif">
        {{/if "using_legends_tab" === wizard.steps[wizard.current_step]}}

        {{#if "printing" === wizard.steps[wizard.current_step]}}
          <h1> Printing the Map </h1>
          <p>
            The <span class='fa fa-print'></span> button will export your map and legends to a layout and open the print dialog window automatically from your browser.
          </p>
          <p>
            The print layout includes a full-page map view and one or more additional pages for legend information. Note that the map view that is exported includes the area beneath the sidebar.
          </p>
          <p>
            <em> Hint: you can hide the sidebar by double-clicking on any tab name, or clicking on the name of the open tab. When the sidebar is collapsed, the map view shows what will be sent to the print layout.  </em>
          </p>
          <img class='full-width' src="img/wizard/printing.gif">
        {{/if "printing" === wizard.steps[wizard.current_step]}}
        {{#if "advanced_layer_controls" === wizard.steps[wizard.current_step]}}
          <h1> Advanced Layer Controls </h1>
          <p>
            Some layers, especially those in the <strong>Climate Data</strong> and <strong>Ecosystems</strong> folders, contain multiple datasets as part of the layer. These datasets can be accessed using customized controls found in the <strong>Controls & Legends</strong> tab once the layer is active.
          </p>
          <p>
            Use drop down menus, buttons and sliders to navigate to the data you are interested in. <em>Note: for most interactive layers, the legend color bar will automatically adjust based on which data you select to show in the map.</em>
          </p>
          <p>
          You can also <strong>Clone</strong> (<span class='fa fa-clone'></span>) a specific dataset and add it to the map as a ‘stand-alone’ layer. This is helpful when comparing multiple datasets from one or more of these types of interactive layers. The new layer is added to the list in the <strong>Controls & Legends</strong> tab (but does <em>not</em> appear in the list on the <strong>Layers</strong> tab).
          </p>
          <p>
            Most interactive layers include the ability to click on the map <span class='fa fa-map-marker'></span> to return a value for that location.
          </p>
          <img class='full-width' src="img/wizard/advanced_layer_controls.gif">
        {{/if "advanced_layer_controls" === wizard.steps[wizard.current_step]}}

        <!--
          <div class='footer'>
            Hint {{wizard.current_step + 1}} / {{wizard.steps.length}}
          </div>
        -->
      </div>
    </div>
  </div>
</script>

<script id='printing_legends_template' type="text/ractive">
  <div class='printing-legends visible-print-block'>
    <div class='columns'>
      {{#layers.active}}
        <div class='active-layer'>
          <label class='layer-name'> {{{name}}} </label>
         {{> layer_controls_details_blocks_template}}
        </div>
      {{/layers.active}}
    </div>
  </div>
</script>

<script id='map_details_modal_template' type="text/ractive">
  <div class='modal-wrapper {{(map_details.location && map_details.feature_info_requests.length > 0) ? "open" : "closed"}}' >
    <div class='modal-bg' on-tap="hide-feature-info-modal"></div>
    <div class='modal-content feature-info-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-feature-info-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Location Info
             <!--  <small>{{map_details.location.lat}},{{map_details.location.lng}}</small> -->
            </h2>
          </div>
        </div>
        {{#map_details.feature_info_requests}}
          <div class='row response'>
            {{#map_details.feature_info_responses[response_id]}}
              {{#error}}
                <div class='col-xs-2'>
                  <label> {{{name}}} </label>
                </div>
                <div class='col-xs-10'>
                  <span class='error'> Error Loading </span>
                  {{#if (show_error_details)}}
                    <a on-tap='toggle-show-feature-info-response-details'> Hide Details. </a>
                    <pre>{{error}}</pre>
                  {{else}}
                    <a on-tap='toggle-show-feature-info-response-details'> Show Details. </a>
                  {{/if (show_error_details)}}
                </div>
              {{else}}
                {{> active_layer.templates.info}}
              {{/error}}
            {{else}}
              <div class='col-xs-2'>
                <label> {{{name}}} </label>
              </div>
              <div class='col-xs-10'>
                <span> loading ...
                  <span class='fa fa-spinner fa-spin-custom'></span>
                </span>
              </div>
            {{/if}}
          </div>
        {{/map_details.feature_info_requests}}
      </div>
    </div>
  </div>
</script>

<script id='sharing_modal_template' type="text/ractive">
  <div class='modal-wrapper {{sharing_modal_loading ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-sharing-modal"></div>
    <div class='modal-content sharing-loading-modal'>
      <div class='container-fluid'>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Loading your map...
              <span class='fa fa-spinner fa-spin-custom'></span>
            </h2>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class='modal-wrapper {{sharing_modal.open ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-sharing-modal"></div>
    <div class='modal-content'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-sharing-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              Saving and Sharing Maps
            </h2>
          </div>
        </div>
        <div class='row'>
          <hr/>
        </div>
        <div class='row'>
          <div class='col-xs-12'>
            <p> You can save the current map view, including all active layers and settings, by requesting a save link below. Bookmark the link to return to the map.</p>
            <p>Share this link with others and they will be able to load up the map directly in their web browser.</p>
          </div>
        </div>
        <hr/>
        <div class='row'>
          {{#if sharing_modal.token }}
            {{#if "loading" === sharing_modal.token}}
              <div class='col-xs-3'> &nbsp; </div>
              <a disabled class='btn btn-primary col-xs-6' on-tap="request-share-link-token">
                <span class='fa fa-spinner fa-spin-custom'></span>
                Requesting Link...
              </a>
              <div class='col-xs-3'> &nbsp; </div>
            {{ else }}
              <div class='col-xs-1'></div>
              <div class='col-xs-10'>
                <input class='form-control' readonly onfocus="this.select()" onmouseup='return false;' value='{{sharing_url(sharing_modal.token)}}'>
              </div>
              <div class='col-xs-1'></div>
            {{/if}}
          {{ else }}
            <div class='col-xs-3'> &nbsp; </div>
            <a class='btn btn-primary col-xs-6' on-tap="request-share-link-token"> Request Link </a>
            <div class='col-xs-3'> &nbsp; </div>
          {{/if sharing_modal.token}}
        </div>
      </div>
    </div>
  </div>
</script>

<script id='layer_info_modal_template' type="text/ractive">
  <div class='modal-wrapper {{layer_controls.current_layer_info ? "open" : "closed"}}'>
    <div class='modal-bg' on-tap="hide-layer-info-modal"></div>
    <div class='modal-content layer-info-modal'>
      <div class='container-fluid'>
        <span class='show-cursor fa fa-close' on-tap="hide-layer-info-modal"></span>
        <div class='row'>
          <div class='col-xs-12'>
            <h2>
              {{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).name}}}
              <small>{{layer_controls.current_layer_info}}</small>
            </h2>
          </div>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Service Status </label>
          </div>
          <span class='col-xs-8'>
            <span class='label label-{{layer_load_state(layers_loading_states, layer_controls.current_layer_info)}}'>
              {{layer_load_state_error_count(layers_loading_states, layer_controls.current_layer_info)}}
            </span>
          </span>
          <span class='col-xs-2'>
          </span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Folder </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).folder}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Description </label>
          </div>
          <span class='col-xs-8'>{{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).description}}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Sectors </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).sectors}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Source </label>
          </div>
          <span class='col-xs-8'>{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source}}</span>
        </div>
        <div class='row'>
          <div class='col-xs-4'>
            <label> Source URL </label>
          </div>
          <span class='col-xs-8'>
            <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source_url}}" target="_blank">
              {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).source_url, 40)}}
            </a>
          </span>
        </div>

        {{#if get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url}}
          <div class='row'>
            <div class='col-xs-4'>
              <label> Download URL </label>
            </div>
            <span class='col-xs-8'>
              <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url}}" download target="_blank">
                {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).download_url, 40)}}
              </a>
            </span>
          </div>
        {{/if}}
        {{#if get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url}}
          <div class='row'>
            <div class='col-xs-4'>
              <label> MetaData URL </label>
            </div>
            <span class='col-xs-8'>
              <a href="{{get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url}}" target="_blank">
                {{u.shorten_url(get_layer_defaults(layers.defaults, layer_controls.current_layer_info).metadata_url, 40)}}
              </a>
            </span>
          </div>
        {{/if}}
      </div>
    </div>
  </div>
</script>

<script id="zoom_controls_template" type="text/ractive">
  <div class='zoom-controls noselect'>
    <a class='noselect {{map_state.zoom > map_state.zoom_max ? "disable" : ""}}  >'
       decorator="tooltip:Zoom in" on-tap="map-zoom-in"> <span class='fa fa-plus'></span> </a>
    {{#if has_geolocation }}
      <a class='noselect' decorator="tooltip:Zoom to your location" on-tap='map-zoom-me'> <span class='fa fa-crosshairs'></span></a>
    {{/if}}
    <a class='noselect' decorator="tooltip:Zoom to original view" on-tap='map-zoom-home'> <span class='fa fa-home'></span></a>
    <a class='noselect {{map_state.zoom < 1 ? "disable" : ""}}' decorator="tooltip:Zoom out" on-tap="map-zoom-out"> <span class='fa fa-minus'></span> </a>
  </div>
</script>

<script id="layer_controls_template" type="text/ractive">
  <div class='layer-controls noselect'>
    <div class='tabs container-fluid'>
      <div class='row'>
        <a on-tap="show-layers-control" class="layers-tab col-xs-3 {{layer_controls.active_tab === 'layers' ? 'active': '' }}">
          <span class='fa fa-check-square-o'></span>
          Layers
        </a>
        <a on-tap="show-details-control" class="legend-map-controls-tab col-xs-6 {{layer_controls.active_tab === 'details' ? 'active': ''}}">
          <span class='fa fa-sliders'></span>
          Controls &amp; Legends
          {{#if layers.active.length > 0 }}
            <span class='label label-default label-xs'>{{layers.active.length}}</span>
          {{/if}}

          {{#wizard.adding_layers_popup}}
            <span class='arrow_box notice-me-banner' on-tap="remove-layer-add-notice">
              <span>After adding layers to the map, click on the Controls &amp; Legends tab to dig deeper!</span>
            </span>
          {{/wizard.adding_layers_popup}}
        </a>
        <a on-tap='show-search-control' class="locations-tab col-xs-3 {{layer_controls.active_tab === 'search' ? 'active': ''}} " >
          <span class='fa fa-search'></span>
          Quick Zoom
        </a>
      </div>
    </div>
    <div class="tray {{layer_controls.tray.open ? 'show' : ''}}">
      <div class='tray-container {{tools.climate_vulnerability ? 'climate-vuln' : ''}}'>
        {{#if layer_controls.active_tab === "layers"}}
          {{>layer_controls_layers_template }}
        {{else}}
          {{#if layer_controls.active_tab === "search"}}
            {{>layer_controls_search_template}}
          {{else}}
            {{>layer_controls_details_template }}
          {{/if}}
        {{/if}}
      </div>
      {{#if tools.climate_vulnerability}}
        <div class='footer '>
          {{#if climate_vulnerability.show_report}}
            <div class='climate-vuln-report'>
              <div class='body'>
                <iframe src="./vulnerability_report.html?town={{climate_vulnerability.show_report.town}}&hazard={{climate_vulnerability.show_report.hazard}}"></iframe>
              </div>
            </div>
          {{/if climate_vulnerability.show_report}}
          <h3> Town Climate Vulnerability</h3>
          <div class='form-group'>
            <label for='climate_vuln_town'>Pick Your Town: </label>
            <input class='form-control' value='{{climate_vulnerability.town}}' type='text' list='climate_vulnerability_towns'/>
            {{#if climate_vulnerability.town}}
              <label>Pick Your Report: </label>
              <div>
                <div class='col-md-5'>
                  <div>
                    <a href='#'
                      class='{{climate_vulnerability.show_report.hazard == 'heat' && climate_vulnerability.show_report.town == climate_vulnerability.town ? 'active' : ''}}'
                      climate-vuln='heat' on-tap="show-climate-vulnerability-layer">Extreme Heat</a>
                  </div>
                  <!--
                    <div>
                      <a href='#'
                        class='{{climate_vulnerability.show_report.hazard == 'slr' && climate_vulnerability.show_report.town == climate_vulnerability.town ? 'active' : ''}}'

                        climate-vuln='slr' on-tap="show-climate-vulnerability-layer">Sea-Level Rise</a>
                    </div>
                  -->
                </div>
                <div class='col-md-7'>
                  <div>
                    <a href='#'
                      class='{{climate_vulnerability.show_report.hazard == 'drought' && climate_vulnerability.show_report.town == climate_vulnerability.town ? 'active' : ''}}'
                      climate-vuln='drought' on-tap="show-climate-vulnerability-layer">Drought</a>
                  </div>
                  <!--
                    <div>
                      <a href='#'
                        class='{{climate_vulnerability.show_report.hazard == 'flooding' && climate_vulnerability.show_report.town == climate_vulnerability.town ? 'active' : ''}}'
                        climate-vuln='flooding' on-tap="show-climate-vulnerability-layer">Stormwater Flooding</a>
                    </div>
                  -->
                </div>
              </div>
            {{/if climate_vulnerability.town}}
          </div>
          <datalist id='climate_vulnerability_towns'>
            {{#climate_vulnerability.towns}}
              <option name={{.}}> {{.}} </option>
            {{/climate_vulnerability.towns}}
          </datalist>
        </div>
      {{/if tools.climate_vulnerability}}
    </div>
  </div>
</script>

<script id="layer_controls_search_template" type="text/ractive">
  <div class='search-header'>
    <input id="search_input" placeholder="Type a search" value="{{layer_controls.search_string}}">
    {{#if layer_controls.search_string.length > 0 }}
      <a>
        <span class='fa fa-times-circle-o show-cursor' on-tap="clear-search-query"></span>
      </a>
    {{/if}}
  </div>

  <div class='search-results'>
    {{#layer_controls.search_results.results}}
      <div class='result show-cursor'
            on-tap="zoom-to-search-result">
        <a class='' decorator="tooltip:Focus map on {{formatted_address}}">
          <span class='fa fa-circle-o'></span>
        </a>
        <span> {{formatted_address}} </span>
      </div>
    {{/layer_controls.search_results}}

    {{#if layer_controls.search_results.length === 0}}
      <div class='search-results-empty'>
        <span class='fa fa-search'></span>
        <div class='text'>
          Type a search above to find Massachusetts locations.
        </div>
      </div>
    {{/if layer_controls.search_results.length === 0}}

  </div>
</script>

<script id="layer_controls_layer_group_template" type="text/ractive">
      <div class='show-cursor' on-tap="toggle-layer-active" >
        {{#if is_active}}
          <span class='fa fa-check-square-o'></span>
        {{else}}
          <span class='fa fa-square-o'></span>
        {{/if is_active}}
        <label class='show-cursor'>{{{name}}}</label>
      </div>
</script>
<script id="layer_controls_layer_group_tree_template" type="text/ractive">
  <li>
    {{#if folder_name}}
      <label on-tap="toggle-layer-group-collapse">
        {{#if is_expanded}}
          <span class='fa fa-caret-down'></span>
        {{else}}
          <span class='fa fa-caret-right'></span>
        {{/if}}
        {{folder_name}}
      </label>
    {{/if}}

    {{#if is_expanded}}
      <ul class='layer-group'>
        {{#children:i}}
          {{#if this.folder_name}}
            {{> layer_controls_layer_group_tree_template}}
          {{else}}
            <li class='layer show-cursor' on-tap="toggle-layer-active">
              {{#is_active_layer(layers.active, this)}}
                {{#if (layer_load_state(layers_loading_states, this) === "success")}}
                  <span class='fa fa-check-square-o'></span>
                {{else}}
                  <span class='fa fa-spinner fa-spin-custom'></span>
                {{/if}}
              {{else}}
                <span class='fa fa-square-o'></span>
              {{/if}}
              <a class='info {{layer_load_state(layers_loading_states, this)}}'
                 on-tap='show-layer-info'>
                <span class='fa fa-info'> </span>
              </a>
              <span>{{{get_layer_defaults(layers.defaults, this).name}}}</span>
            </li>
          {{/if}}
        {{/children}}
      </ul>
    {{/if}}
  </li>
</script>

<script id="layer_controls_layers_template" type="text/ractive">
  <div class='contents'>
    <div class='search-header col-md-12'>
      <div class='row'>
        <input id="layers_search_input" placeholder="Search for layers..." value="{{layers.search_string}}">
        {{#if layers.search_string.length > 0 }}
          <a>
            <span class='fa fa-times-circle-o show-cursor' on-tap="clear-layers-search-query"></span>
          </a>
        {{/if}}
      </div>
      <div class='row'>
        <div class='sector-select'>
          <label> Sectors: </label>
          <div class='selected-text-container' on-tap='toggle-sector-dropdown'>
            <span class='selected'>{{selected_sectors_text(sectors.selected)}}</span>
          </div>
          <span on-tap='toggle-sector-dropdown'
           class='fa fa-caret-down'></span>
          {{#if sectors.show_dropdown}}
            <div class='sector-selection-dropdown'>
              {{#sectors.all}}
                <div on-tap='toggle-sector-selection'>
                  {{#if is_sector_selected(sectors.selected, .)}}
                    <span class='fa fa-check-square-o'></span>
                  {{else}}
                    <span class='fa fa-square-o'></span>
                  {{/if is_sector_selected(sectors.selected, .)}}
                  <span class='sector-name'>{{.}}</span>
                </div>
              {{/sectors.all}}
              <hr/>
              <span class='btn btn-block btn-primary' on-tap='toggle-sector-dropdown'>
                Done
              </span>
              <span class='btn btn-sm btn-block btn-secondary' on-tap='clear-sector-dropdown'>
                Clear All
              </span>
            </div>
          {{/if sectors.show_dropdown}}
        </div>
      </div>
    </div>
    <div class='search-results'>
      <ul class='layer-group'>
        {{#if layers.tree}}
          {{> layer_controls_layer_group_tree_template layers.tree}}
        {{/if}}
      </ul>
    </div>
  </div>
</script>

<script id="layer_controls_details_blocks_template" type="text/ractive">
  {{#if parameters.opacity !== false}}
    <div class='detail-block opacity'>
      <label  decorator='tooltip:Use slider to adjust layer transparency'> Opacity: </label>
      <input type="range" value="{{parameters.opacity}}" min="0" max="100">
      {{parameters.opacity}}%
    </div>
  {{/if}}
  {{#if !copied_source}}
    {{#templates.legend }}
      {{> templates.legend}}
    {{/templates.legend }}
  {{/if !copied_source}}

</script>

<script id="layer_controls_details_template" type="text/ractive">
  <div class='active-layers-wrapper'>
    {{#if layers.active.length > 0 }}
      <div class='bulk'>
        {{#if !all_active_collapsed(layers.active)}}
          <a on-tap='collapse-all-layers' class='show-cursor'> Collapse All</a>
        {{else}}
          <a on-tap='expand-all-layers' class='show-cursor'> Expand All</a>
        {{/if}}

        {{#if !all_active_hidden(layers.active)}}
          <a on-tap='hide-all-layers' class='show-cursor'> Hide All</a>
        {{else}}
          <a on-tap='visible-all-layers' class='show-cursor'> Show All</a>
        {{/if}}

        <a on-tap='deactivate-all-layers' class='show-cursor'> Remove All</a>
      </div>
    {{else}}
      <div class='active-layers-empty'>
        <span class='fa fa-globe'></span>
        <div class='text'>
          You need to select some layers to display on the map.
          <br/>
          Look in the Layers tab to the left to choose.
        </div>
      </div>
    {{/if}}

    {{#each layers.active}}
      <div decorator='{{parameters.no_sorting ? "" : "sortable"}}' class='active-layer'>
        {{#if "" === layer_load_state(layers_loading_states, layer_default_id)}}
          <div class='disable-active-layer-overlay'>
            <label> Loading {{{name}}}...
              <span class='fa fa-spinner fa-spin-custom'></span>
            </label>
          </div>
        {{/if "" !== layer_load_state(layers_loading_states, layer_default_id)}}

        <label class='name' on-tap="toggle-active-collapsed">
          <span class='show-cursor'>
            {{#if is_collapsed}}
              <span decorator="tooltip:Expand Legend" class='fa fa-caret-right'></span>
              {{#if layer_load_state(layers_loading_states, layer_default_id) !== "success"}}
                <a decorator="tooltip:Show layer metadata" on-tap="show-active-layer-info" class='info {{layer_load_state(layers_loading_states, layer_default_id)}}'>
                  <span class='show-cursor fa fa-info'></span>
                </a>
              {{/if}}
            {{else}}
              <span decorator="tooltip:Minimize Legend" class='fa fa-caret-down'></span>
            {{/if}}
            {{#if !parameters.no_sorting}}
              <span decorator="tooltip:Drag to reorder layer" class='drag-handle fa fa-hand-stop-o'></span>
            {{/if !parameters.no_sorting}}
            {{{name}}}
          </span>
        </label>

        {{#if !is_collapsed}}
          <div class='active-details'>
            <div class='control-bar'>
              <a decorator="tooltip:Remove layer" on-tap="remove-active">
                <span class='show-cursor fa fa-trash-o' > </span>
              </a>
              {{#if !parameters.no_sorting}}
                <a decorator="tooltip:Move to top" on-tap='move-active-to-top'>
                  <span class='show-cursor fa fa-angle-double-up'> </span>
                </a>
              {{/if}}
              {{#if is_hidden}}
                <a decorator="tooltip:Make layer visible"  on-tap='make-active-visible'>
                  <span class='show-cursor fa fa-eye-slash' ></span>
                </a>
              {{else}}
                <a decorator="tooltip:Make layer hidden"  on-tap='make-active-hidden'>
                  <span class='show-cursor fa fa-eye'></span>
                </a>
              {{/if}}

              {{#if able_to_copy(this) }}
                <a decorator="tooltip:Clone this layer" on-tap="clone-active-layer">
                  <span class='show-cursor fa fa-clone'></span>
                </a>
              {{/if}}

              <a decorator="tooltip:Show layer metadata" on-tap="show-active-layer-info" class='info {{layer_load_state(layers_loading_states, layer_default_id)}}'>
                <span class='show-cursor fa fa-info'></span>
              </a>

              {{#if layer_has_click_info(this)}}
                <a decorator="tooltip:Click on the map to find out more details">
                  <span class='fa fa-map-marker' > </span>
                </a>
              {{/if layer_has_click_info(this)}}

              {{#if layer_has_standalone_wizard(this)}}
                <a decorator="tooltip:This layer has detailed instructions. Click to view" on-tap="show-standalone-wizard">
                  <span class='fa fa-question'> </span>
                </a>
              {{/if layer_has_standalone_wizard(this)}}
            </div>
            {{> layer_controls_details_blocks_template}}
          </div>
        {{/if}}
      </div>
    {{/each}}
  </div>
</script>

<script id="map_controls_template" type="text/ractive">
<div class='map-controls'>
  <div class='map-control print-control btn-group'>
    <span class='btn btn-md btn-default' on-tap="show-wizard">
      <span class='fa fa-question'></span>
    </span>
    <span class='btn btn-md btn-default add-layer'
          on-tap="open-layer-import-modal">
      <span class='fa fa-map-o'></span>
      <span class='fa fa-plus-circle'></span>
    </span>
    <span class='btn btn-md btn-default'
          on-tap="print-map">
      <span class='fa fa-print'></span>
    </span>

    <span class='btn btn-md btn-default'
          on-tap="open-sharing-modal">
      <span class='fa fa-share-alt'></span>
    </span>

  </div>

  <div class='map-control'>
    <span class='btn btn-md btn-default {{map_controls.base_layer_control_open ? "active" : ""}}'
          on-tap="toggle-base-layer-control"
      > Base Map </span>
    {{#map_controls.base_layer_control_open }}
      <div class='control-details base-layers'>
        {{#each base_layers}}
          <a class="base-layer show-cursor {{map_controls.active_base_layer === name ? 'active' : ''}}" on-tap="activate-base-layer">{{{name}}}</a>
        {{/each}}
      </div>
      <div class='map-control-bg' on-tap='toggle-base-layer-control'></div>
    {{/map_controls.base_layer_control_open }}
  </div>
  {{>zoom_controls_template}}
</div>
</script>

<!-- VIEW TEMPLATES -->
    <!--[if IE]>
      <script src="https://www.promisejs.org/polyfills/promise-6.1.0.js"></script>
    <![endif]-->
    <script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src='https://unpkg.com/shpjs@latest/dist/shp.js'></script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/leaflet-1.2.0/leaflet-src.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,i){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.L={})}(this,function(t){"use strict";function i(t){var i,e,n,o;for(e=1,n=arguments.length;e<n;e++){o=arguments[e];for(i in o)t[i]=o[i]}return t}function e(t,i){var e=Array.prototype.slice;if(t.bind)return t.bind.apply(t,e.call(arguments,1));var n=e.call(arguments,2);return function(){return t.apply(i,n.length?n.concat(e.call(arguments)):arguments)}}function n(t){return t._leaflet_id=t._leaflet_id||++pi,t._leaflet_id}function o(t,i,e){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(e,o),o=!1)},s=function(){n?o=arguments:(t.apply(e,arguments),setTimeout(r,i),n=!0)}}function s(t,i,e){var n=i[1],o=i[0],s=n-o;return t===n&&e?t:((t-o)%s+s)%s+o}function r(){return!1}function a(t,i){var e=Math.pow(10,i||5);return Math.round(t*e)/e}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function u(t){return h(t).split(/\s+/)}function l(t,i){t.hasOwnProperty("options")||(t.options=t.options?di(t.options):{});for(var e in i)t.options[e]=i[e];return t.options}function c(t,i,e){var n=[];for(var o in t)n.push(encodeURIComponent(e?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(i&&-1!==i.indexOf("?")?"&":"?")+n.join("&")}function _(t,i){return t.replace(mi,function(t,e){var n=i[e];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(i)),n})}function d(t,i){for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1}function p(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function m(t){var i=+new Date,e=Math.max(0,16-(i-vi));return vi=i+e,window.setTimeout(t,e)}function f(t,i,n){if(!n||yi!==m)return yi.call(window,e(t,i));t.call(i)}function g(t){t&&xi.call(window,t)}function v(){}function y(t){if(L&&L.Mixin){t=fi(t)?t:[t];for(var i=0;i<t.length;i++)t[i]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function x(t,i,e){this.x=e?Math.round(t):t,this.y=e?Math.round(i):i}function w(t,i,e){return t instanceof x?t:fi(t)?new x(t[0],t[1]):void 0===t||null===t?t:"object"===(void 0===t?"undefined":_typeof(t))&&"x"in t&&"y"in t?new x(t.x,t.y):new x(t,i,e)}function b(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function P(t,i){return!t||t instanceof b?t:new b(t,i)}function T(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function z(t,i){return t instanceof T?t:new T(t,i)}function M(t,i,e){if(isNaN(t)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+i+")");this.lat=+t,this.lng=+i,void 0!==e&&(this.alt=+e)}function C(t,i,e){return t instanceof M?t:fi(t)&&"object"!==_typeof(t[0])?3===t.length?new M(t[0],t[1],t[2]):2===t.length?new M(t[0],t[1]):null:void 0===t||null===t?t:"object"===(void 0===t?"undefined":_typeof(t))&&"lat"in t?new M(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===i?null:new M(t,i,e)}function Z(t,i,e,n){if(fi(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=i,this._c=e,this._d=n}function S(t,i,e,n){return new Z(t,i,e,n)}function E(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function k(t,i){var e,n,o,s,r,a,h="";for(e=0,o=t.length;e<o;e++){for(n=0,s=(r=t[e]).length;n<s;n++)a=r[n],h+=(n?"L":"M")+a.x+" "+a.y;h+=i?ae?"z":"x":""}return h||"M0 0"}function B(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function I(t,i,e,n){return"touchstart"===i?O(t,e,n):"touchmove"===i?W(t,e,n):"touchend"===i&&H(t,e,n),this}function A(t,i,e){var n=t["_leaflet_"+i+e];return"touchstart"===i?t.removeEventListener(le,n,!1):"touchmove"===i?t.removeEventListener(ce,n,!1):"touchend"===i&&(t.removeEventListener(_e,n,!1),t.removeEventListener(de,n,!1)),this}function O(t,i,n){var o=e(function(t){if("mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(pe.indexOf(t.target.tagName)<0))return;$(t)}j(t,i)});t["_leaflet_touchstart"+n]=o,t.addEventListener(le,o,!1),fe||(document.documentElement.addEventListener(le,R,!0),document.documentElement.addEventListener(ce,D,!0),document.documentElement.addEventListener(_e,N,!0),document.documentElement.addEventListener(de,N,!0),fe=!0)}function R(t){me[t.pointerId]=t,ge++}function D(t){me[t.pointerId]&&(me[t.pointerId]=t)}function N(t){delete me[t.pointerId],ge--}function j(t,i){t.touches=[];for(var e in me)t.touches.push(me[e]);t.changedTouches=[t],i(t)}function W(t,i,e){var n=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&j(t,i)};t["_leaflet_touchmove"+e]=n,t.addEventListener(ce,n,!1)}function H(t,i,e){var n=function(t){j(t,i)};t["_leaflet_touchend"+e]=n,t.addEventListener(_e,n,!1),t.addEventListener(de,n,!1)}function F(t,i,e){function n(t){var i;if(ie){if(!Oi||"mouse"===t.pointerType)return;i=ge}else i=t.touches.length;if(!(i>1)){var e=Date.now(),n=e-(s||e);r=t.touches?t.touches[0]:t,a=n>0&&n<=h,s=e}}function o(t){if(a&&!r.cancelBubble){if(ie){if(!Oi||"mouse"===t.pointerType)return;var e,n,o={};for(n in r)e=r[n],o[n]=e&&e.bind?e.bind(r):e;r=o}r.type="dblclick",i(r),s=null}}var s,r,a=!1,h=250;return t[xe+ve+e]=n,t[xe+ye+e]=o,t[xe+"dblclick"+e]=i,t.addEventListener(ve,n,!1),t.addEventListener(ye,o,!1),t.addEventListener("dblclick",i,!1),this}function U(t,i){var e=t[xe+ve+i],n=t[xe+ye+i],o=t[xe+"dblclick"+i];return t.removeEventListener(ve,e,!1),t.removeEventListener(ye,n,!1),Oi||t.removeEventListener("dblclick",o,!1),this}function V(t,i,e,n){if("object"===(void 0===i?"undefined":_typeof(i)))for(var o in i)q(t,o,i[o],e);else for(var s=0,r=(i=u(i)).length;s<r;s++)q(t,i[s],e,n);return this}function G(t,i,e,n){if("object"===(void 0===i?"undefined":_typeof(i)))for(var o in i)K(t,o,i[o],e);else if(i)for(var s=0,r=(i=u(i)).length;s<r;s++)K(t,i[s],e,n);else{for(var a in t[we])K(t,a,t[we][a]);delete t[we]}return this}function q(t,i,e,o){var s=i+n(e)+(o?"_"+n(o):"");if(t[we]&&t[we][s])return this;var r=function(i){return e.call(o||t,i||window.event)},a=r;ie&&0===i.indexOf("touch")?I(t,i,r,s):!ee||"dblclick"!==i||!F||ie&&Wi?"addEventListener"in t?"mousewheel"===i?t.addEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):"mouseenter"===i||"mouseleave"===i?(r=function(i){i=i||window.event,ot(t,i)&&a(i)},t.addEventListener("mouseenter"===i?"mouseover":"mouseout",r,!1)):("click"===i&&Di&&(r=function(t){st(t,a)}),t.addEventListener(i,r,!1)):"attachEvent"in t&&t.attachEvent("on"+i,r):F(t,r,s),t[we]=t[we]||{},t[we][s]=r}function K(t,i,e,o){var s=i+n(e)+(o?"_"+n(o):""),r=t[we]&&t[we][s];if(!r)return this;ie&&0===i.indexOf("touch")?A(t,i,s):ee&&"dblclick"===i&&U?U(t,s):"removeEventListener"in t?"mousewheel"===i?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===i?"mouseover":"mouseleave"===i?"mouseout":i,r,!1):"detachEvent"in t&&t.detachEvent("on"+i,r),t[we][s]=null}function Y(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,nt(t),this}function X(t){return q(t,"mousewheel",Y),this}function J(t){return V(t,"mousedown touchstart dblclick",Y),q(t,"click",et),this}function $(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Q(t){return $(t),Y(t),this}function tt(t,i){if(!i)return new x(t.clientX,t.clientY);var e=i.getBoundingClientRect();return new x(t.clientX-e.left-i.clientLeft,t.clientY-e.top-i.clientTop)}function it(t){return Oi?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Le:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function et(t){be[t.type]=!0}function nt(t){var i=be[t.type];return be[t.type]=!1,i}function ot(t,i){var e=i.relatedTarget;if(!e)return!0;try{for(;e&&e!==t;)e=e.parentNode}catch(t){return!1}return e!==t}function st(t,i){var e=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=Mi&&e-Mi;n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?Q(t):(Mi=e,i(t))}function rt(t){return"string"==typeof t?document.getElementById(t):t}function at(t,i){var e=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!e||"auto"===e)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);e=n?n[i]:null}return"auto"===e?null:e}function ht(t,i,e){var n=document.createElement(t);return n.className=i||"",e&&e.appendChild(n),n}function ut(t){var i=t.parentNode;i&&i.removeChild(t)}function lt(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ct(t){var i=t.parentNode;i.lastChild!==t&&i.appendChild(t)}function _t(t){var i=t.parentNode;i.firstChild!==t&&i.insertBefore(t,i.firstChild)}function dt(t,i){if(void 0!==t.classList)return t.classList.contains(i);var e=gt(t);return e.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(e)}function pt(t,i){if(void 0!==t.classList)for(var e=u(i),n=0,o=e.length;n<o;n++)t.classList.add(e[n]);else if(!dt(t,i)){var s=gt(t);ft(t,(s?s+" ":"")+i)}}function mt(t,i){void 0!==t.classList?t.classList.remove(i):ft(t,h((" "+gt(t)+" ").replace(" "+i+" "," ")))}function ft(t,i){void 0===t.className.baseVal?t.className=i:t.className.baseVal=i}function gt(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function vt(t,i){"opacity"in t.style?t.style.opacity=i:"filter"in t.style&&yt(t,i)}function yt(t,i){var e=!1,n="DXImageTransform.Microsoft.Alpha";try{e=t.filters.item(n)}catch(t){if(1===i)return}i=Math.round(100*i),e?(e.Enabled=100!==i,e.Opacity=i):t.style.filter+=" progid:"+n+"(opacity="+i+")"}function xt(t){for(var i=document.documentElement.style,e=0;e<t.length;e++)if(t[e]in i)return t[e];return!1}function wt(t,i,e){var n=i||new x(0,0);t.style[Te]=(qi?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(e?" scale("+e+")":"")}function Lt(t,i){t._leaflet_pos=i,Xi?wt(t,i):(t.style.left=i.x+"px",t.style.top=i.y+"px")}function bt(t){return t._leaflet_pos||new x(0,0)}function Pt(){V(window,"dragstart",$)}function Tt(){G(window,"dragstart",$)}function zt(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Mt(),Ze=t,Se=t.style.outline,t.style.outline="none",V(window,"keydown",Mt))}function Mt(){Ze&&(Ze.style.outline=Se,Ze=void 0,Se=void 0,G(window,"keydown",Mt))}function Ct(t,i){return new Be(t,i)}function Zt(t,i){if(!i||!t.length)return t.slice();var e=i*i;return t=It(t,e),t=kt(t,e)}function St(t,i,e){return Math.sqrt(Nt(t,i,e,!0))}function Et(t,i,e){return Nt(t,i,e)}function kt(t,i){var e=t.length,n=new(("undefined"==typeof Uint8Array?"undefined":_typeof(Uint8Array))!==void 0+""?Uint8Array:Array)(e);n[0]=n[e-1]=1,Bt(t,n,i,0,e-1);var o,s=[];for(o=0;o<e;o++)n[o]&&s.push(t[o]);return s}function Bt(t,i,e,n,o){var s,r,a,h=0;for(r=n+1;r<=o-1;r++)(a=Nt(t[r],t[n],t[o],!0))>h&&(s=r,h=a);h>e&&(i[s]=1,Bt(t,i,e,n,s),Bt(t,i,e,s,o))}function It(t,i){for(var e=[t[0]],n=1,o=0,s=t.length;n<s;n++)Dt(t[n],t[o])>i&&(e.push(t[n]),o=n);return o<s-1&&e.push(t[s-1]),e}function At(t,i,e,n,o){var s,r,a,h=n?Ue:Rt(t,e),u=Rt(i,e);for(Ue=u;;){if(!(h|u))return[t,i];if(h&u)return!1;a=Rt(r=Ot(t,i,s=h||u,e,o),e),s===h?(t=r,h=a):(i=r,u=a)}}function Ot(t,i,e,n,o){var s,r,a=i.x-t.x,h=i.y-t.y,u=n.min,l=n.max;return 8&e?(s=t.x+a*(l.y-t.y)/h,r=l.y):4&e?(s=t.x+a*(u.y-t.y)/h,r=u.y):2&e?(s=l.x,r=t.y+h*(l.x-t.x)/a):1&e&&(s=u.x,r=t.y+h*(u.x-t.x)/a),new x(s,r,o)}function Rt(t,i){var e=0;return t.x<i.min.x?e|=1:t.x>i.max.x&&(e|=2),t.y<i.min.y?e|=4:t.y>i.max.y&&(e|=8),e}function Dt(t,i){var e=i.x-t.x,n=i.y-t.y;return e*e+n*n}function Nt(t,i,e,n){var o,s=i.x,r=i.y,a=e.x-s,h=e.y-r,u=a*a+h*h;return u>0&&((o=((t.x-s)*a+(t.y-r)*h)/u)>1?(s=e.x,r=e.y):o>0&&(s+=a*o,r+=h*o)),a=t.x-s,h=t.y-r,n?a*a+h*h:new x(s,r)}function jt(t){return!fi(t[0])||"object"!==_typeof(t[0][0])&&void 0!==t[0][0]}function Wt(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jt(t)}function Ht(t,i,e){var n,o,s,r,a,h,u,l,c,_=[1,4,2,8];for(o=0,u=t.length;o<u;o++)t[o]._code=Rt(t[o],i);for(r=0;r<4;r++){for(l=_[r],n=[],o=0,s=(u=t.length)-1;o<u;s=o++)a=t[o],h=t[s],a._code&l?h._code&l||((c=Ot(h,a,l,i,e))._code=Rt(c,i),n.push(c)):(h._code&l&&((c=Ot(h,a,l,i,e))._code=Rt(c,i),n.push(c)),n.push(a));t=n}return t}function Ft(t){return new cn(t)}function Ut(t,i){return new pn(t,i)}function Vt(t,i){return new fn(t,i)}function Gt(t,i,e){return new gn(t,i,e)}function qt(t,i){return new vn(t,i)}function Kt(t,i){return new yn(t,i)}function Yt(t,i){var e,n,o,s,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],u=i&&i.pointToLayer,l=i&&i.coordsToLatLng||Xt;if(!a&&!r)return null;switch(r.type){case"Point":return e=l(a),u?u(t,e):new pn(e);case"MultiPoint":for(o=0,s=a.length;o<s;o++)e=l(a[o]),h.push(u?u(t,e):new pn(e));return new un(h);case"LineString":case"MultiLineString":return n=Jt(a,"LineString"===r.type?0:1,l),new vn(n,i);case"Polygon":case"MultiPolygon":return n=Jt(a,"Polygon"===r.type?1:2,l),new yn(n,i);case"GeometryCollection":for(o=0,s=r.geometries.length;o<s;o++){var c=Yt({geometry:r.geometries[o],type:"Feature",properties:t.properties},i);c&&h.push(c)}return new un(h);default:throw new Error("Invalid GeoJSON object.")}}function Xt(t){return new M(t[1],t[0],t[2])}function Jt(t,i,e){for(var n,o=[],s=0,r=t.length;s<r;s++)n=i?Jt(t[s],i-1,e):(e||Xt)(t[s]),o.push(n);return o}function $t(t,i){return i="number"==typeof i?i:6,void 0!==t.alt?[a(t.lng,i),a(t.lat,i),a(t.alt,i)]:[a(t.lng,i),a(t.lat,i)]}function Qt(t,i,e,n){for(var o=[],s=0,r=t.length;s<r;s++)o.push(i?Qt(t[s],i-1,e,n):$t(t[s],n));return!i&&e&&o.push(o[0]),o}function ti(t,e){return t.feature?i({},t.feature,{geometry:e}):ii(e)}function ii(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function ei(t,i){return new xn(t,i)}function ni(t,i,e){return new Tn(t,i,e)}function oi(t){return new En(t)}function si(t){return new kn(t)}function ri(t,i){return new Bn(t,i)}function ai(t,i){return new In(t,i)}function hi(t){return re?new On(t):null}function ui(t){return ae||he?new jn(t):null}function li(t,i){return new Wn(t,i)}function ci(){return window.L=Yn,this}var _i=Object.freeze;Object.freeze=function(t){return t};var di=Object.create||function(){function t(){}return function(i){return t.prototype=i,new t}}(),pi=0,mi=/\{ *([\w_\-]+) *\}/g,fi=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},gi="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",vi=0,yi=window.requestAnimationFrame||p("RequestAnimationFrame")||m,xi=window.cancelAnimationFrame||p("CancelAnimationFrame")||p("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},wi=(Object.freeze||Object)({freeze:_i,extend:i,create:di,bind:e,lastId:pi,stamp:n,throttle:o,wrapNum:s,falseFn:r,formatNum:a,trim:h,splitWords:u,setOptions:l,getParamString:c,template:_,isArray:fi,indexOf:d,emptyImageUrl:gi,requestFn:yi,cancelFn:xi,requestAnimFrame:f,cancelAnimFrame:g});v.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=e.__super__=this.prototype,o=di(n);o.constructor=e,e.prototype=o;for(var s in this)this.hasOwnProperty(s)&&"prototype"!==s&&"__super__"!==s&&(e[s]=this[s]);return t.statics&&(i(e,t.statics),delete t.statics),t.includes&&(y(t.includes),i.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=i(di(o.options),t.options)),i(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,i=o._initHooks.length;t<i;t++)o._initHooks[t].call(this)}},e},v.include=function(t){return i(this.prototype,t),this},v.mergeOptions=function(t){return i(this.prototype.options,t),this},v.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),e="function"==typeof t?t:function(){this[t].apply(this,i)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(e),this};var Li={on:function(t,i,e){if("object"===(void 0===t?"undefined":_typeof(t)))for(var n in t)this._on(n,t[n],i);else for(var o=0,s=(t=u(t)).length;o<s;o++)this._on(t[o],i,e);return this},off:function(t,i,e){if(t)if("object"===(void 0===t?"undefined":_typeof(t)))for(var n in t)this._off(n,t[n],i);else for(var o=0,s=(t=u(t)).length;o<s;o++)this._off(t[o],i,e);else delete this._events;return this},_on:function(t,i,e){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),e===this&&(e=void 0);for(var o={fn:i,ctx:e},s=n,r=0,a=s.length;r<a;r++)if(s[r].fn===i&&s[r].ctx===e)return;s.push(o)},_off:function(t,i,e){var n,o,s;if(this._events&&(n=this._events[t]))if(i){if(e===this&&(e=void 0),n)for(o=0,s=n.length;o<s;o++){var a=n[o];if(a.ctx===e&&a.fn===i)return a.fn=r,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(o,1)}}else{for(o=0,s=n.length;o<s;o++)n[o].fn=r;delete this._events[t]}},fire:function(t,e,n){if(!this.listens(t,n))return this;var o=i({},e,{type:t,target:this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var h=s[r];h.fn.call(h.ctx||this,o)}this._firingCount--}}return n&&this._propagateEvent(o),this},listens:function(t,i){var e=this._events&&this._events[t];if(e&&e.length)return!0;if(i)for(var n in this._eventParents)if(this._eventParents[n].listens(t,i))return!0;return!1},once:function(t,i,n){if("object"===(void 0===t?"undefined":_typeof(t))){for(var o in t)this.once(o,t[o],i);return this}var s=e(function(){this.off(t,i,n).off(t,s,n)},this);return this.on(t,i,n).on(t,s,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[n(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[n(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,i({layer:t.target},t),!0)}};Li.addEventListener=Li.on,Li.removeEventListener=Li.clearAllEventListeners=Li.off,Li.addOneTimeEventListener=Li.once,Li.fireEvent=Li.fire,Li.hasEventListeners=Li.listens;var bi=v.extend(Li);x.prototype={clone:function(){return new x(this.x,this.y)},add:function(t){return this.clone()._add(w(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(w(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new x(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new x(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){var i=(t=w(t)).x-this.x,e=t.y-this.y;return Math.sqrt(i*i+e*e)},equals:function(t){return(t=w(t)).x===this.x&&t.y===this.y},contains:function(t){return t=w(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+a(this.x)+", "+a(this.y)+")"}},b.prototype={extend:function(t){return t=w(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new x((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new x(this.min.x,this.max.y)},getTopRight:function(){return new x(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var i,e;return t="number"==typeof t[0]||t instanceof x?w(t):P(t),t instanceof b?(i=t.min,e=t.max):i=e=t,i.x>=this.min.x&&e.x<=this.max.x&&i.y>=this.min.y&&e.y<=this.max.y},intersects:function(t){t=P(t);var i=this.min,e=this.max,n=t.min,o=t.max,s=o.x>=i.x&&n.x<=e.x,r=o.y>=i.y&&n.y<=e.y;return s&&r},overlaps:function(t){t=P(t);var i=this.min,e=this.max,n=t.min,o=t.max,s=o.x>i.x&&n.x<e.x,r=o.y>i.y&&n.y<e.y;return s&&r},isValid:function(){return!(!this.min||!this.max)}},T.prototype={extend:function(t){var i,e,n=this._southWest,o=this._northEast;if(t instanceof M)i=t,e=t;else{if(!(t instanceof T))return t?this.extend(C(t)||z(t)):this;if(i=t._southWest,e=t._northEast,!i||!e)return this}return n||o?(n.lat=Math.min(i.lat,n.lat),n.lng=Math.min(i.lng,n.lng),o.lat=Math.max(e.lat,o.lat),o.lng=Math.max(e.lng,o.lng)):(this._southWest=new M(i.lat,i.lng),this._northEast=new M(e.lat,e.lng)),this},pad:function(t){var i=this._southWest,e=this._northEast,n=Math.abs(i.lat-e.lat)*t,o=Math.abs(i.lng-e.lng)*t;return new T(new M(i.lat-n,i.lng-o),new M(e.lat+n,e.lng+o))},getCenter:function(){return new M((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new M(this.getNorth(),this.getWest())},getSouthEast:function(){return new M(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof M||"lat"in t?C(t):z(t);var i,e,n=this._southWest,o=this._northEast;return t instanceof T?(i=t.getSouthWest(),e=t.getNorthEast()):i=e=t,i.lat>=n.lat&&e.lat<=o.lat&&i.lng>=n.lng&&e.lng<=o.lng},intersects:function(t){t=z(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=i.lat&&n.lat<=e.lat,r=o.lng>=i.lng&&n.lng<=e.lng;return s&&r},overlaps:function(t){t=z(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>i.lat&&n.lat<e.lat,r=o.lng>i.lng&&n.lng<e.lng;return s&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,i){return!!t&&(t=z(t),this._southWest.equals(t.getSouthWest(),i)&&this._northEast.equals(t.getNorthEast(),i))},isValid:function(){return!(!this._southWest||!this._northEast)}},M.prototype={equals:function(t,i){return!!t&&(t=C(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===i?1e-9:i))},toString:function(t){return"LatLng("+a(this.lat,t)+", "+a(this.lng,t)+")"},distanceTo:function(t){return Ti.distance(this,C(t))},wrap:function(){return Ti.wrapLatLng(this)},toBounds:function(t){var i=180*t/40075017,e=i/Math.cos(Math.PI/180*this.lat);return z([this.lat-i,this.lng-e],[this.lat+i,this.lng+e])},clone:function(){return new M(this.lat,this.lng,this.alt)}};var Pi={latLngToPoint:function(t,i){var e=this.projection.project(t),n=this.scale(i);return this.transformation._transform(e,n)},pointToLatLng:function(t,i){var e=this.scale(i),n=this.transformation.untransform(t,e);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var i=this.projection.bounds,e=this.scale(t);return new b(this.transformation.transform(i.min,e),this.transformation.transform(i.max,e))},infinite:!1,wrapLatLng:function(t){var i=this.wrapLng?s(t.lng,this.wrapLng,!0):t.lng;return new M(this.wrapLat?s(t.lat,this.wrapLat,!0):t.lat,i,t.alt)},wrapLatLngBounds:function(t){var i=t.getCenter(),e=this.wrapLatLng(i),n=i.lat-e.lat,o=i.lng-e.lng;if(0===n&&0===o)return t;var s=t.getSouthWest(),r=t.getNorthEast();return new T(new M(s.lat-n,s.lng-o),new M(r.lat-n,r.lng-o))}},Ti=i({},Pi,{wrapLng:[-180,180],R:6371e3,distance:function(t,i){var e=Math.PI/180,n=t.lat*e,o=i.lat*e,s=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((i.lng-t.lng)*e);return this.R*Math.acos(Math.min(s,1))}}),zi={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var i=Math.PI/180,e=this.MAX_LATITUDE,n=Math.max(Math.min(e,t.lat),-e),o=Math.sin(n*i);return new x(this.R*t.lng*i,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var i=180/Math.PI;return new M((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*i,t.x*i/this.R)},bounds:function(){var t=6378137*Math.PI;return new b([-t,-t],[t,t])}()};Z.prototype={transform:function(t,i){return this._transform(t.clone(),i)},_transform:function(t,i){return i=i||1,t.x=i*(this._a*t.x+this._b),t.y=i*(this._c*t.y+this._d),t},untransform:function(t,i){return i=i||1,new x((t.x/i-this._b)/this._a,(t.y/i-this._d)/this._c)}};var Mi,Ci,Zi,Si,Ei=i({},Ti,{code:"EPSG:3857",projection:zi,transformation:function(){var t=.5/(Math.PI*zi.R);return S(t,.5,-t,.5)}()}),ki=i({},Ei,{code:"EPSG:900913"}),Bi=document.documentElement.style,Ii="ActiveXObject"in window,Ai=Ii&&!document.addEventListener,Oi="msLaunchUri"in navigator&&!("documentMode"in document),Ri=B("webkit"),Di=B("android"),Ni=B("android 2")||B("android 3"),ji=!!window.opera,Wi=B("chrome"),Hi=B("gecko")&&!Ri&&!ji&&!Ii,Fi=!Wi&&B("safari"),Ui=B("phantom"),Vi="OTransition"in Bi,Gi=0===navigator.platform.indexOf("Win"),qi=Ii&&"transition"in Bi,Ki="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ni,Yi="MozPerspective"in Bi,Xi=!window.L_DISABLE_3D&&(qi||Ki||Yi)&&!Vi&&!Ui,Ji="undefined"!=typeof orientation||B("mobile"),$i=Ji&&Ri,Qi=Ji&&Ki,te=!window.PointerEvent&&window.MSPointerEvent,ie=!(!window.PointerEvent&&!te),ee=!window.L_NO_TOUCH&&(ie||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),ne=Ji&&ji,oe=Ji&&Hi,se=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,re=function(){return!!document.createElement("canvas").getContext}(),ae=!(!document.createElementNS||!E("svg").createSVGRect),he=!ae&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"===_typeof(i.adj)}catch(t){return!1}}(),ue=(Object.freeze||Object)({ie:Ii,ielt9:Ai,edge:Oi,webkit:Ri,android:Di,android23:Ni,opera:ji,chrome:Wi,gecko:Hi,safari:Fi,phantom:Ui,opera12:Vi,win:Gi,ie3d:qi,webkit3d:Ki,gecko3d:Yi,any3d:Xi,mobile:Ji,mobileWebkit:$i,mobileWebkit3d:Qi,msPointer:te,pointer:ie,touch:ee,mobileOpera:ne,mobileGecko:oe,retina:se,canvas:re,svg:ae,vml:he}),le=te?"MSPointerDown":"pointerdown",ce=te?"MSPointerMove":"pointermove",_e=te?"MSPointerUp":"pointerup",de=te?"MSPointerCancel":"pointercancel",pe=["INPUT","SELECT","OPTION"],me={},fe=!1,ge=0,ve=te?"MSPointerDown":ie?"pointerdown":"touchstart",ye=te?"MSPointerUp":ie?"pointerup":"touchend",xe="_leaflet_",we="_leaflet_events",Le=Gi&&Wi?2*window.devicePixelRatio:Hi?window.devicePixelRatio:1,be={},Pe=(Object.freeze||Object)({on:V,off:G,stopPropagation:Y,disableScrollPropagation:X,disableClickPropagation:J,preventDefault:$,stop:Q,getMousePosition:tt,getWheelDelta:it,fakeStop:et,skipped:nt,isExternalTarget:ot,addListener:V,removeListener:G}),Te=xt(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),ze=xt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Me="webkitTransition"===ze||"OTransition"===ze?ze+"End":"transitionend";if("onselectstart"in document)Ci=function(){V(window,"selectstart",$)},Zi=function(){G(window,"selectstart",$)};else{var Ce=xt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ci=function(){if(Ce){var t=document.documentElement.style;Si=t[Ce],t[Ce]="none"}},Zi=function(){Ce&&(document.documentElement.style[Ce]=Si,Si=void 0)}}var Ze,Se,Ee=(Object.freeze||Object)({TRANSFORM:Te,TRANSITION:ze,TRANSITION_END:Me,get:rt,getStyle:at,create:ht,remove:ut,empty:lt,toFront:ct,toBack:_t,hasClass:dt,addClass:pt,removeClass:mt,setClass:ft,getClass:gt,setOpacity:vt,testProp:xt,setTransform:wt,setPosition:Lt,getPosition:bt,disableTextSelection:Ci,enableTextSelection:Zi,disableImageDrag:Pt,enableImageDrag:Tt,preventOutline:zt,restoreOutline:Mt}),ke=bi.extend({run:function(t,i,e,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=e||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=bt(t),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=f(this._animate,this),this._step()},_step:function(t){var i=+new Date-this._startTime,e=1e3*this._duration;i<e?this._runFrame(this._easeOut(i/e),t):(this._runFrame(1),this._complete())},_runFrame:function(t,i){var e=this._startPos.add(this._offset.multiplyBy(t));i&&e._round(),Lt(this._el,e),this.fire("step")},_complete:function(){g(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Be=bi.extend({options:{crs:Ei,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,i){i=l(this,i),this._initContainer(t),this._initLayout(),this._onResize=e(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),void 0!==i.zoom&&(this._zoom=this._limitZoom(i.zoom)),i.center&&void 0!==i.zoom&&this.setView(C(i.center),i.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=ze&&Xi&&!ne&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),V(this._proxy,Me,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(C(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=i({animate:n.animate},n.zoom),n.pan=i({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,i){return this._loaded?this.setView(this.getCenter(),t,{zoom:i}):(this._zoom=t,this)},zoomIn:function(t,i){return t=t||(Xi?this.options.zoomDelta:1),this.setZoom(this._zoom+t,i)},zoomOut:function(t,i){return t=t||(Xi?this.options.zoomDelta:1),this.setZoom(this._zoom-t,i)},setZoomAround:function(t,i,e){var n=this.getZoomScale(i),o=this.getSize().divideBy(2),s=(t instanceof x?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),r=this.containerPointToLatLng(o.add(s));return this.setView(r,i,{zoom:e})},_getBoundsCenterZoom:function(t,i){i=i||{},t=t.getBounds?t.getBounds():z(t);var e=w(i.paddingTopLeft||i.padding||[0,0]),n=w(i.paddingBottomRight||i.padding||[0,0]),o=this.getBoundsZoom(t,!1,e.add(n));if((o="number"==typeof i.maxZoom?Math.min(i.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var s=n.subtract(e).divideBy(2),r=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(r.add(a).divideBy(2).add(s),o),zoom:o}},fitBounds:function(t,i){if(!(t=z(t)).isValid())throw new Error("Bounds are not valid.");var e=this._getBoundsCenterZoom(t,i);return this.setView(e.center,e.zoom,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(t,i){if(t=w(t).round(),i=i||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==i.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ke,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire("movestart"),!1!==i.animate){pt(this._mapPane,"leaflet-pan-anim");var e=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,e,i.duration||.25,i.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,i,e){function n(t){var i=(g*g-m*m+(t?-1:1)*x*x*v*v)/(2*(t?g:m)*x*v),e=Math.sqrt(i*i+1)-i;return e<1e-9?-18:Math.log(e)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function s(t){return(Math.exp(t)+Math.exp(-t))/2}function r(t){return o(t)/s(t)}function a(t){return m*(s(w)/s(w+y*t))}function h(t){return m*(s(w)*r(w+y*t)-o(w))/x}function u(t){return 1-Math.pow(1-t,1.5)}function l(){var e=(Date.now()-L)/P,n=u(e)*b;e<=1?(this._flyToFrame=f(l,this),this._move(this.unproject(c.add(_.subtract(c).multiplyBy(h(n)/v)),p),this.getScaleZoom(m/a(n),p),{flyTo:!0})):this._move(t,i)._moveEnd(!0)}if(!1===(e=e||{}).animate||!Xi)return this.setView(t,i,e);this._stop();var c=this.project(this.getCenter()),_=this.project(t),d=this.getSize(),p=this._zoom;t=C(t),i=void 0===i?p:i;var m=Math.max(d.x,d.y),g=m*this.getZoomScale(p,i),v=_.distanceTo(c)||1,y=1.42,x=y*y,w=n(0),L=Date.now(),b=(n(1)-w)/y,P=e.duration?1e3*e.duration:1e3*b*.8;return this._moveStart(!0),l.call(this),this},flyToBounds:function(t,i){var e=this._getBoundsCenterZoom(t,i);return this.flyTo(e.center,e.zoom,i)},setMaxBounds:function(t){return(t=z(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,i){this._enforcingBounds=!0;var e=this.getCenter(),n=this._limitCenter(e,this._zoom,z(t));return e.equals(n)||this.panTo(n,i),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=i({animate:!1,pan:!0},!0===t?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),s=n.divideBy(2).round(),r=o.divideBy(2).round(),a=s.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(e(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=i({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=e(this._handleGeolocationResponse,this),o=e(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,o,t):navigator.geolocation.getCurrentPosition(n,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var i=t.code,e=t.message||(1===i?"permission denied":2===i?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:i,message:"Geolocation error: "+e+"."})},_handleGeolocationResponse:function(t){var i=new M(t.coords.latitude,t.coords.longitude),e=i.toBounds(t.coords.accuracy),n=this._locateOptions;if(n.setView){var o=this.getBoundsZoom(e);this.setView(i,n.maxZoom?Math.min(o,n.maxZoom):o)}var s={latlng:i,bounds:e,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(s[r]=t.coords[r]);this.fire("locationfound",s)},addHandler:function(t,i){if(!i)return this;var e=this[t]=new i(this);return this._handlers.push(e),this.options[t]&&e.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}ut(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ut(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,i){var e=ht("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),i||this._mapPane);return t&&(this._panes[t]=e),e},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new T(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,i,e){t=z(t),e=w(e||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),s=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(e),u=P(this.project(a,n),this.project(r,n)).getSize(),l=Xi?this.options.zoomSnap:1,c=h.x/u.x,_=h.y/u.y,d=i?Math.max(c,_):Math.min(c,_);return n=this.getScaleZoom(d,n),l&&(n=Math.round(n/(l/100))*(l/100),n=i?Math.ceil(n/l)*l:Math.floor(n/l)*l),Math.max(o,Math.min(s,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new x(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,i){var e=this._getTopLeftPoint(t,i);return new b(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,i){var e=this.options.crs;return i=void 0===i?this._zoom:i,e.scale(t)/e.scale(i)},getScaleZoom:function(t,i){var e=this.options.crs;i=void 0===i?this._zoom:i;var n=e.zoom(t*e.scale(i));return isNaN(n)?1/0:n},project:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.latLngToPoint(C(t),i)},unproject:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.pointToLatLng(w(t),i)},layerPointToLatLng:function(t){var i=w(t).add(this.getPixelOrigin());return this.unproject(i)},latLngToLayerPoint:function(t){return this.project(C(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(C(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(z(t))},distance:function(t,i){return this.options.crs.distance(C(t),C(i))},containerPointToLayerPoint:function(t){return w(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return w(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var i=this.containerPointToLayerPoint(w(t));return this.layerPointToLatLng(i)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(C(t)))},mouseEventToContainerPoint:function(t){return tt(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var i=this._container=rt(t);if(!i)throw new Error("Map container not found.");if(i._leaflet_id)throw new Error("Map container is already initialized.");V(i,"scroll",this._onScroll,this),this._containerId=n(i)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Xi,pt(t,"leaflet-container"+(ee?" leaflet-touch":"")+(se?" leaflet-retina":"")+(Ai?" leaflet-oldie":"")+(Fi?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var i=at(t,"position");"absolute"!==i&&"relative"!==i&&"fixed"!==i&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Lt(this._mapPane,new x(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(t.markerPane,"leaflet-zoom-hide"),pt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,i){Lt(this._mapPane,new x(0,0));var e=!this._loaded;this._loaded=!0,i=this._limitZoom(i),this.fire("viewprereset");var n=this._zoom!==i;this._moveStart(n)._move(t,i)._moveEnd(n),this.fire("viewreset"),e&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,i,e){void 0===i&&(i=this._zoom);var n=this._zoom!==i;return this._zoom=i,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||e&&e.pinch)&&this.fire("zoom",e),this.fire("move",e)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return g(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Lt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[n(this._container)]=this;var i=t?G:V;i(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&i(window,"resize",this._onResize,this),Xi&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){g(this._resizeRequest),this._resizeRequest=f(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,i){for(var e,o=[],s="mouseout"===i||"mouseover"===i,r=t.target||t.srcElement,a=!1;r;){if((e=this._targets[n(r)])&&("click"===i||"preclick"===i)&&!t._simulated&&this._draggableMoved(e)){a=!0;break}if(e&&e.listens(i,!0)){if(s&&!ot(r,t))break;if(o.push(e),s)break}if(r===this._container)break;r=r.parentNode}return o.length||a||s||!ot(r,t)||(o=[this]),o},_handleDOMEvent:function(t){if(this._loaded&&!nt(t)){var i=t.type;"mousedown"!==i&&"keypress"!==i||zt(t.target||t.srcElement),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if("click"===t.type){var o=i({},t);o.type="preclick",this._fireDOMEvent(o,o.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,e))).length){var s=n[0];"contextmenu"===e&&s.listens(e,!0)&&$(t);var r={originalEvent:t};if("keypress"!==t.type){var a=s.options&&"icon"in s.options;r.containerPoint=a?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?s.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<n.length;h++)if(n[h].fire(e,r,!0),r.originalEvent._stopped||!1===n[h].options.bubblingMouseEvents&&-1!==d(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,i=this._handlers.length;t<i;t++)this._handlers[t].disable()},whenReady:function(t,i){return this._loaded?t.call(i||this,{target:this}):this.on("load",t,i),this},_getMapPanePos:function(){return bt(this._mapPane)||new x(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,i){return(t&&void 0!==i?this._getNewPixelOrigin(t,i):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,i,e){var n=this._getNewPixelOrigin(e,i);return this.project(t,i)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,i,e){var n=this._getNewPixelOrigin(e,i);return P([this.project(t.getSouthWest(),i)._subtract(n),this.project(t.getNorthWest(),i)._subtract(n),this.project(t.getSouthEast(),i)._subtract(n),this.project(t.getNorthEast(),i)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,i,e){if(!e)return t;var n=this.project(t,i),o=this.getSize().divideBy(2),s=new b(n.subtract(o),n.add(o)),r=this._getBoundsOffset(s,e,i);return r.round().equals([0,0])?t:this.unproject(n.add(r),i)},_limitOffset:function(t,i){if(!i)return t;var e=this.getPixelBounds(),n=new b(e.min.add(t),e.max.add(t));return t.add(this._getBoundsOffset(n,i))},_getBoundsOffset:function(t,i,e){var n=P(this.project(i.getNorthEast(),e),this.project(i.getSouthWest(),e)),o=n.min.subtract(t.min),s=n.max.subtract(t.max);return new x(this._rebound(o.x,-s.x),this._rebound(o.y,-s.y))},_rebound:function(t,i){return t+i>0?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom(),n=Xi?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(i,Math.min(e,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,i){var e=this._getCenterOffset(t)._floor();return!(!0!==(i&&i.animate)&&!this.getSize().contains(e))&&(this.panBy(e,i),!0)},_createAnimProxy:function(){var t=this._proxy=ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var i=Te,e=this._proxy.style[i];wt(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),e===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),i=this.getZoom();wt(this._proxy,this.project(t,i),this.getZoomScale(i,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ut(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,i,e){if(this._animatingZoom)return!0;if(e=e||{},!this._zoomAnimated||!1===e.animate||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(i),o=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==e.animate&&!this.getSize().contains(o))&&(f(function(){this._moveStart(!0)._animateZoom(t,i,!0)},this),!0)},_animateZoom:function(t,i,n,o){n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=i,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:i,noUpdate:o}),setTimeout(e(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),f(function(){this._moveEnd(!0)},this))}}),Ie=v.extend({options:{position:"topright"},initialize:function(t){l(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var i=this._map;return i&&i.removeControl(this),this.options.position=t,i&&i.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var i=this._container=this.onAdd(t),e=this.getPosition(),n=t._controlCorners[e];return pt(i,"leaflet-control"),-1!==e.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this},remove:function(){return this._map?(ut(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ae=function(t){return new Ie(t)};Be.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,o){var s=e+t+" "+e+o;i[t+o]=ht("div",s,n)}var i=this._controlCorners={},e="leaflet-",n=this._controlContainer=ht("div",e+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ut(this._controlCorners[t]);ut(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oe=Ie.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,i,e,n){return e<n?-1:n<e?1:0}},initialize:function(t,i,e){l(this,e),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in i)this._addLayer(i[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ie.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,i){return this._addLayer(t,i),this._map?this._update():this},addOverlay:function(t,i){return this._addLayer(t,i,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var i=this._getLayer(n(t));return i&&this._layers.splice(this._layers.indexOf(i),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(pt(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):mt(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",i=this._container=ht("div",t),e=this.options.collapsed;i.setAttribute("aria-haspopup",!0),J(i),X(i);var n=this._form=ht("form",t+"-list");e&&(this._map.on("click",this.collapse,this),Di||V(i,{mouseenter:this.expand,mouseleave:this.collapse},this));var o=this._layersLink=ht("a",t+"-toggle",i);o.href="#",o.title="Layers",ee?(V(o,"click",Q),V(o,"click",this.expand,this)):V(o,"focus",this.expand,this),e||this.expand(),this._baseLayersList=ht("div",t+"-base",n),this._separator=ht("div",t+"-separator",n),this._overlaysList=ht("div",t+"-overlays",n),i.appendChild(n)},_getLayer:function(t){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&n(this._layers[i].layer)===t)return this._layers[i]},_addLayer:function(t,i,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:i,overlay:n}),this.options.sortLayers&&this._layers.sort(e(function(t,i){return this.options.sortFunction(t.layer,i.layer,t.name,i.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;lt(this._baseLayersList),lt(this._overlaysList),this._layerControlInputs=[];var t,i,e,n,o=0;for(e=0;e<this._layers.length;e++)n=this._layers[e],this._addItem(n),i=i||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=i&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var i=this._getLayer(n(t.target)),e=i.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;e&&this._map.fire(e,i)},_createRadioElement:function(t,i){var e='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=e,n.firstChild},_addItem:function(t){var i,e=document.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?((i=document.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=o):i=this._createRadioElement("leaflet-base-layers",o),this._layerControlInputs.push(i),i.layerId=n(t.layer),V(i,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+t.name;var r=document.createElement("div");return e.appendChild(r),r.appendChild(i),r.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){var t,i,e=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var s=e.length-1;s>=0;s--)t=e[s],i=this._getLayer(t.layerId).layer,t.checked?n.push(i):t.checked||o.push(i);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])&&this._map.removeLayer(o[s]);for(s=0;s<n.length;s++)this._map.hasLayer(n[s])||this._map.addLayer(n[s]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,i,e=this._layerControlInputs,n=this._map.getZoom(),o=e.length-1;o>=0;o--)t=e[o],i=this._getLayer(t.layerId).layer,t.disabled=void 0!==i.options.minZoom&&n<i.options.minZoom||void 0!==i.options.maxZoom&&n>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Re=function(t,i,e){return new Oe(t,i,e)},De=Ie.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var i="leaflet-control-zoom",e=ht("div",i+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,i+"-in",e,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,i+"-out",e,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),e},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,i,e,n,o){var s=ht("a",e,n);return s.innerHTML=t,s.href="#",s.title=i,s.setAttribute("role","button"),s.setAttribute("aria-label",i),J(s),V(s,"click",Q),V(s,"click",o,this),V(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var t=this._map,i="leaflet-disabled";mt(this._zoomInButton,i),mt(this._zoomOutButton,i),(this._disabled||t._zoom===t.getMinZoom())&&pt(this._zoomOutButton,i),(this._disabled||t._zoom===t.getMaxZoom())&&pt(this._zoomInButton,i)}});Be.mergeOptions({zoomControl:!0}),Be.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new De,this.addControl(this.zoomControl))});var Ne=function(t){return new De(t)},je=Ie.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var i=ht("div","leaflet-control-scale"),e=this.options;return this._addScales(e,"leaflet-control-scale-line",i),t.on(e.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,i,e){t.metric&&(this._mScale=ht("div",i,e)),t.imperial&&(this._iScale=ht("div",i,e))},_update:function(){var t=this._map,i=t.getSize().y/2,e=t.distance(t.containerPointToLatLng([0,i]),t.containerPointToLatLng([this.options.maxWidth,i]));this._updateScales(e)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var i=this._getRoundNum(t),e=i<1e3?i+" m":i/1e3+" km";this._updateScale(this._mScale,e,i/t)},_updateImperial:function(t){var i,e,n,o=3.2808399*t;o>5280?(i=o/5280,e=this._getRoundNum(i),this._updateScale(this._iScale,e+" mi",e/i)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,i,e){t.style.width=Math.round(this.options.maxWidth*e)+"px",t.innerHTML=i},_getRoundNum:function(t){var i=Math.pow(10,(Math.floor(t)+"").length-1),e=t/i;return e=e>=10?10:e>=5?5:e>=3?3:e>=2?2:1,i*e}}),We=function(t){return new je(t)},He=Ie.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){l(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=ht("div","leaflet-control-attribution"),J(this._container);for(var i in t._layers)t._layers[i].getAttribution&&this.addAttribution(t._layers[i].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var i in this._attributions)this._attributions[i]&&t.push(i);var e=[];this.options.prefix&&e.push(this.options.prefix),t.length&&e.push(t.join(", ")),this._container.innerHTML=e.join(" | ")}}});Be.mergeOptions({attributionControl:!0}),Be.addInitHook(function(){this.options.attributionControl&&(new He).addTo(this)});var Fe=function(t){return new He(t)};Ie.Layers=Oe,Ie.Zoom=De,Ie.Scale=je,Ie.Attribution=He,Ae.layers=Re,Ae.zoom=Ne,Ae.scale=We,Ae.attribution=Fe;var Ue,Ve=v.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),Ge={Events:Li},qe=ee?"touchstart mousedown":"mousedown",Ke={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ye={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Xe=bi.extend({options:{clickTolerance:3},initialize:function(t,i,e,n){l(this,n),this._element=t,this._dragStartTarget=i||t,this._preventOutline=e},enable:function(){this._enabled||(V(this._dragStartTarget,qe,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Xe._dragging===this&&this.finishDrag(),G(this._dragStartTarget,qe,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!dt(this._element,"leaflet-zoom-anim")&&!(Xe._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(Xe._dragging=this,this._preventOutline&&zt(this._element),Pt(),Ci(),this._moving)))){this.fire("down");var i=t.touches?t.touches[0]:t;this._startPoint=new x(i.clientX,i.clientY),V(document,Ye[t.type],this._onMove,this),V(document,Ke[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var i=t.touches&&1===t.touches.length?t.touches[0]:t,e=new x(i.clientX,i.clientY).subtract(this._startPoint);(e.x||e.y)&&(Math.abs(e.x)+Math.abs(e.y)<this.options.clickTolerance||($(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=bt(this._element).subtract(e),pt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(e),this._moving=!0,g(this._animRequest),this._lastEvent=t,this._animRequest=f(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Lt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){mt(document.body,"leaflet-dragging"),this._lastTarget&&(mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in Ye)G(document,Ye[t],this._onMove,this),G(document,Ke[t],this._onUp,this);Tt(),Zi(),this._moved&&this._moving&&(g(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Xe._dragging=!1}}),Je=(Object.freeze||Object)({simplify:Zt,pointToSegmentDistance:St,closestPointOnSegment:Et,clipSegment:At,_getEdgeIntersection:Ot,_getBitCode:Rt,_sqClosestPointOnSegment:Nt,isFlat:jt,_flat:Wt}),$e=(Object.freeze||Object)({clipPolygon:Ht}),Qe={project:function(t){return new x(t.lng,t.lat)},unproject:function(t){return new M(t.y,t.x)},bounds:new b([-180,-90],[180,90])},tn={R:6378137,R_MINOR:6356752.314245179,bounds:new b([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var i=Math.PI/180,e=this.R,n=t.lat*i,o=this.R_MINOR/e,s=Math.sqrt(1-o*o),r=s*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-r)/(1+r),s/2);return n=-e*Math.log(Math.max(a,1e-10)),new x(t.lng*i*e,n)},unproject:function(t){for(var i,e=180/Math.PI,n=this.R,o=this.R_MINOR/n,s=Math.sqrt(1-o*o),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),h=0,u=.1;h<15&&Math.abs(u)>1e-7;h++)i=s*Math.sin(a),i=Math.pow((1-i)/(1+i),s/2),a+=u=Math.PI/2-2*Math.atan(r*i)-a;return new M(a*e,t.x*e/n)}},en=(Object.freeze||Object)({LonLat:Qe,Mercator:tn,SphericalMercator:zi}),nn=i({},Ti,{code:"EPSG:3395",projection:tn,transformation:function(){var t=.5/(Math.PI*tn.R);return S(t,.5,-t,.5)}()}),on=i({},Ti,{code:"EPSG:4326",projection:Qe,transformation:S(1/180,1,-1/180,.5)}),sn=i({},Pi,{projection:Qe,transformation:S(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,i){var e=i.lng-t.lng,n=i.lat-t.lat;return Math.sqrt(e*e+n*n)},infinite:!0});Pi.Earth=Ti,Pi.EPSG3395=nn,Pi.EPSG3857=Ei,Pi.EPSG900913=ki,Pi.EPSG4326=on,Pi.Simple=sn;var rn=bi.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[n(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[n(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var i=t.target;if(i.hasLayer(this)){if(this._map=i,this._zoomAnimated=i._zoomAnimated,this.getEvents){var e=this.getEvents();i.on(e,this),this.once("remove",function(){i.off(e,this)},this)}this.onAdd(i),this.getAttribution&&i.attributionControl&&i.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),i.fire("layeradd",{layer:this})}}});Be.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var i=n(t);return this._layers[i]?this:(this._layers[i]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var i=n(t);return this._layers[i]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[i],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&n(t)in this._layers},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},_addLayers:function(t){for(var i=0,e=(t=t?fi(t)?t:[t]:[]).length;i<e;i++)this.addLayer(t[i])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[n(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var i=n(t);this._zoomBoundLayers[i]&&(delete this._zoomBoundLayers[i],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,i=-1/0,e=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),i=void 0===o.maxZoom?i:Math.max(i,o.maxZoom)}this._layersMaxZoom=i===-1/0?void 0:i,this._layersMinZoom=t===1/0?void 0:t,e!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var an=rn.extend({initialize:function(t){this._layers={};var i,e;if(t)for(i=0,e=t.length;i<e;i++)this.addLayer(t[i])},addLayer:function(t){var i=this.getLayerId(t);return this._layers[i]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var i=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[i]&&this._map.removeLayer(this._layers[i]),delete this._layers[i],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var i,e,n=Array.prototype.slice.call(arguments,1);for(i in this._layers)(e=this._layers[i])[t]&&e[t].apply(e,n);return this},onAdd:function(t){for(var i in this._layers)t.addLayer(this._layers[i])},onRemove:function(t){for(var i in this._layers)t.removeLayer(this._layers[i])},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var i in this._layers)t.push(this._layers[i]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return n(t)}}),hn=function(t){return new an(t)},un=an.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),an.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),an.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new T;for(var i in this._layers){var e=this._layers[i];t.extend(e.getBounds?e.getBounds():e.getLatLng())}return t}}),ln=function(t){return new un(t)},cn=v.extend({initialize:function(t){l(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,i){var e=this._getIconUrl(t);if(!e){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(e,i&&"IMG"===i.tagName?i:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,i){var e=this.options,n=e[i+"Size"];"number"==typeof n&&(n=[n,n]);var o=w(n),s=w("shadow"===i&&e.shadowAnchor||e.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+i+" "+(e.className||""),s&&(t.style.marginLeft=-s.x+"px",t.style.marginTop=-s.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,i){return i=i||document.createElement("img"),i.src=t,i},_getIconUrl:function(t){return se&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),_n=cn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return _n.imagePath||(_n.imagePath=this._detectIconPath()),(this.options.imagePath||_n.imagePath)+cn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ht("div","leaflet-default-icon-path",document.body),i=at(t,"background-image")||at(t,"backgroundImage");return document.body.removeChild(t),i=null===i||0!==i.indexOf("url")?"":i.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,"")}}),dn=Ve.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Xe(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var i=this._marker,e=i._shadow,n=bt(i._icon),o=i._map.layerPointToLatLng(n);e&&Lt(e,n),i._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,i.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),pn=rn.extend({options:{icon:new _n,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,i){l(this,i),this._latlng=C(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var i=this._latlng;return this._latlng=C(t),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),e=t.icon.createIcon(this._icon),n=!1;e!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(e.title=t.title),t.alt&&(e.alt=t.alt)),pt(e,i),t.keyboard&&(e.tabIndex="0"),this._icon=e,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),s=!1;o!==this._shadow&&(this._removeShadow(),s=!0),o&&(pt(o,i),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&s&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ut(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ut(this._shadow),this._shadow=null},_setPos:function(t){Lt(this._icon,t),this._shadow&&Lt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(i)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),dn)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new dn(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;vt(this._icon,t),this._shadow&&vt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),mn=rn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return l(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(ee?10:0)}}),fn=mn.extend({options:{fill:!0,radius:10},initialize:function(t,i){l(this,i),this._latlng=C(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=C(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var i=t&&t.radius||this._radius;return mn.prototype.setStyle.call(this,t),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,i=this._radiusY||t,e=this._clickTolerance(),n=[t+e,i+e];this._pxBounds=new b(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),gn=fn.extend({initialize:function(t,e,n){if("number"==typeof e&&(e=i({},n,{radius:e})),l(this,e),this._latlng=C(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new T(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:mn.prototype.setStyle,_project:function(){var t=this._latlng.lng,i=this._latlng.lat,e=this._map,n=e.options.crs;if(n.distance===Ti.distance){var o=Math.PI/180,s=this._mRadius/Ti.R/o,r=e.project([i+s,t]),a=e.project([i-s,t]),h=r.add(a).divideBy(2),u=e.unproject(h).lat,l=Math.acos((Math.cos(s*o)-Math.sin(i*o)*Math.sin(u*o))/(Math.cos(i*o)*Math.cos(u*o)))/o;(isNaN(l)||0===l)&&(l=s/Math.cos(Math.PI/180*i)),this._point=h.subtract(e.getPixelOrigin()),this._radius=isNaN(l)?0:Math.max(Math.round(h.x-e.project([u,t-l]).x),1),this._radiusY=Math.max(Math.round(h.y-r.y),1)}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=e.latLngToLayerPoint(this._latlng),this._radius=this._point.x-e.latLngToLayerPoint(c).x}this._updateBounds()}}),vn=mn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,i){l(this,i),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var i,e,n=1/0,o=null,s=Nt,r=0,a=this._parts.length;r<a;r++)for(var h=this._parts[r],u=1,l=h.length;u<l;u++){var c=s(t,i=h[u-1],e=h[u],!0);c<n&&(n=c,o=s(t,i,e))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,i=0;t<h-1;t++)i+=a[t].distanceTo(a[t+1])/2;if(0===i)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if(o=a[t],s=a[t+1],e=o.distanceTo(s),(n+=e)>i)return r=(n-i)/e,this._map.layerPointToLatLng([s.x-r*(s.x-o.x),s.y-r*(s.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,i){return i=i||this._defaultShape(),t=C(t),i.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new T,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return jt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var i=[],e=jt(t),n=0,o=t.length;n<o;n++)e?(i[n]=C(t[n]),this._bounds.extend(i[n])):i[n]=this._convertLatLngs(t[n]);return i},_project:function(){var t=new b;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var i=this._clickTolerance(),e=new x(i,i);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(e),t.max._add(e),this._pxBounds=t)},_projectLatlngs:function(t,i,e){var n,o,s=t[0]instanceof M,r=t.length;if(s){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),e.extend(o[n]);i.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var i,e,n,o,s,r,a,h=this._parts;for(i=0,n=0,o=this._rings.length;i<o;i++)for(e=0,s=(a=this._rings[i]).length;e<s-1;e++)(r=At(a[e],a[e+1],t,e,!0))&&(h[n]=h[n]||[],h[n].push(r[0]),r[1]===a[e+1]&&e!==s-2||(h[n].push(r[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,i=this.options.smoothFactor,e=0,n=t.length;e<n;e++)t[e]=Zt(t[e],i)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,i){var e,n,o,s,r,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(e=0,s=this._parts.length;e<s;e++)for(n=0,o=(r=(a=this._parts[e]).length)-1;n<r;o=n++)if((i||0!==n)&&St(t,a[o],a[n])<=h)return!0;return!1}});vn._flat=Wt;var yn=vn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r,a,h,u=this._rings[0],l=u.length;if(!l)return null;for(s=r=a=0,t=0,i=l-1;t<l;i=t++)e=u[t],n=u[i],o=e.y*n.x-n.y*e.x,r+=(e.x+n.x)*o,a+=(e.y+n.y)*o,s+=3*o;return h=0===s?u[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var i=vn.prototype._convertLatLngs.call(this,t),e=i.length;return e>=2&&i[0]instanceof M&&i[0].equals(i[e-1])&&i.pop(),i},_setLatLngs:function(t){vn.prototype._setLatLngs.call(this,t),jt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,i=this.options.weight,e=new x(i,i);if(t=new b(t.min.subtract(e),t.max.add(e)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,o=0,s=this._rings.length;o<s;o++)(n=Ht(this._rings[o],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var i,e,n,o,s,r,a,h,u=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(s=0,r=(h=(i=this._parts[o]).length)-1;s<h;r=s++)e=i[s],n=i[r],e.y>t.y!=n.y>t.y&&t.x<(n.x-e.x)*(t.y-e.y)/(n.y-e.y)+e.x&&(u=!u);return u||vn.prototype._containsPoint.call(this,t,!0)}}),xn=un.extend({initialize:function(t,i){l(this,i),this._layers={},t&&this.addData(t)},addData:function(t){var i,e,n,o=fi(t)?t:t.features;if(o){for(i=0,e=o.length;i<e;i++)((n=o[i]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var s=this.options;if(s.filter&&!s.filter(t))return this;var r=Yt(t,s);return r?(r.feature=ii(t),r.defaultOptions=r.options,this.resetStyle(r),s.onEachFeature&&s.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return t.options=i({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(i){this._setLayerStyle(i,t)},this)},_setLayerStyle:function(t,i){"function"==typeof i&&(i=i(t.feature)),t.setStyle&&t.setStyle(i)}}),wn={toGeoJSON:function(t){return ti(this,{type:"Point",coordinates:$t(this.getLatLng(),t)})}};pn.include(wn),gn.include(wn),fn.include(wn),vn.include({toGeoJSON:function(t){var i=!jt(this._latlngs),e=Qt(this._latlngs,i?1:0,!1,t);return ti(this,{type:(i?"Multi":"")+"LineString",coordinates:e})}}),yn.include({toGeoJSON:function(t){var i=!jt(this._latlngs),e=i&&!jt(this._latlngs[0]),n=Qt(this._latlngs,e?2:i?1:0,!0,t);return i||(n=[n]),ti(this,{type:(e?"Multi":"")+"Polygon",coordinates:n})}}),an.include({toMultiPoint:function(t){var i=[];return this.eachLayer(function(e){i.push(e.toGeoJSON(t).geometry.coordinates)}),ti(this,{type:"MultiPoint",coordinates:i})},toGeoJSON:function(t){var i=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===i)return this.toMultiPoint(t);var e="GeometryCollection"===i,n=[];return this.eachLayer(function(i){if(i.toGeoJSON){var o=i.toGeoJSON(t);if(e)n.push(o.geometry);else{var s=ii(o);"FeatureCollection"===s.type?n.push.apply(n,s.features):n.push(s)}}}),e?ti(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Ln=ei,bn=rn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,i,e){this._url=t,this._bounds=z(i),l(this,e)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ut(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ct(this._image),this},bringToBack:function(){return this._map&&_t(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=z(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=ht("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":"")+(this.options.className||""));t.onselectstart=r,t.onmousemove=r,t.onload=e(this.fire,this,"load"),t.onerror=e(this._overlayOnError,this,"error"),this.options.crossOrigin&&(t.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var i=this._map.getZoomScale(t.zoom),e=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;wt(this._image,e,i)},_reset:function(){var t=this._image,i=new b(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),e=i.getSize();Lt(t,i.min),t.style.width=e.x+"px",t.style.height=e.y+"px"},_updateOpacity:function(){vt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Pn=function(t,i,e){return new bn(t,i,e)},Tn=bn.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,i=this._image=t?this._url:ht("video");if(i.class=i.class||"",i.class+="leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""),i.onselectstart=r,i.onmousemove=r,i.onloadeddata=e(this.fire,this,"load"),!t){fi(this._url)||(this._url=[this._url]),i.autoplay=!!this.options.autoplay,i.loop=!!this.options.loop;for(var n=0;n<this._url.length;n++){var o=ht("source");o.src=this._url[n],i.appendChild(o)}}}}),zn=rn.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,i){l(this,t),this._source=i},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&vt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&vt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(vt(this._container,0),this._removeTimeout=setTimeout(e(ut,void 0,this._container),200)):ut(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=C(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ct(this._container),this},bringToBack:function(){return this._map&&_t(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,i="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof i)t.innerHTML=i;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),i=w(this.options.offset),e=this._getAnchor();this._zoomAnimated?Lt(this._container,t.add(e)):i=i.add(t).add(e);var n=this._containerBottom=-i.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+i.x;this._container.style.bottom=n+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}}),Mn=zn.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){zn.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof mn||this._source.on("preclick",Y))},onRemove:function(t){zn.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof mn||this._source.off("preclick",Y))},getEvents:function(){var t=zn.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",i=this._container=ht("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),e=this._wrapper=ht("div",t+"-content-wrapper",i);if(this._contentNode=ht("div",t+"-content",e),J(e),X(this._contentNode),V(e,"contextmenu",Y),this._tipContainer=ht("div",t+"-tip-container",i),this._tip=ht("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=ht("a",t+"-close-button",i);n.href="#close",n.innerHTML="&#215;",V(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,i=t.style;i.width="",i.whiteSpace="nowrap";var e=t.offsetWidth;e=Math.min(e,this.options.maxWidth),e=Math.max(e,this.options.minWidth),i.width=e+1+"px",i.whiteSpace="",i.height="";var n=t.offsetHeight,o=this.options.maxHeight;o&&n>o?(i.height=o+"px",pt(t,"leaflet-popup-scrolled")):mt(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),e=this._getAnchor();Lt(this._container,i.add(e))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,i=parseInt(at(this._container,"marginBottom"),10)||0,e=this._container.offsetHeight+i,n=this._containerWidth,o=new x(this._containerLeft,-e-this._containerBottom);o._add(bt(this._container));var s=t.layerPointToContainerPoint(o),r=w(this.options.autoPanPadding),a=w(this.options.autoPanPaddingTopLeft||r),h=w(this.options.autoPanPaddingBottomRight||r),u=t.getSize(),l=0,c=0;s.x+n+h.x>u.x&&(l=s.x+n-u.x+h.x),s.x-l-a.x<0&&(l=s.x-a.x),s.y+e+h.y>u.y&&(c=s.y+e-u.y+h.y),s.y-c-a.y<0&&(c=s.y-a.y),(l||c)&&t.fire("autopanstart").panBy([l,c])}},_onCloseButtonClick:function(t){this._close(),Q(t)},_getAnchor:function(){return w(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Cn=function(t,i){return new Mn(t,i)};Be.mergeOptions({closePopupOnClick:!0}),Be.include({openPopup:function(t,i,e){return t instanceof Mn||(t=new Mn(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),rn.include({bindPopup:function(t,i){return t instanceof Mn?(l(t,i),this._popup=t,t._source=this):(this._popup&&!i||(this._popup=new Mn(i,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,i){if(t instanceof rn||(i=t,t=this),t instanceof un)for(var e in this._layers){t=this._layers[e];break}return i||(i=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,i)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var i=t.layer||t.target;this._popup&&this._map&&(Q(t),i instanceof mn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===i?this.closePopup():this.openPopup(i,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Zn=zn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){zn.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){zn.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=zn.prototype.getEvents.call(this);return ee&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ht("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var i=this._map,e=this._container,n=i.latLngToContainerPoint(i.getCenter()),o=i.layerPointToContainerPoint(t),s=this.options.direction,r=e.offsetWidth,a=e.offsetHeight,h=w(this.options.offset),u=this._getAnchor();"top"===s?t=t.add(w(-r/2+h.x,-a+h.y+u.y,!0)):"bottom"===s?t=t.subtract(w(r/2-h.x,-h.y,!0)):"center"===s?t=t.subtract(w(r/2+h.x,a/2-u.y+h.y,!0)):"right"===s||"auto"===s&&o.x<n.x?(s="right",t=t.add(w(h.x+u.x,u.y-a/2+h.y,!0))):(s="left",t=t.subtract(w(r+u.x-h.x,a/2-u.y-h.y,!0))),mt(e,"leaflet-tooltip-right"),mt(e,"leaflet-tooltip-left"),mt(e,"leaflet-tooltip-top"),mt(e,"leaflet-tooltip-bottom"),pt(e,"leaflet-tooltip-"+s),Lt(e,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&vt(this._container,t)},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(i)},_getAnchor:function(){return w(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Sn=function(t,i){return new Zn(t,i)};Be.include({openTooltip:function(t,i,e){return t instanceof Zn||(t=new Zn(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),rn.include({bindTooltip:function(t,i){return t instanceof Zn?(l(t,i),this._tooltip=t,t._source=this):(this._tooltip&&!i||(this._tooltip=new Zn(i,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var i=t?"off":"on",e={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?e.add=this._openTooltip:(e.mouseover=this._openTooltip,e.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(e.mousemove=this._moveTooltip),ee&&(e.click=this._openTooltip)),this[i](e),this._tooltipHandlersAdded=!t}},openTooltip:function(t,i){if(t instanceof rn||(i=t,t=this),t instanceof un)for(var e in this._layers){t=this._layers[e];break}return i||(i=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,i),this._tooltip.options.interactive&&this._tooltip._container&&(pt(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(mt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var i=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(i,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var i,e,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(i=this._map.mouseEventToContainerPoint(t.originalEvent),e=this._map.containerPointToLayerPoint(i),n=this._map.layerPointToLatLng(e)),this._tooltip.setLatLng(n)}});var En=cn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:document.createElement("div"),e=this.options;if(i.innerHTML=!1!==e.html?e.html:"",e.bgPos){var n=w(e.bgPos);i.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}});cn.Default=_n;var kn=rn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ji,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){l(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ut(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(ct(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_t(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof x?t:new x(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var i,e=this.getPane().children,n=-t(-1/0,1/0),o=0,s=e.length;o<s;o++)i=e[o].style.zIndex,e[o]!==this._container&&i&&(n=t(n,+i));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ai){vt(this._container,this.options.opacity);var t=+new Date,i=!1,e=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var s=Math.min(1,(t-o.loaded)/200);vt(o.el,s),s<1?i=!0:(o.active?e=!0:this._onOpaqueTile(o),o.active=!0)}}e&&!this._noPrune&&this._pruneTiles(),i&&(g(this._fadeFrame),this._fadeFrame=f(this._updateOpacity,this))}},_onOpaqueTile:r,_initContainer:function(){this._container||(this._container=ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,i=this.options.maxZoom;if(void 0!==t){for(var e in this._levels)this._levels[e].el.children.length||e===t?(this._levels[e].el.style.zIndex=i-Math.abs(t-e),this._onUpdateLevel(e)):(ut(this._levels[e].el),this._removeTilesAtZoom(e),this._onRemoveLevel(e),delete this._levels[e]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=i,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:r,_onRemoveLevel:r,_onCreateLevel:r,_pruneTiles:function(){if(this._map){var t,i,e=this._map.getZoom();if(e>this.options.maxZoom||e<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(i=this._tiles[t]).retain=i.current;for(t in this._tiles)if((i=this._tiles[t]).current&&!i.active){var n=i.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var i in this._tiles)this._tiles[i].coords.z===t&&this._removeTile(i)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ut(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,i,e,n){var o=Math.floor(t/2),s=Math.floor(i/2),r=e-1,a=new x(+o,+s);a.z=+r;var h=this._tileCoordsToKey(a),u=this._tiles[h];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),r>n&&this._retainParent(o,s,r,n))},_retainChildren:function(t,i,e,n){for(var o=2*t;o<2*t+2;o++)for(var s=2*i;s<2*i+2;s++){var r=new x(o,s);r.z=e+1;var a=this._tileCoordsToKey(r),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),e+1<n&&this._retainChildren(o,s,e+1,n))}},_resetView:function(t){var i=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),i,i)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var i=this.options;return void 0!==i.minNativeZoom&&t<i.minNativeZoom?i.minNativeZoom:void 0!==i.maxNativeZoom&&i.maxNativeZoom<t?i.maxNativeZoom:t},_setView:function(t,i,e,n){var o=this._clampZoom(Math.round(i));(void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom)&&(o=void 0);var s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),e||this._pruneTiles(),this._noPrune=!!e),this._setZoomTransforms(t,i)},_setZoomTransforms:function(t,i){for(var e in this._levels)this._setZoomTransform(this._levels[e],t,i)},_setZoomTransform:function(t,i,e){var n=this._map.getZoomScale(e,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(i,e)).round();Xi?wt(t.el,o,n):Lt(t.el,o)},_resetGrid:function(){var t=this._map,i=t.options.crs,e=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,i.wrapLng[0]],n).x/e.x),Math.ceil(t.project([0,i.wrapLng[1]],n).x/e.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([i.wrapLat[0],0],n).y/e.x),Math.ceil(t.project([i.wrapLat[1],0],n).y/e.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var i=this._map,e=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),n=i.getZoomScale(e,this._tileZoom),o=i.project(t,this._tileZoom).floor(),s=i.getSize().divideBy(2*n);return new b(o.subtract(s),o.add(s))},_update:function(t){var i=this._map;if(i){var e=this._clampZoom(i.getZoom());if(void 0===t&&(t=i.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),s=o.getCenter(),r=[],a=this.options.keepBuffer,h=new b(o.getBottomLeft().subtract([a,-a]),o.getTopRight().add([a,-a]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var l=this._tiles[u].coords;l.z===this._tileZoom&&h.contains(new x(l.x,l.y))||(this._tiles[u].current=!1)}if(Math.abs(e-this._tileZoom)>1)this._setView(t,e);else{for(var c=o.min.y;c<=o.max.y;c++)for(var _=o.min.x;_<=o.max.x;_++){var d=new x(_,c);d.z=this._tileZoom,this._isValidTile(d)&&(this._tiles[this._tileCoordsToKey(d)]||r.push(d))}if(r.sort(function(t,i){return t.distanceTo(s)-i.distanceTo(s)}),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var p=document.createDocumentFragment();for(_=0;_<r.length;_++)this._addTile(r[_],p);this._level.el.appendChild(p)}}}}},_isValidTile:function(t){var i=this._map.options.crs;if(!i.infinite){var e=this._globalTileRange;if(!i.wrapLng&&(t.x<e.min.x||t.x>e.max.x)||!i.wrapLat&&(t.y<e.min.y||t.y>e.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return z(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var i=this._map,e=this.getTileSize(),n=t.scaleBy(e),o=n.add(e),s=new T(i.unproject(n,t.z),i.unproject(o,t.z));return this.options.noWrap||i.wrapLatLngBounds(s),s},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var i=t.split(":"),e=new x(+i[0],+i[1]);return e.z=+i[2],e},_removeTile:function(t){var i=this._tiles[t];i&&(ut(i.el),delete this._tiles[t],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){pt(t,"leaflet-tile");var i=this.getTileSize();t.style.width=i.x+"px",t.style.height=i.y+"px",t.onselectstart=r,t.onmousemove=r,Ai&&this.options.opacity<1&&vt(t,this.options.opacity),Di&&!Ni&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,i){var n=this._getTilePos(t),o=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),e(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&f(e(this._tileReady,this,t,null,s)),Lt(s,n),this._tiles[o]={el:s,coords:t,current:!0},i.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,i,n){if(this._map){i&&this.fire("tileerror",{error:i,tile:n,coords:t});var o=this._tileCoordsToKey(t);(n=this._tiles[o])&&(n.loaded=+new Date,this._map._fadeAnimated?(vt(n.el,0),g(this._fadeFrame),this._fadeFrame=f(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),i||(pt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ai||!this._map._fadeAnimated?f(this._pruneTiles,this):setTimeout(e(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var i=new x(this._wrapX?s(t.x,this._wrapX):t.x,this._wrapY?s(t.y,this._wrapY):t.y);return i.z=t.z,i},_pxBoundsToTileRange:function(t){var i=this.getTileSize();return new b(t.min.unscaleBy(i).floor(),t.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),Bn=kn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,i){this._url=t,(i=l(this,i)).detectRetina&&se&&i.maxZoom>0&&(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom++):(i.zoomOffset++,i.maxZoom--),i.minZoom=Math.max(0,i.minZoom)),"string"==typeof i.subdomains&&(i.subdomains=i.subdomains.split("")),Di||this.on("tileunload",this._onTileRemove)},setUrl:function(t,i){return this._url=t,i||this.redraw(),this},createTile:function(t,i){var n=document.createElement("img");return V(n,"load",e(this._tileOnLoad,this,i,n)),V(n,"error",e(this._tileOnError,this,i,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:se?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=n),e["-y"]=n}return _(this._url,i(e,this.options))},_tileOnLoad:function(t,i){Ai?setTimeout(e(t,this,null,i),0):t(null,i)},_tileOnError:function(t,i,e){var n=this.options.errorTileUrl;n&&i.src!==n&&(i.src=n),t(e,i)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,i=this.options.maxZoom,e=this.options.zoomReverse,n=this.options.zoomOffset;return e&&(t=i-t),t+n},_getSubdomain:function(t){var i=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[i]},_abortLoading:function(){var t,i;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((i=this._tiles[t].el).onload=r,i.onerror=r,i.complete||(i.src=gi,ut(i)))}}),In=Bn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n=i({},this.defaultWmsParams);for(var o in e)o in this.options||(n[o]=e[o]);e=l(this,e),n.width=n.height=e.tileSize*(e.detectRetina&&se?2:1),this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[i]=this._crs.code,Bn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var i=this._tileCoordsToBounds(t),e=this._crs.project(i.getNorthWest()),n=this._crs.project(i.getSouthEast()),o=(this._wmsVersion>=1.3&&this._crs===on?[n.y,e.x,e.y,n.x]:[e.x,n.y,n.x,e.y]).join(","),s=Bn.prototype.getTileUrl.call(this,t);return s+c(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,e){return i(this.wmsParams,t),e||this.redraw(),this}});Bn.WMS=In,ri.wms=ai;var An=rn.extend({options:{padding:.1},initialize:function(t){l(this,t),n(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,i){var e=this._map.getZoomScale(i,this._zoom),n=bt(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,i),r=this._map.project(t,i).subtract(s),a=o.multiplyBy(-e).add(n).add(o).subtract(r);Xi?wt(this._container,a,e):Lt(this._container,a)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,i=this._map.getSize(),e=this._map.containerPointToLayerPoint(i.multiplyBy(-t)).round();this._bounds=new b(e,e.add(i.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),On=An.extend({getEvents:function(){var t=An.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){An.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");V(t,"mousemove",o(this._onMouseMove,32,this),this),V(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),V(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,ut(this._container),G(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var t in this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},An.prototype._update.call(this);var t=this._bounds,i=this._container,e=t.getSize(),n=se?2:1;Lt(i,t.min),i.width=n*e.x,i.height=n*e.y,i.style.width=e.x+"px",i.style.height=e.y+"px",se&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){An.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[n(t)]=t;var i=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=i),this._drawLast=i,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var i=t._order,e=i.next,n=i.prev;e?e.prev=n:this._drawLast=n,n?n.next=e:this._drawFirst=e,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var i,e=t.options.dashArray.split(","),n=[];for(i=0;i<e.length;i++)n.push(Number(e[i]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||f(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var i=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new b,this._redrawBounds.extend(t._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(t._pxBounds.max.add([i,i]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var i=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,i.x,i.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,i=this._redrawBounds;if(this._ctx.save(),i){var e=i.getSize();this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,e.x,e.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!i||t._pxBounds&&t._pxBounds.intersects(i))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,i){if(this._drawing){var e,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),e=0;e<a;e++){for(n=0,o=r[e].length;n<o;n++)s=r[e][n],h[n?"lineTo":"moveTo"](s.x,s.y);i&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var i=t._point,e=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(e.save(),e.scale(1,o)),e.beginPath(),e.arc(i.x,i.y/o,n,0,2*Math.PI,!1),1!==o&&e.restore(),this._fillStroke(e,t)}},_fillStroke:function(t,i){var e=i.options;e.fill&&(t.globalAlpha=e.fillOpacity,t.fillStyle=e.fillColor||e.color,t.fill(e.fillRule||"evenodd")),e.stroke&&0!==e.weight&&(t.setLineDash&&t.setLineDash(i.options&&i.options._dashArray||[]),t.globalAlpha=e.opacity,t.lineWidth=e.weight,t.strokeStyle=e.color,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.stroke())},_onClick:function(t){for(var i,e,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(n)&&!this._map._draggableMoved(i)&&(e=i);e&&(et(t),this._fireEvent([e],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var i=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,i)}},_handleMouseOut:function(t){var i=this._hoveredLayer;i&&(mt(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,i){for(var e,n,o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&(n=e);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(pt(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,i,e){this._map._fireDOMEvent(i,e||i.type,t)},_bringToFront:function(t){var i=t._order,e=i.next,n=i.prev;e&&(e.prev=n,n?n.next=e:e&&(this._drawFirst=e),i.prev=this._drawLast,this._drawLast.next=i,i.next=null,this._drawLast=i,this._requestRedraw(t))},_bringToBack:function(t){var i=t._order,e=i.next,n=i.prev;n&&(n.next=e,e?e.prev=n:n&&(this._drawLast=n),i.prev=null,i.next=this._drawFirst,this._drawFirst.prev=i,this._drawFirst=i,this._requestRedraw(t))}}),Rn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Dn={_initContainer:function(){this._container=ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(An.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var i=t._container=Rn("shape");pt(i,"leaflet-vml-shape "+(this.options.className||"")),i.coordsize="1 1",t._path=Rn("path"),i.appendChild(t._path),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){var i=t._container;this._container.appendChild(i),t.options.interactive&&t.addInteractiveTarget(i)},_removePath:function(t){var i=t._container;ut(i),t.removeInteractiveTarget(i),delete this._layers[n(t)]},_updateStyle:function(t){var i=t._stroke,e=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(i||(i=t._stroke=Rn("stroke")),o.appendChild(i),i.weight=n.weight+"px",i.color=n.color,i.opacity=n.opacity,n.dashArray?i.dashStyle=fi(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):i.dashStyle="",i.endcap=n.lineCap.replace("butt","flat"),i.joinstyle=n.lineJoin):i&&(o.removeChild(i),t._stroke=null),n.fill?(e||(e=t._fill=Rn("fill")),o.appendChild(e),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(o.removeChild(e),t._fill=null)},_updateCircle:function(t){var i=t._point.round(),e=Math.round(t._radius),n=Math.round(t._radiusY||e);this._setPath(t,t._empty()?"M0 0":"AL "+i.x+","+i.y+" "+e+","+n+" 0,23592600")},_setPath:function(t,i){t._path.v=i},_bringToFront:function(t){ct(t._container)},_bringToBack:function(t){_t(t._container)}},Nn=he?Rn:E,jn=An.extend({getEvents:function(){var t=An.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=Nn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Nn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ut(this._container),G(this._container),delete this._container,delete this._rootGroup},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){An.prototype._update.call(this);var t=this._bounds,i=t.getSize(),e=this._container;this._svgSize&&this._svgSize.equals(i)||(this._svgSize=i,e.setAttribute("width",i.x),e.setAttribute("height",i.y)),Lt(e,t.min),e.setAttribute("viewBox",[t.min.x,t.min.y,i.x,i.y].join(" ")),this.fire("update")}},_initPath:function(t){var i=t._path=Nn("path");t.options.className&&pt(i,t.options.className),t.options.interactive&&pt(i,"leaflet-interactive"),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ut(t._path),t.removeInteractiveTarget(t._path),delete this._layers[n(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var i=t._path,e=t.options;i&&(e.stroke?(i.setAttribute("stroke",e.color),i.setAttribute("stroke-opacity",e.opacity),i.setAttribute("stroke-width",e.weight),i.setAttribute("stroke-linecap",e.lineCap),i.setAttribute("stroke-linejoin",e.lineJoin),e.dashArray?i.setAttribute("stroke-dasharray",e.dashArray):i.removeAttribute("stroke-dasharray"),e.dashOffset?i.setAttribute("stroke-dashoffset",e.dashOffset):i.removeAttribute("stroke-dashoffset")):i.setAttribute("stroke","none"),e.fill?(i.setAttribute("fill",e.fillColor||e.color),i.setAttribute("fill-opacity",e.fillOpacity),i.setAttribute("fill-rule",e.fillRule||"evenodd")):i.setAttribute("fill","none"))},_updatePoly:function(t,i){this._setPath(t,k(t._parts,i))},_updateCircle:function(t){var i=t._point,e=t._radius,n="a"+e+","+(t._radiusY||e)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(i.x-e)+","+i.y+n+2*e+",0 "+n+2*-e+",0 ";this._setPath(t,o)},_setPath:function(t,i){t._path.setAttribute("d",i)},_bringToFront:function(t){ct(t._path)},_bringToBack:function(t){_t(t._path)}});he&&jn.include(Dn),Be.include({getRenderer:function(t){var i=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return i||(i=this._renderer=this.options.preferCanvas&&hi()||ui()),this.hasLayer(i)||this.addLayer(i),i},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var i=this._paneRenderers[t];return void 0===i&&(i=jn&&ui({pane:t})||On&&hi({pane:t}),this._paneRenderers[t]=i),i}});var Wn=yn.extend({initialize:function(t,i){yn.prototype.initialize.call(this,this._boundsToLatLngs(t),i)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=z(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});jn.create=Nn,jn.pointsToPath=k,xn.geometryToLayer=Yt,xn.coordsToLatLng=Xt,xn.coordsToLatLngs=Jt,xn.latLngToCoords=$t,xn.latLngsToCoords=Qt,xn.getFeature=ti,xn.asFeature=ii,Be.mergeOptions({boxZoom:!0});var Hn=Ve.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){V(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){G(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ut(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Ci(),Pt(),this._startPoint=this._map.mouseEventToContainerPoint(t),V(document,{contextmenu:Q,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ht("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var i=new b(this._point,this._startPoint),e=i.getSize();Lt(this._box,i.min),this._box.style.width=e.x+"px",this._box.style.height=e.y+"px"},_finish:function(){this._moved&&(ut(this._box),mt(this._container,"leaflet-crosshair")),Zi(),Tt(),G(document,{contextmenu:Q,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(e(this._resetState,this),0);var i=new T(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(i).fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});Be.addInitHook("addHandler","boxZoom",Hn),Be.mergeOptions({doubleClickZoom:!0});var Fn=Ve.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var i=this._map,e=i.getZoom(),n=i.options.zoomDelta,o=t.originalEvent.shiftKey?e-n:e+n;"center"===i.options.doubleClickZoom?i.setZoom(o):i.setZoomAround(t.containerPoint,o)}});Be.addInitHook("addHandler","doubleClickZoom",Fn),Be.mergeOptions({dragging:!0,inertia:!Ni,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Un=Ve.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Xe(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){mt(this._map._container,"leaflet-grab"),mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var i=z(this._map.options.maxBounds);this._offsetLimit=P(this._map.latLngToContainerPoint(i.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(i.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var i=this._lastTime=+new Date,e=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(e),this._times.push(i),i-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,i){return t-(t-i)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),i=this._offsetLimit;t.x<i.min.x&&(t.x=this._viscousLimit(t.x,i.min.x)),t.y<i.min.y&&(t.y=this._viscousLimit(t.y,i.min.y)),t.x>i.max.x&&(t.x=this._viscousLimit(t.x,i.max.x)),t.y>i.max.y&&(t.y=this._viscousLimit(t.y,i.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,i=Math.round(t/2),e=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-i+e)%t+i-e,s=(n+i+e)%t-i-e,r=Math.abs(o+e)<Math.abs(s+e)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var i=this._map,e=i.options,n=!e.inertia||this._times.length<2;if(i.fire("dragend",t),n)i.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,r=e.easeLinearity,a=o.multiplyBy(r/s),h=a.distanceTo([0,0]),u=Math.min(e.inertiaMaxSpeed,h),l=a.multiplyBy(u/h),c=u/(e.inertiaDeceleration*r),_=l.multiplyBy(-c/2).round();_.x||_.y?(_=i._limitOffset(_,i.options.maxBounds),f(function(){i.panBy(_,{duration:c,easeLinearity:r,noMoveStart:!0,animate:!0})})):i.fire("moveend")}}});Be.addInitHook("addHandler","dragging",Un),Be.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Vn=Ve.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),V(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),G(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,i=document.documentElement,e=t.scrollTop||i.scrollTop,n=t.scrollLeft||i.scrollLeft;this._map._container.focus(),window.scrollTo(n,e)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var i,e,n=this._panKeys={},o=this.keyCodes;for(i=0,e=o.left.length;i<e;i++)n[o.left[i]]=[-1*t,0];for(i=0,e=o.right.length;i<e;i++)n[o.right[i]]=[t,0];for(i=0,e=o.down.length;i<e;i++)n[o.down[i]]=[0,t];for(i=0,e=o.up.length;i<e;i++)n[o.up[i]]=[0,-1*t]},_setZoomDelta:function(t){var i,e,n=this._zoomKeys={},o=this.keyCodes;for(i=0,e=o.zoomIn.length;i<e;i++)n[o.zoomIn[i]]=t;for(i=0,e=o.zoomOut.length;i<e;i++)n[o.zoomOut[i]]=-t},_addHooks:function(){V(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){G(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var i,e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;i=this._panKeys[e],t.shiftKey&&(i=w(i).multiplyBy(3)),n.panBy(i),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(e in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else{if(27!==e||!n._popup)return;n.closePopup()}Q(t)}}});Be.addInitHook("addHandler","keyboard",Vn),Be.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Gn=Ve.extend({addHooks:function(){V(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){G(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var i=it(t),n=this._map.options.wheelDebounceTime;this._delta+=i,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(e(this._performZoom,this),o),Q(t)},_performZoom:function(){var t=this._map,i=t.getZoom(),e=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=e?Math.ceil(o/e)*e:o,r=t._limitZoom(i+(this._delta>0?s:-s))-i;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(i+r):t.setZoomAround(this._lastMousePos,i+r))}});Be.addInitHook("addHandler","scrollWheelZoom",Gn),Be.mergeOptions({tap:!0,tapTolerance:15});var qn=Ve.extend({addHooks:function(){V(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){G(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if($(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new x(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&pt(n,"leaflet-active"),this._holdTimeout=setTimeout(e(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),V(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),G(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],e=i.target;e&&e.tagName&&"a"===e.tagName.toLowerCase()&&mt(e,"leaflet-active"),this._simulateEvent("mouseup",i),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var i=t.touches[0];this._newPos=new x(i.clientX,i.clientY),this._simulateEvent("mousemove",i)},_simulateEvent:function(t,i){var e=document.createEvent("MouseEvents");e._simulated=!0,i.target._simulatedClick=!0,e.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(e)}});ee&&!ie&&Be.addInitHook("addHandler","tap",qn),Be.mergeOptions({touchZoom:ee&&!Ni,bounceAtZoomLimits:!0});var Kn=Ve.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),V(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){mt(this._map._container,"leaflet-touch-zoom"),G(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var e=i.mouseEventToContainerPoint(t.touches[0]),n=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(e.add(n)._divideBy(2))),this._startDist=e.distanceTo(n),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),V(document,"touchmove",this._onTouchMove,this),V(document,"touchend",this._onTouchEnd,this),$(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var i=this._map,n=i.mouseEventToContainerPoint(t.touches[0]),o=i.mouseEventToContainerPoint(t.touches[1]),s=n.distanceTo(o)/this._startDist;if(this._zoom=i.getScaleZoom(s,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&s<1||this._zoom>i.getMaxZoom()&&s>1)&&(this._zoom=i._limitZoom(this._zoom)),"center"===i.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=n._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(i._moveStart(!0),this._moved=!0),g(this._animRequest);var a=e(i._move,i,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=f(a,this,!0),$(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,g(this._animRequest),G(document,"touchmove",this._onTouchMove),G(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Be.addInitHook("addHandler","touchZoom",Kn),Be.BoxZoom=Hn,Be.DoubleClickZoom=Fn,Be.Drag=Un,Be.Keyboard=Vn,Be.ScrollWheelZoom=Gn,Be.Tap=qn,Be.TouchZoom=Kn;var Yn=window.L;window.L=t,Object.freeze=_i,t.version="1.2.0+HEAD.1ac320b",t.noConflict=ci,t.Control=Ie,t.control=Ae,t.Browser=ue,t.Evented=bi,t.Mixin=Ge,t.Util=wi,t.Class=v,t.Handler=Ve,t.extend=i,t.bind=e,t.stamp=n,t.setOptions=l,t.DomEvent=Pe,t.DomUtil=Ee,t.PosAnimation=ke,t.Draggable=Xe,t.LineUtil=Je,t.PolyUtil=$e,t.Point=x,t.point=w,t.Bounds=b,t.bounds=P,t.Transformation=Z,t.transformation=S,t.Projection=en,t.LatLng=M,t.latLng=C,t.LatLngBounds=T,t.latLngBounds=z,t.CRS=Pi,t.GeoJSON=xn,t.geoJSON=ei,t.geoJson=Ln,t.Layer=rn,t.LayerGroup=an,t.layerGroup=hn,t.FeatureGroup=un,t.featureGroup=ln,t.ImageOverlay=bn,t.imageOverlay=Pn,t.VideoOverlay=Tn,t.videoOverlay=ni,t.DivOverlay=zn,t.Popup=Mn,t.popup=Cn,t.Tooltip=Zn,t.tooltip=Sn,t.Icon=cn,t.icon=Ft,t.DivIcon=En,t.divIcon=oi,t.Marker=pn,t.marker=Ut,t.TileLayer=Bn,t.tileLayer=ri,t.GridLayer=kn,t.gridLayer=si,t.SVG=jn,t.svg=ui,t.Renderer=An,t.Canvas=On,t.canvas=hi,t.Path=mn,t.CircleMarker=fn,t.circleMarker=Vt,t.Circle=gn,t.circle=Gt,t.Polyline=vn,t.polyline=qt,t.Polygon=yn,t.polygon=Kt,t.Rectangle=Wn,t.rectangle=li,t.Map=Be,t.map=Ct});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/esri-leaflet-2.0.8/esri-leaflet.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{}),t.L)}(this,function(t,e){"use strict";function i(t){var e="";t.f=t.f||"json";for(var i in t)if(t.hasOwnProperty(i)){var s,r=t[i],n=Object.prototype.toString.call(r);e.length&&(e+="&"),s="[object Array]"===n?"[object Object]"===Object.prototype.toString.call(r[0])?JSON.stringify(r):r.join(","):"[object Object]"===n?JSON.stringify(r):"[object Date]"===n?r.valueOf():r,e+=encodeURIComponent(i)+"="+encodeURIComponent(s)}return e}function s(t,i){var s=new window.XMLHttpRequest;return s.onerror=function(r){s.onreadystatechange=e.Util.falseFn,t.call(i,{error:{code:500,message:"XMLHttpRequest error"}},null)},s.onreadystatechange=function(){var r,n;if(4===s.readyState){try{r=JSON.parse(s.responseText)}catch(t){r=null,n={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!n&&r.error&&(n=r.error,r=null),s.onerror=e.Util.falseFn,t.call(i,n,r)}},s.ontimeout=function(){this.onerror()},s}function r(t,e,r,n){var o=s(r,n);return o.open("POST",t),void 0!==n&&null!==n&&void 0!==n.options&&(o.timeout=n.options.timeout),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(i(e)),o}function n(t,e,r,n){var o=s(r,n);return o.open("GET",t+"?"+i(e),!0),void 0!==n&&null!==n&&void 0!==n.options&&(o.timeout=n.options.timeout),o.send(null),o}function o(t,e,r,n){var o=i(e),u=s(r,n),l=(t+"?"+o).length;if(l<=2e3&&et.cors?u.open("GET",t+"?"+o):l>2e3&&et.cors&&(u.open("POST",t),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),void 0!==n&&null!==n&&void 0!==n.options&&(u.timeout=n.options.timeout),l<=2e3&&et.cors)u.send(null);else{if(!(l>2e3&&et.cors))return l<=2e3&&!et.cors?a(t,e,r,n):void F("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");u.send(o)}return u}function a(t,s,r,n){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var o="c"+st;s.callback="window._EsriLeafletCallbacks."+o,window._EsriLeafletCallbacks[o]=function(t){if(!0!==window._EsriLeafletCallbacks[o]){var e,i=Object.prototype.toString.call(t);"[object Object]"!==i&&"[object Array]"!==i&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),r.call(n,e,t),window._EsriLeafletCallbacks[o]=!0}};var a=e.DomUtil.create("script",null,document.body);return a.type="text/javascript",a.src=t+"?"+i(s),a.id=o,st++,{id:o,url:a.src,abort:function(){window._EsriLeafletCallbacks._callback[o]({code:0,message:"Request aborted."})}}}function u(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function l(t){return u(t[0],t[t.length-1])||t.push(t[0]),t}function h(t){var e,i=0,s=0,r=t.length,n=t[s];for(s;s<r-1;s++)i+=((e=t[s+1])[0]-n[0])*(e[1]+n[1]),n=e;return i>=0}function c(t,e,i,s){var r=(s[0]-i[0])*(t[1]-i[1])-(s[1]-i[1])*(t[0]-i[0]),n=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),o=(s[1]-i[1])*(e[0]-t[0])-(s[0]-i[0])*(e[1]-t[1]);if(0!==o){var a=r/o,u=n/o;if(a>=0&&a<=1&&u>=0&&u<=1)return!0}return!1}function p(t,e){for(var i=0;i<t.length-1;i++)for(var s=0;s<e.length-1;s++)if(c(t[i],t[i+1],e[s],e[s+1]))return!0;return!1}function d(t,e){for(var i=!1,s=-1,r=t.length,n=r-1;++s<r;n=s)(t[s][1]<=e[1]&&e[1]<t[n][1]||t[n][1]<=e[1]&&e[1]<t[s][1])&&e[0]<(t[n][0]-t[s][0])*(e[1]-t[s][1])/(t[n][1]-t[s][1])+t[s][0]&&(i=!i);return i}function m(t,e){var i=p(t,e),s=d(t,e[0]);return!(i||!s)}function f(t){for(var e,i,s,r=[],n=[],o=0;o<t.length;o++){var a=l(t[o].slice(0));if(!(a.length<4))if(h(a)){var u=[a];r.push(u)}else n.push(a)}for(var c=[];n.length;){s=n.pop();var d=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],m(i,s)){r[e].push(s),d=!0;break}d||c.push(s)}for(;c.length;){s=c.pop();var f=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],p(i,s)){r[e].push(s),f=!0;break}f||r.push([s.reverse()])}return 1===r.length?{type:"Polygon",coordinates:r[0]}:{type:"MultiPolygon",coordinates:r}}function y(t){var e=[],i=t.slice(0),s=l(i.shift().slice(0));if(s.length>=4){h(s)||s.reverse(),e.push(s);for(var r=0;r<i.length;r++){var n=l(i[r].slice(0));n.length>=4&&(h(n)&&n.reverse(),e.push(n))}}return e}function g(t){for(var e=[],i=0;i<t.length;i++)for(var s=y(t[i]),r=s.length-1;r>=0;r--){var n=s[r].slice(0);e.push(n)}return e}function _(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function v(t,e){var i={};return"number"==typeof t.x&&"number"==typeof t.y&&(i.type="Point",i.coordinates=[t.x,t.y]),t.points&&(i.type="MultiPoint",i.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(i.type="LineString",i.coordinates=t.paths[0].slice(0)):(i.type="MultiLineString",i.coordinates=t.paths.slice(0))),t.rings&&(i=f(t.rings.slice(0))),(t.geometry||t.attributes)&&(i.type="Feature",i.geometry=t.geometry?v(t.geometry):null,i.properties=t.attributes?_(t.attributes):null,t.attributes&&(i.id=t.attributes[e]||t.attributes.OBJECTID||t.attributes.FID)),i}function b(t,e){e=e||"OBJECTID";var i,s={wkid:4326},r={};switch(t.type){case"Point":r.x=t.coordinates[0],r.y=t.coordinates[1],r.spatialReference=s;break;case"MultiPoint":r.points=t.coordinates.slice(0),r.spatialReference=s;break;case"LineString":r.paths=[t.coordinates.slice(0)],r.spatialReference=s;break;case"MultiLineString":r.paths=t.coordinates.slice(0),r.spatialReference=s;break;case"Polygon":r.rings=y(t.coordinates.slice(0)),r.spatialReference=s;break;case"MultiPolygon":r.rings=g(t.coordinates.slice(0)),r.spatialReference=s;break;case"Feature":t.geometry&&(r.geometry=b(t.geometry,e)),r.attributes=t.properties?_(t.properties):{},t.id&&(r.attributes[e]=t.id);break;case"FeatureCollection":for(r=[],i=0;i<t.features.length;i++)r.push(b(t.features[i],e));break;case"GeometryCollection":for(r=[],i=0;i<t.geometries.length;i++)r.push(b(t.geometries[i],e))}return r}function x(t,e){return b(t,e)}function S(t,e){return v(t,e)}function A(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function T(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var i=e.latLng(t.ymin,t.xmin),s=e.latLng(t.ymax,t.xmax);return e.latLngBounds(i,s)}return null}function I(t){return t=e.latLngBounds(t),{xmin:t.getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}function w(t,e){var i,s=t.features||t.results,r=s.length;if(e)i=e;else if(t.objectIdFieldName)i=t.objectIdFieldName;else if(t.fields){for(var n=0;n<=t.fields.length-1;n++)if("esriFieldTypeOID"===t.fields[n].type){i=t.fields[n].name;break}}else if(r)for(var o in s[0].attributes)if(o.match(/^(OBJECTID|FID|OID|ID)$/i)){i=o;break}var a={type:"FeatureCollection",features:[]};if(r)for(var u=s.length-1;u>=0;u--){var l=S(s[u],i);a.features.push(l)}return a}function C(t){return"/"!==(t=e.Util.trim(t))[t.length-1]&&(t+="/"),t}function R(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function O(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":e="esriGeometryPolygon";break;case"MultiPolygon":e="esriGeometryPolygon"}return e}function F(){console&&console.warn&&console.warn.apply(console,arguments)}function P(t){return t.getSize().x-it.attributionWidthOffset+"px"}function k(t){if(t.attributionControl&&!t.attributionControl._esriAttributionAdded){t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>');var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(i),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover");var s=document.createElement("style");s.type="text/css",s.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+P(t)+";}",document.getElementsByTagName("head")[0].appendChild(s),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution"),t.on("resize",function(e){t.attributionControl._container.style.maxWidth=P(e.target)}),t.attributionControl._esriAttributionAdded=!0}}function M(t,i){a(t,{},e.Util.bind(function(t,s){if(!t){i._esriAttributions=[];for(var r=0;r<s.contributors.length;r++)for(var n=s.contributors[r],o=0;o<n.coverageAreas.length;o++){var a=n.coverageAreas[o],u=e.latLng(a.bbox[0],a.bbox[1]),l=e.latLng(a.bbox[2],a.bbox[3]);i._esriAttributions.push({attribution:n.attribution,score:a.score,bounds:e.latLngBounds(u,l),minZoom:a.zoomMin,maxZoom:a.zoomMax})}i._esriAttributions.sort(function(t,e){return e.score-t.score}),G({target:i})}},this))}function G(t){var i=t.target,s=i._esriAttributions;if(i&&i.attributionControl&&s){for(var r="",n=i.getBounds(),o=e.latLngBounds(n.getSouthWest().wrap(),n.getNorthEast().wrap()),a=i.getZoom(),u=0;u<s.length;u++){var l=s[u],h=l.attribution;!r.match(h)&&l.bounds.intersects(o)&&a>=l.minZoom&&a<=l.maxZoom&&(r+=", "+h)}r=r.substr(2);var c=i.attributionControl._container.querySelector(".esri-dynamic-attribution");c.innerHTML=r,c.style.maxWidth=P(i),i.fire("attributionupdated",{attribution:r})}}function E(t){return new at(t)}function U(t){return new ut(t)}function q(t){return new lt(t)}function D(t){return new ht(t)}function B(t){return new ct(t)}function z(t){return new pt(t)}function N(t){return new dt(t)}function j(t){return new mt(t)}function Z(t){return new ft(t)}function W(t){return new yt(t)}function J(t,e){return new _t(t,e)}function Q(t,e){return new vt(t,e)}function H(t,e){return new xt(t,e)}function V(t,e){return new St(t,e)}function K(t){this.values=[].concat(t||[])}function X(t){return new It(t)}var $="default"in e?e.default:e,Y=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,tt=""===document.documentElement.style.pointerEvents,et={cors:Y,pointerEvents:tt},it={attributionWidthOffset:55},st=0,rt=et.cors?n:a;rt.CORS=n,rt.JSONP=a;var nt={request:o,get:rt,post:r},ot={shallowClone:A,warn:F,cleanUrl:C,isArcgisOnline:R,geojsonTypeToArcGIS:O,responseToFeatureCollection:w,geojsonToArcGIS:x,arcgisToGeoJSON:S,boundsToExtent:I,extentToBounds:T,calcAttributionWidth:P,setEsriAttribution:k,_getAttributionData:M,_updateMapAttribution:G},at=e.Class.extend({options:{proxy:!1,useCors:Y},generateSetter:function(t,i){return e.Util.bind(function(e){return this.params[t]=e,this},i)},initialize:function(t){if(t.request&&t.options?(this._service=t,e.Util.setOptions(this,t.options)):(e.Util.setOptions(this,t),this.options.url=C(t.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var i in this.setters){var s=this.setters[i];this[i]=this.generateSetter(s,this)}},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},request:function(t,e){return this._service?this._service.request(this.path,this.params,t,e):this._request("request",this.path,this.params,t,e)},_request:function(t,e,i,s,r){var n=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?nt[t](n,i,s,r):nt.get.JSONP(n,i,s,r)}}),ut=at.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometry(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,i){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=i,this.params.inSr=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||R(this.options.url)?(this.params.f="geojson",this.request(function(i,s){this._trapSQLerrors(i),t.call(e,i,s,s)},this)):this.request(function(i,s){this._trapSQLerrors(i),t.call(e,i,s&&w(s),s)},this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.count,i)},e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.objectIds,i)},e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(i,s){s&&s.extent&&T(s.extent)?t.call(e,i,T(s.extent),s):(i={message:"Invalid Bounds"},t.call(e,i,null,s))},e)},pixelSize:function(t){var i=e.point(t);return this.params.pixelSize=[i.x,i.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&F("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometry:function(t){return this.params.inSr=4326,t instanceof e.LatLngBounds?(this.params.geometry=I(t),void(this.params.geometryType="esriGeometryEnvelope")):(t.getLatLng&&(t=t.getLatLng()),t instanceof e.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof e.GeoJSON&&(t=t.getLayers()[0].feature.geometry,this.params.geometry=x(t),this.params.geometryType=O(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(this.params.geometry=x(t),void(this.params.geometryType=O(t.type))):void F("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),lt=at.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,s){t.call(e,i,s&&w(s),s)},e)}}),ht=at.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}}),ct=ht.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(t){var e=I(t.getBounds()),i=t.getSize();return this.params.imageDisplay=[i.x,i.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(t){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this},layerDef:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,s){if(i)t.call(e,i,void 0,s);else{var r=w(s);s.results=s.results.reverse();for(var n=0;n<r.features.length;n++)r.features[n].layerId=s.results[n].layerId;t.call(e,void 0,r,s)}})}}),pt=ht.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(t){return t=e.latLng(t),this.params.geometry=JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(t,e){return this.request(function(i,s){t.call(e,i,s&&this._responseToGeoJSON(s),s)},this)},_responseToGeoJSON:function(t){var e=t.location,i=t.catalogItems,s=t.catalogItemVisibilities,r={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:t.objectId,name:t.name,value:t.value},id:t.objectId}};if(t.properties&&t.properties.Values&&(r.pixel.properties.values=t.properties.Values),i&&i.features&&(r.catalogItems=w(i),s&&s.length===r.catalogItems.features.length))for(var n=s.length-1;n>=0;n--)r.catalogItems.features[n].properties.catalogItemVisibility=s[n];return r}}),dt=e.Evented.extend({options:{proxy:!1,useCors:Y,timeout:0},initialize:function(t){t=t||{},this._requestQueue=[],this._authenticating=!1,e.Util.setOptions(this,t),this.options.url=C(this.options.url)},get:function(t,e,i,s){return this._request("get",t,e,i,s)},post:function(t,e,i,s){return this._request("post",t,e,i,s)},request:function(t,e,i,s){return this._request("request",t,e,i,s)},metadata:function(t,e){return this._request("get","",{},t,e)},authenticate:function(t){return this._authenticating=!1,this.options.token=t,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(t){this.options.timeout=t},_request:function(t,e,i,s,r){this.fire("requeststart",{url:this.options.url+e,params:i,method:t},!0);var n=this._createServiceCallback(t,e,i,s,r);if(this.options.token&&(i.token=this.options.token),!this._authenticating){var o=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?nt[t](o,i,n,r):nt.get.JSONP(o,i,n,r)}this._requestQueue.push([t,e,i,s,r])},_createServiceCallback:function(t,i,s,r,n){return e.Util.bind(function(o,a){!o||499!==o.code&&498!==o.code||(this._authenticating=!0,this._requestQueue.push([t,i,s,r,n]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),o.authenticate=e.Util.bind(this.authenticate,this)),r.call(n,o,a),o?this.fire("requesterror",{url:this.options.url+i,params:s,message:o.message,code:o.code,method:t},!0):this.fire("requestsuccess",{url:this.options.url+i,params:s,response:a,method:t},!0),this.fire("requestend",{url:this.options.url+i,params:s,method:t},!0)},this)},_runQueue:function(){for(var t=this._requestQueue.length-1;t>=0;t--){var e=this._requestQueue[t];this[e.shift()].apply(this,e)}this._requestQueue=[]}}),mt=dt.extend({identify:function(){return B(this)},find:function(){return q(this)},query:function(){return U(this)}}),ft=dt.extend({query:function(){return U(this)},identify:function(){return z(this)}}),yt=dt.extend({options:{idAttribute:"OBJECTID"},query:function(){return U(this)},addFeature:function(t,e,i){return delete t.id,t=x(t),this.post("addFeatures",{features:[t]},function(t,s){var r=s&&s.addResults?s.addResults[0]:void 0;e&&e.call(i,t||s.addResults[0].error,r)},i)},updateFeature:function(t,e,i){return t=x(t,this.options.idAttribute),this.post("updateFeatures",{features:[t]},function(t,s){var r=s&&s.updateResults?s.updateResults[0]:void 0;e&&e.call(i,t||s.updateResults[0].error,r)},i)},deleteFeature:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},function(t,s){var r=s&&s.deleteResults?s.deleteResults[0]:void 0;e&&e.call(i,t||s.deleteResults[0].error,r)},i)},deleteFeatures:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},function(t,s){var r=s&&s.deleteResults?s.deleteResults:void 0;e&&e.call(i,t||s.deleteResults[0].error,r)},i)}}),gt="https:"!==window.location.protocol?"http:":"https:",_t=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:gt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:tt?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:gt+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(t,i){var s;if("object"==(void 0===t?"undefined":_typeof(t))&&t.urlTemplate&&t.options)s=t;else{if("string"!=typeof t||!_t.TILES[t])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');s=_t.TILES[t]}var r=e.Util.extend(s.options,i);e.Util.setOptions(this,r),this.options.token&&(s.urlTemplate+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,s.urlTemplate,r)},onAdd:function(t){k(t),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&M(this.options.attributionUrl,t),t.on("moveend",G),e.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){t.off("moveend",G),e.TileLayer.prototype.onRemove.call(this,t)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var t=this._map.createPane(this.options.pane);t.style.pointerEvents="none",t.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var t='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return t}}),vt=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(t){t.url=C(t.url),t=e.Util.setOptions(this,t),this.tileUrl=t.url+"tile/{z}/{y}/{x}",this.service=j(t),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(t.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),t.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,this.tileUrl,t)},getTileUrl:function(t){var i=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(t),x:t.x,y:t.y,z:this._lodMap&&this._lodMap[i]?this._lodMap[i]:i},this.options))},createTile:function(t,e){var i=document.createElement("img");return L.DomEvent.on(i,"load",L.bind(this._tileOnLoad,this,e,i)),L.DomEvent.on(i,"error",L.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?i.src=this.getTileUrl(t):this.once("lodmap",function(){i.src=this.getTileUrl(t)},this),i},onAdd:function(t){k(t),this._lodMap||this.metadata(function(e,i){if(!e&&i.spatialReference){var s=i.spatialReference.latestWkid||i.spatialReference.wkid;if(!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution())),t.options.crs===L.CRS.EPSG3857&&102100===s||3857===s){this._lodMap={};for(var r=i.tileInfo.lods,n=vt.MercatorZoomLevels,o=0;o<r.length;o++){var a=r[o];for(var u in n){var l=n[u];if(this._withinPercentage(a.resolution,l,this.options.zoomOffsetAllowance)){this._lodMap[u]=a.level;break}}}this.fire("lodmap")}else proj4||F("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this),e.TileLayer.prototype.onAdd.call(this,t)},metadata:function(t,e){return this.service.metadata(t,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(t){var e="?token="+t;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=t,this.service.authenticate(t),this},_withinPercentage:function(t,e,i){return Math.abs(t/e-1)<i}}),bt=e.ImageOverlay.extend({onAdd:function(t){this._topLeft=t.getPixelBounds().min,e.ImageOverlay.prototype.onAdd.call(this,t)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Lt=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Y,attribution:null,interactive:!1,alt:""},onAdd:function(t){k(t),this._update=e.Util.throttle(this._update,this.options.updateInterval,this),t.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?t.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(e,i){!e&&!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(t){this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(t,i){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=e.popup(i),this._popupFunction=t,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage&&this._currentImage.bringToBack(),this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.options.opacity=t,this._currentImage&&this._currentImage.setOpacity(t),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e){return this.options.from=t,this.options.to=e,this._update(),this},metadata:function(t,e){return this.service.metadata(t,e),this},authenticate:function(t){return this.service.authenticate(t),this},redraw:function(){this._update()},_renderImage:function(t,e,i){this._map&&(i&&(t="data:"+i+";base64,"+t),new bt(t,e,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map).once("load",function(t){if(this._map){var i=t.target,s=this._currentImage;i._bounds.equals(e)&&i._bounds.equals(this._map.getBounds())?(this._currentImage=i,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),s&&this._map&&this._map.removeLayer(s),s&&s._map&&s._map.removeLayer(s)):this._map.removeLayer(i)}this.fire("load",{bounds:e})},this),this.fire("loading",{bounds:e}))},_update:function(){if(this._map){var t=this._map.getZoom(),e=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)){if(t>this.options.maxZoom||t<this.options.minZoom)return void(this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null));var i=this._buildExportParams();this._requestExport(i,e)}}},_renderPopup:function(t,i,s,r){if(t=e.latLng(t),this._shouldRenderPopup&&this._lastClick.equals(t)){var n=this._popupFunction(i,s,r);n&&this._popup.setLatLng(t).setContent(n).openOn(this._map)}},_resetPopupState:function(t){this._shouldRenderPopup=!1,this._lastClick=t.latlng}}),xt=Lt.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(t){t.url=C(t.url),this.service=Z(t),this.service.addEventParent(this),e.Util.setOptions(this,t)},setPixelType:function(t){return this.options.pixelType=t,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(t){return e.Util.isArray(t)?this.options.bandIds=t.join(","):this.options.bandIds=t.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(t,i){return e.Util.isArray(t)?this.options.noData=t.join(","):this.options.noData=t.toString(),i&&(this.options.noDataInterpretation=i),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(t){this.options.renderingRule=t,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(t){this.options.mosaicRule=t,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(t){var i=e.Util.bind(function(i,s,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,s,r)},this),300)},this),s=this.identify().at(t.latlng);this.options.mosaicRule&&s.setMosaicRule(this.options.mosaicRule),s.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=this._map.getBounds(),e=this._map.getSize(),i=this._map.options.crs.project(t._northEast),s=this._map.options.crs.project(t._southWest),r=this._map.latLngToLayerPoint(t._northEast),n=this._map.latLngToLayerPoint(t._southWest);(r.y>0||n.y<e.y)&&(e.y=n.y-r.y);var o=parseInt(this._map.options.crs.code.split(":")[1],10),a={bbox:[s.x,s.y,i.x,i.y].join(","),size:e.x+","+e.y,format:this.options.format,transparent:this.options.transparent,bboxSR:o,imageSR:o};return this.options.from&&this.options.to&&(a.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(a.pixelType=this.options.pixelType),this.options.interpolation&&(a.interpolation=this.options.interpolation),this.options.compressionQuality&&(a.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(a.bandIds=this.options.bandIds),this.options.noData&&(a.noData=this.options.noData),this.options.noDataInterpretation&&(a.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(a.token=this.service.options.token),this.options.renderingRule&&(a.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(a.mosaicRule=JSON.stringify(this.options.mosaicRule)),a},_requestExport:function(t,i){"json"===this.options.f?this.service.request("exportImage",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this._renderImage(e.href,i))},this):(t.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(t),i))}}),St=Lt.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(t){t.url=C(t.url),this.service=j(t),this.service.addEventParent(this),(t.proxy||t.token)&&"json"!==t.f&&(t.f="json"),e.Util.setOptions(this,t)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(t){return this.options.dynamicLayers=t,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(t){return this.options.layers=t,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(t){return this.options.layerDefs=t,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(t){return this.options.timeOptions=t,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(t){var i=e.Util.bind(function(i,s,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,s,r)},this),300)},this),s=this.identify().on(this._map).at(t.latlng);s.simplify(this._map,.5),this.options.layers?s.layers("visible:"+this.options.layers.join(",")):s.layers("visible"),s.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=this._map.getBounds(),e=this._map.getSize(),i=this._map.options.crs.project(t.getNorthEast()),s=this._map.options.crs.project(t.getSouthWest()),r=parseInt(this._map.options.crs.code.split(":")[1],10),n=this._map.latLngToLayerPoint(t._northEast),o=this._map.latLngToLayerPoint(t._southWest);(n.y>0||o.y<e.y)&&(e.y=o.y-n.y);var a={bbox:[s.x,s.y,i.x,i.y].join(","),size:e.x+","+e.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:r,imageSR:r};return this.options.dynamicLayers&&(a.dynamicLayers=this.options.dynamicLayers),this.options.layers&&(a.layers="show:"+this.options.layers.join(",")),this.options.layerDefs&&(a.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(a.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(a.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(a.token=this.service.options.token),this.options.proxy&&(a.proxy=this.options.proxy),a},_requestExport:function(t,i){"json"===this.options.f?this.service.request("export",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this.options.proxy&&(e.href=this.options.proxy+"?"+e.href),e.href?this._renderImage(e.href,i):this._renderImage(e.imageData,i,e.contentType))},this):(t.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(t),i))}}),At=$.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(t){t=$.setOptions(this,t),this._zooming=!1},onAdd:function(t){this._map=t,this._update=$.Util.throttle(this._update,this.options.updateInterval,this),this._reset(),this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this),this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(t){return t.addLayer(this),this},removeFrom:function(t){return t.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells(),this._cells={},this._activeCells={},this._cellsToLoad=0,this._cellsTotal=0,this._cellNumBounds=this._getCellNumBounds(),this._resetWrap(),this._zooming=!1},_resetWrap:function(){var t=this._map,e=t.options.crs;if(!e.infinite){var i=this._getCellSize();e.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,e.wrapLng[0]]).x/i),Math.ceil(t.project([0,e.wrapLng[1]]).x/i)]),e.wrapLat&&(this._wrapLat=[Math.floor(t.project([e.wrapLat[0],0]).y/i),Math.ceil(t.project([e.wrapLat[1],0]).y/i)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._getCellSize(),i=$.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).floor());this._removeOtherCells(i),this._addCells(i),this.fire("cellsupdated")}},_addCells:function(t){var e,i,s,r=[],n=t.getCenter(),o=this._map.getZoom();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)(s=$.point(i,e)).z=o,this._isValidCell(s)&&r.push(s);var a=r.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,r.sort(function(t,e){return t.distanceTo(n)-e.distanceTo(n)}),i=0;i<a;i++)this._addCell(r[i])},_isValidCell:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._cellNumBounds;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var s=this._cellCoordsToBounds(t);return $.latLngBounds(this.options.bounds).intersects(s)},_cellCoordsToBounds:function(t){var e=this._map,i=this.options.cellSize,s=t.multiplyBy(i),r=s.add([i,i]),n=e.wrapLatLng(e.unproject(s,t.z)),o=e.wrapLatLng(e.unproject(r,t.z));return $.latLngBounds(n,o)},_cellCoordsToKey:function(t){return t.x+":"+t.y},_keyToCellCoords:function(t){var e=t.split(":"),i=parseInt(e[0],10),s=parseInt(e[1],10);return $.point(i,s)},_removeOtherCells:function(t){for(var e in this._cells)t.contains(this._keyToCellCoords(e))||this._removeCell(e)},_removeCell:function(t){var e=this._activeCells[t];e&&(delete this._activeCells[t],this.cellLeave&&this.cellLeave(e.bounds,e.coords),this.fire("cellleave",{bounds:e.bounds,coords:e.coords}))},_removeCells:function(){for(var t in this._cells){var e=this._cells[t].bounds,i=this._cells[t].coords;this.cellLeave&&this.cellLeave(e,i),this.fire("cellleave",{bounds:e,coords:i})}},_addCell:function(t){this._wrapCoords(t);var e=this._cellCoordsToKey(t),i=this._cells[e];i&&!this._activeCells[e]&&(this.cellEnter&&this.cellEnter(i.bounds,t),this.fire("cellenter",{bounds:i.bounds,coords:t}),this._activeCells[e]=i),i||(i={coords:t,bounds:this._cellCoordsToBounds(t)},this._cells[e]=i,this._activeCells[e]=i,this.createCell&&this.createCell(i.bounds,t),this.fire("cellcreate",{bounds:i.bounds,coords:t}))},_wrapCoords:function(t){t.x=this._wrapLng?$.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?$.Util.wrapNum(t.y,this._wrapLat):t.y},_getCellNumBounds:function(){var t=this._map.getPixelWorldBounds(),e=this._getCellSize();return t?$.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).ceil().subtract([1,1])):null}});K.prototype.query=function(t){var e=this.getIndex(t);return this.values[e]},K.prototype.getIndex=function(t){this.dirty&&this.sort();for(var e,i,s=0,r=this.values.length-1;s<=r;)if(e=(s+r)/2|0,+(i=this.values[Math.round(e)]).value<+t)s=e+1;else{if(!(+i.value>+t))return e;r=e-1}return Math.abs(~r)},K.prototype.between=function(t,e){var i=this.getIndex(t),s=this.getIndex(e);if(0===i&&0===s)return[];for(;this.values[i-1]&&this.values[i-1].value===t;)i--;for(;this.values[s+1]&&this.values[s+1].value===e;)s++;return this.values[s]&&this.values[s].value===e&&this.values[s+1]&&s++,this.values.slice(i,s)},K.prototype.insert=function(t){return this.values.splice(this.getIndex(t.value),0,t),this},K.prototype.bulkAdd=function(t,e){return this.values=this.values.concat([].concat(t||[])),e?this.sort():this.dirty=!0,this},K.prototype.sort=function(){return this.values.sort(function(t,e){return+e.value-+t.value}).reverse(),this.dirty=!1,this};var Tt=At.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(t){if(At.prototype.initialize.call(this,t),t.url=C(t.url),t=e.setOptions(this,t),this.service=W(t),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var i=!1,s=0;s<this.options.fields.length;s++)this.options.fields[s].match(/^(OBJECTID|FID|OID|ID)$/i)&&(i=!0);!1===i&&F("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new K,this._endTimeIndex=new K):this.options.timeField&&(this._timeIndex=new K),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(t){return k(t),this.service.metadata(function(e,i){if(!e){var s=i.supportedQueryFormats,r=!1;!1===this.service.options.isModern&&(r=!0),!r&&s&&-1!==s.indexOf("geoJSON")&&(this.service.options.isModern=!0),!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}},this),t.on("zoomend",this._handleZoomChange,this),At.prototype.onAdd.call(this,t)},onRemove:function(t){return t.off("zoomend",this._handleZoomChange,this),At.prototype.onRemove.call(this,t)},getAttribution:function(){return this.options.attribution},createCell:function(t,e){this._visibleZoom()&&this._requestFeatures(t,e)},_requestFeatures:function(t,i,s){return 1===++this._activeRequests&&this.fire("loading",{bounds:t},!0),this._buildQuery(t).run(function(r,n,o){o&&o.exceededTransferLimit&&this.fire("drawlimitexceeded"),!r&&n&&n.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(n.features,i),this._postProcessFeatures(t)},this)),r||!n||n.features.length||this._postProcessFeatures(t),r&&this._postProcessFeatures(t),s&&s.call(this,r,n)},this)},_postProcessFeatures:function(t){--this._activeRequests<=0&&this.fire("load",{bounds:t})},_cacheKey:function(t){return t.z+":"+t.x+":"+t.y},_addFeatures:function(t,e){var i=this._cacheKey(e);this._cache[i]=this._cache[i]||[];for(var s=t.length-1;s>=0;s--){var r=t[s].id;-1===this._currentSnapshot.indexOf(r)&&this._currentSnapshot.push(r),-1===this._cache[i].indexOf(r)&&this._cache[i].push(r)}this.options.timeField&&this._buildTimeIndexes(t),this.createLayers(t)},_buildQuery:function(t){var e=this.service.query().intersects(t).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.simplifyFactor&&e.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&e.between(this.options.from,this.options.to),e},setWhere:function(t,i,s){this.options.where=t&&t.length?t:"1=1";for(var r=[],n=[],o=0,a=null,u=e.Util.bind(function(t,u){if(t&&(a=t),u)for(var l=u.features.length-1;l>=0;l--)n.push(u.features[l].id);--o<=0&&(this._currentSnapshot=n,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(r),this.addLayers(n),i&&i.call(s,a)},this)))},this),l=this._currentSnapshot.length-1;l>=0;l--)r.push(this._currentSnapshot[l]);for(var h in this._activeCells){o++;var c=this._keyToCellCoords(h),p=this._cellCoordsToBounds(c);this._requestFeatures(p,h,u)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,i,s,r){var n=this.options.from,o=this.options.to,a=0,u=null,l=e.Util.bind(function(e){e&&(u=e),this._filterExistingFeatures(n,o,t,i),a--,s&&a<=0&&s.call(r,u)},this);if(this.options.from=t,this.options.to=i,this._filterExistingFeatures(n,o,t,i),"server"===this.options.timeFilterMode)for(var h in this._activeCells){a++;var c=this._keyToCellCoords(h),p=this._cellCoordsToBounds(c);this._requestFeatures(p,h,l)}return this},refresh:function(){for(var t in this._activeCells){var e=this._keyToCellCoords(t),i=this._cellCoordsToBounds(e);this._requestFeatures(i,t)}this.redraw&&this.once("load",function(){this.eachFeature(function(t){this._redraw(t.feature.id)},this)},this)},_filterExistingFeatures:function(t,i,s,r){var n=t&&i?this._getFeaturesInTimeRange(t,i):this._currentSnapshot,o=this._getFeaturesInTimeRange(s,r);if(o.indexOf)for(var a=0;a<o.length;a++){var u=n.indexOf(o[a]);u>=0&&n.splice(u,1)}e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(n),this.addLayers(o)},this))},_getFeaturesInTimeRange:function(t,e){var i,s=[];if(this.options.timeField.start&&this.options.timeField.end){var r=this._startTimeIndex.between(t,e),n=this._endTimeIndex.between(t,e);i=r.concat(n)}else i=this._timeIndex.between(t,e);for(var o=i.length-1;o>=0;o--)s.push(i[o].id);return s},_buildTimeIndexes:function(t){var e,i;if(this.options.timeField.start&&this.options.timeField.end){var s=[],r=[];for(e=t.length-1;e>=0;e--)i=t[e],s.push({id:i.id,value:new Date(i.properties[this.options.timeField.start])}),r.push({id:i.id,value:new Date(i.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(s),this._endTimeIndex.bulkAdd(r)}else{var n=[];for(e=t.length-1;e>=0;e--)i=t[e],n.push({id:i.id,value:new Date(i.properties[this.options.timeField])});this._timeIndex.bulkAdd(n)}},_featureWithinTimeRange:function(t){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),i=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var s=+t.properties[this.options.timeField];return s>=e&&s<=i}if(this.options.timeField.start&&this.options.timeField.end){var r=+t.properties[this.options.timeField.start],n=+t.properties[this.options.timeField.end];return r>=e&&r<=i||n>=e&&n<=i}},_visibleZoom:function(){if(!this._map)return!1;var t=this._map.getZoom();return!(t>this.options.maxZoom||t<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var t in this._activeCells){var e=this._activeCells[t].coords,i=this._cacheKey(e);this._cache[i]&&this.addLayers(this._cache[i])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(t){return this.service.authenticate(t),this},metadata:function(t,e){return this.service.metadata(t,e),this},query:function(){return this.service.query()},_getMetadata:function(t){if(this._metadata){t(void 0,this._metadata)}else this.metadata(e.Util.bind(function(e,i){this._metadata=i,t(e,this._metadata)},this))},addFeature:function(t,i,s){this._getMetadata(e.Util.bind(function(r,n){return r?void(i&&i.call(this,r,null)):void this.service.addFeature(t,e.Util.bind(function(e,r){e||(t.properties[n.objectIdField]=r.objectId,t.id=r.objectId,this.createLayers([t])),i&&i.call(s,e,r)},this))},this))},updateFeature:function(t,e,i){this.service.updateFeature(t,function(s,r){s||(this.removeLayers([t.id],!0),this.createLayers([t])),e&&e.call(i,s,r)},this)},deleteFeature:function(t,e,i){this.service.deleteFeature(t,function(t,s){!t&&s.objectId&&this.removeLayers([s.objectId],!0),e&&e.call(i,t,s)},this)},deleteFeatures:function(t,e,i){return this.service.deleteFeatures(t,function(t,s){if(!t&&s.length>0)for(var r=0;r<s.length;r++)this.removeLayers([s[r].objectId],!0);e&&e.call(i,t,s)},this)}}),It=Tt.extend({options:{cacheLayers:!0},initialize:function(t){Tt.prototype.initialize.call(this,t),this._originalStyle=this.options.style,this._layers={}},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return Tt.prototype.onRemove.call(this,t)},createNewLayer:function(t){var i=e.GeoJSON.geometryToLayer(t,this.options);return i.defaultOptions=i.options,i},_updateLayer:function(t,i){var s=[],r=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;switch(i.properties&&(t.feature.properties=i.properties),i.geometry.type){case"Point":s=e.GeoJSON.coordsToLatLng(i.geometry.coordinates),t.setLatLng(s);break;case"LineString":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,0,r),t.setLatLngs(s);break;case"MultiLineString":case"Polygon":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,1,r),t.setLatLngs(s);break;case"MultiPolygon":s=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,2,r),t.setLatLngs(s)}},createLayers:function(t){for(var e=t.length-1;e>=0;e--){var i,s=t[e],r=this._layers[s.id];this._visibleZoom()&&r&&!this._map.hasLayer(r)&&(this._map.addLayer(r),this.fire("addfeature",{feature:r.feature},!0)),r&&this.options.simplifyFactor>0&&(r.setLatLngs||r.setLatLng)&&this._updateLayer(r,s),r||(i=this.createNewLayer(s),i.feature=s,i.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(i.feature,i),this._layers[i.feature.id]=i,this.setFeatureStyle(i.feature.id,this.options.style),this.fire("createfeature",{feature:i.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(s))&&this._map.addLayer(i))}},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=this._layers[t[e]];i&&this._map.addLayer(i)}},removeLayers:function(t,e){for(var i=t.length-1;i>=0;i--){var s=t[i],r=this._layers[s];r&&(this.fire("removefeature",{feature:r.feature,permanent:e},!0),this._map.removeLayer(r)),r&&e&&delete this._layers[s]}},cellEnter:function(t,i){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),s=this._cache[t];this._activeCells[e]&&s&&this.addLayers(s)},this))},cellLeave:function(t,i){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),s=this._cache[t],r=this._map.getBounds();if(!this._activeCells[e]&&s){for(var n=!0,o=0;o<s.length;o++){var a=this._layers[s[o]];a&&a.getBounds&&r.intersects(a.getBounds())&&(n=!1)}n&&this.removeLayers(s,!this.options.cacheLayers),!this.options.cacheLayers&&n&&(delete this._cache[t],delete this._cells[e],delete this._activeCells[e])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(t){this.resetFeatureStyle(t.feature.id)},this),this},setStyle:function(t){return this.options.style=t,this.eachFeature(function(e){this.setFeatureStyle(e.feature.id,t)},this),this},resetFeatureStyle:function(t){var i=this._layers[t],s=this._originalStyle||L.Path.prototype.options;return i&&(e.Util.extend(i.options,i.defaultOptions),this.setFeatureStyle(t,s)),this},setFeatureStyle:function(t,e){var i=this._layers[t];return"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e),this},eachActiveFeature:function(t,e){if(this._map){var i=this._map.getBounds();for(var s in this._layers)i.intersects(this._layers[s].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[s].feature.id)&&t.call(e,this._layers[s])}return this},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]},bringToBack:function(){this.eachFeature(function(t){t.bringToBack&&t.bringToBack()})},bringToFront:function(){this.eachFeature(function(t){t.bringToFront&&t.bringToFront()})},redraw:function(t){return t&&this._redraw(t),this},_redraw:function(t){var i=this._layers[t],s=i.feature;if(i&&i.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var r=this.options.pointToLayer(s,e.latLng(s.geometry.coordinates[1],s.geometry.coordinates[0])).options.icon;i.setIcon(r)}if(i&&i.setStyle&&this.options.pointToLayer){var n=this.options.pointToLayer(s,e.latLng(s.geometry.coordinates[1],s.geometry.coordinates[0])).options;this.setFeatureStyle(s.id,n)}i&&i.setStyle&&this.options.style&&this.resetStyle(s.id)}});t.VERSION="2.0.8",t.Support=et,t.options=it,t.Util=ot,t.get=rt,t.post=r,t.request=o,t.Task=at,t.task=E,t.Query=ut,t.query=U,t.Find=lt,t.find=q,t.Identify=ht,t.identify=D,t.IdentifyFeatures=ct,t.identifyFeatures=B,t.IdentifyImage=pt,t.identifyImage=z,t.Service=dt,t.service=N,t.MapService=mt,t.mapService=j,t.ImageService=ft,t.imageService=Z,t.FeatureLayerService=yt,t.featureLayerService=W,t.BasemapLayer=_t,t.basemapLayer=J,t.TiledMapLayer=vt,t.tiledMapLayer=Q,t.RasterLayer=Lt,t.ImageMapLayer=xt,t.imageMapLayer=H,t.DynamicMapLayer=St,t.dynamicMapLayer=V,t.FeatureManager=Tt,t.FeatureLayer=It,t.featureLayer=X});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/togeojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},toGeoJSON=function(){"use strict";function e(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function t(e,t){return e.getElementsByTagName(t)}function r(e,t){return e.getAttribute(t)}function n(e,t){return parseFloat(r(e,t))}function o(e,r){var n=t(e,r);return n.length?n[0]:null}function i(e){return e.normalize&&e.normalize(),e}function a(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function s(e){return e&&i(e),e&&e.textContent||""}function l(e,t){var r,n,i={};for(n=0;n<t.length;n++)(r=o(e,t[n]))&&(i[t[n]]=s(r));return i}function u(e,t){for(var r in t)e[r]=t[r]}function f(e){return a(e.replace(y,"").split(","))}function p(e){for(var t=e.replace(m,"").split(d),r=[],n=0;n<t.length;n++)r.push(f(t[n]));return r}function c(e){var t,r=[n(e,"lon"),n(e,"lat")],i=o(e,"ele"),a=o(e,"gpxtpx:hr")||o(e,"hr"),l=o(e,"time");return i&&(t=parseFloat(s(i)),isNaN(t)||r.push(t)),{coordinates:r,time:l?s(l):null,heartRate:a?parseFloat(s(a)):null}}function h(e){return void 0!==e.xml?e.xml:g.serializeToString(e)}var g,y=/\s*/g,m=/^\s*|\s*$/g,d=/\s+/;return"undefined"!=typeof XMLSerializer?g=new XMLSerializer:"object"!==("undefined"==typeof exports?"undefined":_typeof(exports))||"object"!==("undefined"==typeof process?"undefined":_typeof(process))||process.browser||(g=new(require("xmldom").XMLSerializer)),{kml:function(n){function i(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function l(e){return a(e.split(" "))}function u(e){var r=t(e,"coord","gx"),n=[],o=[];0===r.length&&(r=t(e,"gx:coord"));for(var i=0;i<r.length;i++)n.push(l(s(r[i])));for(var a=t(e,"when"),u=0;u<a.length;u++)o.push(s(a[u]));return{coords:n,times:o}}function c(e){var r,n,i,a,l,h=[],g=[];if(o(e,"MultiGeometry"))return c(o(e,"MultiGeometry"));if(o(e,"MultiTrack"))return c(o(e,"MultiTrack"));if(o(e,"gx:MultiTrack"))return c(o(e,"gx:MultiTrack"));for(i=0;i<v.length;i++)if(n=t(e,v[i]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===v[i])h.push({type:"Point",coordinates:f(s(o(r,"coordinates")))});else if("LineString"===v[i])h.push({type:"LineString",coordinates:p(s(o(r,"coordinates")))});else if("Polygon"===v[i]){var y=t(r,"LinearRing"),m=[];for(l=0;l<y.length;l++)m.push(p(s(o(y[l],"coordinates"))));h.push({type:"Polygon",coordinates:m})}else if("Track"===v[i]||"gx:Track"===v[i]){var d=u(r);h.push({type:"LineString",coordinates:d.coords}),d.times.length&&g.push(d.times)}return{geoms:h,coordTimes:g}}for(var g={type:"FeatureCollection",features:[]},y={},m={},d={},v=["Polygon","LineString","Point","Track","gx:Track"],S=t(n,"Placemark"),k=t(n,"Style"),b=t(n,"StyleMap"),x=0;x<k.length;x++){var T=e(h(k[x])).toString(16);y["#"+r(k[x],"id")]=T,m[T]=k[x]}for(var N=0;N<b.length;N++){y["#"+r(b[N],"id")]=e(h(b[N])).toString(16);for(var F=t(b[N],"Pair"),L={},M=0;M<F.length;M++)L[s(o(F[M],"key"))]=s(o(F[M],"styleUrl"));d["#"+r(b[N],"id")]=L}for(var w=0;w<S.length;w++)g.features=g.features.concat(function(e){var n,a=c(e),l={},u=s(o(e,"name")),f=s(o(e,"address")),p=s(o(e,"styleUrl")),h=s(o(e,"description")),g=o(e,"TimeSpan"),v=o(e,"TimeStamp"),S=o(e,"ExtendedData"),k=o(e,"LineStyle"),b=o(e,"PolyStyle"),x=o(e,"visibility");if(!a.geoms.length)return[];if(u&&(l.name=u),f&&(l.address=f),p){"#"!==p[0]&&(p="#"+p),l.styleUrl=p,y[p]&&(l.styleHash=y[p]),d[p]&&(l.styleMapHash=d[p],l.styleHash=y[d[p].normal]);var T=m[l.styleHash];T&&(k||(k=o(T,"LineStyle")),b||(b=o(T,"PolyStyle")))}if(h&&(l.description=h),g){var N=s(o(g,"begin")),F=s(o(g,"end"));l.timespan={begin:N,end:F}}if(v&&(l.timestamp=s(o(v,"when"))),k){var L=i(s(o(k,"color"))),M=L[0],w=L[1],P=parseFloat(s(o(k,"width")));M&&(l.stroke=M),isNaN(w)||(l["stroke-opacity"]=w),isNaN(P)||(l["stroke-width"]=P)}if(b){var R=i(s(o(b,"color"))),z=R[0],C=R[1],G=s(o(b,"fill")),A=s(o(b,"outline"));z&&(l.fill=z),isNaN(C)||(l["fill-opacity"]=C),G&&(l["fill-opacity"]="1"===G?l["fill-opacity"]||1:0),A&&(l["stroke-opacity"]="1"===A?l["stroke-opacity"]||1:0)}if(S){var H=t(S,"Data"),D=t(S,"SimpleData");for(n=0;n<H.length;n++)l[H[n].getAttribute("name")]=s(o(H[n],"value"));for(n=0;n<D.length;n++)l[D[n].getAttribute("name")]=s(D[n])}x&&(l.visibility=s(x)),a.coordTimes.length&&(l.coordTimes=1===a.coordTimes.length?a.coordTimes[0]:a.coordTimes);var U={type:"Feature",geometry:1===a.geoms.length?a.geoms[0]:{type:"GeometryCollection",geometries:a.geoms},properties:l};return r(e,"id")&&(U.id=r(e,"id")),[U]}(S[w]));return g},gpx:function(e){function n(e,r){var n=t(e,r),o=[],i=[],a=[],s=n.length;if(s<2)return{};for(var l=0;l<s;l++){var u=c(n[l]);o.push(u.coordinates),u.time&&i.push(u.time),u.heartRate&&a.push(u.heartRate)}return{line:o,times:i,heartRates:a}}function i(e){var t={};if(e){var r=o(e,"line");if(r){var n=s(o(r,"color")),i=parseFloat(s(o(r,"opacity"))),a=parseFloat(s(o(r,"width")));n&&(t.stroke=n),isNaN(i)||(t["stroke-opacity"]=i),isNaN(a)||(t["stroke-width"]=96*a/25.4)}}return t}function a(e){var n=l(e,["name","cmt","desc","type","time","keywords"]),o=t(e,"link");o.length&&(n.links=[]);for(var i,a=0;a<o.length;a++)u(i={href:r(o[a],"href")},l(o[a],["text","type"])),n.links.push(i);return n}var f,p,h=t(e,"trk"),g=t(e,"rte"),y=t(e,"wpt"),m={type:"FeatureCollection",features:[]};for(f=0;f<h.length;f++)(p=function(e){for(var r,s=t(e,"trkseg"),l=[],f=[],p=[],c=0;c<s.length;c++)(r=n(s[c],"trkpt"))&&(r.line&&l.push(r.line),r.times&&r.times.length&&f.push(r.times),r.heartRates&&r.heartRates.length&&p.push(r.heartRates));if(0!==l.length){var h=a(e);return u(h,i(o(e,"extensions"))),f.length&&(h.coordTimes=1===l.length?f[0]:f),p.length&&(h.heartRates=1===l.length?p[0]:p),{type:"Feature",properties:h,geometry:{type:1===l.length?"LineString":"MultiLineString",coordinates:1===l.length?l[0]:l}}}}(h[f]))&&m.features.push(p);for(f=0;f<g.length;f++)(p=function(e){var t=n(e,"rtept");if(t.line){var r=a(e);return u(r,i(o(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}(g[f]))&&m.features.push(p);for(f=0;f<y.length;f++)m.features.push(function(e){var t=a(e);return u(t,l(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:c(e).coordinates}}}(y[f]));return m}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
</script>

    <script>
      if (!console) {
        window.console = { log: function () { }, warn: function() {}, error: function () {}};
      }
    </script>

    <!-- OUR SYSTEM CODE -->

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/zero-clipboard/ZeroClipboard.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"use strict";var n,r,a,o=e,i=o.document,l=o.navigator,s=o.setTimeout,c=o.clearTimeout,d=o.setInterval,u=o.clearInterval,f=o.getComputedStyle,p=o.encodeURIComponent,h=o.ActiveXObject,y=o.Error,m=o.Number.parseInt||o.parseInt,v=o.Number.parseFloat||o.parseFloat,b=o.Number.isNaN||o.isNaN,g=o.Date.now,w=o.Object.keys,x=o.Object.prototype.hasOwnProperty,C=o.Array.prototype.slice,E=function(){var e=function(e){return e};if("function"==typeof o.wrap&&"function"==typeof o.unwrap)try{var t=i.createElement("div"),n=o.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=o.unwrap)}catch(e){}return e}(),T=function(e){return C.call(e,0)},j=function(){var e,t,n,r,a,o=T(arguments),i=o[0]||{};for(e=1,t=o.length;e<t;e++)if(null!=(n=o[e]))for(r in n)x.call(n,r)&&(i[r],i!==(a=n[r])&&void 0!==a&&(i[r]=a));return i},_=function e(t){var n,r,a,o;if("object"!==(void 0===t?"undefined":_typeof(t))||null==t||"number"==typeof t.nodeType)n=t;else if("number"==typeof t.length)for(n=[],r=0,a=t.length;r<a;r++)x.call(t,r)&&(n[r]=e(t[r]));else{n={};for(o in t)x.call(t,o)&&(n[o]=e(t[o]))}return n},D=function(e,t){for(var n={},r=0,a=t.length;r<a;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},k=function(e,t){var n={};for(var r in e)-1===t.indexOf(r)&&(n[r]=e[r]);return n},O=function(e){if(e)for(var t in e)x.call(e,t)&&delete e[t];return e},I=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},N=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},S=function(e){var t,n;return"string"==typeof e&&e&&((n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]&&(t=n[1])),t},L=function(){var e,t;try{throw new y}catch(e){t=e}return t&&(e=t.sourceURL||t.fileName||S(t.stack)),e},A=function(){var e,t,n;if(i.currentScript&&(e=i.currentScript.src))return e;if(1===(t=i.getElementsByTagName("script")).length)return t[0].src||void 0;if("readyState"in(t[0]||document.createElement("script")))for(n=t.length;n--;)if("interactive"===t[n].readyState&&(e=t[n].src))return e;return"loading"===i.readyState&&(e=t[t.length-1].src)?e:(e=L())?e:void 0},F=function(){var e,t,n,r=i.getElementsByTagName("script");for(e=r.length;e--;){if(!(n=r[e].src)){t=null;break}if(n=N(n),null==t)t=n;else if(t!==n){t=null;break}}return t||void 0},z=function(){var e=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!l&&(e.test(l.appVersion||"")||e.test(l.platform||"")||-1!==(l.userAgent||"").indexOf("Windows"))},Z=function(){return null==o.opener&&(!!o.top&&o!=o.top||!!o.parent&&o!=o.parent)}(),V="html"===i.documentElement.nodeName,$={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},X={},M={},Y=null,H=0,P=0,B={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}},R=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],W=["flash-sandboxed","flash-disabled","flash-outdated","flash-insecure","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],J=new RegExp("^flash-("+W.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),K=new RegExp("^flash-("+W.filter(function(e){return"flash-disabled"!==e}).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),U={swfPath:function(){return(N(A())||F()||"")+"ZeroClipboard.swf"}(),trustedDomains:o.location.host?[o.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},q=function(e){"object"!==(void 0===e?"undefined":_typeof(e))||!e||"length"in e||w(e).forEach(function(t){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(t))U[t]=e[t];else if(null==$.bridge)if("containerId"===t||"swfObjectId"===t){if(!he(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");U[t]=e[t]}else U[t]=e[t]});if("string"!=typeof e||!e)return _(U);if(x.call(U,e))return U[e]},G=function(){return Je(),{browser:j(D(l,["userAgent","platform","appName","appVersion"]),{isSupported:Q()}),flash:k($,["bridge"]),zeroclipboard:{version:Ue.version,config:Ue.config()}}},Q=function(){return!!(i.addEventListener&&o.Object.keys&&o.Array.prototype.map)},ee=function(){return!!($.sandboxed||$.disabled||$.outdated||$.unavailable||$.degraded||$.deactivated)},te=function(e,t){var r,a,o,i={};if("string"==typeof e&&e?o=e.toLowerCase().split(/\s+/):"object"!==(void 0===e?"undefined":_typeof(e))||!e||"length"in e||void 0!==t||w(e).forEach(function(t){var n=e[t];"function"==typeof n&&Ue.on(t,n)}),o&&o.length&&t){for(r=0,a=o.length;r<a;r++)i[e=o[r].replace(/^on/,"")]=!0,X[e]||(X[e]=[]),X[e].push(t);if(i.ready&&$.ready&&Ue.emit({type:"ready"}),i.error){for(Q()||Ue.emit({type:"error",name:"browser-unsupported"}),r=0,a=W.length;r<a;r++)if(!0===$[W[r].replace(/^flash-/,"")]){Ue.emit({type:"error",name:W[r]});break}void 0!==n&&Ue.version!==n&&Ue.emit({type:"error",name:"version-mismatch",jsVersion:Ue.version,swfVersion:n})}}return Ue},ne=function(e,t){var n,r,a,o,i;if(0===arguments.length?o=w(X):"string"==typeof e&&e?o=e.toLowerCase().split(/\s+/):"object"!==(void 0===e?"undefined":_typeof(e))||!e||"length"in e||void 0!==t||w(e).forEach(function(t){var n=e[t];"function"==typeof n&&Ue.off(t,n)}),o&&o.length)for(n=0,r=o.length;n<r;n++)if(e=o[n].replace(/^on/,""),(i=X[e])&&i.length)if(t)for(a=i.indexOf(t);-1!==a;)i.splice(a,1),a=i.indexOf(t,a);else i.length=0;return Ue},re=function(e){return"string"==typeof e&&e?_(X[e])||null:_(X)},ae=function(e){var t,n,r;if((e=ye(e))&&!Ce(e))return"ready"===e.type&&!0===$.overdue?Ue.emit({type:"error",name:"flash-overdue"}):(t=j({},e),we.call(this,t),"copy"===e.type&&(n=(r=Ne(M)).data,Y=r.formatMap),n)},oe=function(){var e=U.swfPath||"",t=e.slice(0,2),n=e.slice(0,e.indexOf("://")+1);return"\\\\"===t?"file:":"//"===t||""===n?o.location.protocol:n},ie=function(){var e,t,n=$.sandboxed;if(!Q())return $.ready=!1,void Ue.emit({type:"error",name:"browser-unsupported"});Je(),"boolean"!=typeof $.ready&&($.ready=!1),$.sandboxed!==n&&!0===$.sandboxed?($.ready=!1,Ue.emit({type:"error",name:"flash-sandboxed"})):Ue.isFlashUnusable()||null!==$.bridge||((t=oe())&&t!==o.location.protocol?Ue.emit({type:"error",name:"flash-insecure"}):("number"==typeof(e=U.flashLoadTimeout)&&e>=0&&(H=s(function(){"boolean"!=typeof $.deactivated&&($.deactivated=!0),!0===$.deactivated&&Ue.emit({type:"error",name:"flash-deactivated"})},e)),$.overdue=!1,Oe()))},le=function(){Ue.clearData(),Ue.blur(),Ue.emit("destroy"),Ie(),Ue.off()},se=function(e,t){var n;if("object"===(void 0===e?"undefined":_typeof(e))&&e&&void 0===t)n=e,Ue.clearData();else{if("string"!=typeof e||!e)return;(n={})[e]=t}for(var r in n)"string"==typeof r&&r&&x.call(n,r)&&"string"==typeof n[r]&&n[r]&&(M[r]=We(n[r]))},ce=function(e){void 0===e?(O(M),Y=null):"string"==typeof e&&x.call(M,e)&&delete M[e]},de=function(e){return void 0===e?_(M):"string"==typeof e&&x.call(M,e)?M[e]:void 0},ue=function(e){if(e&&1===e.nodeType){r&&($e(r,U.activeClass),r!==e&&$e(r,U.hoverClass)),r=e,Ve(e,U.hoverClass);var t=e.getAttribute("title")||U.title;if("string"==typeof t&&t){var n=De($.bridge);n&&n.setAttribute("title",t)}var a=!0===U.forceHandCursor||"pointer"===Xe(e,"cursor");Be(a),Pe()}},fe=function(){var e=De($.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),r&&($e(r,U.hoverClass),$e(r,U.activeClass),r=null)},pe=function(){return r||null},he=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},ye=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"===(void 0===e?"undefined":_typeof(e))&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=a),j(e,{type:t,target:e.target||r||null,relatedTarget:e.relatedTarget||null,currentTarget:$&&$.bridge||null,timeStamp:e.timeStamp||g()||null});var n=B[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&j(e,{target:null,version:$.version}),"error"===e.type&&(J.test(e.name)&&j(e,{target:null,minimumVersion:"11.0.0"}),K.test(e.name)&&j(e,{version:$.version}),"flash-insecure"===e.name&&j(e,{pageProtocol:o.location.protocol,swfProtocol:oe()})),"copy"===e.type&&(e.clipboardData={setData:Ue.setData,clearData:Ue.clearData}),"aftercopy"===e.type&&(e=Se(e,Y)),e.target&&!e.relatedTarget&&(e.relatedTarget=me(e.target)),ve(e)}},me=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?i.getElementById(t):null},ve=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,n="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:void 0,r="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:void 0,a=Me(t),l=o.screenLeft||o.screenX||0,s=o.screenTop||o.screenY||0,c=i.body.scrollLeft+i.documentElement.scrollLeft,d=i.body.scrollTop+i.documentElement.scrollTop,u=a.left+("number"==typeof e._stageX?e._stageX:0),f=a.top+("number"==typeof e._stageY?e._stageY:0),p=u-c,h=f-d,y=l+p,m=s+h,v="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,j(e,{srcElement:t,fromElement:n,toElement:r,screenX:y,screenY:m,pageX:u,pageY:f,clientX:p,clientY:h,x:p,y:h,movementX:v,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},be=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},ge=function(e,t,n,r){r?s(function(){e.apply(t,n)},0):e.apply(t,n)},we=function(e){if("object"===(void 0===e?"undefined":_typeof(e))&&e&&e.type){var t=be(e),n=X["*"]||[],r=X[e.type]||[],a=n.concat(r);if(a&&a.length){var i,l,s,c,d,u=this;for(i=0,l=a.length;i<l;i++)c=u,"string"==typeof(s=a[i])&&"function"==typeof o[s]&&(s=o[s]),"object"===(void 0===s?"undefined":_typeof(s))&&s&&"function"==typeof s.handleEvent&&(c=s,s=s.handleEvent),"function"==typeof s&&(d=j({},e),ge(s,c,[d],t))}return this}},xe=function(e){var t=null;return(!1===Z||e&&"error"===e.type&&e.name&&-1!==R.indexOf(e.name))&&(t=!1),t},Ce=function(e){var t=e.target||r||null,o="swf"===e._source;switch(delete e._source,e.type){case"error":var i="flash-sandboxed"===e.name||xe(e);"boolean"==typeof i&&($.sandboxed=i),"browser-unsupported"===e.name?j($,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):-1!==W.indexOf(e.name)?j($,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,insecure:"flash-insecure"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(n=e.swfVersion,j($,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),He();break;case"ready":n=e.swfVersion;var l=!0===$.deactivated;j($,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:l,ready:!l}),He();break;case"beforecopy":a=t;break;case"copy":var s,c,d=e.relatedTarget;!M["text/html"]&&!M["text/plain"]&&d&&(c=d.value||d.outerHTML||d.innerHTML)&&(s=d.value||d.textContent||d.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s),c!==s&&e.clipboardData.setData("text/html",c)):!M["text/plain"]&&e.target&&(s=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s));break;case"aftercopy":Ee(e),Ue.clearData(),t&&t!==Ze()&&t.focus&&t.focus();break;case"_mouseover":Ue.focus(t),!0===U.bubbleEvents&&o&&(t&&t!==e.relatedTarget&&!I(e.relatedTarget,t)&&Te(j({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),Te(j({},e,{type:"mouseover"})));break;case"_mouseout":Ue.blur(),!0===U.bubbleEvents&&o&&(t&&t!==e.relatedTarget&&!I(e.relatedTarget,t)&&Te(j({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),Te(j({},e,{type:"mouseout"})));break;case"_mousedown":Ve(t,U.activeClass),!0===U.bubbleEvents&&o&&Te(j({},e,{type:e.type.slice(1)}));break;case"_mouseup":$e(t,U.activeClass),!0===U.bubbleEvents&&o&&Te(j({},e,{type:e.type.slice(1)}));break;case"_click":a=null,!0===U.bubbleEvents&&o&&Te(j({},e,{type:e.type.slice(1)}));break;case"_mousemove":!0===U.bubbleEvents&&o&&Te(j({},e,{type:e.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type))return!0},Ee=function(e){if(e.errors&&e.errors.length>0){var t=_(e);j(t,{type:"error",name:"clipboard-error"}),delete t.success,s(function(){Ue.emit(t)},0)}},Te=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,r=n&&n.ownerDocument||i,a={view:r.defaultView||o,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:r.createEvent?0:1},l=j(a,e);n&&r.createEvent&&n.dispatchEvent&&(l=[l.type,l.canBubble,l.cancelable,l.view,l.detail,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget],(t=r.createEvent("MouseEvents")).initMouseEvent&&(t.initMouseEvent.apply(t,l),t._source="js",n.dispatchEvent(t)))}},je=function(){var e=U.flashLoadTimeout;if("number"==typeof e&&e>=0){var t=Math.min(1e3,e/10),n=U.swfObjectId+"_fallbackContent";P=d(function(){var e=i.getElementById(n);Ye(e)&&(He(),$.deactivated=null,Ue.emit({type:"error",name:"swf-not-found"}))},t)}},_e=function(){var e=i.createElement("div");return e.id=U.containerId,e.className=U.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Re(U.zIndex),e},De=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},ke=function(e){return"string"==typeof e&&e?e.replace(/["&'<>]/g,function(e){switch(e){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"<":return"&lt;";case">":return"&gt;";default:return e}}):e},Oe=function(){var e,t=$.bridge,n=De(t);if(!t){var r=ze(o.location.host,U),a="never"===r?"none":"all",l=Ae(j({jsVersion:Ue.version},U)),s=U.swfPath+Le(U.swfPath,U);V&&(s=ke(s)),n=_e();var c=i.createElement("div");n.appendChild(c),i.body.appendChild(n);var d=i.createElement("div"),u="activex"===$.pluginType;d.innerHTML='<object id="'+U.swfObjectId+'" name="'+U.swfObjectId+'" width="100%" height="100%" '+(u?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+s+'"')+">"+(u?'<param name="movie" value="'+s+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+a+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+l+'"/><div id="'+U.swfObjectId+'_fallbackContent">&nbsp;</div></object>',t=d.firstChild,d=null,E(t).ZeroClipboard=Ue,n.replaceChild(t,c),je()}return t||((t=i[U.swfObjectId])&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),$.bridge=t||null,t},Ie=function(){var e=$.bridge;if(e){var t=De(e);t&&("activex"===$.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var r in e)"function"==typeof e[r]&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else s(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),He(),$.ready=null,$.bridge=null,$.deactivated=null,$.insecure=null,n=void 0}},Ne=function(e){var t={},n={};if("object"===(void 0===e?"undefined":_typeof(e))&&e){for(var r in e)if(r&&x.call(e,r)&&"string"==typeof e[r]&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r}return{data:t,formatMap:n}}},Se=function(e,t){if("object"!==(void 0===e?"undefined":_typeof(e))||!e||"object"!==(void 0===t?"undefined":_typeof(t))||!t)return e;var n={};for(var r in e)if(x.call(e,r))if("errors"===r){n[r]=e[r]?e[r].slice():[];for(var a=0,o=n[r].length;a<o;a++)n[r][a].format=t[n[r][a].format]}else if("success"!==r&&"data"!==r)n[r]=e[r];else{n[r]={};var i=e[r];for(var l in i)l&&x.call(i,l)&&x.call(t,l)&&(n[r][t[l]]=i[l])}return n},Le=function(e,t){return null==t||t&&!0===t.cacheBust?(-1===e.indexOf("?")?"?":"&")+"noCache="+g():""},Ae=function(e){var t,n,r,a,i="",l=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?a=[e.trustedDomains]:"object"===_typeof(e.trustedDomains)&&"length"in e.trustedDomains&&(a=e.trustedDomains)),a&&a.length)for(t=0,n=a.length;t<n;t++)if(x.call(a,t)&&a[t]&&"string"==typeof a[t]){if(!(r=Fe(a[t])))continue;if("*"===r){l.length=0,l.push(r);break}l.push.apply(l,[r,"//"+r,o.location.protocol+"//"+r])}return l.length&&(i+="trustedOrigins="+p(l.join(","))),!0===e.forceEnhancedClipboard&&(i+=(i?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(i+=(i?"&":"")+"swfObjectId="+p(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(i+=(i?"&":"")+"jsVersion="+p(e.jsVersion)),i},Fe=function(e){if(null==e||""===e)return null;if(""===(e=e.replace(/^\s+|\s+$/g,"")))return null;var t=e.indexOf("//"),n=(e=-1===t?e:e.slice(t+2)).indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},ze=function(){var e=function(e){var t,n,r,a=[];if("string"==typeof e&&(e=[e]),"object"!==(void 0===e?"undefined":_typeof(e))||!e||"number"!=typeof e.length)return a;for(t=0,n=e.length;t<n;t++)if(x.call(e,t)&&(r=Fe(e[t]))){if("*"===r){a.length=0,a.push("*");break}-1===a.indexOf(r)&&a.push(r)}return a};return function(t,n){var r=Fe(n.swfPath);null===r&&(r=t);var a=e(n.trustedDomains),o=a.length;if(o>0){if(1===o&&"*"===a[0])return"always";if(-1!==a.indexOf(t))return 1===o&&t===r?"sameDomain":"always"}return"never"}}(),Ze=function(){try{return i.activeElement}catch(e){return null}},Ve=function(e,t){var n,r,a,o=[];if("string"==typeof t&&t&&(o=t.split(/\s+/)),e&&1===e.nodeType&&o.length>0){for(a=(" "+(e.className||"")+" ").replace(/[\t\r\n\f]/g," "),n=0,r=o.length;n<r;n++)-1===a.indexOf(" "+o[n]+" ")&&(a+=o[n]+" ");(a=a.replace(/^\s+|\s+$/g,""))!==e.className&&(e.className=a)}return e},$e=function(e,t){var n,r,a,o=[];if("string"==typeof t&&t&&(o=t.split(/\s+/)),e&&1===e.nodeType&&o.length>0&&e.className){for(a=(" "+e.className+" ").replace(/[\t\r\n\f]/g," "),n=0,r=o.length;n<r;n++)a=a.replace(" "+o[n]+" "," ");(a=a.replace(/^\s+|\s+$/g,""))!==e.className&&(e.className=a)}return e},Xe=function(e,t){var n=f(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Me=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),r=o.pageXOffset,a=o.pageYOffset,l=i.documentElement.clientLeft||0,s=i.documentElement.clientTop||0,c=0,d=0;if("relative"===Xe(i.body,"position")){var u=i.body.getBoundingClientRect(),f=i.documentElement.getBoundingClientRect();c=u.left-f.left||0,d=u.top-f.top||0}t.left=n.left+r-l-c,t.top=n.top+a-s-d,t.width="width"in n?n.width:n.right-n.left,t.height="height"in n?n.height:n.bottom-n.top}return t},Ye=function(e){if(!e)return!1;var t=f(e,null);if(!t)return!1;var n=v(t.height)>0,r=v(t.width)>0,a=v(t.top)>=0,o=v(t.left)>=0,i=n&&r&&a&&o,l=i?null:Me(e);return"none"!==t.display&&"collapse"!==t.visibility&&(i||!!l&&(n||l.height>0)&&(r||l.width>0)&&(a||l.top>=0)&&(o||l.left>=0))},He=function(){c(H),H=0,u(P),P=0},Pe=function(){var e;if(r&&(e=De($.bridge))){var t=Me(r);j(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Re(U.zIndex)})}},Be=function(e){!0===$.ready&&($.bridge&&"function"==typeof $.bridge.setHandCursor?$.bridge.setHandCursor(e):$.ready=!1)},Re=function e(t){if(/^(?:auto|inherit)$/.test(t))return t;var n;return"number"!=typeof t||b(t)?"string"==typeof t&&(n=e(m(t,10))):n=t,"number"==typeof n?n:"auto"},We=function(e){var t=/(\r\n|\r|\n)/g;return"string"==typeof e&&!0===U.fixLineEndings&&(z()?/((^|[^\r])\n|\r([^\n]|$))/.test(e)&&(e=e.replace(t,"\r\n")):/\r/.test(e)&&(e=e.replace(t,"\n"))),e},Je=function(t){var n,r,a,o=$.sandboxed,i=null;if(t=!0===t,!1===Z)i=!1;else{try{r=e.frameElement||null}catch(e){a={name:e.name,message:e.message}}if(r&&1===r.nodeType&&"IFRAME"===r.nodeName)try{i=r.hasAttribute("sandbox")}catch(e){i=null}else{try{n=document.domain||null}catch(e){n=null}(null===n||a&&"SecurityError"===a.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(a.message.toLowerCase()))&&(i=!0)}}return $.sandboxed=i,o===i||t||Ke(h),i},Ke=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function r(e){e&&(i=!0,e.version&&(d=t(e.version)),!d&&e.description&&(d=t(e.description)),e.filename&&(c=n(e.filename)))}var a,o,i=!1,s=!1,c=!1,d="";if(l.plugins&&l.plugins.length)r(l.plugins["Shockwave Flash"]),l.plugins["Shockwave Flash 2.0"]&&(i=!0,d="2.0.0.11");else if(l.mimeTypes&&l.mimeTypes.length)r((o=l.mimeTypes["application/x-shockwave-flash"])&&o.enabledPlugin);else if(void 0!==e){s=!0;try{a=new e("ShockwaveFlash.ShockwaveFlash.7"),i=!0,d=t(a.GetVariable("$version"))}catch(n){try{a=new e("ShockwaveFlash.ShockwaveFlash.6"),i=!0,d="6.0.21"}catch(n){try{a=new e("ShockwaveFlash.ShockwaveFlash"),i=!0,d=t(a.GetVariable("$version"))}catch(e){s=!1}}}}$.disabled=!0!==i,$.outdated=d&&v(d)<v("11.0.0"),$.version=d||"0.0.0",$.pluginType=c?"pepper":s?"activex":i?"netscape":"unknown"};Ke(h),Je(!0);var Ue=function e(){if(!(this instanceof e))return new e;"function"==typeof e._createClient&&e._createClient.apply(this,T(arguments))};Ue.version="2.3.0",Ue.config=function(){return q.apply(this,T(arguments))},Ue.state=function(){return G.apply(this,T(arguments))},Ue.isFlashUnusable=function(){return ee.apply(this,T(arguments))},Ue.on=function(){return te.apply(this,T(arguments))},Ue.off=function(){return ne.apply(this,T(arguments))},Ue.handlers=function(){return re.apply(this,T(arguments))},Ue.emit=function(){return ae.apply(this,T(arguments))},Ue.create=function(){return ie.apply(this,T(arguments))},Ue.destroy=function(){return le.apply(this,T(arguments))},Ue.setData=function(){return se.apply(this,T(arguments))},Ue.clearData=function(){return ce.apply(this,T(arguments))},Ue.getData=function(){return de.apply(this,T(arguments))},Ue.focus=Ue.activate=function(){return ue.apply(this,T(arguments))},Ue.blur=Ue.deactivate=function(){return fe.apply(this,T(arguments))},Ue.activeElement=function(){return pe.apply(this,T(arguments))};var qe=0,Ge={},Qe=0,et={},tt={};j(U,{autoActivate:!0});var nt=function(e){var t,n=this;n.id=""+qe++,t={instance:n,elements:[],handlers:{},coreWildcardHandler:function(e){return n.emit(e)}},Ge[n.id]=t,e&&n.clip(e),Ue.on("*",t.coreWildcardHandler),Ue.on("destroy",function(){n.destroy()}),Ue.create()},rt=function(e,t){var r,a,o,i={},l=this,s=Ge[l.id],c=s&&s.handlers;if(!s)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e?o=e.toLowerCase().split(/\s+/):"object"!==(void 0===e?"undefined":_typeof(e))||!e||"length"in e||void 0!==t||w(e).forEach(function(t){var n=e[t];"function"==typeof n&&l.on(t,n)}),o&&o.length&&t){for(r=0,a=o.length;r<a;r++)i[e=o[r].replace(/^on/,"")]=!0,c[e]||(c[e]=[]),c[e].push(t);if(i.ready&&$.ready&&this.emit({type:"ready",client:this}),i.error){for(r=0,a=W.length;r<a;r++)if($[W[r].replace(/^flash-/,"")]){this.emit({type:"error",name:W[r],client:this});break}void 0!==n&&Ue.version!==n&&this.emit({type:"error",name:"version-mismatch",jsVersion:Ue.version,swfVersion:n})}}return l},at=function(e,t){var n,r,a,o,i,l=this,s=Ge[l.id],c=s&&s.handlers;if(!c)return l;if(0===arguments.length?o=w(c):"string"==typeof e&&e?o=e.split(/\s+/):"object"!==(void 0===e?"undefined":_typeof(e))||!e||"length"in e||void 0!==t||w(e).forEach(function(t){var n=e[t];"function"==typeof n&&l.off(t,n)}),o&&o.length)for(n=0,r=o.length;n<r;n++)if(e=o[n].toLowerCase().replace(/^on/,""),(i=c[e])&&i.length)if(t)for(a=i.indexOf(t);-1!==a;)i.splice(a,1),a=i.indexOf(t,a);else i.length=0;return l},ot=function(e){var t=null,n=Ge[this.id]&&Ge[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:_(n)),t},it=function(e){var t,n=this;return ut.call(n,e)&&("object"===(void 0===e?"undefined":_typeof(e))&&e&&"string"==typeof e.type&&e.type&&(e=j({},e)),t=j({},ye(e),{client:n}),ft.call(n,t)),n},lt=function(e){if(!Ge[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=pt(e);for(var t=0;t<e.length;t++)if(x.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===et[e[t].zcClippingId].indexOf(this.id)&&et[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+Qe++,et[e[t].zcClippingId]=[this.id],!0===U.autoActivate&&ht(e[t]));var n=Ge[this.id]&&Ge[this.id].elements;-1===n.indexOf(e[t])&&n.push(e[t])}return this},st=function(e){var t=Ge[this.id];if(!t)return this;for(var n,r=t.elements,a=(e=void 0===e?r.slice(0):pt(e)).length;a--;)if(x.call(e,a)&&e[a]&&1===e[a].nodeType){for(n=0;-1!==(n=r.indexOf(e[a],n));)r.splice(n,1);var o=et[e[a].zcClippingId];if(o){for(n=0;-1!==(n=o.indexOf(this.id,n));)o.splice(n,1);0===o.length&&(!0===U.autoActivate&&yt(e[a]),delete e[a].zcClippingId)}}return this},ct=function(){var e=Ge[this.id];return e&&e.elements?e.elements.slice(0):[]},dt=function(){var e=Ge[this.id];e&&(this.unclip(),this.off(),Ue.off("*",e.coreWildcardHandler),delete Ge[this.id])},ut=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Ge[this.id],n=t&&t.elements,r=!!n&&n.length>0,a=!e.target||r&&-1!==n.indexOf(e.target),o=e.relatedTarget&&r&&-1!==n.indexOf(e.relatedTarget),i=e.client&&e.client===this;return!(!t||!(a||o||i))},ft=function(e){var t=Ge[this.id];if("object"===(void 0===e?"undefined":_typeof(e))&&e&&e.type&&t){var n=be(e),r=t&&t.handlers["*"]||[],a=t&&t.handlers[e.type]||[],i=r.concat(a);if(i&&i.length){var l,s,c,d,u,f=this;for(l=0,s=i.length;l<s;l++)d=f,"string"==typeof(c=i[l])&&"function"==typeof o[c]&&(c=o[c]),"object"===(void 0===c?"undefined":_typeof(c))&&c&&"function"==typeof c.handleEvent&&(d=c,c=c.handleEvent),"function"==typeof c&&(u=j({},e),ge(c,d,[u],n))}}},pt=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},ht=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=o.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=o.event))&&(t(n),Ue.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),tt[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},yt=function(e){if(e&&1===e.nodeType){var t=tt[e.zcClippingId];if("object"===(void 0===t?"undefined":_typeof(t))&&t){for(var n,r,a=["move","leave","enter","out","over"],o=0,i=a.length;o<i;o++)"function"==typeof(r=t[n="mouse"+a[o]])&&e.removeEventListener(n,r,!1);delete tt[e.zcClippingId]}}};Ue._createClient=function(){nt.apply(this,T(arguments))},Ue.prototype.on=function(){return rt.apply(this,T(arguments))},Ue.prototype.off=function(){return at.apply(this,T(arguments))},Ue.prototype.handlers=function(){return ot.apply(this,T(arguments))},Ue.prototype.emit=function(){return it.apply(this,T(arguments))},Ue.prototype.clip=function(){return lt.apply(this,T(arguments))},Ue.prototype.unclip=function(){return st.apply(this,T(arguments))},Ue.prototype.elements=function(){return ct.apply(this,T(arguments))},Ue.prototype.destroy=function(){return dt.apply(this,T(arguments))},Ue.prototype.setText=function(e){if(!Ge[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.setData("text/plain",e),this},Ue.prototype.setHtml=function(e){if(!Ge[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.setData("text/html",e),this},Ue.prototype.setRichText=function(e){if(!Ge[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.setData("application/rtf",e),this},Ue.prototype.setData=function(){if(!Ge[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.setData.apply(this,T(arguments)),this},Ue.prototype.clearData=function(){if(!Ge[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.clearData.apply(this,T(arguments)),this},Ue.prototype.getData=function(){if(!Ge[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Ue.getData.apply(this,T(arguments))},"function"==typeof define&&define.amd?define(function(){return Ue}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module&&"object"===_typeof(module.exports)&&module.exports?module.exports=Ue:e.ZeroClipboard=Ue}(function(){return this||window}());
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/uri.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],e):t.URI=e(t.punycode,t.IPv6,t.SecondLevelDomains,t)}(this,function(t,e,r,n){function s(t,e){var r=1<=arguments.length,n=2<=arguments.length;if(!(this instanceof s))return r?n?new s(t,e):new s(t):new s;if(void 0===t){if(r)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}return this.href(t),void 0!==e?this.absoluteTo(e):this}function i(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function a(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function o(t){return"Array"===a(t)}function h(t,e){var r,n,s={};if("RegExp"===a(e))s=null;else if(o(e))for(r=0,n=e.length;r<n;r++)s[e[r]]=!0;else s[e]=!0;for(r=0,n=t.length;r<n;r++)(s&&void 0!==s[t[r]]||!s&&e.test(t[r]))&&(t.splice(r,1),n--,r--);return t}function u(t,e){var r,n;if(o(e)){for(r=0,n=e.length;r<n;r++)if(!u(t,e[r]))return!1;return!0}var s=a(e);for(r=0,n=t.length;r<n;r++)if("RegExp"===s){if("string"==typeof t[r]&&t[r].match(e))return!0}else if(t[r]===e)return!0;return!1}function p(t,e){if(!o(t)||!o(e)||t.length!==e.length)return!1;t.sort(),e.sort();for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function c(t){return escape(t)}function d(t){return encodeURIComponent(t).replace(/[!'()*]/g,c).replace(/\*/g,"%2A")}function l(t){return function(e,r){return void 0===e?this._parts[t]||"":(this._parts[t]=e||null,this.build(!r),this)}}function f(t,e){return function(r,n){return void 0===r?this._parts[t]||"":(null!==r&&(r+="").charAt(0)===e&&(r=r.substring(1)),this._parts[t]=r,this.build(!n),this)}}var m=n&&n.URI;s.version="1.16.1";var y=s.prototype,g=Object.prototype.hasOwnProperty;s._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:s.duplicateQueryParameters,escapeQuerySpace:s.escapeQuerySpace}},s.duplicateQueryParameters=!1,s.escapeQuerySpace=!0,s.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,s.idn_expression=/[^a-z0-9\.-]/i,s.punycode_expression=/(xn--)/i,s.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,s.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/gi,s.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u201e\u2018\u2019]+$/},s.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},s.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,s.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},s.getDomAttribute=function(t){if(t&&t.nodeName){var e=t.nodeName.toLowerCase();return"input"===e&&"image"!==t.type?void 0:s.domAttributes[e]}},s.encode=d,s.decode=decodeURIComponent,s.iso8859=function(){s.encode=escape,s.decode=unescape},s.unicode=function(){s.encode=d,s.decode=decodeURIComponent},s.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},s.encodeQuery=function(t,e){var r=s.encode(t+"");return void 0===e&&(e=s.escapeQuerySpace),e?r.replace(/%20/g,"+"):r},s.decodeQuery=function(t,e){t+="",void 0===e&&(e=s.escapeQuerySpace);try{return s.decode(e?t.replace(/\+/g,"%20"):t)}catch(e){return t}};var _,v={encode:"encode",decode:"decode"},b=function(t,e){return function(r){try{return s[e](r+"").replace(s.characters[t][e].expression,function(r){return s.characters[t][e].map[r]})}catch(t){return r}}};for(_ in v)s[_+"PathSegment"]=b("pathname",v[_]),s[_+"UrnPathSegment"]=b("urnpath",v[_]);v=function(t,e,r){return function(n){var i;i=r?function(t){return s[e](s[r](t))}:s[e];for(var a=0,o=(n=(n+"").split(t)).length;a<o;a++)n[a]=i(n[a]);return n.join(t)}},s.decodePath=v("/","decodePathSegment"),s.decodeUrnPath=v(":","decodeUrnPathSegment"),s.recodePath=v("/","encodePathSegment","decode"),s.recodeUrnPath=v(":","encodeUrnPathSegment","decode"),s.encodeReserved=b("reserved","encode"),s.parse=function(t,e){var r;return e||(e={}),-1<(r=t.indexOf("#"))&&(e.fragment=t.substring(r+1)||null,t=t.substring(0,r)),-1<(r=t.indexOf("?"))&&(e.query=t.substring(r+1)||null,t=t.substring(0,r)),"//"===t.substring(0,2)?(e.protocol=null,t=t.substring(2),t=s.parseAuthority(t,e)):-1<(r=t.indexOf(":"))&&(e.protocol=t.substring(0,r)||null,e.protocol&&!e.protocol.match(s.protocol_expression)?e.protocol=void 0:"//"===t.substring(r+1,r+3)?(t=t.substring(r+3),t=s.parseAuthority(t,e)):(t=t.substring(r+1),e.urn=!0)),e.path=t,e},s.parseHost=function(t,e){var r,n=(t=t.replace(/\\/g,"/")).indexOf("/");if(-1===n&&(n=t.length),"["===t.charAt(0))r=t.indexOf("]"),e.hostname=t.substring(1,r)||null,e.port=t.substring(r+2,n)||null,"/"===e.port&&(e.port=null);else{var s=t.indexOf(":");r=t.indexOf("/"),-1!==(s=t.indexOf(":",s+1))&&(-1===r||s<r)?(e.hostname=t.substring(0,n)||null,e.port=null):(r=t.substring(0,n).split(":"),e.hostname=r[0]||null,e.port=r[1]||null)}return e.hostname&&"/"!==t.substring(n).charAt(0)&&(n++,t="/"+t),t.substring(n)||"/"},s.parseAuthority=function(t,e){return t=s.parseUserinfo(t,e),s.parseHost(t,e)},s.parseUserinfo=function(t,e){var r=t.indexOf("/"),n=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<n&&(-1===r||n<r)?(r=t.substring(0,n).split(":"),e.username=r[0]?s.decode(r[0]):null,r.shift(),e.password=r[0]?s.decode(r.join(":")):null,t=t.substring(n+1)):(e.username=null,e.password=null),t},s.parseQuery=function(t,e){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var r,n,i={},a=t.split("&"),o=a.length,h=0;h<o;h++)r=a[h].split("="),n=s.decodeQuery(r.shift(),e),r=r.length?s.decodeQuery(r.join("="),e):null,g.call(i,n)?("string"!=typeof i[n]&&null!==i[n]||(i[n]=[i[n]]),i[n].push(r)):i[n]=r;return i},s.build=function(t){var e="";return t.protocol&&(e+=t.protocol+":"),t.urn||!e&&!t.hostname||(e+="//"),e+=s.buildAuthority(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(e+="/"),e+=t.path),"string"==typeof t.query&&t.query&&(e+="?"+t.query),"string"==typeof t.fragment&&t.fragment&&(e+="#"+t.fragment),e},s.buildHost=function(t){var e="";return t.hostname?(e=s.ip6_expression.test(t.hostname)?e+"["+t.hostname+"]":e+t.hostname,t.port&&(e+=":"+t.port),e):""},s.buildAuthority=function(t){return s.buildUserinfo(t)+s.buildHost(t)},s.buildUserinfo=function(t){var e="";return t.username&&(e+=s.encode(t.username),t.password&&(e+=":"+s.encode(t.password)),e+="@"),e},s.buildQuery=function(t,e,r){var n,i,a,h,u="";for(i in t)if(g.call(t,i)&&i)if(o(t[i]))for(n={},a=0,h=t[i].length;a<h;a++)void 0!==t[i][a]&&void 0===n[t[i][a]+""]&&(u+="&"+s.buildQueryParameter(i,t[i][a],r),!0!==e&&(n[t[i][a]+""]=!0));else void 0!==t[i]&&(u+="&"+s.buildQueryParameter(i,t[i],r));return u.substring(1)},s.buildQueryParameter=function(t,e,r){return s.encodeQuery(t,r)+(null!==e?"="+s.encodeQuery(e,r):"")},s.addQuery=function(t,e,r){if("object"===(void 0===e?"undefined":_typeof(e)))for(var n in e)g.call(e,n)&&s.addQuery(t,n,e[n]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");void 0===t[e]?t[e]=r:("string"==typeof t[e]&&(t[e]=[t[e]]),o(r)||(r=[r]),t[e]=(t[e]||[]).concat(r))}},s.removeQuery=function(t,e,r){var n;if(o(e))for(r=0,n=e.length;r<n;r++)t[e[r]]=void 0;else if("RegExp"===a(e))for(n in t)e.test(n)&&(t[n]=void 0);else if("object"===(void 0===e?"undefined":_typeof(e)))for(n in e)g.call(e,n)&&s.removeQuery(t,n,e[n]);else{if("string"!=typeof e)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==r?"RegExp"===a(r)?!o(t[e])&&r.test(t[e])?t[e]=void 0:t[e]=h(t[e],r):t[e]===r?t[e]=void 0:o(t[e])&&(t[e]=h(t[e],r)):t[e]=void 0}},s.hasQuery=function(t,e,r,n){if("object"===(void 0===e?"undefined":_typeof(e))){for(var i in e)if(g.call(e,i)&&!s.hasQuery(t,i,e[i]))return!1;return!0}if("string"!=typeof e)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(a(r)){case"Undefined":return e in t;case"Boolean":return t=Boolean(o(t[e])?t[e].length:t[e]),r===t;case"Function":return!!r(t[e],e,t);case"Array":return!!o(t[e])&&(n?u:p)(t[e],r);case"RegExp":return o(t[e])?!!n&&u(t[e],r):Boolean(t[e]&&t[e].match(r));case"Number":r=String(r);case"String":return o(t[e])?!!n&&u(t[e],r):t[e]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},s.commonPath=function(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r++)if(t.charAt(r)!==e.charAt(r)){r--;break}return 1>r?t.charAt(0)===e.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(r)&&"/"===e.charAt(r)||(r=t.substring(0,r).lastIndexOf("/")),t.substring(0,r+1))},s.withinString=function(t,e,r){r||(r={});var n=r.start||s.findUri.start,i=r.end||s.findUri.end,a=r.trim||s.findUri.trim,o=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var h=n.exec(t);if(!h)break;if(h=h.index,!(r.ignoreHtml&&(u=t.slice(Math.max(h-3,0),h))&&o.test(u))){var u=h+t.slice(h).search(i),p=t.slice(h,u).replace(a,"");r.ignore&&r.ignore.test(p)||(u=h+p.length,p=e(p,h,u,t),t=t.slice(0,h)+p+t.slice(u),n.lastIndex=h+p.length)}}return n.lastIndex=0,t},s.ensureValidHostname=function(e){if(e.match(s.invalid_hostname_characters)){if(!t)throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(t.toASCII(e).match(s.invalid_hostname_characters))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]')}},s.noConflict=function(t){return t?(t={URI:this.noConflict()},n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t):(n.URI===this&&(n.URI=m),this)},y.build=function(t){return!0===t?this._deferred_build=!0:(void 0===t||this._deferred_build)&&(this._string=s.build(this._parts),this._deferred_build=!1),this},y.clone=function(){return new s(this)},y.valueOf=y.toString=function(){return this.build(!1)._string},y.protocol=l("protocol"),y.username=l("username"),y.password=l("password"),y.hostname=l("hostname"),y.port=l("port"),y.query=f("query","?"),y.fragment=f("fragment","#"),y.search=function(t,e){var r=this.query(t,e);return"string"==typeof r&&r.length?"?"+r:r},y.hash=function(t,e){var r=this.fragment(t,e);return"string"==typeof r&&r.length?"#"+r:r},y.pathname=function(t,e){if(void 0===t||!0===t){var r=this._parts.path||(this._parts.hostname?"/":"");return t?(this._parts.urn?s.decodeUrnPath:s.decodePath)(r):r}return this._parts.path=this._parts.urn?t?s.recodeUrnPath(t):"":t?s.recodePath(t):"/",this.build(!e),this},y.path=y.pathname,y.href=function(t,e){var r;if(void 0===t)return this.toString();this._string="",this._parts=s._parts();var n=t instanceof s,i="object"===(void 0===t?"undefined":_typeof(t))&&(t.hostname||t.path||t.pathname);if(t.nodeName&&(i=s.getDomAttribute(t),t=t[i]||"",i=!1),!n&&i&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this._parts=s.parse(String(t),this._parts);else{if(!n&&!i)throw new TypeError("invalid input");for(r in n=n?t._parts:t)g.call(this._parts,r)&&(this._parts[r]=n[r])}return this.build(!e),this},y.is=function(t){var e=!1,n=!1,i=!1,a=!1,o=!1,h=!1,u=!1,p=!this._parts.urn;switch(this._parts.hostname&&(p=!1,n=s.ip4_expression.test(this._parts.hostname),i=s.ip6_expression.test(this._parts.hostname),e=n||i,o=(a=!e)&&r&&r.has(this._parts.hostname),h=a&&s.idn_expression.test(this._parts.hostname),u=a&&s.punycode_expression.test(this._parts.hostname)),t.toLowerCase()){case"relative":return p;case"absolute":return!p;case"domain":case"name":return a;case"sld":return o;case"ip":return e;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return i;case"idn":return h;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return u}return null};var w=y.protocol,Q=y.port,A=y.hostname;y.protocol=function(t,e){if(void 0!==t&&t&&!(t=t.replace(/:(\/\/)?$/,"")).match(s.protocol_expression))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return w.call(this,t,e)},y.scheme=y.protocol,y.port=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),t.match(/[^0-9]/))))throw new TypeError('Port "'+t+'" contains characters other than [0-9]');return Q.call(this,t,e)},y.hostname=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t){var r={};if("/"!==s.parseHost(t,r))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=r.hostname}return A.call(this,t,e)},y.host=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t)return this._parts.hostname?s.buildHost(this._parts):"";if("/"!==s.parseHost(t,this._parts))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.build(!e),this},y.authority=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t)return this._parts.hostname?s.buildAuthority(this._parts):"";if("/"!==s.parseAuthority(t,this._parts))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.build(!e),this},y.userinfo=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.username)return"";var r=s.buildUserinfo(this._parts);return r.substring(0,r.length-1)}return"@"!==t[t.length-1]&&(t+="@"),s.parseUserinfo(t,this._parts),this.build(!e),this},y.resource=function(t,e){var r;return void 0===t?this.path()+this.search()+this.hash():(r=s.parse(t),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!e),this)},y.subdomain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,r)||""}return r=this._parts.hostname.length-this.domain().length,r=this._parts.hostname.substring(0,r),r=new RegExp("^"+i(r)),t&&"."!==t.charAt(t.length-1)&&(t+="."),t&&s.ensureValidHostname(t),this._parts.hostname=this._parts.hostname.replace(r,t),this.build(!e),this},y.domain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);return r&&2>r.length?this._parts.hostname:(r=this._parts.hostname.length-this.tld(e).length-1,r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||"")}if(!t)throw new TypeError("cannot set domain empty");return s.ensureValidHostname(t),!this._parts.hostname||this.is("IP")?this._parts.hostname=t:(r=new RegExp(i(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(r,t)),this.build(!e),this},y.tld=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),n=this._parts.hostname.substring(n+1);return!0!==e&&r&&r.list[n.toLowerCase()]?r.get(this._parts.hostname)||n:n}if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');n=new RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(n,t)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");n=new RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(n,t)}return this.build(!e),this},y.directory=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return t?s.decodePath(r):r}return r=this._parts.path.length-this.filename().length,r=this._parts.path.substring(0,r),r=new RegExp("^"+i(r)),this.is("relative")||(t||(t="/"),"/"!==t.charAt(0)&&(t="/"+t)),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=s.recodePath(t),this._parts.path=this._parts.path.replace(r,t),this.build(!e),this},y.filename=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(r+1);return t?s.decodePathSegment(r):r}r=!1,"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(r=!0);var n=new RegExp(i(this.filename())+"$");return t=s.recodePath(t),this._parts.path=this._parts.path.replace(n,t),r?this.normalizePath(e):this.build(!e),this},y.suffix=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this._parts.path||"/"===this._parts.path)return"";var r=this.filename(),n=r.lastIndexOf(".");return-1===n?"":(r=r.substring(n+1),r=/^[a-z0-9%]+$/i.test(r)?r:"",t?s.decodePathSegment(r):r)}if("."===t.charAt(0)&&(t=t.substring(1)),r=this.suffix())n=t?new RegExp(i(r)+"$"):new RegExp(i("."+r)+"$");else{if(!t)return this;this._parts.path+="."+s.recodePath(t)}return n&&(t=s.recodePath(t),this._parts.path=this._parts.path.replace(n,t)),this.build(!e),this},y.segment=function(t,e,r){var n=this._parts.urn?":":"/",s="/"===(i=this.path()).substring(0,1),i=i.split(n);if(void 0!==t&&"number"!=typeof t&&(r=e,e=t,t=void 0),void 0!==t&&"number"!=typeof t)throw Error('Bad segment "'+t+'", must be 0-based integer');if(s&&i.shift(),0>t&&(t=Math.max(i.length+t,0)),void 0===e)return void 0===t?i:i[t];if(null===t||void 0===i[t])if(o(e)){i=[],t=0;for(var a=e.length;t<a;t++)(e[t].length||i.length&&i[i.length-1].length)&&(i.length&&!i[i.length-1].length&&i.pop(),i.push(e[t]))}else(e||"string"==typeof e)&&(""===i[i.length-1]?i[i.length-1]=e:i.push(e));else e?i[t]=e:i.splice(t,1);return s&&i.unshift(""),this.path(i.join(n),r)},y.segmentCoded=function(t,e,r){var n,i;if("number"!=typeof t&&(r=e,e=t,t=void 0),void 0===e){if(t=this.segment(t,e,r),o(t))for(n=0,i=t.length;n<i;n++)t[n]=s.decode(t[n]);else t=void 0!==t?s.decode(t):void 0;return t}if(o(e))for(n=0,i=e.length;n<i;n++)e[n]=s.encode(e[n]);else e="string"==typeof e||e instanceof String?s.encode(e):e;return this.segment(t,e,r)};var P=y.query;return y.query=function(t,e){if(!0===t)return s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof t){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=t.call(this,r);return this._parts.query=s.buildQuery(n||r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this}return void 0!==t&&"string"!=typeof t?(this._parts.query=s.buildQuery(t,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this):P.call(this,t,e)},y.setQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof t||t instanceof String)n[t]=void 0!==e?e:null;else{if("object"!==(void 0===t?"undefined":_typeof(t)))throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var i in t)g.call(t,i)&&(n[i]=t[i])}return this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.addQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.addQuery(n,t,void 0===e?null:e),this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.removeQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.removeQuery(n,t,e),this._parts.query=s.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},y.hasQuery=function(t,e,r){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.hasQuery(n,t,e,r)},y.setSearch=y.setQuery,y.addSearch=y.addQuery,y.removeSearch=y.removeQuery,y.hasSearch=y.hasQuery,y.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},y.normalizeProtocol=function(t){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!t)),this},y.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&t?this._parts.hostname=t.toASCII(this._parts.hostname):this.is("IPv6")&&e&&(this._parts.hostname=e.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},y.normalizePort=function(t){return"string"==typeof this._parts.protocol&&this._parts.port===s.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!t)),this},y.normalizePath=function(t){var e=this._parts.path;if(!e)return this;if(this._parts.urn)return this._parts.path=s.recodeUrnPath(this._parts.path),this.build(!t),this;if("/"===this._parts.path)return this;var r,n,i,a="";for("/"!==e.charAt(0)&&(r=!0,e="/"+e),"/.."!==e.slice(-3)&&"/."!==e.slice(-2)||(e+="/"),e=e.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),r&&(a=e.substring(1).match(/^(\.\.\/)+/)||"")&&(a=a[0]);-1!==(n=e.indexOf("/.."));)0!==n?(-1===(i=e.substring(0,n).lastIndexOf("/"))&&(i=n),e=e.substring(0,i)+e.substring(n+3)):e=e.substring(3);return r&&this.is("relative")&&(e=a+e.substring(1)),e=s.recodePath(e),this._parts.path=e,this.build(!t),this},y.normalizePathname=y.normalizePath,y.normalizeQuery=function(t){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(s.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!t)),this},y.normalizeFragment=function(t){return this._parts.fragment||(this._parts.fragment=null,this.build(!t)),this},y.normalizeSearch=y.normalizeQuery,y.normalizeHash=y.normalizeFragment,y.iso8859=function(){var t=s.encode,e=s.decode;s.encode=escape,s.decode=decodeURIComponent;try{this.normalize()}finally{s.encode=t,s.decode=e}return this},y.unicode=function(){var t=s.encode,e=s.decode;s.encode=d,s.decode=unescape;try{this.normalize()}finally{s.encode=t,s.decode=e}return this},y.readable=function(){var e=this.clone();e.username("").password("").normalize();var r="";if(e._parts.protocol&&(r+=e._parts.protocol+"://"),e._parts.hostname&&(e.is("punycode")&&t?(r+=t.toUnicode(e._parts.hostname),e._parts.port&&(r+=":"+e._parts.port)):r+=e.host()),e._parts.hostname&&e._parts.path&&"/"!==e._parts.path.charAt(0)&&(r+="/"),r+=e.path(!0),e._parts.query){for(var n="",i=0,a=e._parts.query.split("&"),o=a.length;i<o;i++){var h=(a[i]||"").split("="),n=n+"&"+s.decodeQuery(h[0],this._parts.escapeQuerySpace).replace(/&/g,"%26");void 0!==h[1]&&(n+="="+s.decodeQuery(h[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}r+="?"+n.substring(1)}return r+=s.decodeQuery(e.hash(),!0)},y.absoluteTo=function(t){var e,r,n=this.clone(),i=["protocol","username","password","hostname","port"];if(this._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(t instanceof s||(t=new s(t)),n._parts.protocol||(n._parts.protocol=t._parts.protocol),this._parts.hostname)return n;for(e=0;r=i[e];e++)n._parts[r]=t._parts[r];return n._parts.path?".."===n._parts.path.substring(-2)&&(n._parts.path+="/"):(n._parts.path=t._parts.path,n._parts.query||(n._parts.query=t._parts.query)),"/"!==n.path().charAt(0)&&(i=(i=t.directory())?i:0===t.path().indexOf("/")?"/":"",n._parts.path=(i?i+"/":"")+n._parts.path,n.normalizePath()),n.build(),n},y.relativeTo=function(t){var e,r,n,i=this.clone().normalize();if(i._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(t=new s(t).normalize(),e=i._parts,r=t._parts,n=i.path(),t=t.path(),"/"!==n.charAt(0))throw Error("URI is already relative");if("/"!==t.charAt(0))throw Error("Cannot calculate a URI relative to another relative URI");return e.protocol===r.protocol&&(e.protocol=null),e.username!==r.username||e.password!==r.password||null!==e.protocol||null!==e.username||null!==e.password||e.hostname!==r.hostname||e.port!==r.port?i.build():(e.hostname=null,e.port=null,n===t?(e.path="",i.build()):(n=s.commonPath(n,t))?(r=r.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../"),e.path=r+e.path.substring(n.length)||"./",i.build()):i.build())},y.equals=function(t){var e=this.clone();t=new s(t);var r,n={},i={},a={};if(e.normalize(),t.normalize(),e.toString()===t.toString())return!0;if(n=e.query(),i=t.query(),e.query(""),t.query(""),e.toString()!==t.toString()||n.length!==i.length)return!1;n=s.parseQuery(n,this._parts.escapeQuerySpace),i=s.parseQuery(i,this._parts.escapeQuerySpace);for(r in n)if(g.call(n,r)){if(o(n[r])){if(!p(n[r],i[r]))return!1}else if(n[r]!==i[r])return!1;a[r]=!0}for(r in i)if(g.call(i,r)&&!a[r])return!1;return!0},y.duplicateQueryParameters=function(t){return this._parts.duplicateQueryParameters=!!t,this},y.escapeQuerySpace=function(t){return this._parts.escapeQuerySpace=!!t,this},s});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/colorbrewer.js */
var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/ractive.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):function(){var n=t.Ractive,i=e();t.Ractive=i,i.noConflict=function(){return t.Ractive=n,i}}()}(this,function(){"use strict";function t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function e(e){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];for(var r=0;r<n.length;r++){var s=n[r];for(var a in s)a in e||!t(s,a)||(e[a]=s[a])}return e}function n(e){void 0===e&&(e={});var n=[];for(var i in e)t(e,i)&&n.push([i,e[i]]);return n}function i(t,e){return null===t&&null===e||!o(t)&&!o(e)&&t===e}function r(t){return!isNaN(parseFloat(t))&&isFinite(t)}function s(t){return t&&"[object Object]"===La.call(t)}function a(t){return!(!t||!o(t)&&!u(t))}function o(t){return"object"===(void 0===t?"undefined":_typeof(t))}function u(t){return"function"==typeof t}function h(t){return"string"==typeof t}function l(t){return"number"==typeof t}function c(t){return void 0===t}function f(){}function d(t,e){return t.replace(/%s/g,function(){return e.shift()})}function p(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];throw t=d(t,e),new Error(t)}function m(){Va.DEBUG&&io.apply(null,arguments)}function v(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];t=d(t,e),ro(t,e)}function g(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];t=d(t,e),uo[t]||(uo[t]=!0,ro(t,e))}function y(){Va.DEBUG&&v.apply(null,arguments)}function b(){Va.DEBUG&&g.apply(null,arguments)}function w(t,e,n){var i=x(t,e,n);return i?i[t][n]:null}function x(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function k(t,e,n,i){if(t===e)return null;if(i){var r=w("interpolators",n,i);if(r)return r(t,e)||null;p(fo(i,"interpolator"))}return po.number(t,e)||po.array(t,e)||po.object(t,e)||null}function _(t){return h(t)?t.replace(go,"\\$&"):t}function E(t){return t?t.replace(mo,".$1"):""}function A(t){var e,n=[];for(t=E(t);e=vo.exec(t);){var i=e.index+e[1].length;n.push(t.substr(0,i)),t=t.substr(i+1)}return n.push(t),n}function S(t){return h(t)?t.replace(yo,"$1$2"):t}function C(t,e){-1===t.indexOf(e)&&t.push(e)}function O(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]==e)return!0;return!1}function j(t,e){var n;if(!Da(t)||!Da(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function N(t){return h(t)?[t]:c(t)?[]:t}function T(t){return t[t.length-1]}function V(t,e){if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}function M(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=t.concat.apply([],t),i=n.length;i--;){var r=n.indexOf(n[i]);~r&&r<i&&n.splice(i,1)}return n}function P(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function I(t,e){for(var n=t.length,i=0;i<n;i++){var r=e(t[i]);if(r)return r}}function R(t,e,n){var i=t,r=e;n&&(i=i.map(n),r=r.map(n));var s=i.length,a={},o=0,u=i.map(function(t){var e,n=o;do{if(-1===(e=r.indexOf(t,n)))return-1;n=e+1}while(!0===a[e]&&n<s);return e===o&&(o+=1),a[e]=!0,e}),h=u.oldLen=i.length;if(u.newLen=r.length,h===u.newLen){var l=0;for(l;l<h&&u[l]===l;l++);l===h&&(u.same=!0)}return u}function B(t,e){if(!/this/.test(t.toString()))return t;var n=bo.call(t,e);for(var i in t)n[i]=t[i];return n}function K(t,e,n){return n&&u(e)&&t.parent&&t.parent.isRoot?(t.boundValue||(t.boundValue=B(e._r_unbound||e,t.parent.ractive)),t.boundValue):e}function L(t){t.updateFromBindings(!0)}function D(t){for(var e=t.length;e--;)if(t[e].bound){var n=t[e].owner;if(n)return{value:"checked"===n.name?n.node.checked:n.node.value}}}function F(t){if(t){var e=wo[t];wo[t]=[];for(var n=e.length;n--;)e[n]();var i=xo[t];for(xo[t]=[],n=i.length;n--;)i[n].model.register(i[n].item)}else F("early"),F("mark")}function z(t,e,n,i){t.shuffling=!0;for(var r=e.length;r--;){var s=e[r];r!==s&&(r in t.childByKey&&t.childByKey[r].rebind(~s?t.joinKey(s):void 0,t.childByKey[r],!i))}var a=t.source().length!==t.source().value.length;for(t.links.forEach(function(t){return t.shuffle(e)}),n||F("early"),r=t.deps.length;r--;)t.deps[r].shuffle&&t.deps[r].shuffle(e);t[n?"marked":"mark"](),n||F("mark"),a&&t.notifyUpstream(),t.shuffling=!1}function U(t,e){e!==t.dataModel&&(e&&e.viewmodel&&e.viewmodel.isRoot&&t.childByKey.data?(t.childByKey.data.link(e.viewmodel,"data"),t.dataModel=e):t.dataModel&&(t.childByKey.data.unlink(),t.dataModel=!0))}function $(){So.push(Ao=[])}function q(){var t=So.pop();return Ao=So[So.length-1],t}function H(t){Ao&&Ao.push(t)}function Z(t){t.bind()}function W(t){t.cancel()}function G(t){t.destroyed()}function Q(t){t.handleChange()}function Y(t){t.mark()}function J(t){t.mark(!0)}function X(t){t.marked()}function tt(t){t.markedAll()}function et(t){t.render()}function nt(t){t.shuffled()}function it(t){t.teardown()}function rt(t){t.unbind()}function st(t){t.unrender()}function at(t){t.update()}function ot(t){return t.toString()}function ut(t){return t.toString(!0)}function ht(t,e,n,i){var r=t.r||t;if(!r||!h(r))return e;if("."===r||"@"===r[0]||(e||n).isKey||(e||n).isKeypath)return e;var s=r.split("/"),a=A(s[s.length-1]),o=a[a.length-1],u=e||n;u&&1===a.length&&o!==u.key&&i&&(a=lt(o,i)||a);for(var l=a.length,c=!0,f=!1;u&&l--;)u.shuffling&&(f=!0),a[l]!=u.key&&(c=!1),u=u.parent;return!e&&c&&f?n:e&&!c&&f?n:e}function lt(t,e){for(;e;){var n=e.aliases;if(n&&n[t]){for(var i=(e.owner.iterations?e.owner:e).owner.template.z,r=0;r<i.length;r++)if(i[r].n===t){var s=i[r].x;if(!s.r)return!1;var a=s.r.split("/");return A(a[a.length-1])}return}e=e.componentParent||e.parent}}function ct(t,e){void 0===e&&(e=0);for(var n=new Array(e);e--;)n[e]="_"+e;return new Function([],"return function ("+n.join(",")+"){return("+t+");};")()}function ft(t,e){return jo[t]?jo[t]:jo[t]=Be(t,e)}function dt(t){if(t){var e=t.e;e&&Ka(e).forEach(function(t){jo[t]||(jo[t]=e[t])})}}function pt(t){if(!t.matchString("="))return null;var e=t.pos;t.sp();var n=t.matchPattern(Nu);if(!n)return t.pos=e,null;if(!t.matchPattern(Tu))return null;var i=t.matchPattern(Nu);return i?(t.sp(),t.matchString("=")?[n,i]:(t.pos=e,null)):(t.pos=e,null)}function mt(t){var e;return(e=t.matchPattern(Vu))?{t:su,v:e}:null}function vt(t){return t.replace(Mu,"\\$&")}function gt(t,e){return t.search(Pu[e.join()]||(Pu[e.join()]=new RegExp(e.map(vt).join("|"))))}function yt(t){return t.replace(Lu,function(t,e){var n;return n="#"!==e[0]?Bu[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?Fu(wt(n)):t})}function bt(t){return t.replace($u,"&amp;").replace(zu,"&lt;").replace(Uu,"&gt;")}function wt(t){return t?10===t?32:t<128?t:t<=159?Ku[t-128]:t<55296?t:t<=57343?qu:t<=65535?t:Du?t>=65536&&t<=131071?t:t>=131072&&t<=196607?t:qu:qu:qu}function xt(t){var e;return(e=t.matchPattern(Wu))?{t:tu,v:e}:null}function kt(t){var e=t.remaining();return"true"===e.substr(0,4)?(t.pos+=4,{t:ru,v:"true"}):"false"===e.substr(0,5)?(t.pos+=5,{t:ru,v:"false"}):null}function _t(t){return function(e){for(var n,i='"',r=!1;!r;)(n=e.matchPattern(Gu)||e.matchPattern(Qu)||e.matchString(t))?i+='"'===n?'\\"':"\\'"===n?"'":n:(n=e.matchPattern(Yu))?i+="\\u"+("000"+n.charCodeAt(1).toString(16)).slice(-4):r=!0;return i+='"',JSON.parse(i)}}function Et(t){var e=t.pos,n=t.matchString("'")||t.matchString('"');if(n){var i=("'"===n?Ju:Xu)(t);return t.matchString(n)?{t:eu,v:i}:(t.pos=e,null)}return null}function At(t){return JSON.parse('"'+t.replace(eh,St)+'"')}function St(t){switch(t){case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\b":return"\\b";case"\f":return"\\f"}}function Ct(t){if(!t.matchString("`"))return null;for(var e,n="",i=!1,r=[];!i;)if(e=t.matchPattern(th)||t.matchPattern(Qu)||t.matchString("$")||t.matchString('"'))if('"'===e)n+='\\"';else if("\\`"===e)n+="`";else if("$"===e)if(t.matchString("{")){r.push({t:eu,v:At(n)}),n="",t.sp();var s=Dt(t);s||t.error("Expected valid expression"),r.push({t:fu,x:s}),t.sp(),t.matchString("}")||t.error("Expected closing '}' after interpolated expression")}else n+="$";else n+=e;else(e=t.matchPattern(Yu))?n+="\\u"+("000"+e.charCodeAt(1).toString(16)).slice(-4):i=!0;if(n.length&&r.push({t:eu,v:At(n)}),t.matchString("`")||t.error("Expected closing '`'"),1===r.length)return r[0];for(var a,o=r.pop();a=r.pop();)o={t:pu,s:"+",o:[a,o]};return{t:fu,x:o}}function Ot(t){var e;return(e=Et(t))?ah.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=xt(t))?e.v:(e=t.matchPattern(nh))?e:null}function jt(t){var e,n=t.pos;t.sp();var i="'"!==t.nextChar()&&'"'!==t.nextChar();i&&(e=t.matchPattern(ih));var r=e?Dt(t):Ot(t);if(null===r)return t.pos=n,null;if(t.sp(),i&&(","===t.nextChar()||"}"===t.nextChar())){e||nh.test(r)||t.error("Expected a valid reference, but found '"+r+"' instead.");var s={t:ou,k:r,v:{t:uu,n:r}};return e&&(s.p=!0),s}if(!t.matchString(":"))return t.pos=n,null;t.sp();var a=Dt(t);return null===a?(t.pos=n,null):{t:ou,k:r,v:a}}function Nt(t){var e=t.pos,n=jt(t);if(null===n)return null;var i=[n];if(t.matchString(",")){var r=Nt(t);return r?i.concat(r):(t.pos=e,null)}return i}function Tt(t){var e=t.pos;if(t.sp(),!t.matchString("{"))return t.pos=e,null;var n=Nt(t);return t.sp(),t.matchString("}")?{t:iu,m:n}:(t.pos=e,null)}function Vt(t){var e=t.pos;if(t.sp(),!t.matchString("["))return t.pos=e,null;var n=Ft(t,!0);return t.matchString("]")?{t:nu,m:n}:(t.pos=e,null)}function Mt(t){return xt(t)||kt(t)||Et(t)||Ct(t)||Tt(t)||Vt(t)||mt(t)}function Pt(t){var e,n,i,r,s,a=t.pos;n=!(e=t.matchPattern(hh)||"")&&t.relaxedNames&&t.matchPattern(sh)||t.matchPattern(rh);var o=e.length+(n&&n.length||0);if("@."===e&&(e="@",n=n?"this."+n:"this"),!n&&e&&(n=e,e=""),!n)return null;if("@"===e)if(lh.test(n))if(n.indexOf("event")&&n.indexOf("node")||t.inEvent){if(~n.indexOf("context"))return t.pos=t.pos-(n.length-7),{t:fu,x:{t:uu,n:"@context"}}}else t.error("@event and @node are only valid references within an event directive");else t.error("Unrecognized special reference @"+n);if(!e&&!t.relaxedNames&&uh.test(n))return t.pos=a,null;if(!e&&oh.test(n))return i=oh.exec(n)[0],t.pos=a+i.length,{t:au,v:i};if(r=(e||"")+E(n),t.matchString("("))if(-1!==(s=r.lastIndexOf("."))&&"]"!==n[n.length-1])if(0===s)r=".",t.pos=a;else{var u=r.length;r=r.substr(0,s),t.pos=a+(o-(u-s))}else t.pos-=1;return{t:uu,n:r.replace(/^this\./,"./").replace(/^this$/,".")}}function It(t){if(!t.matchString("("))return null;t.sp();var e=Dt(t);return e||t.error(Hu),t.sp(),t.matchString(")")||t.error(Zu),{t:fu,x:e}}function Rt(t){return Mt(t)||Pt(t)||It(t)}function Bt(t){if(t.strictRefinement||t.sp(),t.matchString(".")){t.sp();var e=t.matchPattern(nh);if(e)return{t:hu,n:e};t.error("Expected a property name")}if(t.matchString("[")){t.sp();var n=Dt(t);return n||t.error(Hu),t.sp(),t.matchString("]")||t.error("Expected ']'"),{t:hu,x:n}}return null}function Kt(t){var e=Rt(t);if(!e)return null;for(;e;){var n=Bt(t);if(n)e={t:lu,x:e,r:n};else{if(!t.matchString("("))break;t.sp();var i=Ft(t,!0);t.sp(),t.matchString(")")||t.error(Zu),e={t:mu,x:e},i&&(e.o=i)}}return e}function Lt(t){var e=mh(t);if(!e)return null;var n=t.pos;if(t.sp(),!t.matchString("?"))return t.pos=n,e;t.sp();var i=Dt(t);i||t.error(Hu),t.sp(),t.matchString(":")||t.error('Expected ":"'),t.sp();var r=Dt(t);return r||t.error(Hu),{t:du,o:[e,i,r]}}function Dt(t){if(!1===t.allowExpressions){var e=Pt(t);return t.sp(),e}return Lt(t)}function Ft(t,e){var n,i=[],r=t.pos;do{t.sp(),e&&(n=t.matchPattern(ih));var s=Dt(t);if(null===s&&i.length)t.error(Hu);else if(null===s)return t.pos=r,null;n&&(s.p=!0),i.push(s),t.sp()}while(t.matchString(","));return i}function zt(t,e){var n=t.pos,i=Dt(t);if(!i){var r=t.matchPattern(/^(\w+)/);return r?{t:uu,n:r}:null}for(var s=0;s<e.length;s+=1)if(t.remaining().substr(0,e[s].length)===e[s])return i;return t.pos=n,Pt(t)}function Ut(t){function e(t){if(h(t))return t;switch(t.t){case ru:case au:case tu:case su:return t.v;case eu:return JSON.stringify(String(t.v));case nu:return t.m&&$t(t.m)?"[].concat("+i(t.m,"[","]",e)+")":"["+(t.m?t.m.map(e).join(","):"")+"]";case iu:return t.m&&$t(t.m)?"Object.assign({},"+i(t.m,"{","}",n)+")":"{"+(t.m?t.m.map(function(t){return t.k+":"+e(t.v)}).join(","):"")+"}";case cu:return("typeof"===t.s?"typeof ":t.s)+e(t.o);case pu:return e(t.o[0])+("in"===t.s.substr(0,2)?" "+t.s+" ":t.s)+e(t.o[1]);case mu:if(t.o&&$t(t.o)){var a=s++;return"(x$"+a+"="+e(t.x)+").apply(x$"+a+","+e({t:nu,m:t.o})+")"}return e(t.x)+"("+(t.o?t.o.map(e).join(","):"")+")";case fu:return"("+e(t.x)+")";case lu:return e(t.x)+e(t.r);case hu:return t.n?"."+t.n:"["+e(t.x)+"]";case du:return e(t.o[0])+"?"+e(t.o[1])+":"+e(t.o[2]);case uu:return"_"+r.indexOf(t.n);default:throw new Error("Expected legal JavaScript")}}function n(t){return t.p?e(t.k):t.k+":"+e(t.v)}function i(t,e,n,i){var r=t.reduce(function(t,r){return r.p?t.str+=(t.open?n+",":t.str.length?",":"")+i(r):t.str+=""+(t.str.length?t.open?",":","+e:e)+i(r),t.open=!r.p,t},{open:!1,str:""});return r.open&&(r.str+=n),r.str}var r,s=0;qt(t,r=[]);var a=e(t);return{r:r,s:function(t){for(var e=[],n=s-1;n>=0;n--)e.push("x$"+n);return e.length?"(function(){var "+e.join(",")+";return("+t+");})()":t}(a)}}function $t(t){for(var e=0;e<t.length;e++)if(t[e].p)return!0;return!1}function qt(t,e){t.t===uu&&h(t.n)&&(~e.indexOf(t.n)||e.unshift(t.n));var n=t.o||t.m;if(n)if(s(n))qt(n,e);else for(var i=n.length;i--;)qt(n[i],e);t.k&&t.t===ou&&!h(t.k)&&qt(t.k,e),t.x&&qt(t.x,e),t.r&&qt(t.r,e),t.v&&qt(t.v,e)}function Ht(t,e){var n;if(t){for(;t.t===fu&&t.x;)t=t.x;return t.t===uu?~t.n.indexOf("@context")?e.x=Ut(t):e.r=t.n:(n=Zt(t))?e.rx=n:e.x=Ut(t),e}}function Zt(t){for(var e,n=[];t.t===lu&&t.r.t===hu;)(e=t.r).x?e.x.t===uu?n.unshift(e.x):n.unshift(Ut(e.x)):n.unshift(e.n),t=t.x;return t.t!==uu?null:{r:t.n,m:n}}function Wt(t){for(var e=[],n=0,i=0;i<t.length;i++)"-"===t[i]&&"\\"!==t[i-1]&&(e.push(t.substring(n,i).replace(Ch,"")),n=i+1);return e.push(t.substring(n).replace(Ch,"")),e}function Gt(t){var e,n,i,r;if(t.sp(),!(e=t.matchPattern(vh)))return null;for(i=e.length,n=0;n<t.tags.length;n++)~(r=e.indexOf(t.tags[n].open))&&r<i&&(i=r);return i<e.length&&(t.pos-=e.length-i,!(e=e.substr(0,i)))?null:{n:e}}function Qt(t){var e=t.pos;if(/[=\/>\s]/.test(t.nextChar())||t.error("Expected `=`, `/`, `>` or whitespace"),t.sp(),!t.matchString("="))return t.pos=e,null;t.sp();var n=t.pos,i=t.sectionDepth,r=Xt(t,"'")||Xt(t,'"')||Jt(t);return null===r&&t.error("Expected valid attribute value"),t.sectionDepth!==i&&(t.pos=n,t.error("An attribute value must contain as many opening section tags as closing section tags")),r.length?1===r.length&&h(r[0])?yt(r[0]):r:""}function Yt(t){var e,n,i=t.pos;return(e=t.matchPattern(Eh))?(-1!==(n=gt(e,t.tags.map(function(t){return t.open})))&&(e=e.substr(0,n),t.pos=i+e.length),e):null}function Jt(t){t.inAttribute=!0;for(var e=[],n=re(t)||Yt(t);n;)e.push(n),n=re(t)||Yt(t);return e.length?(t.inAttribute=!1,e):null}function Xt(t,e){var n=t.pos;if(!t.matchString(e))return null;t.inAttribute=e;for(var i=[],r=re(t)||te(t,e);null!==r;)i.push(r),r=re(t)||te(t,e);return t.matchString(e)?(t.inAttribute=!1,i):(t.pos=n,null)}function te(t,e){var n=t.remaining(),i=t.tags.map(function(t){return t.open});i.push(e);var r=gt(n,i);return-1===r&&t.error("Quoted attribute value must have a closing quote"),r?(t.pos+=r,n.substr(0,r)):null}function ee(t){var e,n,i=Gt(t,!1);if(!i)return null;if(n=_h[i.n])i.t=n.t,n.v&&(i.v=n.v),delete i.n,t.sp(),"="===t.nextChar()&&(i.f=Qt(t));else if(e=wh.exec(i.n))i.n=e[1],i.t=Su,ie(t,i);else if(e=xh.exec(i.n))i.n=e[1],i.t=Cu,ie(t,i),i.v="in-out"===e[2]?"t0":"in"===e[2]?"t1":"t2";else if(e=yh.exec(i.n))i.n=Wt(e[1]),i.t=Au,t.matchString("(")&&(i.a=Ut({t:nu,m:Ft(t)}),t.matchString(")")||t.error("Expected closing ')'")),t.inEvent=!0,ne(t,i)?bh.test(i.f)&&(t.pos-=i.f.length,t.error("Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)")):ie(t,i,!0),t.inEvent=!1;else if(e=kh.exec(i.n)){var r="bind"===e[2];i.n=r?e[3]:e[1],i.t=Ho,ie(t,i,!1,!0),!i.f&&r&&(i.f=[{t:Ro,r:e[3]}])}else{t.sp();var s="="===t.nextChar()?Qt(t):null;if(i.f=null!=s?s:i.f,t.sanitizeEventAttributes&&gh.test(i.n))return{exclude:!0};i.f=i.f||(""===i.f?"":0),i.t=Ho}return i}function ne(t,e){var n=t.pos;t.matchString("=")||t.error("Missing required directive arguments");var i=t.matchString("'")||t.matchString('"');t.sp();var r=t.matchPattern(Ah);if(void 0!==r)if(i){if(t.sp(),t.matchString(i))return(e.f=r)||!0;t.pos=n}else{if(t.matchPattern(Sh))return(e.f=r)||!0;t.pos=n}else t.pos=n}function ie(t,e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),t.sp(),t.matchString("=")){t.sp();var r=t.matchString('"')||t.matchString("'"),s=t.spreadArgs;t.spreadArgs=!0,t.inUnquotedAttribute=!r;var a=i?zt(t,[r||" ","/",">"]):{m:Ft(t),t:nu};if(t.inUnquotedAttribute=!1,t.spreadArgs=s,r&&(t.sp(),t.matchString(r)!==r&&t.error("Expected matching quote '"+r+"'")),i){var o={t:Ro};Ht(a,o),e.f=[o]}else e.f=Ut(a)}else n&&t.error("Missing required directive arguments")}function re(t){var e,n;if(!1===t.interpolate[t.inside])return null;for(n=0;n<t.tags.length;n+=1)if(e=se(t,t.tags[n]))return e;return t.inTag&&!t.inAttribute&&(e=ee(t))?(t.sp(),e):void 0}function se(t,e){var n,i,r,s=t.pos;if(t.matchString("\\"+e.open)){if(0===s||"\\"!==t.str[s-1])return e.open}else if(!t.matchString(e.open))return null;if(n=pt(t))return t.matchString(e.close)?(e.open=n[0],e.close=n[1],t.sortMustacheTags(),Oh):null;if(t.sp(),t.matchString("/")){t.pos-=1;var a=t.pos;if(mt(t))t.pos=a;else{if(t.pos=a-e.close.length,t.inAttribute)return t.pos=s,null;t.error("Attempted to close a section that wasn't open")}}for(r=0;r<e.readers.length;r+=1)if(i=e.readers[r],n=i(t,e))return e.isStatic&&(n.s=1),t.includeLinePositions&&(n.q=t.getLinePos(s)),n;return t.pos=s,null}function ae(t,e){var n=Dt(t);if(!n)return null;t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'");var i={t:Bo};return Ht(n,i),i}function oe(t,e){if(!t.matchString("&"))return null;t.sp();var n=Dt(t);if(!n)return null;t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'");var i={t:Bo};return Ht(n,i),i}function ue(t){var e,n=[],i=t.pos;if(t.sp(),e=he(t)){for(e.x=Ht(e.x,{}),n.push(e),t.sp();t.matchString(",");)(e=he(t))||t.error("Expected another alias."),e.x=Ht(e.x,{}),n.push(e),t.sp();return n}return t.pos=i,null}function he(t){var e=t.pos;t.sp();var n=Dt(t,[]);if(!n)return t.pos=e,null;t.sp(),t.matchPattern(Nh),t.sp();var i=t.matchPattern(jh);return i?{n:i,x:n}:(t.pos=e,null)}function le(t,e){var n,i=t.matchString(">")||t.matchString("yield"),r={t:">"===i?zo:Go};if(!i)return null;if(t.sp(),">"===i||!(n=t.matchString("with"))){t.relaxedNames=t.strictRefinement=!0;var s=Dt(t);if(t.relaxedNames=t.strictRefinement=!1,!s&&">"===i)return null;s&&(Ht(s,r),t.sp(),">"!==i&&(n=t.matchString("with")))}if(t.sp(),n||">"===i){if((n=ue(t))&&n.length)r.z=n;else{var a=Dt(t);a&&(r.c={},Ht(a,r.c)),t.matchString(",")&&(n=ue(t))&&n.length&&(r.z=n)}">"===i||r.c||r.z||t.error("Expected a context or one or more aliases")}return t.sp(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r}function ce(t,e){if(!t.matchString("!"))return null;var n=t.remaining().indexOf(e.close);return-1!==n?(t.pos+=n+e.close.length,{t:Uo}):void 0}function fe(t,e){var n,i,r=t.pos;try{n=zt(t,[e.close])}catch(t){i=t}if(!n){if("!"===t.str.charAt(r))return t.pos=r,null;if(i)throw i}if(!t.matchString(e.close)&&(t.error("Expected closing delimiter '"+e.close+"' after reference"),!n)){if("!"===t.nextChar())return null;t.error("Expected expression or legal reference")}var s={t:Ro};return Ht(n,s),s}function de(t,e){var n=t.pos;if(!t.matchString(e.open))return null;if(t.sp(),!t.matchString("/"))return t.pos=n,null;t.sp();var i=t.remaining(),r=i.indexOf(e.close);if(-1!==r){var s={t:Do,r:i.substr(0,r).split(" ")[0]};return t.pos+=r,t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),s}return t.pos=n,null}function pe(t,e,n){var i=t.pos;if(!t.matchString(e.open))return null;if(!t.matchPattern(Th[n]))return t.pos=i,null;var r={t:Vh[n]};if("elseif"===n)r.x=Dt(t);else if("catch"===n||"then"===n){var s=t.matchPattern(nh);s&&(r.n=s)}return t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r}function me(t,e){var n,i,r,s,a,o,u,h,l,c,f,d,p,m=!1,v=t.pos;if(t.matchString("^")){if(t.matchString("^/"))return t.pos=v,null;i={t:Ko,f:[],n:gu}}else{if(!t.matchString("#"))return null;i={t:Ko,f:[]},t.matchString("partial")&&(t.pos=v-t.standardDelimiters[0].length,t.error("Partial definitions can only be at the top level of the template, or immediately inside components")),(o=t.matchString("await"))?(c=o,i.t=Xo):(o=t.matchPattern(Rh))&&(c=o,i.n=Mh[o])}if(t.sp(),"with"===o){var g=ue(t);g&&(m=!0,i.z=g,i.t=Jo)}else if("each"===o){var y=he(t);y&&(i.z=[{n:y.n,x:{r:"."}}],n=y.x)}if(!m){if(n||(n=Dt(t)),n||t.error("Expected expression"),"each"===o&&t.matchString(",")){var b=ue(t);b&&(i.z&&b.unshift(i.z[0]),i.z=b)}if("each"!==o&&o||!(l=t.matchPattern(Ph)))"await"===o&&t.matchString("then")&&(t.sp(),f=!0,(p=t.matchPattern(nh))||(p=!0));else{var w;(w=t.matchPattern(Ih))?i.i=l+","+w:i.i=l}!o&&n.n&&(c=n.n)}t.sp(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),t.sectionDepth+=1,s=i.f;var x;do{if(x=t.pos,r=de(t,e))c&&r.r!==c&&(o?(t.pos=x,t.error("Expected "+e.open+"/"+c+e.close)):r.r&&t.warn("Expected "+e.open+"/"+c+e.close+" but found "+e.open+"/"+r.r+e.close)),t.sectionDepth-=1,h=!0;else if(!m&&((r=pe(t,e,"elseif"))||(r=pe(t,e,"else"))||"await"===o&&((r=pe(t,e,"then"))||(r=pe(t,e,"catch"))))){if(i.n===gu&&t.error("{{else}} not allowed in {{#unless}}"),a&&(r.t===xu?t.error("there can only be one {{else}} block, at the end of a section"):r.t===ku&&t.error("illegal {{elseif...}} after {{else}}")),!u&&(p||!f)&&!d)if("await"===o){var k={f:s};i.f=[k],p?(k.t=_u,!0!==p&&(k.n=p)):k.t=Ko}else u=[];var _={t:Ko,f:s=[]};r.t===xu?("await"===o?(i.f.push(_),_.t=xu):(_.n=gu,u.push(_)),a=!0):r.t===ku?(_.n=vu,Ht(r.x,_),u.push(_)):r.t===_u?(a&&t.error("{{then}} block must appear before any {{else}} block"),d&&t.error("{{then}} block must appear before any {{catch}} block"),f&&t.error("there can only be one {{then}} block per {{#await}}"),_.t=_u,f=!0,r.n&&(_.n=r.n),i.f.push(_)):r.t===Eu&&(a&&t.error("{{catch}} block must appear before any {{else}} block"),d&&t.error("there can only be one {{catch}} block per {{#await}}"),_.t=Eu,d=!0,_.n=r.n,i.f.push(_))}else{if(!(r=t.read(rl)))break;s.push(r)}}while(!h);if(u&&(i.l=u),m||Ht(n,i),"await"===o&&(p||!f)&&!d&&!a){var E={f:i.f};i.f=[E],p?(E.t=_u,!0!==p&&(E.n=p)):E.t=Ko}return i.f.length||delete i.f,i}function ve(t){var e=t.pos;if(t.textOnlyMode||!t.matchString(Bh))return null;var n=t.remaining(),i=n.indexOf(Kh);-1===i&&t.error("Illegal HTML - expected closing comment sequence ('--\x3e')");var r=n.substr(0,i);t.pos+=i+3;var s={t:Uo,c:r};return t.includeLinePositions&&(s.q=t.getLinePos(e)),s}function ge(t){var e,n,i,r,s;for(e=1;e<t.length;e+=1)n=t[e],i=t[e-1],r=t[e-2],h(n)&&ye(i)&&h(r)&&Dh.test(r)&&Lh.test(n)&&(t[e-2]=r.replace(Dh,"\n"),t[e]=n.replace(Lh,"")),be(n)&&h(i)&&Dh.test(i)&&h(n.f[0])&&Lh.test(n.f[0])&&(t[e-1]=i.replace(Dh,"\n"),n.f[0]=n.f[0].replace(Lh,"")),h(n)&&be(i)&&h(s=T(i.f))&&Dh.test(s)&&Lh.test(n)&&(i.f[i.f.length-1]=s.replace(Dh,"\n"),t[e]=n.replace(Lh,""));return t}function ye(t){return t.t===Uo||t.t===$o}function be(t){return(t.t===Ko||t.t===Lo)&&t.f}function we(t,e,n){var i;e&&h(i=t[0])&&((i=i.replace(e,""))?t[0]=i:t.shift()),n&&h(i=T(t))&&((i=i.replace(n,""))?t[t.length-1]=i:t.pop())}function xe(t,e,n,i,r,s){if(!h(t)){var a,o,u,l,c,f,d;for(ge(t),a=t.length;a--;)(o=t[a]).exclude?t.splice(a,1):e&&o.t===Uo&&t.splice(a,1);for(we(t,i?zh:null,r?Uh:null),a=t.length;a--;){if(o=t[a],f=d=!1,o.f){var p=o.t===Fo&&(s[o.e.toLowerCase()]||s[o.e]);c=n||p,!n&&p&&we(o.f,$h,qh),c||(u=t[a-1],l=t[a+1],(!u||h(u)&&Uh.test(u))&&(f=!0),(!l||h(l)&&zh.test(l))&&(d=!0)),xe(o.f,e,c,f,d,s)}o.l&&(xe(o.l,e,n,f,d,s),o.l.forEach(function(t){return t.l=1}),o.l.unshift(a+1,0),t.splice.apply(t,o.l),delete o.l),o.m&&(xe(o.m,e,n,f,d,s),o.m.length<1&&delete o.m)}for(a=t.length;a--;)h(t[a])&&(h(t[a+1])&&(t[a]=t[a]+t[a+1],t.splice(a+1,1)),n||(t[a]=t[a].replace(Fh," ")),""===t[a]&&t.splice(a,1))}}function ke(t){var e,n=t.pos;return t.matchString("</")?(e=t.matchPattern(Hh))?t.inside&&e!==t.inside?(t.pos=n,null):{t:Zo,e:e}:(t.pos-=2,void t.error("Illegal closing tag")):null}function _e(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})}function Ee(t){var e,n,i,r,s,a,o,u,l,c,f,d=t.pos;if(t.inside||t.inAttribute||t.textOnlyMode)return null;if(!t.matchString("<"))return null;if("/"===t.nextChar())return null;var p={};if(t.includeLinePositions&&(p.q=t.getLinePos(d)),t.matchString("!"))return p.t=Yo,t.matchPattern(/^doctype/i)||t.error("Expected DOCTYPE declaration"),p.a=t.matchPattern(/^(.+?)>/),p;if(f=t.matchString("#"))t.sp(),p.t=qo,p.n=t.matchPattern(Wh);else if(p.t=Fo,p.e=t.matchPattern(Zh),!p.e)return null;for(Gh.test(t.nextChar())||t.error("Illegal tag name"),t.sp(),t.inTag=!0;e=re(t);)!1!==e&&(p.m||(p.m=[]),p.m.push(e)),t.sp();if(t.inTag=!1,t.sp(),t.matchString("/")&&(n=!0),!t.matchString(">"))return null;var m=(p.e||p.n).toLowerCase(),v=t.preserveWhitespace;if(!n&&(f||!Ru[p.e.toLowerCase()])){f||(t.elementStack.push(m),m in t.interpolate&&(t.inside=m)),i=[],r=Ia(null);do{if(u=t.pos,!(l=t.remaining())){if("script"===t.inside){o=!0;break}t.error("Missing end "+(t.elementStack.length>1?"tags":"tag")+" ("+t.elementStack.reverse().map(function(t){return"</"+t+">"}).join("")+")")}if(f||Ae(m,l))if(!f&&(c=ke(t))){o=!0;var g=c.e.toLowerCase();if(g!==m&&(t.pos=u,!~t.elementStack.indexOf(g))){var y="Unexpected closing tag";Ru[g.toLowerCase()]&&(y+=" (<"+g+"> is a void element - it cannot contain children)"),t.error(y)}}else if(f&&Se(t,p.n))o=!0;else{var b={open:t.standardDelimiters[0],close:t.standardDelimiters[1]};de(t,b)||Ce(t,b)?(o=!0,t.pos=u):(a=t.read(sl))?(r[a.n]&&(t.pos=u,t.error("Duplicate partial definition")),xe(a.f,t.stripComments,v,!v,!v,t.whiteSpaceElements),r[a.n]=a.f,s=!0):(a=t.read(rl))?i.push(a):o=!0}else o=!0}while(!o);i.length&&(p.f=i),s&&(p.p=r),t.elementStack.pop()}if(t.inside=null,t.sanitizeElements&&-1!==t.sanitizeElements.indexOf(m))return Yh;if(p.m&&"input"!==m&&"select"!==m&&"textarea"!==m&&"option"!==m){for(var w,x,k,_,E,A=p.m,S=0;S<A.length;)(E=A[S]).t===Ho?0!==E.n.indexOf("class-")||E.f?0===E.n.indexOf("style-")&&h(E.f)?((x||(x=[])).push(_e(E.n.slice(6))+": "+E.f+";"),A.splice(S,1)):"class"===E.n&&h(E.f)?((w||(w=[])).push(E.f),A.splice(S,1)):"style"===E.n&&h(E.f)?((x||(x=[])).push(E.f+(Qh.test(E.f)?"":";")),A.splice(S,1)):"class"===E.n?(k=E,S++):"style"===E.n?(_=E,S++):!~E.n.indexOf(":")&&"value"!==E.n&&"contenteditable"!==E.n&&h(E.f)?(E.g=1,S++):S++:((w||(w=[])).push(E.n.slice(6)),A.splice(S,1)):S++;w?k&&h(k.f)?k.f+=" "+w.join(" "):A.unshift({t:Ho,n:"class",f:w.join(" "),g:1}):k&&h(k.f)&&(k.g=1),x?_&&h(_.f)?_.f+="; "+x.join(" "):A.unshift({t:Ho,n:"style",f:x.join(" "),g:1}):_&&h(_.f)&&(_.g=1)}return p}function Ae(t,e){var n=/^<([a-zA-Z][a-zA-Z0-9]*)/.exec(e),i=Jh[t];return!n||!i||!~i.indexOf(n[1].toLowerCase())}function Se(t,e){var n=t.pos;return t.matchString("</")?(t.matchString("#"),t.sp(),t.matchString(e)?(t.sp(),!!t.matchString(">")||(t.pos=n,null)):(t.pos=n,null)):null}function Ce(t,e){var n=t.pos;if(t.matchString(e.open))return!!t.matchPattern(Xh)||void(t.pos=n)}function Oe(t){var e,n,i,r=t.remaining();return t.textOnlyMode?e=gt(r,n=(n=t.tags.map(function(t){return t.open})).concat(t.tags.map(function(t){return"\\"+t.open}))):(i=t.inside?"</"+t.inside:"<",t.inside&&!t.interpolate[t.inside]?e=r.indexOf(i):(n=(n=t.tags.map(function(t){return t.open})).concat(t.tags.map(function(t){return"\\"+t.open})),!0===t.inAttribute?n.push('"',"'","=","<",">","`"):t.inAttribute?n.push(t.inAttribute):n.push(i),e=gt(r,n))),e?(-1===e&&(e=r.length),t.pos+=e,t.inside&&"textarea"!==t.inside||t.textOnlyMode?r.substr(0,e):yt(r.substr(0,e))):null}function je(t){var e,n,i=t.pos,r=t.standardDelimiters;if(!t.matchString(r[0]))return null;if(!t.matchPattern(tl))return t.pos=i,null;var s=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-\/]*/);s||t.error("expected legal partial name"),t.sp(),t.matchString(r[1])||t.error("Expected closing delimiter '"+r[1]+"'");var a=[],o=r[0],u=r[1];do{(e=de(t,{open:o,close:u}))?("partial"!==e.r&&t.error("Expected "+o+"/partial"+u),n=!0):((e=t.read(rl))||t.error("Expected "+o+"/partial"+u),a.push(e))}while(!n);return{t:Qo,n:s,f:a}}function Ne(t){for(var e=[],n=Ia(null),i=!1,r=t.preserveWhitespace;t.pos<t.str.length;){var s=t.pos,a=void 0,o=void 0;(o=t.read(sl))?(n[o.n]&&(t.pos=s,t.error("Duplicated partial definition")),xe(o.f,t.stripComments,r,!r,!r,t.whiteSpaceElements),n[o.n]=o.f,i=!0):(a=t.read(rl))?e.push(a):t.error("Unexpected template content")}var u={v:No,t:e};return i&&(u.p=n),u}function Te(t,e){Ka(t).forEach(function(n){if(Ve(n,t))return Me(t,e);var i=t[n];Pe(i)&&Te(i,e)})}function Ve(t,e){return"s"===t&&Da(e.r)}function Me(t,e){var n=t.s,i=t.r;e[n]||(e[n]=ct(n,i.length))}function Pe(t){return Da(t)||s(t)}function Ie(t,e){return new ul(t,e||{}).result}function Re(t,e,n){t||p("Missing Ractive.parse - cannot parse "+e+". "+n)}function Be(t,e){return Re(ct,"new expression function",ll),ct(t,e)}function Ke(t,e){Re(Ie,'compution string "${str}"',cl);var n=Ie(t,{expression:!0});return function(){return n.e.apply(e,n.r.map(function(t){return e.get(t)}))}}function Le(t,e,n){var i,r,s,a,l;return u(n)&&(i=B(n,t),s=n.toString(),a=!0),h(n)&&(i=Ke(n,t),s=n),o(n)&&(h(n.get)?(i=Ke(n.get,t),s=n.get):u(n.get)?(i=B(n.get,t),s=n.get.toString(),a=!0):p("`%s` computation must have a `get()` method",e),u(n.set)&&(r=B(n.set,t),l=n.set.toString())),{getter:i,setter:r,getterString:s,setterString:l,getterUseStack:a}}function De(t){!t.started||t.outros.length||t.outroChildren||(t.outrosComplete||(t.outrosComplete=!0,t.parent&&t.parent.decrementOutros(t),t.parent&&!t.parent.outrosComplete||t.detachNodes()),t.intros.length||t.totalChildren||(u(t.callback)&&t.callback(),t.parent&&!t.notifiedTotal&&(t.notifiedTotal=!0,t.parent.decrementTotal())))}function Fe(t){var e=t.detachQueue,n=ze(t);if(n.length){var i,r,s=e.length,a=0,o=t.detachQueue=[];t:for(;s--;){for(i=e[s].node,a=n.length;a--;)if((r=n[a].element.node)===i||r.contains(i)||i.contains(r)){o.push(e[s]);continue t}e[s].detach()}}else t.detachNodes()}function ze(t,e){var n=e;if(n){for(var i=t.children.length;i--;)n=ze(t.children[i],n);return t.outros.length&&(n=n.concat(t.outros)),n}n=[];for(var r=t;r.parent;)r=r.parent;return ze(r,n)}function Ue(t){t.dispatch()}function $e(){var t=vl.immediateObservers;vl.immediateObservers=[],t.forEach(Ue);var e=vl.fragments.length;for(t=vl.fragments,vl.fragments=[];e--;)t[e].update();vl.transitionManager.ready(),t=vl.deferredObservers,vl.deferredObservers=[],t.forEach(Ue);var n=vl.tasks;for(vl.tasks=[],e=0;e<n.length;e+=1)n[e]();if(vl.fragments.length||vl.immediateObservers.length||vl.deferredObservers.length||vl.tasks.length)return $e()}function qe(){gl.start();var t,e=performance.now();for(t=0;t<yl.length;t+=1)yl[t].tick(e)||yl.splice(t--,1);gl.end(),yl.length?requestAnimationFrame(qe):bl=!1}function He(e,n){var i={};if(!n)return e;n+=".";for(var r in e)t(e,r)&&(i[n+r]=e[r]);return i}function Ze(t){var e;return kl[t]||(e=t?t+".":"",kl[t]=function(n,i){var r;return h(n)?(r={},r[e+n]=i,r):o(n)?e?He(n,t):n:void 0}),kl[t]}function We(t){for(var e=[],n=0;n<t.length;n++)e[n]=(t.childByKey[n]||{}).value;return e}function Ge(t){for(var e=t;e&&!e.context&&!e.aliases;)e=e.parent;return e}function Qe(e,n){var i=e;if("."===n)return e.findContext();if("~"===n[0])return e.ractive.viewmodel.joinAll(A(n.slice(2)));if("."===n[0]||"^"===n[0]){for(var r=e,s=n.split("/"),a="^^"===s[0];r&&!r.context;)r=Ye(r);for(var o=r&&r.context;r&&"^^"===s[0];){for(s.shift(),r=r.isIteration?r.parent.parent:Ye(r);r&&!r.context;)r=Ye(r);o=r&&r.context}if(!o&&a)throw new Error("Invalid context parent reference ('"+n+"'). There is not context at that level.");for(;"."===s[0]||".."===s[0];)".."===s.shift()&&(o=o.parent);return"."===(n=s.join("/"))[0]&&(n=n.slice(1)),o.joinAll(A(n))}var h=A(n);if(h.length){var l=h.shift();if("@"===l[0]){if("@this"===l||"@"===l)return e.ractive.viewmodel.getRactiveModel().joinAll(h);if("@index"===l||"@key"===l){h.length&&tn(l);var c=Je(e);return c&&c["get"+("i"===l[1]?"Index":"Key")]()}if("@last"===l){var f=Je(e);return f&&f.parent.getLast()}if("@global"===l)return Ol.joinAll(h);if("@shared"===l)return Cl.joinAll(h);if("@keypath"===l||"@rootpath"===l){for(var d="r"===n[1]?e.ractive.root:null,p=e;p&&(!p.context||p.isRoot&&p.ractive.component&&(d||!p.ractive.isolated));)p=p.isRoot?p.componentParent:p.parent;return p.getKeypath(d)}if("@context"===l)return new Sl(e.getContext(),"context").joinAll(h);if("@local"===l)return e.getContext()._data.joinAll(h);if("@style"===l)return e.ractive.constructor._cssModel.joinAll(h);if("@helpers"===l)return e.ractive.viewmodel.getHelpers().joinAll(h);if("@macro"===l){var m=Xe(e);return m?new Sl(m,"macro").joinAll(h):void 0}throw new Error("Invalid special reference '"+l+"'")}if(l&&!h.length){var v=e.ractive.viewmodel.getHelpers();if(v.has(l))return v.joinKey(l)}var g=Ge(e);g=g&&g.context?g.context:e.findContext();for(var b,w=!1,x=e.ractive.warnAboutAmbiguity,k=0;e;){if(e.isIteration&&(l===e.parent.keyRef?b=e.getKey():l===e.parent.indexRef&&(b=e.getIndex()),b&&h.length&&tn(l)),!b&&e.aliases&&t(e.aliases,l)&&(b=e.aliases[l]),!b&&e.context&&e.context.has(l)&&(b=e.context.joinKey(l),w?x&&y("'"+n+"' resolved but is ambiguous and will create a mapping to a parent component."):x&&k&&y("'"+n+"' resolved but is ambiguous.")),b)return w&&(b=i.ractive.viewmodel.createLink(l,b,l,{implicit:!0})),h.length>0&&u(b.joinAll)&&(b=b.joinAll(h)),b;e.context&&!e.aliases&&(k=1),(e.componentParent||!e.parent&&e.ractive.component)&&!e.ractive.isolated?(e=e.componentParent||e.ractive.component.up,w=!0):e=e.parent}var _=i.ractive;return _.resolveInstanceMembers&&"data"!==l&&l in _?_.viewmodel.getRactiveModel().joinKey(l).joinAll(h):(x&&y("'"+n+"' is ambiguous and did not resolve."),g.joinKey(l).joinAll(h))}}function Ye(t){return t&&(!t.ractive.isolated&&t.componentParent||t.parent)}function Je(t){for(var e,n=t;!n.isIteration&&(e=Ye(n));)n=e;return n.isIteration&&n}function Xe(t){for(var e=t;e;){if(e.owner.handle)return e.owner.handle;e=Ye(e)}}function tn(t){throw new Error("An index or key reference ("+t+") cannot have child properties")}function en(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=t.fragment||t._fakeFragment||(t._fakeFragment=new Nl(t));return i.getContext.apply(i,e)}function nn(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.ctx||(this.ctx=new jl.Context(this)),t.unshift(Ia(this.ctx)),Pa.apply(null,t)}function rn(t){for(var e=t;e&&!e.context;)e=e.parent;return e||t&&t.ractive.fragment}function sn(t,e){var n=Vl,i=e&&e.deep,r=e&&e.shuffle,s=gl.start();e&&"keep"in e&&(Vl=e.keep);for(var a=t.length;a--;){var o=t[a][0],u=t[a][1],h=t[a][2];if(!o)throw gl.end(),new Error("Failed to set invalid keypath '"+h+"'");if(i)un(o,u);else if(r){var l=u,f=o.get();if(l||(l=f),c(f))o.set(l);else{if(!Da(f)||!Da(l))throw gl.end(),new Error("You cannot merge an array with a non-array");var d=hn(r);o.merge(l,d)}}else o.set(u)}return gl.end(),Vl=n,s}function an(t,e,n,i){if(!n&&("."===e[0]||"^"===e[1]))return y("Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths."),[];var r=A(e),s=n||t.viewmodel;return Ml.test(e)?s.findMatches(r):s===t.viewmodel?!t.component||t.isolated||s.has(r[0])||"@"===e[0]||!e[0]||i?[s.joinAll(r)]:[Qe(t.fragment||new Nl(t),e)]:[s.joinAll(r)]}function on(e,n,i,r){var a=[];if(s(n)){for(var o in n)!function(i){t(n,i)&&a.push.apply(a,an(e,i,null,r).map(function(t){return[t,n[i],i]}))}(o)}else a.push.apply(a,an(e,n,null,r).map(function(t){return[t,i,n]}));return a}function un(e,n){var i=e.get(!1,Pl);if(null==i||!o(n))return e.set(n);if(!o(i))return e.set(n);for(var r in n)t(n,r)&&un(e.joinKey(r),n[r])}function hn(t){if(!0===t)return null;if(u(t))return t;if(h(t))return Il[t]||(Il[t]=function(e){return e[t]});throw new Error("If supplied, options.compare must be a string, function, or true")}function ln(t,e,n,i){if(!h(e)||!r(n))throw new Error("Bad arguments");return sn(on(t,e,n,i&&i.isolated).map(function(t){var e=t[0],n=t[1],i=e.get();if(!r(n)||!r(i))throw new Error(Rl);return[e,i+n]}))}function cn(t,e,n){return ln(this,t,l(e)?e:1,o(e)?e:n)}function fn(t){var e=Promise.resolve(t);return Ra(e,"stop",{value:f}),e}function dn(t,e){var n;return(t=t||{}).easing&&(n=u(t.easing)?t.easing:e.easing[t.easing]),{easing:n||Bl,duration:"duration"in t?t.duration:400,complete:t.complete||f,step:t.step||f,interpolator:t.interpolator}}function pn(t,e,n,r){r=dn(r,t);var s=e.get();if(i(s,n))return r.complete(r.to),fn(n);var a=k(s,n,t,r.interpolator);return a?e.animate(s,n,r,a):(gl.start(),e.set(n),gl.end(),fn(n))}function mn(t,e,n){if(o(t)){var i=Ka(t);throw new Error("ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  "+i.map(function(e){return"'"+e+"': "+t[e]}).join("\n  ")+"\n}, {...}), do\n\n"+i.map(function(e){return"ractive.animate('"+e+"', "+t[e]+", {...});"}).join("\n")+"\n")}return pn(this,this.viewmodel.joinAll(A(t)),e,n)}function vn(t,e){t.event&&t._eventQueue.push(t.event),t.event=e}function gn(t){t._eventQueue.length?t.event=t._eventQueue.pop():t.event=null}function yn(t,e){var n=e?Kl:Ll;if(n[t])return n[t];var i=t.split("."),r=[],s=!1;e&&(i.unshift("this"),s=!0);for(var a=Math.pow(2,i.length)-(e?1:0),o=0;o<a;o++){for(var u=[],h=0;h<i.length;h++)u.push(1&o>>h?"*":i[h]);r.unshift(u.join("."))}return s&&(i.length>2?r.push.apply(r,yn(t,!1)):(r.push("*"),r.push(t))),n[t]=r,r}function bn(t,e,n,i){if(void 0===i&&(i=[]),e)return n.name=e,i.unshift(n),wn(t,t._nsSubs?yn(e,!0):["*",e],n,i,!0)}function wn(t,e,n,i,r){void 0===r&&(r=!1);var s=!0;if(r||t._nsSubs){vn(t,n);for(var a=e.length;a--;)e[a]in t._subs&&(s=xn(t,t._subs[e[a]],n,i)&&s);gn(t)}return t.parent&&s&&(r&&t.component&&(e=yn(t.component.name+"."+e[e.length-1],!1),n&&!n.component&&(n.component=t)),s=wn(t.parent,e,n,i)),s}function xn(t,e,n,i){for(var r=null,s=!1,a=0,o=(e=e.slice()).length;a<o;a+=1)e[a].off||!1!==e[a].handler.apply(t,i)||(s=!0);return n&&s&&(r=n.event)&&(r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation()),!s}function kn(t,e){return t[e._guid]||(t[e._guid]=[])}function _n(t,e){var n=kn(t.queue,e);for(t.hook.fire(e);n.length;)_n(t,n.shift());delete t.queue[e._guid]}function En(t,e){void 0===e&&(e=null);var n=[];return An(t,e,n),n}function An(t,e,n){t.isAnchor?e&&t.name!==e||n.push(t):t.items?t.items.forEach(function(t){return An(t,e,n)}):t.iterations?t.iterations.forEach(function(t){return An(t,e,n)}):t.fragment&&!t.component&&An(t.fragment,e,n)}function Sn(t,e){void 0===e&&(e=null);var n=En(t.fragment,e),i={},r=t._children.byName;n.forEach(function(t){var e=t.name;e in i||(i[e]=0);var n=i[e],s=(r[e]||[])[n];s&&s.lastBound!==t&&(s.lastBound&&s.lastBound.removeChild(s),t.addChild(s)),i[e]++})}function Cn(t){t.instance.fragment.rendered&&(t.shouldDestroy=!0,t.instance.unrender()),t.instance.el=null}function On(t,e){void 0===e&&(e={});var n,i=this._children;if(t.parent&&t.parent!==this)throw new Error("Instance "+t._guid+" is already attached to a different instance "+t.parent._guid+". Please detach it from the other instance using detachChild first.");if(t.parent)throw new Error("Instance "+t._guid+" is already attached to this instance.");var r={instance:t,ractive:this,name:e.name||t.constructor.name||"Ractive",target:e.target||!1,bubble:jn,findNextNode:Nn};if(r.nameOption=e.name,r.target){var s;(s=i.byName[r.target])||(s=[],this.set("@this.children.byName."+r.target,s)),n=e.prepend?0:void 0!==e.insertAt?e.insertAt:s.length}else r.up=this.fragment,r.external=!0;t.parent=this,t.root=this.root,t.component=r,i.push(r);var a=gl.start(),o=t.viewmodel.getRactiveModel();return o.joinKey("parent",{lastLink:!1}).link(this.viewmodel.getRactiveModel()),o.joinKey("root",{lastLink:!1}).link(this.root.viewmodel.getRactiveModel()),Ul.attachchild.fire(t),r.target?(Cn(r),this.splice("@this.children.byName."+r.target,n,0,r),Sn(this,r.target)):t.isolated||t.viewmodel.attached(this.fragment),gl.end(),a.ractive=t,a.then(function(){return t})}function jn(){gl.addFragment(this.instance.fragment)}function Nn(){if(this.anchor)return this.anchor.findNextNode()}function Tn(t,e){this.computed[t]=e,(h(e)||u(e))&&(e=this.computed[t]={get:e});var n=A(t);if(!~t.indexOf("*")){var i=n.pop();return this.viewmodel.joinAll(n).compute(i,e)}e.pattern=new RegExp("^"+n.map(function(t){return t.replace(/\*\*/g,"(.+)").replace(/\*/g,"((?:\\\\.|[^\\.])+)")}).join("\\.")+"$")}function Vn(t,e){var n=gl.start(),i=Tn.call(this,t,e);if(i){var r=A(t);1!==r.length||i.isReadonly||i.set(this.viewmodel.value[r[0]]);var s=r.reduce(function(t,e){return t&&t.childByKey[e]},this.viewmodel);s&&(s.rebind(i,s,!1),s.parent&&delete s.parent.childByKey[s.key],F())}return gl.end(),n}function Mn(){return this.isDetached?this.el:(this.el&&V(this.el.__ractive_instances__,this),this.el=this.fragment.detach(),this.isDetached=!0,Ul.detach.fire(this),this.el)}function Pn(t){for(var e,n,i=this._children,r=i.length;r--;)if(i[r].instance===t){n=r,e=i[r];break}if(!e||t.parent!==this)throw new Error("Instance "+t._guid+" is not attached to this instance.");var s=gl.start();e.anchor&&e.anchor.removeChild(e),t.isolated||t.viewmodel.detached(),i.splice(n,1),e.target&&(this.splice("@this.children.byName."+e.target,i.byName[e.target].indexOf(e),1),Sn(this,e.target));var a=t.viewmodel.getRactiveModel();return a.joinKey("parent",{lastLink:!1}).unlink(),a.joinKey("root",{lastLink:!1}).link(a),t.root=t,t.parent=null,t.component=null,Ul.detachchild.fire(t),gl.end(),s.ractive=t,s.then(function(){return t})}function In(t,e){var n=this;if(void 0===e&&(e={}),!this.rendered)throw new Error("Cannot call ractive.find('"+t+"') unless instance is rendered to the DOM");var i=this.fragment.find(t,e);if(i)return i;if(e.remote)for(var r=0;r<this._children.length;r++)if(n._children[r].instance.fragment.rendered&&(i=n._children[r].instance.find(t,e)))return i}function Rn(t,e){if(void 0===e&&(e={}),!this.rendered)throw new Error("Cannot call ractive.findAll('"+t+"', ...) unless instance is rendered to the DOM");return Da(e.result)||(e.result=[]),this.fragment.findAll(t,e),e.remote&&this._children.forEach(function(n){!n.target&&n.instance.fragment&&n.instance.fragment.rendered&&n.instance.findAll(t,e)}),e.result}function Bn(t,e){return!e&&o(t)&&(e=t,t=""),e=e||{},Da(e.result)||(e.result=[]),this.fragment.findAllComponents(t,e),e.remote&&this._children.forEach(function(n){!n.target&&n.instance.fragment&&n.instance.fragment.rendered&&(t&&n.name!==t||e.result.push(n.instance),n.instance.findAllComponents(t,e))}),e.result}function Kn(t,e){var n=this;void 0===e&&(e={}),o(t)&&(e=t,t="");var i=this.fragment.findComponent(t,e);if(i)return i;if(e.remote){if(!t&&this._children.length)return this._children[0].instance;for(var r=0;r<this._children.length;r++)if(!n._children[r].target){if(n._children[r].name===t)return n._children[r].instance;if(i=n._children[r].instance.findComponent(t,e))return i}}}function Ln(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function Dn(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function Fn(t,e,n){for(void 0===e&&(e=!0);t&&(t.type!==Fo||n&&t.name!==n)&&(!e||t.type!==Wo&&t.type!==qo);)t=t.owner?t.owner:t.component||t.yield?t.containerFragment||t.component.up:t.parent?t.parent:t.up?t.up:void 0;return t}function zn(t,e,n){var i=[],r=Un(t,e,n);if(!r)return null;var s=r.length-2-r[1],a=Math.min(t,r[0]),o=a+r[1];i.startIndex=a;var u;for(u=0;u<a;u+=1)i.push(u);for(;u<o;u+=1)i.push(-1);for(;u<t;u+=1)i.push(u+s);return i.touchedFrom=0!==s?r[0]:t,i}function Un(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t+Math.max(n[0],-t)),c(n[0])&&(n[0]=0);n.length<2;)n.push(t-n[0]);return l(n[1])||(n[1]=t-n[0]),n[1]=Math.min(n[1],t-n[0]),n;case"sort":case"reverse":return null;case"pop":return t?[t-1,1]:[0,0];case"push":return[t,0].concat(n);case"shift":return[0,t?1:0];case"unshift":return[0,0].concat(n)}}function $n(t){function e(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return n(this.viewmodel.joinAll(A(t)),e)}function n(e,n){var i=e.get();if(!Da(i)){if(c(i)){i=[];var r=$l[t].apply(i,n),s=gl.start().then(function(){return r});return e.set(i),gl.end(),s}throw new Error("shuffle array method "+t+" called on non-array at "+e.getKeypath())}var a=zn(i.length,t,n),o=$l[t].apply(i,n),u=gl.start().then(function(){return o});return u.result=o,a?e.shuffle?e.shuffle(a):e.mark():e.set(o),gl.end(),u}return{path:e,model:n}}function qn(t,e,n){e.parent&&e.parent.wrapper&&e.parent.adapt();var i=gl.start();return e.mark(n&&n.force),e.notifyUpstream(),gl.end(),Ul.update.fire(t,e),i}function Hn(t,e){var n,i;return h(t)?(i=A(t),n=e):n=t,qn(this,i?this.viewmodel.joinAll(i):this.viewmodel,n)}function Zn(e,n,i){var r=[];if(s(n))for(var a in n)t(n,a)&&r.push([Wn(e,a).model,n[a]]);else r.push([Wn(e,n).model,i]);return r}function Wn(t,e){var n=t.fragment;return h(e)?{model:Qe(n,e),instance:n.ractive}:{model:n.findContext(),instance:e}}function Gn(t,e){return t.events&&t.events.find&&t.events.find(function(t){return~t.template.n.indexOf(e)})}function Qn(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i;if(e[0]instanceof Xl){var r=e.shift();i=Ia(r),Pa(i,r)}else i=!o(e[0])||null!==e[0]&&e[0].constructor!==Object?Xl.forRactive(this):Xl.forRactive(this,e.shift());return bn(this,t,i,e)}function Yn(t,e){if(!h(t))return this.viewmodel.get(!0,t);var n=A(t),i=n[0];return this.viewmodel.has(i)||this.component&&!this.isolated&&Qe(this.fragment||new Nl(this),i),this.viewmodel.joinAll(n).get(!0,e)}function Jn(t){h(t)&&cc&&(t=cc.call(document,t));var e;if(t){if(t._ractive)return t._ractive.proxy.getContext();if(!(e=t.__ractive_instances__))return Jn(t.parentNode);if(1===e.length)return en(e[0])}}function Xn(t,e){return t?(h(t)&&(t=this.find(t,e)),Jn(t)):en(this)}function ti(){return Ua.createDocumentFragment()}function ei(t){var e;if(t&&"boolean"!=typeof t){if(!za||!Ua||!t)return null;if(t.nodeType)return t;if(h(t)){if(!(e=Ua.getElementById(t))&&Ua.querySelector)try{e=Ua.querySelector(t)}catch(t){}if(e&&e.nodeType)return e}return t[0]&&t[0].nodeType?t[0]:null}}function ni(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function ii(t){return null==t||l(t)&&isNaN(t)||!t.toString?"":""+t}function ri(t){return ii(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function si(t,e){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(t=ei(t),e=ei(e)||null,!t)throw new Error("You must specify a valid target to insert into");t.insertBefore(this.detach(),e),this.el=t,(t.__ractive_instances__||(t.__ractive_instances__=[])).push(this),this.isDetached=!1,ai(this)}function ai(t){Ul.insert.fire(t),t.findAllComponents("*").forEach(function(t){ai(t.instance)})}function oi(t,e,n){var i,r=n&&(n.ractive||n.instance)||this,s=A(t);!r.viewmodel.has(s[0])&&r.component&&(i=(i=Qe(r.component.up,s[0])).joinAll(s.slice(1)));var a=i||r.viewmodel.joinAll(s),o=this.viewmodel.joinAll(A(e),{lastLink:!1});if(ui(a,o)||ui(o,a))throw new Error("A keypath cannot be linked to itself.");var u=gl.start();return o.link(a,n&&n.keypath||t),gl.end(),u}function ui(t,e){for(var n=e;n;){if(n===t||n.owner===t)return!0;n=n.target||n.parent}}function hi(t,e){var n=e&&t.model?t.model.get():t.newValue;t.oldValue=t.oldFn?t.oldFn.call(t.oldContext,void 0,n,t.keypath):n}function li(t,e,n){var i=t.oldValues;t.oldFn?(n||(t.oldValues={}),Ka(e).forEach(function(n){var r=[i[n],e[n],n],s=t.pattern.exec(n);s&&r.push.apply(r,s.slice(1)),t.oldValues[n]=t.oldFn.apply(t.oldContext,r)})):n?Ka(e).forEach(function(t){return i[t]=e[t]}):t.oldValues=e}function ci(){return-1}function fi(t,e,n){var i,r,a=this,o=[];s(t)?(i=t,r=e||{}):u(t)?(i={"":t},r=e||{}):((i={})[t]=e,r=n||{});var h=!1;return Ka(i).forEach(function(t){var e=i[t],n=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(!h)return e.apply(this,t)},s=t.split(" ");s.length>1&&(s=s.filter(function(t){return t})),s.forEach(function(t){r.keypath=t;var e=di(a,t,n,r);e&&o.push(e)})}),this._observers.push.apply(this._observers,o),{cancel:function(){return o.forEach(function(t){return t.cancel()})},isSilenced:function(){return h},silence:function(){return h=!0},resume:function(){return h=!1}}}function di(t,e,n,i){var r=A(e),s=r.indexOf("*");~s||(s=r.indexOf("**")),i.fragment=i.fragment||t.fragment;var a;if(i.fragment?~r[0].indexOf(".*")?(a=i.fragment.findContext(),s=0,r[0]=r[0].slice(1)):a=0===s?i.fragment.findContext():Qe(i.fragment,r[0]):a=t.viewmodel.joinKey(r[0]),a||(a=t.viewmodel.joinKey(r[0])),~s){var o=r.indexOf("**");return~o&&(o+1!==r.length||~r.indexOf("*"))?void b("Recursive observers may only specify a single '**' at the end of the path."):(a=a.joinAll(r.slice(1,s)),new yc(t,a,r.slice(s),n,i))}return a=a.joinAll(r.slice(1)),i.array?new wc(t,a,n,i):new mc(t,a,n,i)}function pi(t,e,n){return s(t)||u(t)?(n=Pa(e||{},kc),this.observe(t,n)):(n=Pa(n||{},kc),this.observe(t,e,n))}function mi(t,e){var n=this;return t?t.split(" ").map(_c).filter(Ec).forEach(function(t){var i=n._subs[t];if(i&&e){var r=i.find(function(t){return t.callback===e});r&&(V(i,r),r.off=!0,t.indexOf(".")&&n._nsSubs--)}else i&&(t.indexOf(".")&&(n._nsSubs-=i.length),i.length=0)}):this._subs={},this}function vi(e,n){var i=this,r=o(e)?e:{};h(e)&&(r[e]=n);var s=!1,a=[];for(var u in r)!function(e){var n=r[e],o={callback:n,handler:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(!s)return n.apply(this,t)}};t(r,e)&&e.split(" ").map(_c).filter(Ec).forEach(function(t){(i._subs[t]||(i._subs[t]=[])).push(o),t.indexOf(".")&&i._nsSubs++,a.push([t,o])})}(u);return{cancel:function(){return a.forEach(function(t){return i.off(t[0],t[1].callback)})},isSilenced:function(){return s},silence:function(){return s=!0},resume:function(){return s=!1}}}function gi(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function yi(t,e){void 0===e&&(e={});var n=A(t);if(this.viewmodel.has(n[0])){var i=this.viewmodel.joinAll(n);if(!i.isLink)return;for(;(i=i.target)&&!1!==e.canonical&&i.isLink;);if(i)return{ractive:i.root.ractive,keypath:i.getKeypath()}}}function bi(t){Oc.push(t),jc=!0}function wi(t){var e=ki();e&&(t||jc)&&(Tc?e.styleSheet.cssText=xi(null):e.innerHTML=xi(null),jc=!1)}function xi(t){var e=t?Oc.filter(function(e){return~t.indexOf(e.id)}):Oc;return e.forEach(function(t){return t.applied=!0}),e.reduce(function(t,e){return t?t+"\n\n/* {"+e.id+"} */\n"+e.styles:""},Cc)}function ki(){return Ua&&!Nc&&((Nc=Ua.createElement("style")).type="text/css",Nc.setAttribute("data-ractive-css",""),Ua.getElementsByTagName("head")[0].appendChild(Nc),Tc=!!Nc.styleSheet),Nc}function _i(t,e,n){void 0===n&&(n=[]);var i=[],r=function(t){return t.replace(Ic,function(t,e){return i[e]})};return t=t.replace(Pc,function(t){return"\0"+(i.push(t)-1)}).replace(Mc,""),n.forEach(function(e){t=t.replace(e,function(t){return"\0"+(i.push(t)-1)})}),e(t,r)}function Ei(t){return t.trim()}function Ai(t){return t.str}function Si(t,e){for(var n,i=[];n=Dc.exec(t);)i.push({str:n[0],base:n[1],modifiers:n[2]});for(var r=i.map(Ai),s=[],a=i.length;a--;){var o=r.slice(),u=i[a];o[a]=u.base+e+u.modifiers||"";var h=r.slice();h[a]=e+" "+h[a],s.push(o.join(" "),h.join(" "))}return s.join(", ")}function Ci(t,e){var n='[data-ractive-css~="{'+e+'}"]';return zc.test(t)?t.replace(zc,n):_i(t,function(t,e){return t=t.replace(Bc,"$&").replace(Rc,function(t,e){if(Fc.test(e))return t;var i=e.split(",").map(Ei).map(function(t){return Si(t,n)}).join(", ")+" ";return t.replace(e,i)}).replace(Kc,""),e(t)},[Lc])}function Oi(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function ji(){return Oi()+Oi()+"-"+Oi()+"-"+Oi()+"-"+Oi()+"-"+Oi()+Oi()+Oi()}function Ni(t,e,n){var i=o(t)?e:n,r=this._cssModel;r.locked=!0;var s=sn(on({viewmodel:r},t,e,!0),i);r.locked=!1;var a=gl.start();return this.extensions.forEach(function(t){var e=t._cssModel;e.mark(),e.downstreamChanged("",1)}),gl.end(),Ti(this,!i||!1!==i.apply),s.then(function(){return a})}function Ti(t,e){var n=Vi(t),i=t.extensions.map(function(t){return Ti(t,!1)}).reduce(function(t,e){return e||t},!1);if(e&&(n||i)){var r=t._cssDef;(!r||r&&r.applied)&&wi(!0)}return n||i}function Vi(t){var e=t.css;if(u(e)){var n=t._cssDef,i=Pi(t,e),r=n.transform?Ci(i,n.id):i;if(n.styles!==r)return n.styles=r,!0}}function Mi(t){for(var e=t,n=[];e;)e.prototype.cssId&&n.push(e.prototype.cssId),e=e.Parent;return n}function Pi(t,e){if(h(e))return e;var n=t.cssData,i=t._cssModel,r=function(t){return i.joinAll(A(t)).get()};r.__proto__=n;var s=e.call(t,r);return h(s)?s:""}function Ii(t,e,n){var i=!0===t.css?"":h(t.css)&&!$c.test(t.css)?ei(t.css)||t.css:t.css,r=i,s=t.cssId||ji();o(i)?(i="textContent"in i?i.textContent:i.innerHTML,r=i):u(i)&&(r=i,i=Pi(e,i));var a={transform:"noCSSTransform"in t?!t.noCSSTransform:!t.noCssTransform};Ra(e,"_cssDef",{configurable:!0,value:a}),Ra(e,"css",{get:function(){return r},set:function(t){var n=Pi(e,r=t),i=a.styles;a.styles=a.transform?Ci(n,s):n,a.applied&&i!==a.styles&&wi(!0)}}),a.styles=a.transform?Ci(i,s):i,a.id=n.cssId=s,e._cssIds.push(s),bi(e._cssDef)}function Ri(t){t&&t.constructor!==Object&&(u(t)||(o(t)?y("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged"):p("data option must be an object or a function, `"+t+"` is not valid")))}function Bi(){return{}}function Ki(t,e){Ri(e);var n=u(t);e||n||(e=Bi);var i=u(e);return n||i?function(){return Di(i?Li(e,this):e,n?Li(t,this):t)}:Di(e,t)}function Li(t,e){var n=t.call(e);if(n)return o(n)||p("Data function must return an object"),n.constructor!==Object&&b("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function Di(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function Fi(t){var e=t._config.template;if(e&&e.fn){var n=zi(t,e.fn);return n!==e.result?(e.result=n,n):void 0}}function zi(t,e){return e.call(t,{fromId:fl.fromId,isParsed:fl.isParsed,parse:function(e,n){return void 0===n&&(n=fl.getParseOptions(t)),fl.parse(e,n)}})}function Ui(t,e){return h(t)?t=$i(t,e):(qi(t),dt(t)),t}function $i(t,e){return"#"===t[0]&&(t=fl.fromId(t)),fl.parseFor(t,e)}function qi(t){if(void 0==t)throw new Error("The template cannot be "+t+".");if(!l(t.v))throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==No)throw new Error("Mismatched template version (expected "+No+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}function Hi(e,n,i){if(n)for(var r in n)!i&&t(e,r)||(e[r]=n[r])}function Zi(t,e,n){function i(){var t=Wi(i._parent,e),r="_super"in this,s=this._super;this._super=t;var a=n.apply(this,arguments);return r?this._super=s:delete this._super,a}return/_super/.test(n)?(i._parent=t,i._method=n,i):n}function Wi(t,e){if(e in t){var n=t[e];return u(n)?n:function(){return n}}return f}function Gi(t,e,n){return"options."+t+" has been deprecated in favour of options."+e+"."+(n?" You cannot specify both options, please use options."+e+".":"")}function Qi(t,e,n){if(e in t){if(n in t)throw new Error(Gi(e,n,!0));y(Gi(e,n)),t[n]=t[e]}}function Yi(t){Qi(t,"beforeInit","onconstruct"),Qi(t,"init","onrender"),Qi(t,"complete","oncomplete"),Qi(t,"eventDefinitions","events"),Da(t.adaptors)&&Qi(t,"adaptors","adapt")}function Ji(e,n,i,r,s){Yi(r);for(var a in r)if(t(nf,a)){var o=r[a];"el"!==a&&u(o)?y(a+" is a Ractive option that does not expect a function and will be ignored","init"===e?i:null):i[a]=o}if(i.append&&i.enhance)throw new Error("Cannot use append and enhance at the same time");Jc.forEach(function(t){t[e](n,i,r,s)}),Vc[e](n,i,r,s),Zc[e](n,i,r,s),qc[e](n,i,r,s),Xi(n.prototype,i,r)}function Xi(e,n,i){for(var r in i)if(!rf[r]&&t(i,r)){var s=i[r];u(s)&&((r in jp||"on"===r.slice(0,2)&&r.slice(2)in Ul&&r in n)&&!af.test(s.toString())&&y("Overriding Ractive prototype function '"+r+"' without calling the '"+af+"' method can be very dangerous."),s=Zi(e,r,s)),n[r]=s}}function tr(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function er(t){return h(t)?_i(t,function(t,e){return t.split(";").filter(function(t){return!!t.trim()}).map(e).reduce(function(t,e){var n=e.indexOf(":");return t[e.substr(0,n).trim()]=e.substr(n+1).trim(),t},{})}):{}}function nr(t){for(var e=t.split(lf),n=e.length;n--;)e[n]||e.splice(n,1);return e}function ir(t){var e=t.element,n=t.name;if("value"===n){if(t.interpolator&&(t.interpolator.bound=!0),"select"===e.name&&"value"===n)return e.getAttribute("multiple")?rr:sr;if("textarea"===e.name)return hr;if(null!=e.getAttribute("contenteditable"))return ar;if("input"===e.name){var i=e.getAttribute("type");if("file"===i)return f;if("radio"===i&&e.binding&&"name"===e.binding.attribute.name)return or;if(~cf.indexOf(i))return hr}return ur}var r=e.node;if(t.isTwoway&&"name"===n){if("radio"===r.type)return lr;if("checkbox"===r.type)return cr}if("style"===n)return fr;if(0===n.indexOf("style-"))return dr;if("class"===n&&(!r.namespaceURI||r.namespaceURI===fc))return pr;if(0===n.indexOf("class-"))return mr;if(t.isBoolean){var s=e.getAttribute("type");return!t.interpolator||"checked"!==n||"checkbox"!==s&&"radio"!==s||(t.interpolator.bound=!0),vr}return t.namespace&&t.namespace!==t.node.namespaceURI?yr:gr}function rr(t){var e=this.getValue();Da(e)||(e=[e]);var n=this.node.options,i=n.length;if(t)for(;i--;)n[i].selected=!1;else for(;i--;){var r=n[i],s=r._ractive?r._ractive.value:r.value;r.selected=O(e,s)}}function sr(t){var e=this.getValue();if(!this.locked){this.node._ractive.value=e;var n=this.node.options,i=n.length,r=!1;if(t)for(;i--;)n[i].selected=!1;else for(;i--;){var s=n[i],a=s._ractive?s._ractive.value:s.value;if(s.disabled&&s.selected&&(r=!0),a==e)return void(s.selected=!0)}r||(this.node.selectedIndex=-1)}}function ar(t){var e=this.getValue();this.locked||(this.node.innerHTML=t?"":c(e)?"":e)}function or(t){var e=this.node,n=e.checked,i=this.getValue();if(t)return e.checked=!1;e.value=this.node._ractive.value=i,e.checked=this.element.compare(i,this.element.getAttribute("name")),n&&!e.checked&&this.element.binding&&this.element.binding.rendered&&this.element.binding.group.model.set(this.element.binding.group.getValue())}function ur(t){if(!this.locked)if(t)this.node.removeAttribute("value"),this.node.value=this.node._ractive.value=null;else{var e=this.getValue();this.node.value=this.node._ractive.value=e,this.node.setAttribute("value",ii(e))}}function hr(t){if(!this.locked)if(t)this.node._ractive.value="",this.node.removeAttribute("value");else{var e=this.getValue();this.node._ractive.value=e;var n=ii(e);this.node.value!==n&&(this.node.value=n),this.node.setAttribute("value",n)}}function lr(t){this.node.checked=!t&&this.element.compare(this.getValue(),this.element.binding.getValue())}function cr(t){var e=this,n=e.element,i=e.node,r=n.binding,s=this.getValue(),a=n.getAttribute("value");if(Da(s)){for(var o=s.length;o--;)if(n.compare(a,s[o]))return void(r.isChecked=i.checked=!0);r.isChecked=i.checked=!1}else r.isChecked=i.checked=n.compare(s,a)}function fr(t){for(var e=t?{}:er(this.getValue()||""),n=this.node.style,i=Ka(e),r=this.previous||[],s=0;s<i.length;){if(i[s]in n){var a=e[i[s]].replace("!important","");n.setProperty(i[s],a,a.length!==e[i[s]].length?"important":"")}s++}for(s=r.length;s--;)!~i.indexOf(r[s])&&r[s]in n&&n.setProperty(r[s],"","");this.previous=i}function dr(t){if(this.style||(this.style=_e(this.name.substr(6))),!t||this.node.style.getPropertyValue(this.style)===this.last){var e=t?"":ii(this.getValue()),n=e.replace("!important","");this.node.style.setProperty(this.style,n,n.length!==e.length?"important":""),this.last=this.node.style.getPropertyValue(this.style)}}function pr(t){var e=t?[]:nr(ii(this.getValue())),n=this.node.className,i=nr(n=void 0!==n.baseVal?n.baseVal:n),r=this.previous||[],s=e.concat(i.filter(function(t){return!~r.indexOf(t)})).join(" ");s!==n&&(h(this.node.className)?this.node.className=s:this.node.className.baseVal=s),this.previous=e}function mr(t){var e=this.name.substr(6),n=this.node.className,i=nr(n=void 0!==n.baseVal?n.baseVal:n),r=!t&&this.getValue();this.inlineClass||(this.inlineClass=e),r&&!~i.indexOf(e)?i.push(e):!r&&~i.indexOf(e)&&i.splice(i.indexOf(e),1),h(this.node.className)?this.node.className=i.join(" "):this.node.className.baseVal=i.join(" ")}function vr(t){if(!this.locked)if(t)this.useProperty&&(this.node[this.propertyName]=!1),this.node.removeAttribute(this.propertyName);else if(this.useProperty)this.node[this.propertyName]=this.getValue();else{var e=this.getValue();e?this.node.setAttribute(this.propertyName,h(e)?e:""):this.node.removeAttribute(this.propertyName)}}function gr(t){t?this.node.getAttribute(this.name)===this.value&&this.node.removeAttribute(this.name):(this.value=ii(this.getString()),this.node.setAttribute(this.name,this.value))}function yr(t){t?this.value===this.node.getAttributeNS(this.namespace,this.name.slice(this.name.indexOf(":")+1))&&this.node.removeAttributeNS(this.namespace,this.name.slice(this.name.indexOf(":")+1)):(this.value=ii(this.getString()),this.node.setAttributeNS(this.namespace,this.name.slice(this.name.indexOf(":")+1),this.value))}function br(){return pf}function wr(t,e){if(vf.test(t))return[];var n=e?"svg":"div";return t?(df.innerHTML="<"+n+" "+t+"></"+n+">")&&P(df.childNodes[0].attributes):[]}function xr(t,e){for(var n=t.length;n--;)if(t[n].name===e.name)return!1;return!0}function kr(t,e){for(var n="xmlns:"+e;t;){if(t.hasAttribute&&t.hasAttribute(n))return t.getAttribute(n);t=t.parentNode}return pc[e]}function _r(){return gf}function Er(t,e,n){t.value=0===e||("true"===e||"false"!==e&&"0"!==e&&e);var i=t.element[t.flag];return t.element[t.flag]=t.value,n&&!t.element.attributes.binding&&i!==t.value&&t.element.recreateTwowayBinding(),t.value}function Ar(t){of.call(this,t)}function Sr(){var t=this;return this.torndown?(y("ractive.teardown() was called on a Ractive instance that was already torn down"),Promise.resolve()):(this.shouldDestroy=!0,Cr(this,function(){return t.fragment.rendered?t.unrender():Promise.resolve()}))}function Cr(t,e){t.torndown=!0,t.fragment.unbind(),t._observers.slice().forEach(W),t.el&&t.el.__ractive_instances__&&V(t.el.__ractive_instances__,t);var n=e();return Ul.teardown.fire(t),n.then(function(){Ul.destruct.fire(t),t.viewmodel.teardown()}),n}function Or(t,e){if(t.applyValue=function(t){this.parent.value[e]=t,t&&t.viewmodel?(this.link(t.viewmodel.getRactiveModel(),e),this._link.markedAll()):(this.link(Ia(Co),e),this._link.markedAll())},"root"===e){var n=t.mark;t.mark=function(t){this._marking||(this._marking=!0,n.apply(this,t),this._marking=!1)}}return t.applyValue(t.parent.ractive[e],e),t._link.set=function(e){return t.applyValue(e)},t._link.applyValue=function(e){return t.applyValue(e)},t._link}function jr(t,e){t._link&&t._link.implicit&&t._link.isDetached()&&t.attach(e);for(var n in t.childByKey)if(t.value)if(n in t.value)jr(t.childByKey[n],e);else if(!t.childByKey[n]._link||t.childByKey[n]._link.isDetached()){var i=Qe(e,n);i&&t.childByKey[n].link(i,n,{implicit:!0})}}function Nr(t){t._link&&t._link.implicit&&t.unlink();for(var e in t.childByKey)Nr(t.childByKey[e])}function Tr(t,e,i){var r=(t.constructor["_"+i]||[]).concat(n(e[i]||[])),s="on"===i?"once":i+"Once";r.forEach(function(e){var n=e[0],r=e[1];u(r)?t[i](n,r):o(r)&&u(r.handler)&&t[r.once?s:i](n,r.handler,Ia(r))})}function Vr(e,n){Va.DEBUG&&so(),Pr(e),Ir(e),Tr(e,n,"on"),!t(n,"delegate")&&e.parent&&e.parent.delegate!==e.delegate&&(e.delegate=!1),Da(n.use)&&e.use.apply(e,n.use.filter(function(t){return t.construct})),Ul.construct.fire(e,n),n.onconstruct&&n.onconstruct.call(e,en(e),n);for(var i=Ef.length;i--;){var r=Ef[i];e[r]=Pa(Ia(e.constructor[r]||null),n[r])}for(i=Af.length;i--;){var s=Af[i];e[s]=Pa(Ia(e.constructor.prototype[s]),n[s])}e._attributePartial&&(e.partials["extra-attributes"]=e._attributePartial,delete e._attributePartial);var a=new _f({adapt:Mr(e,e.adapt,n),data:Hc.init(e.constructor,e,n),ractive:e});e.adapt=a.adaptors,e.viewmodel=a;for(var o in e.computed)Tn.call(e,o,e.computed[o])}function Mr(t,e,n){function i(e){return h(e)&&((e=w("adaptors",t,e))||p(fo(e,"adaptor"))),e}var r=[e=e.map(i),N(n.adapt).map(i)];return t.parent&&!t.isolated&&r.push(t.parent.viewmodel.adaptors),M.apply(null,r)}function Pr(t){t._guid="r-"+Sf++,t._subs=Ia(null),t._nsSubs=0,t._config={},t.event=null,t._eventQueue=[],t._observers=[],t._children=[],t._children.byName={},t.children=t._children,t.component||(t.root=t,t.parent=t.container=null)}function Ir(t){var e=t.component,n=t.constructor.attributes;if(n&&e){var i=e.template,r=i.m?i.m.slice():[],s=r.filter(function(t){return t.t===Ho}).map(function(t){return t.n});n.required.forEach(function(t){~s.indexOf(t)||y("Component '"+e.name+"' requires attribute '"+t+"' to be provided")});for(var a=n.optional.concat(n.required),o=[],u=r.length;u--;){var h=r[u];h.t!==Ho||~a.indexOf(h.n)?n.mapAll||h.t!==Su&&h.t!==Cu&&h.t!==Ou||o.unshift(r.splice(u,1)[0]):n.mapAll?o.unshift({t:Ho,n:h.n,f:[{t:Ro,r:"~/"+h.n}]}):o.unshift(r.splice(u,1)[0])}o.length&&(e.template={t:i.t,e:i.e,f:i.f,m:r,p:i.p}),t._attributePartial=o}}function Rr(t){this.item&&this.removeChild(this.item);var e=t.instance;t.anchor=this,t.up=this.up,t.name=t.nameOption||this.name,this.name=t.name,e.isolated||e.viewmodel.attached(this.up),this.rendered&&Kr(this,t)}function Br(t){this.item===t&&(Lr(this,t),this.name=this.template.n)}function Kr(t,e){if(t.rendered){e.shouldDestroy=!1,e.up=t.up,t.item=e,t.instance=e.instance;var n=t.up.findNextNode(t);e.instance.fragment.rendered&&e.instance.unrender(),e.partials=e.instance.partials,e.instance.partials=Pa(Ia(e.partials),e.partials,t._partials),e.instance.fragment.unbind(!0),e.instance.fragment.componentParent=t.up,e.instance.fragment.bind(e.instance.viewmodel),t.attributes.forEach(Z),t.eventHandlers.forEach(Z),t.attributes.forEach(et),t.eventHandlers.forEach(et);var i=t.up.findParentNode();ta(e.instance,i,i.contains(n)?n:null,t.occupants),e.lastBound!==t&&(e.lastBound=t)}}function Lr(t,e){t.rendered&&(e.shouldDestroy=!0,e.instance.unrender(),t.eventHandlers.forEach(st),t.attributes.forEach(st),t.eventHandlers.forEach(rt),t.attributes.forEach(rt),e.instance.el=e.instance.anchor=null,e.instance.fragment.componentParent=null,e.up=null,e.anchor=null,t.item=null,t.instance=null)}function Dr(){var t=Of;Of=[],t.forEach(Sn)}function Fr(t,e,n,i){void 0===i&&(i={}),e&&e.f&&e.f.s&&(t.fn=ft(e.f.s,e.f.r.length),!0===i.register&&(t.models=zr(t,e,n,i)))}function zr(t,e,n,i){return void 0===i&&(i={}),e.f.r.map(function(e,r){var s;return i.specialRef&&(s=i.specialRef(e,r))?s:(s=Qe(n,e),!0===i.register&&s.register(t),s)})}function Ur(t,e){e&&e.f&&e.f.s&&(t.models&&t.models.forEach(function(e){e&&e.unregister&&e.unregister(t)}),t.models=null)}function $r(){this._ractive.binding.handleChange()}function qr(t,e,n){var i=t+"-bindingGroup";return e[i]||(e[i]=new Bf(i,e,n))}function Hr(){var t=this,e=[];return this.bindings.filter(function(t){return t.node&&t.node.checked}).map(function(t){return t.element.getAttribute("value")}).forEach(function(n){t.bindings[0].arrayContains(e,n)||e.push(n)}),e}function Zr(){$r.call(this);var t=this._ractive.binding.model.get();this.value=void 0==t?"":t}function Wr(t){var e;return function(){var n=this;e&&clearTimeout(e),e=setTimeout(function(){n._ractive.binding.rendered&&$r.call(n),e=null},t)}}function Gr(t){return t.selectedOptions?P(t.selectedOptions):t.options?P(t.options).filter(function(t){return t.selected}):[]}function Qr(t){return Hf[t]||(Hf[t]=[])}function Yr(){var t=this.bindings.filter(function(t){return t.node.checked});if(t.length>0)return t[0].element.getAttribute("value")}function Jr(t){return!(!t||!t.template.f||1!==t.template.f.length||t.template.f[0].s)&&(t.template.f[0].t===Ro||(t.template.f[0].t===Bo&&y("It is not possible create a binding using a triple mustache."),!1))}function Xr(t){var e=t.name,n=t.attributeByName;if("input"===e||"textarea"===e||"select"===e||n.contenteditable){var i=Jr(n.value),r=Jr(n.contenteditable);if((t.getAttribute("contenteditable")||r)&&i)return Ff;if("input"===e){var s=t.getAttribute("type");if("radio"===s){var a=Jr(n.name),o=Jr(n.checked);return a&&o?(y("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root}),Wf):a?Wf:o?Zf:null}if("checkbox"===s){var u=Jr(n.name),h=Jr(n.checked);return u&&h?Rf:u?Df:h?Rf:null}return"file"===s&&i?Uf:"number"===s&&i?qf:"range"===s&&i?qf:i?zf:null}return"select"===e&&i?t.getAttribute("multiple")?$f:Gf:"textarea"===e&&i?zf:null}}function ts(t){var e=t.attributeByName.name;return"radio"===t.getAttribute("type")&&(e||{}).interpolator&&t.getAttribute("value")===e.interpolator.model.get()}function es(t){var e=t.toString();return e?" "+e:""}function ns(t){var e=t.getAttribute("xmlns");if(e)return e;if("svg"===t.name)return dc;var n=t.parent;return n?"foreignobject"===n.name?fc:n.node.namespaceURI:t.ractive.el.namespaceURI}function is(t){for(var e,n=t.type,i=t.currentTarget,r=i._ractive&&i._ractive.proxy,s=t.target,a=!0;a&&s&&s!==i;){var o=s._ractive&&s._ractive.proxy;if(o&&o.up.delegate===r&&rs(t,s,i)&&(e=o.listeners&&o.listeners[n]))for(var u=e.length,h=0;h<u;h++)a=!1!==e[h].call(s,t)&&a;s=s.parentNode||s.correspondingUseElement}return a}function rs(t,e,n){if(Jf&&t instanceof Jf)for(var i=e;i&&i!==n;){if(i.disabled)return!1;i=i.parentNode||i.correspondingUseElement}return!0}function ss(t){var e,n=this,i=this._ractive.proxy;if(i.listeners&&(e=i.listeners[t.type]))for(var r=e.length,s=0;s<r;s++)e[s].call(n,t)}function as(){var t=this._ractive.proxy;gl.start(),t.formBindings.forEach(os),gl.end()}function os(t){t.model.set(t.resetValue)}function us(t,e,n,i){if(n){var r=n[0];if(r&&3===r.nodeType){var s=r.nodeValue.indexOf(i);n.shift(),0===s?r.nodeValue.length!==i.length&&n.unshift(r.splitText(i.length)):r.nodeValue=i}else r=t.node=Ua.createTextNode(i),n[0]?e.insertBefore(r,n[0]):e.appendChild(r);t.node=r}else t.node||(t.node=Ua.createTextNode(i)),e.appendChild(t.node)}function hs(t){t.deps.length||t.refs||t.links.length||t.teardown()}function ls(t){t.base&&t.base.unregister(t.proxy),t.models&&t.models.forEach(function(e){e.unregister&&e.unregister(t)})}function cs(t){var e,n,i=t.deps.length;for(e=0;e<i;e++)(n=t.deps[e]).pathChanged&&n.pathChanged(),n.fragment&&n.fragment.pathModel&&n.fragment.pathModel.applyValue(t.getKeypath());for(i=t.children.length,e=0;e<i;e++)cs(t.children[e])}function fs(t,e){return e.r?Qe(t,e.r):e.x?new md(t,e.x):e.rx?new yd(t,e.rx):void 0}function ds(t){xd.call(this,t)}function ps(t){t.sp();var e=Ot(t);if(!e)return null;var n={key:e};if(t.sp(),!t.matchString(":"))return null;t.sp();var i=t.read();return i?(n.value=i.v,n):null}function ms(t,e){return new Td(t,{values:e}).result}function vs(t){var e=t.template.f,n=t.element.instance.viewmodel,i=n.value;if(1===e.length&&e[0].t===Ro){var r=fs(t.up,e[0]),s=r.get(!1);e[0].s?!o(s)||e[0].x?n.joinKey(A(t.name)).set(s):y("Cannot copy non-computed object value from static mapping '"+t.name+"'"):(t.model=r,t.link=n.createLink(t.name,r,e[0].r,{mapping:!0}),c(s)&&!r.isReadonly&&t.name in i&&r.set(i[t.name])),r!==t.model&&r.unregister()}else t.boundFragment=new Sp({owner:t,template:e}).bind(),t.model=n.joinKey(A(t.name)),t.model.set(t.boundFragment.valueOf()),t.boundFragment.bubble=function(){Sp.prototype.bubble.call(t.boundFragment),gl.scheduleTask(function(){t.boundFragment.update(),t.model.set(t.boundFragment.valueOf())})}}function gs(t,n,i){var r=ys(t,n,i||{});if(r)return r;if(r=fl.fromId(n,{noThrow:!0})){var s=fl.parseFor(r,t);return s.p&&e(t.partials,s.p),t.partials[n]=s.t}}function ys(e,n,i){var r=xs(n,i.owner);if(r)return r;var s=x("partials",e,n);if(s){var a;if(u(r=s.partials[n])){if((a=r).styleSet)return a;(a=r.bind(s)).isOwner=t(s.partials,n),r=a.call(e,fl)}if(r||""===r){if(!fl.isParsed(r)){var o=fl.parseFor(r,s);o.p&&y("Partials ({{>%s}}) cannot contain nested inline partials",n,{ractive:e}),(a?s:bs(s,n)).partials[n]=r=o.t}return a&&(r._fn=a),r.v?(dt(r),s.partials[n]=r.t):r}y(co,n,"partial","partial",{ractive:e})}}function bs(e,n){return t(e.partials,n)?e:ws(e.constructor,n)}function ws(e,n){if(e)return t(e.partials,n)?e:ws(e.Parent,n)}function xs(e,n){if(n){if(n.template&&n.template.p&&!Da(n.template.p)&&t(n.template.p,e))return n.template.p[e];if(n.up&&n.up.owner)return xs(e,n.up.owner)}}function ks(t){ds.call(this,t);var e=t.template;e.t===Go?this.yielder=1:e.t===Fo&&(this.type=zo,this.macro=t.macro)}function _s(t,e){t.partial=t.last=e,Es(t);var n={owner:t,template:t.partial};t.yielder&&(n.ractive=t.container.parent),t.fn&&(n.cssIds=t.fn._cssIds),t.fragment=new Sp(n)}function Es(t){t.template.c&&(t.partial=[{t:Ko,n:bu,f:t.partial,z:t.template.z}],Pa(t.partial[0],t.template.c),t.yielder&&(t.partial[0].y=t))}function As(t,e,n){var i=e;return Da(i)?t.partial=i:i&&o(i)?Da(i.t)?t.partial=i.t:h(i.template)&&(t.partial=js(i.template,i.template,t.ractive).t):u(i)&&i.styleSet?(t.fn=i,t.fragment&&(t.fragment.cssIds=i._cssIds)):null!=i&&((i=gs(t.ractive,""+i,t.containerFragment||t.up))?(t.name=e,i.styleSet?(t.fn=i,t.fragment&&(t.fragment.cssIds=i._cssIds)):t.partial=i):n?t.partial=js(""+e,""+e,t.ractive).t:t.name=e),t.partial}function Ss(t){if(As(this,t,!0),!this.initing){if(this.dirtyTemplate=!0,this.fnTemplate=this.partial,!this.updating){var e=gl.start();return this.bubble(),gl.end(),e}this.bubble(),gl.promise()}}function Cs(t,e){var n=this.fragment.aliases||(this.fragment.aliases={});e?n[e]=this._data.joinAll(A(t)):n[t]=this._data}function Os(e){var n=e.fn,i=e.fragment,r=e.template=Pa({},e.template),s=e.handle=i.getContext({proxy:e,aliasLocal:Cs,name:e.template.e||e.name,attributes:{},setTemplate:Ss.bind(e),template:r,macro:n});if(r.p||(r.p={}),r.p=s.partials=Pa({},r.p),t(r.p,"content")||(r.p.content=r.f||[]),Da(n.attributes)){e._attrs={};var a=function(){this.dirty=!0,e.dirtyAttrs=!0,e.bubble()};if(Da(r.m)){var o=r.m;r.p[Id]=r.m=o.filter(function(t){return!~n.attributes.indexOf(t.n)}),o.filter(function(t){return~n.attributes.indexOf(t.n)}).forEach(function(t){var n=new Sp({template:t.f,owner:e});n.bubble=a,n.findFirstNode=f,e._attrs[t.n]=n})}else r.p[Id]=[]}else r.p[Id]=r.m;e._attrs&&(Ka(e._attrs).forEach(function(t){e._attrs[t].bind()}),e.refreshAttrs()),e.initing=1,e.proxy=n.call(e.ractive,s,s.attributes)||{},e.partial||(e.partial=[]),e.fnTemplate=e.partial,e.initing=0,Es(e),i.resetTemplate(e.partial)}function js(t,e,n){var i;try{i=fl.parse(e,fl.getParseOptions(n))}catch(e){y("Could not parse partial from expression '"+t+"'\n"+e.message)}return i||{t:[]}}function Ns(t){var e,n,i=t;t:for(;i;){for(n=0;!n&&i;){if(i.owner.type===Fo&&(n=i.owner),i.owner.ractive&&!1===i.owner.ractive.delegate)break t;i=i.parent||i.componentParent}if(!1===n.delegate)break t;for(e=n.delegate||n;i&&!i.iterations;){if(i.owner.ractive&&!1===i.owner.ractive.delegate)break t;i=i.parent||i.componentParent}}return e}function Ts(t,e,n,i){var r=t.context?Ms(t,e,n):void 0;e.key=n,e.index=i,e.context=r,t.source&&(e.lastValue=r&&r.get()),e.idxModel&&e.idxModel.applyValue(i),e.keyModel&&e.keyModel.applyValue(n),e.pathModel&&(e.pathModel.context=r,e.pathModel.applyValue(r.getKeypath())),e.rootModel&&(e.rootModel.context=r,e.rootModel.applyValue(r.getKeypath(e.ractive.root)));var s=e.aliases;t.aliases&&t.aliases.forEach(function(t){"."===t.x.r?s[t.n]=r:"@index"===t.x.r?s[t.n]=e.getIndex():"@key"===t.x.r?s[t.n]=e.getKey():"@keypath"===t.x.r?s[t.n]=e.getKeypath():"@rootpath"===t.x.r&&(s[t.n]=e.getKeypath(!0))})}function Vs(t,e){var n=t.context.get()||[];return!0===e?n.slice():n.map(function(t){return e.reduce(function(t,e){return t&&t[e]},t)})}function Ms(t,e,n){if(t.source){var i,r=t.source.model.get();if(r.indexOf&&~(i=r.indexOf(t.context.joinKey(n).get())))return t.source.model.joinKey(i)}return t.context.joinKey(n)}function Ps(t){return!t||Da(t)&&0===t.length||s(t)&&0===Ka(t).length}function Is(t,e){return e||Da(t)?yu:a(t)?wu:c(t)?null:vu}function Rs(t,e){var n=(t.containerFragment||t.up).findNextNode(t);if(n){var i=ti();e.render(i),n.parentNode.insertBefore(i,n)}else e.render(t.up.findParentNode())}function Bs(){Hd=!Ua[Zd]}function Ks(){Hd=!1}function Ls(){Hd=!0}function Ds(t){return t?(np.test(t)&&(t="-"+t),t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})):""}function Fs(e,n,i){for(var r=n;r;){if(t(r,e)&&(c(i)||i?r.rendering:r.unrendering))return r[e];r=r.component&&r.component.ractive}return n[e]}function zs(t,e){var n=[];if(null==t||""===t)return n;var i,r,s;wp&&(r=xp[e.tagName])?((i=Us("DIV")).innerHTML=r[0]+t+r[1],"SELECT"===(i=i.querySelector(".x")).tagName&&(s=i.options[i.selectedIndex])):e.namespaceURI===dc?((i=Us("DIV")).innerHTML='<svg class="x">'+t+"</svg>",i=i.querySelector(".x")):"TEXTAREA"===e.tagName?void 0!==(i=nc("div")).textContent?i.textContent=t:i.innerHTML=t:((i=Us(e.tagName)).innerHTML=t,"SELECT"===i.tagName&&(s=i.options[i.selectedIndex]));for(var a;a=i.firstChild;)n.push(a),i.removeChild(a);var o;if("SELECT"===e.tagName)for(o=n.length;o--;)n[o]!==s&&(n[o].selected=!1);return n}function Us(t){return kp[t]||(kp[t]=nc(t))}function $s(e,n){var i,r=x("components",e,n);if(r&&(i=r.components[n])&&!i.isInstance)if(i.default&&i.default.isInstance)i=i.default;else if(!i.then&&u(i)){var s=i.bind(r);if(s.isOwner=t(r.components,n),!(i=s()))return void y(co,n,"component","component",{ractive:e});h(i)&&(i=$s(e,i)),i._fn=s,r.components[n]=i}return i}function qs(t,e){var n=e.template.p||{},i=e.template.e;return new ks(Pa({},e,{template:{t:Fo,e:i},macro:function(r){r.setTemplate(n["async-loading"]||[]),t.then(function(t){e.up.ractive.components[i]=t,n["async-loaded"]?(r.partials.component=[e.template],r.setTemplate(n["async-loaded"])):r.setTemplate([e.template])},function(t){n["async-failed"]?(r.aliasLocal("error","error"),r.set("@local.error",t),r.setTemplate(n["async-failed"])):r.setTemplate([])})}}))}function Hs(t,e,n){var i=t.f.find(function(t){return t.t===e});return i?i.n?[{t:19,n:54,f:i.f||[],z:[{n:i.n,x:{r:"__await."+n}}]}]:i.f||[]:[]}function Zs(t){var e=t.template,n=Hs(e,_u,"value"),i=Hs(e,Eu,"error"),r=Hs(e,Ko),s=Hs(e,xu),a=Pa({},t,{template:{t:Fo,m:[{t:Ho,n:"for",f:[{t:Ro,r:e.r,rx:e.rx,x:e.x}]}]},macro:function(t,e){function a(e){e.for&&u(e.for.then)?(t.setTemplate(r),e.for.then(function(e){t.set("@local.value",e),t.setTemplate(n)},function(e){t.set("@local.error",e),t.setTemplate(i)})):c(e.for)?t.setTemplate(s):(t.set("@local.value",e.for),t.setTemplate(n))}return t.aliasLocal("__await"),a(e),{update:a}}});return a.macro.attributes=["for"],new ks(a)}function Ws(t){if(h(t.template))return new $d(t);var e,n,i=t.template.t;if(i===Fo){if(n=t.template.e,(e=x("partials",t.up.ractive,n))&&(e=e.partials[n]).styleSet)return t.macro=e,new ks(t);if(e=$s(t.up.ractive,n)){if(u(e.then))return qs(e,t);if(u(e))return new Cf(t,e)}return new(e=Ap[n.toLowerCase()]||Yf)(t)}var r;if(i===Ho){var s=t.owner;(!s||s.type!==qo&&s.type!==Wo&&s.type!==Fo)&&(s=Fn(t.up)),t.element=s,r=s.type===Wo||s.type===qo?Vd:yf}else r=Ep[i];if(!r)throw new Error("Unrecognised item type "+i);return new r(t)}function Gs(t,e,n,i){return void 0===i&&(i=0),t.map(function(t){if(t.type===Io)return t.template;if(t.fragment)return t.fragment.iterations?t.fragment.iterations.map(function(t){return Gs(t.items,e,n,i)}).join(""):Gs(t.fragment.items,e,n,i);var r=n+"-"+i++,s=t.model||t.newModel;return e[r]=s?s.wrapper?s.wrapperValue:s.get():void 0,"${"+r+"}"}).join("")}function Qs(t,e,n){void 0===n&&(n={});for(var i=0;i<t.length;i++)if(!n[t[i].n]){var r=fs(e,t[i].x);n[t[i].n]=r,r.reference()}return n}function Ys(t){var e,n=rn(this);if(t){if(this.rootModel)return this.rootModel;this.rootModel=new Rd(this.context.getKeypath(this.ractive.root),this.context,this.ractive.root),e=this.rootModel}else{if(this.pathModel)return this.pathModel;this.pathModel=new Rd(this.context.getKeypath(),this.context),e=this.pathModel}return n&&n.context&&n.getKeypath(t).registerChild(e),e}function Js(t,e,n){var i=t.viewmodel.computed;if(i)for(var r in i)r in t.viewmodel.value&&i[r]&&!i[r].isReadonly&&i[r].set(t.viewmodel.value[r]);Xc.init(t.constructor,t,e),Da(e.use)&&t.use.apply(t,e.use.filter(function(t){return!t.construct})),Ul.config.fire(t),Ul.init.begin(t);var s=t.fragment=Xs(t,n);if(s&&s.bind(t.viewmodel),Ul.init.end(t),Tr(t,e,"observe"),s){var a=t.el=t.target=ei(t.el||t.target);if(a&&!t.component){var o=t.render(a,t.append);Va.DEBUG_PROMISES&&o.catch(function(e){throw b("Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\n  Ractive.DEBUG_PROMISES = false;"),y("An error happened during rendering",{ractive:t}),m(e),e})}}}function Xs(t,e){if(void 0===e&&(e={}),t.template){var n=[].concat(t.constructor._cssIds||[],e.cssIds||[]);return new Sp({owner:t,template:t.template,cssIds:n})}}function ta(t,e,n,i){t.rendering=!0;var r=gl.start();if(gl.scheduleTask(function(){return Ul.render.fire(t)},!0),t.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(t.destroyed&&(t.destroyed=!1,t.fragment=Xs(t).bind(t.viewmodel)),n=ei(n)||t.anchor,t.el=t.target=e,t.anchor=n,t.cssId&&wi(),e)if((e.__ractive_instances__||(e.__ractive_instances__=[])).push(t),n){var s=Ua.createDocumentFragment();t.fragment.render(s),e.insertBefore(s,n)}else t.fragment.render(e,i);return gl.end(),t.rendering=!1,r.then(function(){t.torndown||Ul.complete.fire(t)})}function ea(t,e){if(this.torndown)return y("ractive.render() was called on a Ractive instance that was already torn down"),Promise.resolve();if(t=ei(t)||this.el,!this.append&&t){var n=t.__ractive_instances__;n&&n.forEach(it),this.enhance||(t.innerHTML="")}var i=this.enhance?P(t.childNodes):null,r=ta(this,t,e,i);if(i)for(;i.length;)t.removeChild(i.pop());return r}function na(t){if(t=t||{},!o(t))throw new Error("The reset method takes either no arguments, or an object containing new data");t=Hc.init(this.constructor,this,{data:t});var e=gl.start(),n=this.viewmodel.wrapper;n&&n.reset?!1===n.reset(t)&&this.viewmodel.set(t):this.viewmodel.set(t);for(var i,r=Xc.reset(this),s=r.length;s--;)if(Op.indexOf(r[s])>-1){i=!0;break}return i&&(Ul.unrender.fire(this),this.fragment.resetTemplate(this.template),Ul.render.fire(this),Ul.complete.fire(this)),gl.end(),Ul.reset.fire(this,t),e}function ia(t,e,n,i){t.forEach(function(t){if(t.type===zo&&(t.refName===e||t.name===e))return t.inAttribute=n,void i.push(t);if(t.fragment)ia(t.fragment.iterations||t.fragment.items,e,n,i);else if(Da(t.items))ia(t.items,e,n,i);else if(t.type===Wo&&t.instance){if(t.instance.partials[e])return;ia(t.instance.fragment.items,e,n,i)}t.type===Fo&&Da(t.attributes)&&ia(t.attributes,e,!0,i)})}function ra(t,e){var n=[];ia(this.fragment.items,t,!1,n);var i=gl.start();return this.partials[t]=e,n.forEach(Q),gl.end(),i}function sa(t){Zc.init(null,this,{template:t});var e=this.transitionsEnabled;this.transitionsEnabled=!1;var n=this.component;n&&(n.shouldDestroy=!0),this.unrender(),n&&(n.shouldDestroy=!1);var i=gl.start();this.fragment.unbind().unrender(!0),this.fragment=new Sp({template:this.template,root:this,owner:this});var r=ti();return this.fragment.bind(this.viewmodel).render(r),n&&!n.external?this.fragment.findParentNode().insertBefore(r,n.findNextNode()):this.el.insertBefore(r,this.anchor),gl.end(),this.transitionsEnabled=e,i}function aa(t,e,n){var i=this,r=o(t)?e:n;return sn(on(i,t,e,r&&r.isolated),r)}function oa(t,e,n){return ln(this,t,l(e)?-e:-1,o(e)?e:n)}function ua(t,e){if(!h(t))throw new TypeError(lo);return sn(an(this,t,null,e&&e.isolated).map(function(t){return[t,!t.get()]}),e)}function ha(){var t=[this.cssId].concat(this.findAllComponents().map(function(t){return t.cssId}));return xi(Ka(t.reduce(function(t,e){return t[e]=!0,t},{})))}function la(){return this.fragment.toString(!0)}function ca(){return this.fragment.toString(!1)}function fa(t,e,n){e instanceof HTMLElement||s(e)&&(n=e),(e=e||this.event.node)&&e._ractive||p("No node was supplied for transition "+t),n=n||{};var i=e._ractive.proxy,r=new gp({owner:i,up:i.up,name:t,params:n});r.bind();var a=gl.start();return gl.registerTransition(r),gl.end(),a.then(function(){return r.unbind()}),a}function da(t){var e=gl.start();return this.viewmodel.joinAll(A(t),{lastLink:!1}).unlink(),gl.end(),e}function pa(){if(!this.fragment.rendered)return y("ractive.unrender() was called on a Ractive instance that was not rendered"),Promise.resolve();this.unrendering=!0;var t=gl.start();Ul.unrendering.fire(this);var e=!this.component||(this.component.anchor||{}).shouldDestroy||this.component.shouldDestroy||this.shouldDestroy;return this.fragment.unrender(e),e&&(this.destroyed=!0),V(this.el.__ractive_instances__,this),Ul.unrender.fire(this),gl.end(),this.unrendering=!1,t}function ma(t,e){var n=gl.start();return t?this.viewmodel.joinAll(A(t)).updateFromBindings(!1!==e):this.viewmodel.updateFromBindings(!0),gl.end(),n}function va(){for(var t=this,e=[],n=arguments.length;n--;)e[n]=arguments[n];return e.forEach(function(e){e({proto:t,Ractive:t.constructor.Ractive,instance:t})}),this}function ga(t){return t&&t instanceof this}function ya(t,e){return this._cssModel.joinAll(A(t)).get(!0,e)}function ba(t,e){if(Np.find(function(e){return e.id===t}))throw new Error("Extra styles with the id '"+t+"' have already been added.");Np.push({id:t,css:e}),this.css||Object.defineProperty(this,"css",{configurable:!1,writable:!1,value:wa}),this._cssDef||(Object.defineProperty(this,"_cssDef",{configurable:!0,writable:!1,value:{transform:!1,id:"Ractive.addStyle"}}),bi(this._cssDef)),Vi(this),wi(!0)}function wa(t){return Np.map(function(e){return"\n/* ---- extra style "+e.id+" */\n"+(u(e.css)?e.css(t):e.css)}).join("")}function xa(t){return!!Np.find(function(e){return e.id===t})}function ka(t,e,n){var i=o(t)?e:n;return sn(on({viewmodel:Cl},t,e,!0),i)}function _a(t,e){return Cl.joinAll(A(t)).get(!0,e)}function Ea(){for(var t=this,e=[],n=arguments.length;n--;)e[n]=arguments[n];return e.forEach(function(e){u(e)&&e({proto:t.prototype,Ractive:t.Ractive,instance:t})}),this}function Aa(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.length?t.reduce(Ca,this):Ca(this)}function Sa(t,e){return void 0===e&&(e={}),Ca(this,e,t)}function Ca(t,e,i){void 0===e&&(e={});var r,s=u(i)&&i;if(e.prototype instanceof Va)throw new Error("Ractive no longer supports multiple inheritance.");if(s){if(!(s.prototype instanceof t))throw new Error("Only classes that inherit the appropriate prototype may be used with extend");if(!Tp.test(s.toString()))throw new Error("Only classes that call super in their constructor may be used with extend");r=s.prototype}else s=function(t){if(!(this instanceof s))return new s(t);Vr(this,t||{}),Js(this,t||{},{})},(r=Ia(t.prototype)).constructor=s,s.prototype=r;if(Ba(s,{defaults:{value:r},extend:{value:Aa,writable:!0,configurable:!0},extendWith:{value:Sa,writable:!0,configurable:!0},extensions:{value:[]},use:{value:Ea},isInstance:{value:ga},Parent:{value:t},Ractive:{value:Va},styleGet:{value:ya.bind(s),configurable:!0},styleSet:{value:Ni.bind(s),configurable:!0}}),Xc.extend(t,r,e,s),s._on=(t._on||[]).concat(n(e.on)),s._observe=(t._observe||[]).concat(n(e.observe)),t.extensions.push(s),e.attributes){var a;a=Da(e.attributes)?{optional:e.attributes,required:[]}:e.attributes,Da(a.required)||(a.required=[]),Da(a.optional)||(a.optional=[]),s.attributes=a}return Hc.extend(t,r,e,s),Ra(s,"helpers",{writable:!0,value:r.helpers}),Da(e.use)&&s.use.apply(s,e.use),s}function Oa(t,e){if(!u(t))throw new Error("The macro must be a function");return Pa(t,e),Ba(t,{extensions:{value:[]},_cssIds:{value:[]},cssData:{value:Pa(Ia(this.cssData),t.cssData||{})},styleGet:{value:ya.bind(t)},styleSet:{value:Ni.bind(t)}}),Ra(t,"_cssModel",{value:new Uc(t)}),t.css&&Ii(t,t,t),this.extensions.push(t),t}function ja(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.map(_).join(".")}function Na(t){return A(t).map(S)}function Ta(t,e,n){return w(e,n,t)}function Va(t){if(!(this instanceof Va))return new Va(t);Vr(this,t||{}),Js(this,t||{},{})}Object.assign||(Object.assign=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=e.length,s=0;s<r;s++){var a=e[s];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])}return i});var Ma=Object,Pa=Ma.assign,Ia=Ma.create,Ra=Ma.defineProperty,Ba=Ma.defineProperties,Ka=Ma.keys,La=Object.prototype.toString,Da=Array.isArray;if(Array.prototype.find||Ra(Array.prototype,"find",{value:function(e,n){if(null===this||c(this))throw new TypeError("Array.prototype.find called on null or undefined");if(!u(e))throw new TypeError(e+" is not a function");for(var i=Object(this),r=i.length>>>0,s=0;s<r;s++)if(t(i,s)&&e.call(n,i[s],s,i))return i[s]},configurable:!0,writable:!0}),"undefined"!=typeof window&&window.Node&&window.Node.prototype&&!window.Node.prototype.contains&&(Node.prototype.contains=function(t){var e=this;if(!t)throw new TypeError("node required");do{if(e===t)return!0}while(t=t&&t.parentNode);return!1}),"undefined"!=typeof window&&window.performance&&!window.performance.now){window.performance=window.performance||{};var Fa=Date.now();window.performance.now=function(){return Date.now()-Fa}}var za="undefined"!=typeof window?window:null,Ua=za?document:null,$a=!!Ua,qa="undefined"!=typeof global?global:za,Ha="undefined"!=typeof console&&u(console.warn)&&u(console.warn.apply),Za=!!Ua&&Ua.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),Wa=["o","ms","moz","webkit"];if(!qa.Promise){var Ga={},Qa={},Ya={},Ja=qa.Promise=function(t){var e,n,i=[],r=[],s=Ga,a=function(t){return function(a){s===Ga&&(e=a,n=to((s=t)===Qa?i:r,e),Xa(n))}},o=a(Qa),h=a(Ya);try{t(o,h)}catch(t){h(t)}return{then:function(t,e){var a=new Ja(function(o,h){var l=function(t,e,n){u(t)?e.push(function(e){try{eo(a,t(e),o,h)}catch(t){h(t)}}):e.push(n)};l(t,i,o),l(e,r,h),s!==Ga&&Xa(n)});return a},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(function(e){return t(),e},function(e){throw t(),e})}}};Ja.all=function(t){return new Ja(function(e,n){var i,r,s=[];if(t.length){for(i=r=t.length;r--;)!function(t,r){t&&u(t.then)?t.then(function(t){s[r]=t,--i||e(s)},n):(s[r]=t,--i||e(s))}(t[r],r)}else e(s)})},Ja.race=function(t){return new Ja(function(e,n){function i(t){s&&(s=!1,e(t))}function r(t){s&&(s=!1,n(t))}for(var s=!0,a=0;a<t.length;a++)t[a]&&u(t[a].then)&&t[a].then(i,r)})},Ja.resolve=function(t){return t&&u(t.then)?t:new Ja(function(e){e(t)})},Ja.reject=function(t){return t&&u(t.then)?t:new Ja(function(e,n){n(t)})};var Xa=function(t){setTimeout(t,0)},to=function(t,e){return function(){for(var n=void 0;n=t.shift();)n(e)}},eo=function t(e,n,i,r){var s;if(n===e)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(n instanceof Ja)n.then(i,r);else if(n&&(o(n)||u(n))){try{s=n.then}catch(t){return void r(t)}if(u(s)){var a,h=function(n){a||(a=!0,t(e,n,i,r))},l=function(t){a||(a=!0,r(t))};try{s.call(n,h,l)}catch(t){if(!a)return r(t),void(a=!0)}}else i(n)}else i(n)}}if(!("undefined"==typeof window||window.requestAnimationFrame&&window.cancelAnimationFrame)){var no=0;window.requestAnimationFrame=function(t){var e=Date.now(),n=Math.max(0,16-(e-no)),i=window.setTimeout(function(){t(e+n)},n);return no=e+n,i},window.cancelAnimationFrame=function(t){clearTimeout(t)}}var io,ro,so,ao={el:void 0,append:!1,delegate:!0,enhance:!1,template:null,allowExpressions:!0,delimiters:["{{","}}"],tripleDelimiters:["{{{","}}}"],staticDelimiters:["[[","]]"],staticTripleDelimiters:["[[[","]]]"],csp:!0,interpolate:!1,preserveWhitespace:!1,sanitize:!1,stripComments:!0,contextLines:0,data:Ia(null),helpers:Ia(null),computed:Ia(null),syncComputedChildren:!1,resolveInstanceMembers:!1,warnAboutAmbiguity:!1,adapt:[],isolated:!0,twoway:!0,lazy:!1,noIntro:!1,noOutro:!1,transitionsEnabled:!0,complete:void 0,nestedTransitions:!0,css:null,noCSSTransform:!1},oo={linear:function(t){return t},easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)}},uo={};if(Ha){var ho=["%cRactive.js %c1.3.7 %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"];so=function(){if(!1!==Va.WELCOME_MESSAGE){var t="WELCOME_MESSAGE"in Va?Va.WELCOME_MESSAGE:"You're running Ractive 1.3.7 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n",e=!!console.groupCollapsed;e&&console.groupCollapsed.apply(console,ho),console.log(t),e&&console.groupEnd(ho),so=f}else so=f},ro=function(t,e){if(so(),o(e[e.length-1])){var n=e.pop(),i=n?n.ractive:null;if(i){var r;i.component&&(r=i.component.name)&&(t="<"+r+"> "+t);var s;(s=n.node||i.fragment&&i.fragment.rendered&&i.find("*"))&&e.push(s)}}console.warn.apply(console,["%cRactive.js: %c"+t,"color: rgb(114, 157, 52);","color: rgb(85, 85, 85);"].concat(e))},io=function(){console.log.apply(console,arguments)}}else ro=io=so=f;var lo="Bad arguments",co='A function was specified for "%s" %s, but no %s was returned',fo=function(t,e){return'Missing "'+t+'" '+e+" plugin. You may need to download a plugin via http://ractive.js.org/integrations/#"+e+"s"},po={number:function(t,e){if(!r(t)||!r(e))return null;var n=(e=+e)-(t=+t);return n?function(e){return t+e*n}:function(){return t}},array:function(t,e){var n,i;if(!Da(t)||!Da(e))return null;var r=[],s=[];for(i=n=Math.min(t.length,e.length);i--;)s[i]=k(t[i],e[i]);for(i=n;i<t.length;i+=1)r[i]=t[i];for(i=n;i<e.length;i+=1)r[i]=e[i];return function(t){for(var e=n;e--;)r[e]=s[e](t);return r}},object:function(e,n){if(!s(e)||!s(n))return null;var i=[],r={},a={};for(var o in e)!function(s){t(e,s)&&(t(n,s)?(i.push(s),a[s]=k(e[s],n[s])||function(){return n[s]}):r[s]=e[s])}(o);for(var u in n)t(n,u)&&!t(e,u)&&(r[u]=n[u]);var h=i.length;return function(t){for(var e=h;e--;){var n=i[e];r[n]=a[n](t)}return r}}},mo=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g,vo=/([^\\](?:\\\\)*)\./,go=/\\|\./g,yo=/((?:\\)+)\1|\\(\.)/g,bo=Function.prototype.bind,wo={early:[],mark:[]},xo={early:[],mark:[]},ko={virtual:!1},_o=function(t){this.deps=[],this.children=[],this.childByKey={},this.links=[],this.bindings=[],t&&(this.parent=t,this.root=t.root)},Eo=_o.prototype;Eo.addShuffleTask=function(t,e){void 0===e&&(e="early"),wo[e].push(t)},Eo.addShuffleRegister=function(t,e){void 0===e&&(e="early"),xo[e].push({model:this,item:t})},Eo.downstreamChanged=function(){},Eo.findMatches=function(t){var e,n,i=t.length,r=[this];for(n=0;n<i;n+=1)!function(){var i=t[n];"*"===i?(e=[],r.forEach(function(t){e.push.apply(e,t.getValueChildren(t.get()))})):e=r.map(function(t){return t.joinKey(i)}),r=e}();return e},Eo.getKeypath=function(t){if(t!==this.ractive&&this._link)return this._link.target.getKeypath(t);if(!this.keypath){var e=this.parent&&this.parent.getKeypath(t);this.keypath=e?this.parent.getKeypath(t)+"."+_(this.key):_(this.key)}return this.keypath},Eo.getValueChildren=function(t){var e,n=this;Da(t)?(e=[],"length"in this&&this.length!==t.length&&e.push(this.joinKey("length")),t.forEach(function(t,i){e.push(n.joinKey(i))})):s(t)||u(t)?e=Ka(t).map(function(t){return n.joinKey(t)}):null!=t&&(e=[]);var i=this.computed;return i&&e.push.apply(e,Ka(i).map(function(t){return n.joinKey(t)})),e},Eo.getVirtual=function(t){var e=this,n=this.get(t,{virtual:!1});if(s(n)){for(var i=Da(n)?[]:Ia(null),r=Ka(n),a=r.length;a--;){var o=e.childByKey[r[a]];o?o._link?i[r[a]]=o._link.getVirtual():i[r[a]]=o.getVirtual():i[r[a]]=n[r[a]]}for(a=this.children.length;a--;){var u=e.children[a];u.key in i||!u._link||(i[u.key]=u._link.getVirtual())}if(this.computed)for(a=(r=Ka(this.computed)).length;a--;)i[r[a]]=e.computed[r[a]].get();return i}return n},Eo.has=function(t){var e=this;if(this._link)return this._link.has(t);var n=this.get(!1,ko);if(!n)return!1;if(t=S(t),(u(n)||s(n))&&t in n)return!0;var i=this.computed;return!!(i&&t in this.computed)||((i=this.root.ractive&&this.root.ractive.computed)&&Ka(i).forEach(function(t){if(i[t].pattern&&i[t].pattern.test(e.getKeypath()))return!0}),!1)},Eo.joinAll=function(t,e){for(var n=this,i=0;i<t.length;i+=1){if(e&&!1===e.lastLink&&i+1===t.length&&n.childByKey[t[i]]&&n.childByKey[t[i]]._link)return n.childByKey[t[i]];n=n.joinKey(t[i],e)}return n},Eo.notifyUpstream=function(t){for(var e=this,n=this.parent,i=t||[this.key];n;)n.patterns&&n.patterns.forEach(function(t){return t.notify(i.slice())}),i.unshift(n.key),n.links.forEach(function(t){return t.notifiedUpstream(i,e.root)}),n.deps.forEach(function(t){return t.handleChange(i)}),n.downstreamChanged(t),n=n.parent},Eo.rebind=function(t,e,n){var i=this;this._link&&this._link.rebind(t,e,!1);for(var r=this.deps.length;r--;)i.deps[r].rebind&&i.deps[r].rebind(t,e,n);for(r=this.links.length;r--;){var s=i.links[r];s.owner&&s.owner._link&&s.relinking(t,n)}for(r=this.children.length;r--;){var a=i.children[r];a.rebind(t?t.joinKey(a.key):void 0,a._link||a,n),i.dataModel&&i.addShuffleTask(function(){return U(i,i.retrieve())},"early")}for(r=this.bindings.length;r--;)i.bindings[r].rebind(t,e,n)},Eo.reference=function(){"refs"in this?this.refs++:this.refs=1},Eo.register=function(t){this.deps.push(t)},Eo.registerLink=function(t){C(this.links,t)},Eo.registerPatternObserver=function(t){(this.patterns||(this.patterns=[])).push(t),this.register(t)},Eo.registerTwowayBinding=function(t){this.bindings.push(t)},Eo.unreference=function(){"refs"in this&&this.refs--},Eo.unregister=function(t){V(this.deps,t)},Eo.unregisterLink=function(t){V(this.links,t)},Eo.unregisterPatternObserver=function(t){V(this.patterns,t),this.unregister(t)},Eo.unregisterTwowayBinding=function(t){V(this.bindings,t)},Eo.updateFromBindings=function(t){for(var e=this,n=this.bindings.length;n--;){var i=e.bindings[n].getValue();i!==e.value&&e.set(i)}if(!this.bindings.length){var r=D(this.deps);r&&r.value!==this.value&&this.set(r.value)}t&&(this.children.forEach(L),this.links.forEach(L),this._link&&this._link.updateFromBindings(t))};var Ao,So=[],Co={key:"@missing",animate:f,applyValue:f,get:f,getKeypath:function(){return this.key},joinAll:function(){return this},joinKey:function(){return this},mark:f,registerLink:f,shufle:f,set:f,unregisterLink:f};Co.parent=Co;var Oo=function(e){function n(t,n,i,r){e.call(this,t),this.owner=n,this.target=i,this.key=c(r)?n.key:r,n&&n.isLink&&(this.sourcePath=n.sourcePath+"."+this.key),i&&i.registerLink(this),t&&(this.isReadonly=t.isReadonly),this.isLink=!0}e&&(n.__proto__=e);var i=n.prototype=Object.create(e&&e.prototype);return i.constructor=n,i.animate=function(t,e,n,i){return this.target.animate(t,e,n,i)},i.applyValue=function(t){this.boundValue&&(this.boundValue=null),this.target.applyValue(t)},i.attach=function(t){var e=Qe(t,this.key);e?this.relinking(e,!1):this.owner.unlink()},i.detach=function(){this.relinking(Co,!1)},i.get=function(t,e){void 0===e&&(e={}),t&&(H(this),e.unwrap=!("unwrap"in e)||e.unwrap);var n=!("shouldBind"in e)||e.shouldBind;return e.shouldBind=this.mapping&&this.target.parent&&this.target.parent.isRoot,K(this,this.target.get(!1,e),n)},i.getKeypath=function(t){return t&&t!==this.root.ractive?this.target.getKeypath(t):e.prototype.getKeypath.call(this,t)},i.handleChange=function(){this.deps.forEach(Q),this.links.forEach(Q),this.notifyUpstream()},i.isDetached=function(){return this.virtual&&this.target===Co},i.joinKey=function(e){if(c(e)||""===e)return this;if(!t(this.childByKey,e)){var i=new n(this,this,this.target.joinKey(e),e);this.children.push(i),this.childByKey[e]=i}return this.childByKey[e]},i.mark=function(t){this.target.mark(t)},i.marked=function(){this.boundValue&&(this.boundValue=null),this.links.forEach(X),this.deps.forEach(Q)},i.markedAll=function(){this.children.forEach(tt),this.marked()},i.notifiedUpstream=function(t,e){var n=this;if(this.links.forEach(function(e){return e.notifiedUpstream(t,n.root)}),this.deps.forEach(Q),t&&this.rootLink&&this.root!==e){var i=t.slice(1);i.unshift(this.key),this.notifyUpstream(i)}},i.relinked=function(){this.target.registerLink(this),this.children.forEach(function(t){return t.relinked()})},i.relinking=function(t,e){var n=this;this.rootLink&&this.sourcePath&&(t=ht(this.sourcePath,t,this.target)),t&&this.target!==t&&(this.target&&this.target.unregisterLink(this),this.target=t,this.children.forEach(function(n){n.relinking(t.joinKey(n.key),e)}),this.rootLink&&this.addShuffleTask(function(){n.relinked(),e||(n.markedAll(),n.notifyUpstream())}))},i.set=function(t){this.boundValue&&(this.boundValue=null),this.target.set(t)},i.shuffle=function(t){this.shuffling||(this.target.shuffling?z(this,t,!0):this.target.shuffle?this.target.shuffle(t):this.target.mark())},i.source=function(){return this.target.source?this.target.source():this.target},i.teardown=function(){this._link&&this._link.teardown(),this.target.unregisterLink(this),this.children.forEach(it)},n}(_o);_o.prototype.link=function(t,e,n){var i=this._link||new Oo(this.parent,this,t,this.key);return i.implicit=n&&n.implicit,i.mapping=n&&n.mapping,i.sourcePath=e,i.rootLink=!0,this._link&&this._link.relinking(t,!1),this.rebind(i,this,!1),F(),this._link=i,i.markedAll(),this.notifyUpstream(),i},_o.prototype.unlink=function(){if(this._link){var t=this._link;this._link=void 0,t.rebind(this,t,!1),F(),t.teardown(),this.notifyUpstream()}};var jo=Ia(null),No=4,To=/^\s+/,Vo=function(t){this.name="ParseError",this.message=t;try{throw new Error(t)}catch(t){this.stack=t.stack}};Vo.prototype=Error.prototype;var Mo=function(t,e){var n,i=0;this.str=t,this.options=e||{},this.pos=0,this.lines=this.str.split("\n"),this.lineEnds=this.lines.map(function(t){var e=i+t.length+1;return i=e,e},0),this.init&&this.init(t,e);for(var r=[];this.pos<this.str.length&&(n=this.read());)r.push(n);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(r,e):r};Mo.prototype={read:function(t){var e,n,i=this;t||(t=this.converters);var r=this.pos,s=t.length;for(e=0;e<s;e+=1)if(i.pos=r,n=t[e](i))return n;return null},getContextMessage:function(t,e){var n=this.getLinePos(t),i=n[0],r=n[1];if(-1===this.options.contextLines)return[i,r,e+" at line "+i+" character "+r];var s=this.lines[i-1],a="",o="";if(this.options.contextLines){var u=i-1-this.options.contextLines<0?0:i-1-this.options.contextLines;a=this.lines.slice(u,i-1-u).join("\n").replace(/\t/g,"  "),o=this.lines.slice(i,i+this.options.contextLines).join("\n").replace(/\t/g,"  "),a&&(a+="\n"),o&&(o="\n"+o)}var h=0,l=a+s.replace(/\t/g,function(t,e){return e<r&&(h+=1),"  "})+"\n"+new Array(r+h).join(" ")+"^----"+o;return[i,r,e+" at line "+i+" character "+r+":\n"+l]},getLinePos:function(t){for(var e=this,n=0,i=0;t>=this.lineEnds[n];)i=e.lineEnds[n],n+=1;return[n+1,t-i+1,t]},error:function(t){var e=this.getContextMessage(this.pos,t),n=e[0],i=e[1],r=e[2],s=new Vo(r);throw s.line=n,s.character=i,s.shortMessage=t,s},matchString:function(t){if(this.str.substr(this.pos,t.length)===t)return this.pos+=t.length,t},matchPattern:function(t){var e;if(e=t.exec(this.remaining()))return this.pos+=e[0].length,e[1]||e[0]},sp:function(){this.matchPattern(To)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)},warn:function(t){y(this.getContextMessage(this.pos,t)[2])}},Mo.extend=function(e){var n=this,i=function(t,e){Mo.call(this,t,e)};i.prototype=Ia(n.prototype);for(var r in e)t(e,r)&&(i.prototype[r]=e[r]);return i.extend=Mo.extend,i};var Po,Io=1,Ro=2,Bo=3,Ko=4,Lo=5,Do=6,Fo=7,zo=8,Uo=9,$o=10,qo=11,Ho=13,Zo=14,Wo=15,Go=16,Qo=17,Yo=18,Jo=19,Xo=55,tu=20,eu=21,nu=22,iu=23,ru=24,su=25,au=26,ou=27,uu=30,hu=31,lu=32,cu=33,fu=34,du=35,pu=36,mu=40,vu=50,gu=51,yu=52,bu=53,wu=54,xu=60,ku=61,_u=62,Eu=63,Au=70,Su=71,Cu=72,Ou=73,ju=74,Nu=/^[^\s=]+/,Tu=/^\s+/,Vu=/^(\/(?:[^\n\r\u2028\u2029/\\[]|\\.|\[(?:[^\n\r\u2028\u2029\]\\]|\\.)*])+\/(?:([gimuy])(?![a-z]*\2))*(?![a-zA-Z_$0-9]))/,Mu=/[-/\\^$*+?.()|[\]{}]/g,Pu={},Iu={allowfullscreen:1,async:1,autofocus:1,autoplay:1,checked:1,compact:1,controls:1,declare:1,default:1,defaultchecked:1,defaultmuted:1,defaultselected:1,defer:1,disabled:1,enabled:1,formnovalidate:1,hidden:1,indeterminate:1,inert:1,ismap:1,itemscope:1,loop:1,multiple:1,muted:1,nohref:1,noresize:1,noshade:1,novalidate:1,nowrap:1,open:1,pauseonexit:1,readonly:1,required:1,reversed:1,scoped:1,seamless:1,selected:1,sortable:1,translate:1,truespeed:1,typemustmatch:1,visible:1},Ru={area:1,base:1,br:1,col:1,command:1,doctype:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},Bu={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Ku=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],Lu=new RegExp("&(#?(?:x[\\w\\d]+|\\d+|"+Ka(Bu).join("|")+"));?","g"),Du=u(String.fromCodePoint),Fu=Du?String.fromCodePoint:String.fromCharCode,zu=/</g,Uu=/>/g,$u=/&/g,qu=65533,Hu="Expected a JavaScript expression",Zu="Expected closing paren",Wu=/^(?:[+-]?)0*(?:(?:(?:[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,Gu=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,Qu=/^\\(?:[`'"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,Yu=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/,Ju=_t('"'),Xu=_t("'"),th=/^[^`"\\\$]+?(?:(?=[`"\\\$]))/,eh=/[\r\n\t\b\f]/g,nh=/^[a-zA-Z_$][a-zA-Z_$0-9]*/,ih=/^\s*\.{3}/,rh=/^(?:[a-zA-Z$_0-9]|\\\.)+(?:(?:\.(?:[a-zA-Z$_0-9]|\\\.)+)|(?:\[[0-9]+\]))*/,sh=/^[a-zA-Z_$][-\/a-zA-Z_$0-9]*(?:\.(?:[a-zA-Z_$][-\/a-zA-Z_$0-9]*))*/,ah=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,oh=/^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\b/,uh=/^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/,hh=/^(?:\@\.|\@|~\/|(?:\^\^\/(?:\^\^\/)*(?:\.\.\/)*)|(?:\.\.\/)+|\.\/(?:\.\.\/)*|\.)/,lh=/^(key|index|keypath|rootpath|this|global|shared|context|event|node|local|style|helpers|last|macro)/,ch=function(t,e){return function(n){var i;return(i=e(n))?i:n.matchString(t)?(n.sp(),(i=Dt(n))||n.error(Hu),{s:t,o:i,t:cu}):null}};!function(){var t,e,n,i="! ~ + - typeof".split(" ");for(n=Kt,t=0,e=i.length;t<e;t+=1)n=ch(i[t],n);Po=n}();var fh,dh=Po,ph=function(t,e){return function(n){if(n.inUnquotedAttribute&&(">"===t||"/"===t))return e(n);var i,r,s;if(!(r=e(n)))return null;for(;;){if(i=n.pos,n.sp(),!n.matchString(t))return n.pos=i,r;if("in"===t&&/[a-zA-Z_$0-9]/.test(n.remaining().charAt(0)))return n.pos=i,r;if(n.sp(),!(s=e(n)))return n.pos=i,r;r={t:pu,s:t,o:[r,s]}}}};!function(){var t,e,n,i="* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||".split(" ");for(n=dh,t=0,e=i.length;t<e;t+=1)n=ph(i[t],n);fh=n}();var mh=fh,vh=/^[^\s"'>\/=(]+/,gh=/^on/,yh=/^on-([a-zA-Z\*\.$_]((?:[a-zA-Z\*\.$_0-9\-]|\\-)+))$/,bh=/^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/,wh=/^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/,xh=/^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/,kh=/^((bind|class)-(([-a-zA-Z0-9_])+))$/,_h={lazy:{t:Ou,v:"l"},twoway:{t:Ou,v:"t"},"no-delegation":{t:ju}},Eh=/^[^\s"'=<>\/`]+/,Ah=/^[^\s"'=<>@\[\]()]*/,Sh=/^\s+/,Ch=/\\/g,Oh={t:$o,exclude:!0},jh=/^(?:[a-zA-Z$_0-9]|\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\.)+)|(?:\[[0-9]+\]))*/,Nh=/^as/i,Th={else:/^\s*else\s*/,elseif:/^\s*elseif\s+/,then:/^\s*then\s*/,catch:/^\s*catch\s*/},Vh={else:xu,elseif:ku,then:_u,catch:Eu},Mh={each:yu,if:vu,with:wu,unless:gu},Ph=/^\s*:\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Ih=/^\s*,\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Rh=new RegExp("^("+Ka(Mh).join("|")+")\\b"),Bh="\x3c!--",Kh="--\x3e",Lh=/^[ \t\f\r\n]*\r?\n/,Dh=/\r?\n[ \t\f\r\n]*$/,Fh=/[ \t\f\r\n]+/g,zh=/^[ \t\f\r\n]+/,Uh=/[ \t\f\r\n]+$/,$h=/^(?:\r\n|\r|\n)/,qh=/(?:\r\n|\r|\n)$/,Hh=/^([a-zA-Z]{1,}:?[a-zA-Z0-9\-]*)\s*\>/,Zh=/^[a-zA-Z]{1,}:?[a-zA-Z0-9\-]*/,Wh=/^[a-zA-Z_$][-a-zA-Z0-9_$]*/,Gh=/^[\s\n\/>]/,Qh=/;\s*$/,Yh={exclude:!0},Jh={li:["li"],dt:["dt","dd"],dd:["dt","dd"],p:"address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul".split(" "),rt:["rt","rp"],rp:["rt","rp"],optgroup:["optgroup"],option:["option","optgroup"],thead:["tbody","tfoot"],tbody:["tbody","tfoot"],tfoot:["tbody"],tr:["tr","tbody"],td:["td","th","tr"],th:["td","th","tr"]},Xh=/^\s*(elseif|else|then|catch)\s*/,tl=/^\s*#\s*partial\s+/,el={},nl=[le,oe,me,fe,ce],il=[ae],rl=[re,ve,Ee,Oe],sl=[je],al={pre:1,script:1,style:1,textarea:1},ol={textarea:!0,script:!0,style:!0,template:!0},ul=Mo.extend({init:function(t,e){var n=e.tripleDelimiters||el.defaults.tripleDelimiters,i=e.staticDelimiters||el.defaults.staticDelimiters,r=e.staticTripleDelimiters||el.defaults.staticTripleDelimiters;this.standardDelimiters=e.delimiters||el.defaults.delimiters,this.tags=[{isStatic:!1,isTriple:!1,open:this.standardDelimiters[0],close:this.standardDelimiters[1],readers:nl},{isStatic:!1,isTriple:!0,open:n[0],close:n[1],readers:il},{isStatic:!0,isTriple:!1,open:i[0],close:i[1],readers:nl},{isStatic:!0,isTriple:!0,open:r[0],close:r[1],readers:il}],this.contextLines=e.contextLines||el.defaults.contextLines,this.sortMustacheTags(),this.sectionDepth=0,this.elementStack=[],this.interpolate=Pa({},ol,el.defaults.interpolate,e.interpolate),!0===e.sanitize&&(e.sanitize={elements:"applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title".split(" "),eventAttributes:!0}),this.stripComments=!1!==e.stripComments,this.preserveWhitespace=!o(e.preserveWhitespace)&&e.preserveWhitespace,this.sanitizeElements=e.sanitize&&e.sanitize.elements,this.sanitizeEventAttributes=e.sanitize&&e.sanitize.eventAttributes,this.includeLinePositions=e.includeLinePositions,this.textOnlyMode=e.textOnlyMode,this.csp=e.csp,this.allowExpressions=e.allowExpressions,e.expression&&(this.converters=[Dt]),e.attributes&&(this.inTag=!0),this.whiteSpaceElements=Pa({},e.preserveWhitespace,al)},postProcess:function(t,e){var n=t[0];if(e.expression){var i=Ut(n);return i.e=ct(i.s,i.r.length),i}if(!t.length)return{t:[],v:No};if(this.sectionDepth>0&&this.error("A section was left open"),xe(n.t,this.stripComments,this.preserveWhitespace,!this.preserveWhitespace,!this.preserveWhitespace,this.whiteSpaceElements),!1!==this.csp){var r={};Te(n.t,r),Te(n.p||{},r),Ka(r).length&&(n.e=r)}return n},converters:[Ne],sortMustacheTags:function(){this.tags.sort(function(t,e){return e.open.length-t.open.length})}}),hl=["delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","interpolate","preserveWhitespace","sanitize","stripComments","contextLines","allowExpressions","attributes"],ll="Either preparse or use a ractive runtime source that includes the parser. ",cl="Either include a version of Ractive that can parse or convert your computation strings to functions.",fl={fromId:function(t,e){if(!Ua){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}t&&(t=t.replace(/^#/,""));var n;if(!(n=Ua.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==n.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in n?n.textContent:n.innerHTML},isParsed:function(t){return!h(t)},getParseOptions:function(t){return t.defaults&&(t=t.defaults),hl.reduce(function(e,n){return e[n]=t[n],e},{})},parse:function(t,e){Re(Ie,"template",ll);var n=Ie(t,e);return dt(n),n},parseFor:function(t,e){return this.parse(t,this.getParseOptions(e))}},dl=0,pl=function(t,e){this.callback=t,this.parent=e,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.outrosComplete=!1,this.id=dl++,e&&e.addChild(this)},ml=pl.prototype;ml.add=function(t){var e=t.isIntro?this.intros:this.outros;t.starting=!0,e.push(t)},ml.addChild=function(t){this.children.push(t),this.totalChildren+=1,this.outroChildren+=1},ml.checkStart=function(){this.parent&&this.parent.started&&this.start()},ml.decrementOutros=function(){this.outroChildren-=1,De(this)},ml.decrementTotal=function(){this.totalChildren-=1,De(this)},ml.detachNodes=function(){for(var t=this,e=this.detachQueue.length,n=0;n<e;n++)t.detachQueue[n].detach();e=this.children.length;for(var i=0;i<e;i++)t.children[i].detachNodes();this.detachQueue=[]},ml.ready=function(){this.detachQueue.length&&Fe(this)},ml.remove=function(t){V(t.isIntro?this.intros:this.outros,t),De(this)},ml.start=function(){this.started=!0,this.children.forEach(function(t){return t.start()}),this.intros.concat(this.outros).forEach(function(t){return t.start()}),De(this)};var vl,gl={active:function(){return!!vl},start:function(){var t,e=new Promise(function(e){return t=e});return vl={previousBatch:vl,transitionManager:new pl(t,vl&&vl.transitionManager),fragments:[],tasks:[],immediateObservers:[],deferredObservers:[],promise:e},e},end:function(){$e(),vl.previousBatch?vl.transitionManager.checkStart():vl.transitionManager.start(),vl=vl.previousBatch},addFragment:function(t){C(vl.fragments,t)},addFragmentToRoot:function(t){if(vl){for(var e=vl;e.previousBatch;)e=e.previousBatch;C(e.fragments,t)}},addObserver:function(t,e){vl?C(e?vl.deferredObservers:vl.immediateObservers,t):t.dispatch()},registerTransition:function(t){t._manager=vl.transitionManager,vl.transitionManager.add(t)},detachWhenReady:function(t){vl.transitionManager.detachQueue.push(t)},scheduleTask:function(t,e){var n;if(vl){for(n=vl;e&&n.previousBatch;)n=n.previousBatch;n.tasks.push(t)}else t()},promise:function(){if(!vl)return Promise.resolve();for(var t=vl;t.previousBatch;)t=t.previousBatch;return t.promise||Promise.resolve()}},yl=[],bl=!1,wl=function(t){this.duration=t.duration,this.step=t.step,this.complete=t.complete,this.easing=t.easing,this.start=performance.now(),this.end=this.start+this.duration,this.running=!0,yl.push(this),bl||requestAnimationFrame(qe)},xl=wl.prototype;xl.tick=function(t){if(!this.running)return!1;if(t>this.end)return this.step&&this.step(1),this.complete&&this.complete(1),!1;var e=t-this.start,n=this.easing(e/this.duration);return this.step&&this.step(n),!0},xl.stop=function(){this.abort&&this.abort(),this.running=!1};var kl={},_l={},El=function(e){function n(t,n){e.call(this,t),this.ticker=null,t&&(this.key=S(n),this.isReadonly=t.isReadonly,t.value&&(this.value=t.value[this.key],Da(this.value)&&(this.length=this.value.length),this.adapt()))}e&&(n.__proto__=e);var s=n.prototype=Object.create(e&&e.prototype);return s.constructor=n,s.adapt=function(){var t=this,e=this.root.adaptors,n=e.length;if(this.rewrap=!1,0!==n){var i=this.wrapper?"newWrapperValue"in this?this.newWrapperValue:this.wrapperValue:this.value,r=this.root.ractive,s=this.getKeypath();if(this.wrapper){if(!(this.wrapperValue!==i&&(!this.wrapper.reset||!1===this.wrapper.reset(i))))return delete this.newWrapperValue,void(this.value=this.wrapper.get());if(this.wrapper.teardown(),delete this.wrapper,delete this.wrapperValue,delete this.newWrapperValue,void 0!==this.value){var a=this.parent.value||this.parent.createBranch(this.key);a[this.key]!==i&&(a[this.key]=i),this.value=i}}var o;for(o=0;o<n;o+=1){var u=e[o];if(u.filter(i,s,r)){t.wrapper=u.wrap(r,i,s,Ze(s)),t.wrapperValue=i,t.wrapper.__model=t,t.value=t.wrapper.get();break}}}},s.animate=function(t,e,n,i){var r=this;this.ticker&&this.ticker.stop();var s,a=new Promise(function(t){return s=t});return this.ticker=new wl({duration:n.duration,easing:n.easing,step:function(t){var e=i(t);r.applyValue(e),n.step&&n.step(t,e)},complete:function(){r.applyValue(e),n.complete&&n.complete(e),r.ticker=null,s(e)}}),a.stop=this.ticker.stop,a},s.applyValue=function(t,e){if(void 0===e&&(e=!0),!i(t,this.value)){if(this.boundValue&&(this.boundValue=null),this.parent.wrapper&&this.parent.wrapper.set)this.parent.wrapper.set(this.key,t),this.parent.value=this.parent.wrapper.get(),this.value=this.parent.value[this.key],this.wrapper&&(this.newWrapperValue=this.value),this.adapt();else if(this.wrapper)this.newWrapperValue=t,this.adapt();else{var n=this.parent.value||this.parent.createBranch(this.key);if(!a(n))return void y("Attempted to set a property of a non-object '"+this.getKeypath()+"'");n[this.key]=t,this.value=t,this.adapt()}(this.dataModel||t&&t.viewmodel&&t.viewmodel.isRoot)&&U(this,t),Da(t)?(this.length=t.length,this.isArray=!0):this.isArray=!1,this.links.forEach(Q),this.children.forEach(Y),this.deps.forEach(Q),e&&this.notifyUpstream(),this.parent.isArray&&("length"===this.key?this.parent.length=t:this.parent.joinKey("length").mark())}},s.compute=function(t,e){var n=this.computed||(this.computed={});return n[t]?(n[t].signature=Le(this.root.ractive,t,e),n[t].mark()):n[t]=new _l.Computation(this,Le(this.root.ractive,t,e),t),n[t]},s.createBranch=function(t){var e=r(t)?[]:{};return this.applyValue(e,!1),e},s.get=function(t,e){return this._link?this._link.get(t,e):(t&&H(this),e&&e.virtual?this.getVirtual(!1):K(this,(e&&"unwrap"in e?!1!==e.unwrap:t)&&this.wrapper?this.wrapperValue:this.value,!e||!1!==e.shouldBind))},s.joinKey=function(e,i){var r=this;if(this._link)return i&&!1!==i.lastLink&&(c(e)||""===e)?this:this._link.joinKey(e);if(c(e)||""===e)return this;var s;if(!(s=t(this.childByKey,e)?this.childByKey[e]:this.computed&&this.computed[e])){var a;if(this.isRoot&&this.ractive&&(a=this.ractive.computed[e]))s=this.compute(e,a);else if(!this.isRoot&&this.root.ractive){var o=this.root.ractive.computed;for(var u in o)(a=o[u]).pattern&&a.pattern.test(r.getKeypath()+"."+e)&&(s=r.compute(e,a))}}if(!s&&(s=new n(this,e),this.children.push(s),this.childByKey[e]=s,"data"===e)){var h=this.retrieve();h&&h.viewmodel&&h.viewmodel.isRoot&&(s.link(h.viewmodel,"data"),this.dataModel=h)}return!s._link||i&&!1===i.lastLink?s:s._link},s.mark=function(t){if(this._link)return this._link.mark(t);var e=this.value,n=this.retrieve();(this.dataModel||n&&n.viewmodel&&n.viewmodel.isRoot)&&U(this,n),!t&&i(n,e)||(this.value=n,this.boundValue&&(this.boundValue=null),(e!==n||this.rewrap)&&(this.wrapper&&(this.newWrapperValue=n),this.adapt()),Da(n)?(this.length=n.length,this.isArray=!0):this.isArray=!1,this.children.forEach(t?J:Y),this.links.forEach(X),this.deps.forEach(Q))},s.merge=function(t,e){var n=R(this.value===t?We(this):this.value,t,e);this.parent.value[this.key]=t,this.shuffle(n,!0)},s.retrieve=function(){return this.parent.value?this.parent.value[this.key]:void 0},s.set=function(t){this.ticker&&this.ticker.stop(),this.applyValue(t)},s.shuffle=function(t,e){z(this,t,!1,e)},s.source=function(){return this},s.teardown=function(){var t=this;this._link&&(this._link.teardown(),this._link=null),this.children.forEach(it),this.wrapper&&this.wrapper.teardown(),this.computed&&Ka(this.computed).forEach(function(e){return t.computed[e].teardown()})},n}(_o),Al={},Sl=function(t){function e(e,n,i){t.call(this,null,"@"+n),this.key="@"+n,this.value=e,this.isRoot=!0,this.root=this,this.adaptors=[],this.ractive=i}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getKeypath=function(){return this.key},n.retrieve=function(){return this.value},e}(El),Cl=new Sl(Al,"shared"),Ol=new Sl(qa,"global"),jl={},Nl=function(t){this.ractive=t};Nl.prototype.findContext=function(){return this.ractive.viewmodel};var Tl=Nl.prototype;Tl.getContext=nn,Tl.find=Tl.findComponent=Tl.findAll=Tl.findAllComponents=f;var Vl=!1,Ml=/\*/,Pl={virtual:!1},Il={},Rl="Cannot add to a non-numeric value",Bl=oo.linear,Kl={},Ll={},Dl=function(t){this.event=t,this.method="on"+t};Dl.prototype.fire=function(t,e){var n=en(t),i=this.method;t[i]&&(e?t[i](n,e):t[i](n)),bn(t,this.event,n,e?[e,t]:[t])};var Fl=function(t){this.hook=new Dl(t),this.inProcess={},this.queue={}},zl=Fl.prototype;zl.begin=function(t){this.inProcess[t._guid]=!0},zl.end=function(t){var e=t.parent;e&&this.inProcess[e._guid]?kn(this.queue,e).push(t):_n(this,t),delete this.inProcess[t._guid]};var Ul={};["construct","config","attachchild","detach","detachchild","insert","complete","reset","render","unrendering","unrender","teardown","destruct","update"].forEach(function(t){Ul[t]=new Dl(t)}),Ul.init=new Fl("init");var $l=Array.prototype,ql=$n("push").model,Hl=$n("pop").model,Zl=$n("shift").model,Wl=$n("unshift").model,Gl=$n("sort").model,Ql=$n("splice").model,Yl=$n("reverse").model,Jl=function(t){function e(e){t.call(this,null,null),this.isRoot=!0,this.root=this,this.value={},this.ractive=e.ractive,this.adaptors=[],this.context=e.context}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getKeypath=function(){return"@context.data"},n.rebound=function(){},e}(El),Xl=function(t,e){this.fragment=t,this.element=e||Fn(t),this.node=this.element&&this.element.node,this.ractive=t.ractive,this.root=this},tc=Xl.prototype,ec={decorators:{},_data:{}};ec.decorators.get=function(){var t={};return this.element?(this.element.decorators.forEach(function(e){return t[e.name]=e.handle}),t):t},ec._data.get=function(){return this.model||(this.root.model=new Jl({ractive:this.ractive,context:this.root}))},tc.add=function(t,e,n){var i=l(e)?+e:1,s=o(e)?e:n;return sn(Zn(this,t,i).map(function(t){var e=t[0],n=t[1],i=e.get();if(!r(n)||!r(i))throw new Error("Cannot add non-numeric value");return[e,i+n]}),s)},tc.animate=function(t,e,n){var i=Wn(this,t).model;return pn(this.ractive,i,e,n)},tc.find=function(t){return this.fragment.find(t)},tc.findAll=function(t){var e=[];return this.fragment.findAll(t,{result:e}),e},tc.findAllComponents=function(t){var e=[];return this.fragment.findAllComponents(t,{result:e}),e},tc.findComponent=function(t){return this.fragment.findComponent(t)},tc.get=function(t){if(!t)return this.fragment.findContext().get(!0);var e=Wn(this,t).model;return e?e.get(!0):void 0},tc.getParent=function(t){var e=this.fragment;return!e.parent&&t?e=e.componentParent:e.context?e=rn(e.parent):(e=rn(e.parent))&&(e=!e.parent&&t?e.componentParent:rn(e.parent)),e&&e!==this.fragment?e.getContext():void 0},tc.hasListener=function(t,e){var n,i=this.fragment.owner.component?this.fragment.owner:this.element||this.fragment.owner;do{if((n=i.component||i).template.t===Fo&&Gn(n,t))return!0;(i=i.up&&i.up.owner)&&i.component&&(i=i.component)}while(i&&e)},tc.link=function(t,e){var n=Wn(this,t).model,i=Wn(this,e).model,r=gl.start();return i.link(n,t),gl.end(),r},tc.listen=function(t,e){var n=this.element;return n.on(t,e),{cancel:function(){n.off(t,e)}}},tc.observe=function(t,e,n){return void 0===n&&(n={}),s(t)&&(n=e||{}),n.fragment=this.fragment,this.ractive.observe(t,e,n)},tc.observeOnce=function(t,e,n){return void 0===n&&(n={}),s(t)&&(n=e||{}),n.fragment=this.fragment,this.ractive.observeOnce(t,e,n)},tc.pop=function(t){return Hl(Wn(this,t).model,[])},tc.push=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return ql(Wn(this,t).model,e)},tc.raise=function(t,e){for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];for(var r,s=this.element;s;){if(s.component&&(s=s.component),r=Gn(s,t))return r.fire(r.element.getContext(e||{},!e||"original"in e?{}:{original:{}}),n);s=s.up&&s.up.owner}},tc.readLink=function(t,e){return this.ractive.readLink(this.resolve(t),e)},tc.resolve=function(t,e){var n=Wn(this,t),i=n.model,r=n.instance;return i?i.getKeypath(e||r):t},tc.reverse=function(t){return Yl(Wn(this,t).model,[])},tc.set=function(t,e,n){return sn(Zn(this,t,e),n)},tc.shift=function(t){return Zl(Wn(this,t).model,[])},tc.splice=function(t,e,n){for(var i=[],r=arguments.length-3;r-- >0;)i[r]=arguments[r+3];return i.unshift(e,n),Ql(Wn(this,t).model,i)},tc.sort=function(t){return Gl(Wn(this,t).model,[])},tc.subtract=function(t,e,n){var i=l(e)?e:1,s=o(e)?e:n;return sn(Zn(this,t,i).map(function(t){var e=t[0],n=t[1],i=e.get();if(!r(n)||!r(i))throw new Error("Cannot add non-numeric value");return[e,i-n]}),s)},tc.toggle=function(t,e){var n=Wn(this,t).model;return sn([[n,!n.get()]],e)},tc.unlink=function(t){var e=Wn(this,t).model,n=gl.start();return e.owner&&e.owner._link&&e.owner.unlink(),gl.end(),n},tc.unlisten=function(t,e){this.element.off(t,e)},tc.unshift=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return Wl(Wn(this,t).model,e)},tc.update=function(t,e){return qn(this.ractive,Wn(this,t).model,e)},tc.updateModel=function(t,e){var n=Wn(this,t).model,i=gl.start();return n.updateFromBindings(e),gl.end(),i},tc.isBound=function(){return!!this.getBindingModel(this).model},tc.getBindingPath=function(t){var e=this.getBindingModel(this),n=e.model,i=e.instance;if(n)return n.getKeypath(t||i)},tc.getBinding=function(){var t=this.getBindingModel(this).model;if(t)return t.get(!0)},tc.getBindingModel=function(t){var e=t.element;return{model:e.binding&&e.binding.model,instance:e.up.ractive}},tc.setBinding=function(t){return sn([[this.getBindingModel(this).model,t]])},Object.defineProperties(tc,ec),Xl.forRactive=en,jl.Context=Xl;var nc,ic,rc,sc,ac,oc,uc,hc,lc,cc=Ua&&Ua.querySelector,fc="http://www.w3.org/1999/xhtml",dc="http://www.w3.org/2000/svg",pc={html:fc,mathml:"http://www.w3.org/1998/Math/MathML",svg:dc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns"};if(nc=Za?function(t,e,n){return e&&e!==fc?n?Ua.createElementNS(e,t,n):Ua.createElementNS(e,t):n?Ua.createElement(t,n):Ua.createElement(t)}:function(t,e,n){if(e&&e!==fc)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information";return n?Ua.createElement(t,n):Ua.createElement(t)},$a){for(rc=nc("div"),lc=function(t){return function(e,n){return e[t](n)}},uc=(sc=["matches","matchesSelector"]).length;uc--&&!ic;)if(ac=sc[uc],rc[ac])ic=lc(ac);else for(hc=Wa.length;hc--;)if(oc=Wa[uc]+ac.substr(0,1).toUpperCase()+ac.substring(1),rc[oc]){ic=lc(oc);break}ic||(ic=function(t,e){var n,i;(n=t.parentNode)||(rc.innerHTML="",n=rc,t=t.cloneNode(),rc.appendChild(t));var r=n.querySelectorAll(e);for(i=r.length;i--;)if(r[i]===t)return!0;return!1})}else ic=null;var mc=function(t,e,n,i){this.context=i.context||t,this.callback=n,this.ractive=t,this.keypath=i.keypath,this.options=i,e&&this.resolved(e),u(i.old)&&(this.oldContext=Ia(t),this.oldFn=i.old),!1!==i.init?(this.dirty=!0,this.dispatch()):hi(this),this.dirty=!1},vc=mc.prototype;vc.cancel=function(){this.cancelled=!0,this.model?this.model.unregister(this):this.resolver.unbind(),V(this.ractive._observers,this)},vc.dispatch=function(){this.cancelled||(this.callback.call(this.context,this.newValue,this.oldValue,this.keypath),hi(this,!0),this.dirty=!1)},vc.handleChange=function(){var t=this;if(this.dirty)this.newValue=this.model.get();else{var e=this.model.get();if(i(e,this.oldValue))return;if(this.newValue=e,this.options.strict&&this.newValue===this.oldValue)return;gl.addObserver(this,this.options.defer),this.dirty=!0,this.options.once&&gl.scheduleTask(function(){return t.cancel()})}},vc.rebind=function(t,e){var n=this;if((t=ht(this.keypath,t,e))===this.model)return!1;this.model&&this.model.unregister(this),t&&t.addShuffleTask(function(){return n.resolved(t)})},vc.resolved=function(t){this.model=t,this.oldValue=void 0,this.newValue=t.get(),t.register(this)};var gc=/\*+/g,yc=function(t,e,n,i,r){var s=this;this.context=r.context||t,this.ractive=t,this.baseModel=e,this.keys=n,this.callback=i;var a=n.join("\\.").replace(gc,"(.+)"),o=this.baseKeypath=e.getKeypath(t);this.pattern=new RegExp("^"+(o?o+"\\.":"")+a+"$"),this.recursive=1===n.length&&"**"===n[0],this.recursive&&(this.keys=["*"]),r.old&&(this.oldContext=Ia(t),this.oldFn=r.old),this.oldValues={},this.newValues={},this.defer=r.defer,this.once=r.once,this.strict=r.strict,this.dirty=!1,this.changed=[],this.partial=!1,this.links=r.links,e.findMatches(this.keys).forEach(function(t){s.newValues[t.getKeypath(s.ractive)]=t.get()}),!1!==r.init?this.dispatch():li(this,this.newValues),e.registerPatternObserver(this)},bc=yc.prototype;bc.cancel=function(){this.baseModel.unregisterPatternObserver(this),V(this.ractive._observers,this)},bc.dispatch=function(){var t=this,e=this.newValues;this.newValues={},Ka(e).forEach(function(n){var r=e[n],s=t.oldValues[n];if(!(t.strict&&r===s||i(r,s))){var a=[r,s,n];if(n){var o=t.pattern.exec(n);o&&(a=a.concat(o.slice(1)))}t.callback.apply(t.context,a)}}),li(this,e,this.partial),this.dirty=!1},bc.notify=function(t){this.changed.push(t)},bc.shuffle=function(t){var e=this;if(Da(this.baseModel.value)){for(var n=this.baseModel.value.length,i=0;i<t.length;i++)-1!==t[i]&&t[i]!==i&&e.changed.push([i]);for(var r=t.touchedFrom;r<n;r++)e.changed.push([r])}},bc.handleChange=function(){var t=this;if(!this.dirty||this.changed.length){if(this.dirty||(this.newValues={}),this.changed.length){var e=0;if(this.recursive)this.changed.forEach(function(n){var i=t.baseModel.joinAll(n);i.isLink&&!t.links||(e++,t.newValues[i.getKeypath(t.ractive)]=i.get())});else{var n=this.baseModel.isRoot?this.changed.map(function(t){return t.map(_).join(".")}):this.changed.map(function(e){return t.baseKeypath+"."+e.map(_).join(".")});this.baseModel.findMatches(this.keys).forEach(function(i){var r=i.getKeypath(t.ractive),s=function(t){return 0===t.indexOf(r)&&(t.length===r.length||"."===t[r.length])||0===r.indexOf(t)&&(t.length===r.length||"."===r[t.length])};n.filter(s).length&&(e++,t.newValues[r]=i.get())})}if(!e)return;this.partial=!0}else this.baseModel.findMatches(this.keys).forEach(function(e){var n=e.getKeypath(t.ractive);t.newValues[n]=e.get()}),this.partial=!1;gl.addObserver(this,this.defer),this.dirty=!0,this.changed.length=0,this.once&&this.cancel()}};var wc=function(t,e,n,i){this.ractive=t,this.model=e,this.keypath=e.getKeypath(),this.callback=n,this.options=i,this.pending=null,e.register(this),!1!==i.init?(this.sliced=[],this.shuffle([]),this.dispatch()):this.sliced=this.slice()},xc=wc.prototype;xc.cancel=function(){this.model.unregister(this),V(this.ractive._observers,this)},xc.dispatch=function(){this.callback(this.pending),this.pending=null,this.options.once&&this.cancel()},xc.handleChange=function(t){this.pending?gl.addObserver(this,this.options.defer):t||(this.shuffle(this.sliced.map(ci)),this.handleChange())},xc.shuffle=function(t){var e,n=this,i=this.slice(),r=[],s=[],a={};t.forEach(function(t,i){a[t]=!0,t!==i&&c(e)&&(e=i),-1===t&&s.push(n.sliced[i])}),c(e)&&(e=t.length);for(var o=i.length,u=0;u<o;u+=1)a[u]||r.push(i[u]);this.pending={inserted:r,deleted:s,start:e},this.sliced=i},xc.slice=function(){var t=this.model.get();return Da(t)?t.slice():[]};var kc={init:!1,once:!0},_c=function(t){return t.trim()},Ec=function(t){return""!==t},Ac=$n("pop").path,Sc=$n("push").path,Cc="/* Ractive.js component styles */",Oc=[],jc=!1,Nc=null,Tc=null,Vc={extend:function(t,e,n){e.adapt=M(e.adapt,N(n.adapt))},init:function(){}},Mc=/\/\*(?:[\s\S]*?)\*\//g,Pc=/url\(\s*(['"])(?:\\[\s\S]|(?!\1).)*\1\s*\)|url\((?:\\[\s\S]|[^)])*\)|(['"])(?:\\[\s\S]|(?!\2).)*\2/gi,Ic=/\0(\d+)/g,Rc=/(?:^|\}|\{|\x01)\s*([^\{\}\0\x01]+)\s*(?=\{)/g,Bc=/@import\s*\([^)]*\)\s*;?/gi,Kc=/\x01/g,Lc=/@keyframes\s+[^\{\}]+\s*\{(?:[^{}]+|\{[^{}]+})*}/gi,Dc=/((?:(?:\[[^\]]+\])|(?:[^\s\+\>~:]))+)((?:::?[^\s\+\>\~\(:]+(?:\([^\)]+\))?)*\s*[\s\+\>\~]?)\s*/g,Fc=/^(?:@|\d+%)/,zc=/\[data-ractive-css~="\{[a-z0-9-]+\}"]/g,Uc=function(t){function e(e){t.call(this,e.cssData,"@style"),this.component=e}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.downstreamChanged=function(t,e){if(!this.locked){var n=this.component;n.extensions.forEach(function(n){var i=n._cssModel;i.mark(),i.downstreamChanged(t,e||1)}),e||Ti(n,!0)}},e}(Sl),$c=/\{/,qc={name:"css",extend:function(t,e,n,i){i._cssIds=Mi(t),Ra(i,"cssData",{configurable:!0,value:Pa(Ia(t.cssData),n.cssData||{})}),Ra(i,"_cssModel",{configurable:!0,value:new Uc(i)}),n.css&&Ii(n,i,e)},init:function(t,e,n){n.css&&y("\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t")}},Hc={name:"data",extend:function(t,e,n){var i,r;if(n.data&&s(n.data))for(i in n.data)(r=n.data[i])&&o(r)&&(s(r)||Da(r))&&y("Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }");e.data=Ki(e.data,n.data)},init:function(t,e,n){var i=Ki(t.prototype.data,n.data);if(u(i)&&(i=i.call(e)),i&&i.constructor===Object)for(var r in i)if(u(i[r])){var s=i[r];i[r]=B(s,e),i[r]._r_unbound=s}return i||{}},reset:function(t){var e=this.init(t.constructor,t,t.viewmodel);return t.viewmodel.root.set(e),!0}},Zc={name:"template",extend:function(t,e,n){if("template"in n){var i=n.template;u(i)?e.template=i:e.template=Ui(i,e)}},init:function(t,e,n){var i="template"in n?n.template:t.prototype.template;if(i=i||{v:No,t:[]},u(i)){var r=i;i=zi(e,r),e._config.template={fn:r,result:i}}i=Ui(i,e),e.template=i.t,i.p&&Hi(e.partials,i.p)},reset:function(t){var e=Fi(t);if(e){var n=Ui(e,t);return t.template=n.t,Hi(t.partials,n.p,!0),!0}}},Wc=["adaptors","components","computed","decorators","easing","events","helpers","interpolators","partials","transitions"],Gc=["computed","helpers"],Qc=function(t,e){this.name=t,this.useDefaults=e},Yc=Qc.prototype;Yc.extend=function(t,e,n){var i=this.useDefaults?t.defaults:t,r=this.useDefaults?e:e.constructor;this.configure(i,r,n)},Yc.init=function(){},Yc.configure=function(t,e,n){var i=this.name,r=n[i],s=Ia(t[i]);Pa(s,r),e[i]=s,"partials"===i&&e[i]&&Ka(e[i]).forEach(function(t){dt(e[i][t])})},Yc.reset=function(t){var e=t[this.name],n=!1;return Ka(e).forEach(function(t){var i=e[t];i._fn&&(i._fn.isOwner?e[t]=i._fn:delete e[t],n=!0)}),n};var Jc=Wc.map(function(t){var e=Gc.indexOf(t)>-1;return new Qc(t,e)}),Xc={extend:function(t,e,n,i){return Ji("extend",t,e,n,i)},init:function(t,e,n){return Ji("init",t,e,n)},reset:function(t){return sf.filter(function(e){return e.reset&&e.reset(t)}).map(function(t){return t.name})}},tf={adapt:Vc,computed:Xc,css:qc,data:Hc,helpers:Xc,template:Zc},ef=Ka(ao),nf=tr(ef.filter(function(t){return!tf[t]})),rf=tr(ef.concat(Jc.map(function(t){return t.name}),["on","observe","attributes","cssData","use"])),sf=[].concat(ef.filter(function(t){return!Jc[t]&&!tf[t]}),Jc,tf.template,tf.css),af=/\b_super\b/,of=function(t){this.up=t.up,this.ractive=t.up.ractive,this.template=t.template,this.index=t.index,this.type=t.template.t,this.dirty=!1},uf=of.prototype;uf.bubble=function(){this.dirty||(this.dirty=!0,this.up.bubble())},uf.destroyed=function(){this.fragment&&this.fragment.destroyed()},uf.find=function(){return null},uf.findComponent=function(){return null},uf.findNextNode=function(){return this.up.findNextNode(this)},uf.rebound=function(t){this.fragment&&this.fragment.rebound(t)},uf.shuffled=function(){this.fragment&&this.fragment.shuffled()},uf.valueOf=function(){return this.toString()},of.prototype.findAll=f,of.prototype.findAllComponents=f;var hf=function(t){function e(e){t.call(this,e)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.detach=function(){return this.fragment?this.fragment.detach():ti()},n.find=function(t){if(this.fragment)return this.fragment.find(t)},n.findAll=function(t,e){this.fragment&&this.fragment.findAll(t,e)},n.findComponent=function(t){if(this.fragment)return this.fragment.findComponent(t)},n.findAllComponents=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},n.firstNode=function(t){return this.fragment&&this.fragment.firstNode(t)},n.toString=function(t){return this.fragment?this.fragment.toString(t):""},e}(of),lf=/\s+/,cf=[void 0,"text","search","url","email","hidden","password","search","reset","submit"],ff={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor",class:"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",dirname:"dirName",for:"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},df=Ua?nc("div"):null,pf=!1,mf=function(t){function e(e){t.call(this,e),this.attributes=[],this.owner=e.owner,this.fragment=new Sp({ractive:this.ractive,owner:this,template:this.template}),this.fragment.findNextNode=f,this.dirty=!1}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.fragment.bind()},n.bubble=function(){this.dirty||(this.dirty=!0,this.owner.bubble())},n.destroyed=function(){this.unrender()},n.render=function(){this.node=this.owner.node,this.node&&(this.isSvg=this.node.namespaceURI===dc),pf=!0,this.rendered||this.fragment.render(),this.rendered=!0,this.dirty=!0,this.update(),pf=!1},n.toString=function(){return this.fragment.toString()},n.unbind=function(t){this.fragment.unbind(t)},n.unrender=function(){this.rendered=!1,this.fragment.unrender()},n.update=function(){var t,e,n=this;if(this.dirty){this.dirty=!1;var i=pf;pf=!0,this.fragment.update(),this.rendered&&this.node&&(t=this.fragment.toString(),e=wr(t,this.isSvg),this.attributes.filter(function(t){return xr(e,t)}).forEach(function(t){n.node.removeAttribute(t.name)}),e.forEach(function(t){n.node.setAttribute(t.name,t.value)}),this.attributes=e),pf=i||!1}},e}(of),vf=/^\s*$/,gf=!1,yf=function(t){function e(e){if(t.call(this,e),this.name=e.template.n,this.namespace=null,this.owner=e.owner||e.up.owner||e.element||Fn(e.up),this.element=e.element||(this.owner.attributeByName?this.owner:Fn(e.up)),this.up=e.up,this.ractive=this.up.ractive,this.rendered=!1,this.updateDelegate=null,this.fragment=null,this.element.attributeByName[this.name]=this,!Da(e.template.f))return this.value=e.template.f,void(0===this.value?this.value="":c(this.value)&&(this.value=!0));this.fragment=new Sp({owner:this,template:e.template.f}),this.interpolator=this.fragment&&1===this.fragment.items.length&&this.fragment.items[0].type===Ro&&this.fragment.items[0],this.interpolator&&(this.interpolator.owner=this)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.fragment&&this.fragment.bind()},n.bubble=function(){this.dirty||(this.up.bubble(),this.element.bubble(),this.dirty=!0)},n.firstNode=function(){},n.getString=function(){gf=!0;var t=this.fragment?this.fragment.toString():null!=this.value?""+this.value:"";return gf=!1,t},n.getValue=function(){gf=!0;var t=this.fragment?this.fragment.valueOf():!!Iu[this.name.toLowerCase()]||this.value;return gf=!1,t},n.render=function(){var t=this.element.node;if(this.node=t,t.namespaceURI&&t.namespaceURI!==pc.html||(this.propertyName=ff[this.name]||this.name,void 0!==t[this.propertyName]&&(this.useProperty=!0),(Iu[this.name.toLowerCase()]||this.isTwoway)&&(this.isBoolean=!0),"value"===this.propertyName&&(t._ractive.value=this.value)),t.namespaceURI){var e=this.name.indexOf(":");this.namespace=-1!==e?kr(t,this.name.slice(0,e)):t.namespaceURI}this.rendered=!0,this.updateDelegate=ir(this),this.updateDelegate()},n.toString=function(){if(br())return"";gf=!0;var t=this.getValue();if("value"!==this.name||void 0===this.element.getAttribute("contenteditable")&&"select"!==this.element.name&&"textarea"!==this.element.name){if("name"===this.name&&"input"===this.element.name&&this.interpolator&&"radio"===this.element.getAttribute("type"))return'name="{{'+this.interpolator.model.getKeypath()+'}}"';if(this.owner!==this.element||"style"!==this.name&&"class"!==this.name&&!this.style&&!this.inlineClass){if(this.rendered||this.owner!==this.element||this.name.indexOf("style-")&&this.name.indexOf("class-")){if(Iu[this.name.toLowerCase()])return t?h(t)?this.name+'="'+ri(t)+'"':this.name:"";if(null==t)return"";var e=ri(this.getString());return gf=!1,e?this.name+'="'+e+'"':this.name}this.name.indexOf("style-")?this.inlineClass=this.name.substr(6):this.style=_e(this.name.substr(6))}}},n.unbind=function(t){this.fragment&&this.fragment.unbind(t)},n.unrender=function(){this.updateDelegate(!0),this.rendered=!1},n.update=function(){if(this.dirty){var t;if(this.dirty=!1,this.fragment&&this.fragment.update(),this.rendered&&this.updateDelegate(),this.isTwoway&&!this.locked)this.interpolator.twowayBinding.lastVal(!0,this.interpolator.model.get());else if("value"===this.name&&(t=this.element.binding)){var e=t.attribute;e&&!e.dirty&&e.rendered&&this.element.binding.attribute.updateDelegate()}}},e}(of),bf=function(t){function e(e){t.call(this,e),this.owner=e.owner||e.up.owner||Fn(e.up),this.element=this.owner.attributeByName?this.owner:Fn(e.up),this.flag="l"===e.template.v?"lazy":"twoway",this.bubbler=this.owner===this.element?this.element:this.up,this.element.type===Fo&&(Da(e.template.f)&&(this.fragment=new Sp({owner:this,template:e.template.f})),this.interpolator=this.fragment&&1===this.fragment.items.length&&this.fragment.items[0].type===Ro&&this.fragment.items[0])}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.fragment&&this.fragment.bind(),Er(this,this.getValue(),!0)},n.bubble=function(){this.dirty||(this.bubbler.bubble(),this.dirty=!0)},n.getValue=function(){return this.fragment?this.fragment.valueOf():"value"in this?this.value:!("f"in this.template)||this.template.f},n.render=function(){Er(this,this.getValue(),!0)},n.toString=function(){return""},n.unbind=function(t){this.fragment&&this.fragment.unbind(t),delete this.element[this.flag]},n.unrender=function(){this.element.rendered&&this.element.recreateTwowayBinding()},n.update=function(){this.dirty&&(this.dirty=!1,this.fragment&&this.fragment.update(),Er(this,this.getValue(),!0))},e}(of),wf=Ia(of.prototype);Pa(wf,{bind:f,unbind:f,update:f,detach:function(){return ni(this.node)},firstNode:function(){return this.node},render:function(t){this.rendered=!0,this.node=Ua.createComment(this.template.c),t.appendChild(this.node)},toString:function(){return"\x3c!-- "+this.template.c+" --\x3e"},unrender:function(t){this.rendered&&t&&this.detach(),this.rendered=!1}}),Ar.prototype=wf;var xf=function(t){function e(e){t.call(this,e,"@this"),this.ractive=e}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.joinKey=function(e){var n=t.prototype.joinKey.call(this,e);return"root"!==e&&"parent"!==e||n.isLink?"data"===e?this.ractive.viewmodel:"cssData"===e?this.ractive.constructor._cssModel:n:Or(n,e)},e}(Sl),kf={"@this":function(t){return t.getRactiveModel()},"@global":function(){return Ol},"@shared":function(){return Cl},"@style":function(t){return t.getRactiveModel().joinKey("cssData")},"@helpers":function(t){return t.getHelpers()}};kf["@"]=kf["@this"];var _f=function(t){function e(e){t.call(this,null,null),this.isRoot=!0,this.root=this,this.ractive=e.ractive,this.value=e.data,this.adaptors=e.adapt,this.adapt()}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.attached=function(t){jr(this,t)},n.createLink=function(t,e,n,i){for(var r=A(t),s=this;r.length;){var a=r.shift();s=s.childByKey[a]||s.joinKey(a)}return s.link(e,n,i)},n.detached=function(){Nr(this)},n.get=function(t,e){return t&&H(this),e&&!1===e.virtual?this.value:this.getVirtual()},n.getHelpers=function(){return this.helpers||(this.helpers=new Sl(this.ractive.helpers,"helpers",this.ractive)),this.helpers},n.getKeypath=function(){return""},n.getRactiveModel=function(){return this.ractiveModel||(this.ractiveModel=new xf(this.ractive))},n.getValueChildren=function(){var e=t.prototype.getValueChildren.call(this,this.value);return this.children.forEach(function(t){if(t._link){var n=e.indexOf(t);~n?e.splice(n,1,t._link):e.push(t._link)}}),e},n.has=function(e){if("~"===e[0]&&"/"===e[1]&&(e=e.slice(2)),kf[e]||""===e)return!0;if(t.prototype.has.call(this,e))return!0;var n=S(e);return!(!this.childByKey[n]||!this.childByKey[n]._link)||void 0},n.joinKey=function(e,n){if("~"===e[0]&&"/"===e[1]&&(e=e.slice(2)),"@"!==e[0])return t.prototype.joinKey.call(this,e,n);var i=kf[e];return i?i(this):void 0},n.set=function(t){var e=this.wrapper;e?(!e.reset||!1===e.reset(t))&&(e.teardown(),this.wrapper=null,this.value=t,this.adapt()):(this.value=t,this.adapt()),this.deps.forEach(Q),this.children.forEach(Y)},n.retrieve=function(){return this.wrapper?this.wrapper.get():this.value},n.teardown=function(){t.prototype.teardown.call(this),this.ractiveModel&&this.ractiveModel.teardown()},e}(El);_f.prototype.update=f;var Ef=["adaptors","components","decorators","easing","events","interpolators","partials","transitions"],Af=["computed","helpers"],Sf=0,Cf=function(t){function e(e,n){var i=this;t.call(this,e);var r=e.template;this.isAnchor=r.t===qo,this.type=this.isAnchor?qo:Wo;var s=r.m,a=r.p||{};if("content"in a||(a.content=r.f||[]),this._partials=a,this.isAnchor)this.name=r.n,this.addChild=Rr,this.removeChild=Br;else{var o=Ia(n.prototype);this.instance=o,this.name=r.e,(o.el||o.target)&&(y("The <"+this.name+"> component has a default '"+(o.el?"el":"target")+"' property; it has been disregarded"),o.el=o.target=null);for(var u,l=e.up;l;){if(l.owner.type===Go){u=l.owner.container;break}l=l.parent}o.parent=this.up.ractive,o.container=u||null,o.root=o.parent.root,o.component=this,Vr(this.instance,{partials:a}),s=(r=this.template).m,Da(this.mappings)?s=(s||[]).concat(this.mappings):h(this.mappings)&&(s=(s||[]).concat(fl.parse(this.mappings,{attributes:!0}).t)),o._inlinePartials=a}if(this.attributeByName={},this.attributes=[],s){var c=[];s.forEach(function(t){switch(t.t){case Ho:case Au:i.attributes.push(Ws({owner:i,up:i.up,template:t}));break;case Cu:case Ou:case Su:break;default:c.push(t)}}),c.length&&this.attributes.push(new mf({owner:this,up:this.up,template:c}))}this.eventHandlers=[]}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.isAnchor||(this.attributes.forEach(Z),this.eventHandlers.forEach(Z),Js(this.instance,{partials:this._partials},{cssIds:this.up.cssIds}),(this.instance.target||this.instance.el)&&(this.extern=!0),this.bound=!0)},n.bubble=function(){this.dirty||(this.dirty=!0,this.up.bubble())},n.destroyed=function(){!this.isAnchor&&this.instance.fragment&&this.instance.fragment.destroyed()},n.detach=function(){return this.isAnchor?this.instance?this.instance.fragment.detach():ti():this.instance.fragment.detach()},n.find=function(t,e){if(this.instance)return this.instance.fragment.find(t,e)},n.findAll=function(t,e){this.instance&&this.instance.fragment.findAll(t,e)},n.findComponent=function(t,e){return t&&this.name!==t?this.instance.fragment?this.instance.fragment.findComponent(t,e):void 0:this.instance},n.findAllComponents=function(t,e){var n=e.result;!this.instance||t&&this.name!==t||n.push(this.instance),this.instance&&this.instance.findAllComponents(t,e)},n.firstNode=function(t){if(this.instance)return this.instance.fragment.firstNode(t)},n.getContext=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.unshift(this.instance),en.apply(null,t)},n.rebound=function(t){this.attributes.forEach(function(e){return e.rebound(t)})},n.render=function(t,e){this.isAnchor?(this.rendered=!0,this.target=t,Of.length||(Of.push(this.ractive),e?(this.occupants=e,Dr(),this.occupants=null):gl.scheduleTask(Dr,!0))):(this.attributes.forEach(et),this.eventHandlers.forEach(et),this.extern?(this.instance.delegate=!1,this.instance.render()):ta(this.instance,t,null,e),this.rendered=!0)},n.shuffled=function(){t.prototype.shuffled.call(this),this.instance&&!this.instance.isolated&&this.instance.fragment&&this.instance.fragment.shuffled()},n.toString=function(){if(this.instance)return this.instance.toHTML()},n.unbind=function(t){this.isAnchor||(this.bound=!1,this.attributes.forEach(rt),t?this.instance.fragment.unbind():Cr(this.instance,function(){return gl.promise()}))},n.unrender=function(t){this.shouldDestroy=t,this.isAnchor?(this.item&&Lr(this,this.item),this.target=null,Of.length||(Of.push(this.ractive),gl.scheduleTask(Dr,!0))):(this.instance.unrender(),this.instance.el=this.instance.target=null,this.attributes.forEach(st),this.eventHandlers.forEach(st)),this.rendered=!1},n.update=function(){this.dirty=!1,this.instance&&(this.instance.fragment.update(),this.attributes.forEach(at),this.eventHandlers.forEach(at))},e}(of),Of=[],jf={update:f,teardown:f},Nf=function(t){this.owner=t.owner||t.up.owner||Fn(t.up),this.element=this.owner.attributeByName?this.owner:Fn(t.up),this.up=t.up||this.owner.up,this.ractive=this.owner.ractive;var e=this.template=t.template;this.name=e.n,this.node=null,this.handle=null,this.element.decorators.push(this)},Tf=Nf.prototype;Tf.bind=function(){var t=this.element===this.owner?new Sp({owner:this.owner}):this.up;Fr(this,this.template,t,{register:!0})},Tf.bubble=function(){this.dirty||(this.dirty=!0,this.owner.bubble(),this.up.bubble())},Tf.destroyed=function(){this.handle&&(this.handle.teardown(),this.handle=null),this.shouldDestroy=!0},Tf.handleChange=function(){this.bubble()},Tf.rebind=function(t,e,n){var i=this.models.indexOf(e);~i&&(t=ht(this.template.f.r[i],t,e))!==e&&(e.unregister(this),this.models.splice(i,1,t),t&&t.addShuffleRegister(this,"mark"),n||this.bubble())},Tf.rebound=function(t){Ur(this,this.template),Fr(this,this.template,this.up,{register:!0}),t&&this.bubble()},Tf.render=function(){var t=this;this.shouldDestroy=!1,this.handle&&this.unrender(),gl.scheduleTask(function(){if(t.element.rendered){var e=w("decorators",t.ractive,t.name);if(!e)return g(fo(t.name,"decorator")),void(t.handle=jf);t.node=t.element.node;var n;if(t.fn&&(n=t.models.map(function(t){if(t)return t.get()}),n=t.fn.apply(t.ractive,n)),t.handle=e.apply(t.ractive,[t.node].concat(n)),!t.handle||!t.handle.teardown)throw new Error("The '"+t.name+"' decorator must return an object with a teardown method");t.shouldDestroy&&t.destroyed()}},!0)},Tf.toString=function(){return""},Tf.unbind=function(){Ur(this,this.template)},Tf.unrender=function(t){t&&!this.element.rendered||!this.handle||(this.handle.teardown(),this.handle=null)},Tf.update=function(){var t=this.handle;if(this.dirty){if(this.dirty=!1,t)if(t.update){var e=this.models.map(function(t){return t&&t.get()});t.update.apply(this.ractive,this.fn.apply(this.ractive,e))}else this.unrender(),this.render()}else t&&t.invalidate&&gl.scheduleTask(function(){return t.invalidate()},!0)},Nf.prototype.firstNode=f;var Vf=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.toString=function(){return"<!DOCTYPE"+this.template.a+">"},e}(of),Mf=Vf.prototype;Mf.bind=Mf.render=Mf.teardown=Mf.unbind=Mf.unrender=Mf.update=f;var Pf=function(t,e){void 0===e&&(e="value"),this.element=t,this.ractive=t.ractive,this.attribute=t.attributeByName[e];var n=this.attribute.interpolator;n.twowayBinding=this;var i=n.model;if(i.isReadonly&&!i.setRoot){var r=i.getKeypath().replace(/^@/,"");return b("Cannot use two-way binding on <"+t.name+"> element: "+r+" is read-only. To suppress this warning use <"+t.name+" twoway='false'...>",{ractive:this.ractive}),!1}this.attribute.isTwoway=!0,this.model=i;var s=i.get();this.wasUndefined=c(s),c(s)&&this.getInitialValue&&(s=this.getInitialValue(),i.set(s)),this.lastVal(!0,s);var a=Fn(this.element,!1,"form");a&&(this.resetValue=s,a.formBindings.push(this))},If=Pf.prototype;If.bind=function(){this.model.registerTwowayBinding(this)},If.handleChange=function(){var t=this,e=this.getValue();this.lastVal()!==e&&(gl.start(),this.attribute.locked=!0,this.model.set(e),this.lastVal(!0,e),this.model.get()!==e?this.attribute.locked=!1:gl.scheduleTask(function(){return t.attribute.locked=!1}),gl.end())},If.lastVal=function(t,e){if(!t)return this.lastValue;this.lastValue=e},If.rebind=function(t,e){var n=this;this.model&&this.model===e&&e.unregisterTwowayBinding(this),t&&(this.model=t,gl.scheduleTask(function(){return t.registerTwowayBinding(n)}))},If.rebound=function(){this.model&&this.model.unregisterTwowayBinding(this),this.model=this.attribute.interpolator.model,this.model&&this.model.registerTwowayBinding(this)},If.render=function(){this.node=this.element.node,this.node._ractive.binding=this,this.rendered=!0},If.setFromNode=function(t){this.model.set(t.value)},If.unbind=function(){this.model&&this.model.unregisterTwowayBinding(this)},Pf.prototype.unrender=f;var Rf=function(t){function e(e){t.call(this,e,"checked")}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.render=function(){t.prototype.render.call(this),this.element.on("change",$r),this.node.attachEvent&&this.element.on("click",$r)},n.unrender=function(){this.element.off("change",$r),this.node.attachEvent&&this.element.off("click",$r)},n.getInitialValue=function(){return!!this.element.getAttribute("checked")},n.getValue=function(){return this.node.checked},n.setFromNode=function(t){this.model.set(t.checked)},e}(Pf),Bf=function(t,e,n){var i=this;this.model=e,this.hash=t,this.getValue=function(){return i.value=n.call(i),i.value},this.bindings=[]},Kf=Bf.prototype;Kf.add=function(t){this.bindings.push(t)},Kf.bind=function(){this.value=this.model.get(),this.model.registerTwowayBinding(this),this.bound=!0},Kf.remove=function(t){V(this.bindings,t),this.bindings.length||this.unbind()},Kf.unbind=function(){this.model.unregisterTwowayBinding(this),this.bound=!1,delete this.model[this.hash]},Bf.prototype.rebind=Pf.prototype.rebind;var Lf=[].push,Df=function(t){function e(e){if(t.call(this,e,"name"),this.checkboxName=!0,this.group=qr("checkboxes",this.model,Hr),this.group.add(this),this.noInitialValue&&(this.group.noInitialValue=!0),this.group.noInitialValue&&this.element.getAttribute("checked")){var n=this.model.get(),i=this.element.getAttribute("value");this.arrayContains(n,i)||Lf.call(n,i)}}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.group.bound||this.group.bind()},n.getInitialValue=function(){return this.noInitialValue=!0,[]},n.getValue=function(){return this.group.value},n.handleChange=function(){this.isChecked=this.element.node.checked,this.group.value=this.model.get().slice();var e=this.element.getAttribute("value");this.isChecked&&!this.arrayContains(this.group.value,e)?this.group.value.push(e):!this.isChecked&&this.arrayContains(this.group.value,e)&&this.removeFromArray(this.group.value,e),this.lastValue=null,t.prototype.handleChange.call(this)},n.render=function(){t.prototype.render.call(this);var e=this.node,n=this.model.get(),i=this.element.getAttribute("value");Da(n)?this.isChecked=this.arrayContains(n,i):this.isChecked=this.element.compare(n,i),e.name="{{"+this.model.getKeypath()+"}}",e.checked=this.isChecked,this.element.on("change",$r),this.node.attachEvent&&this.element.on("click",$r)},n.setFromNode=function(t){if(this.group.bindings.forEach(function(t){return t.wasUndefined=!0}),t.checked){var e=this.group.getValue();e.push(this.element.getAttribute("value")),this.group.model.set(e)}},n.unbind=function(){this.group.remove(this)},n.unrender=function(){var t=this.element;t.off("change",$r),this.node.attachEvent&&t.off("click",$r)},n.arrayContains=function(t,e){for(var n=this,i=t.length;i--;)if(n.element.compare(e,t[i]))return!0;return!1},n.removeFromArray=function(t,e){var n=this;if(t)for(var i=t.length;i--;)n.element.compare(e,t[i])&&t.splice(i,1)},e}(Pf),Ff=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getInitialValue=function(){return this.element.fragment?this.element.fragment.toString():""},n.getValue=function(){return this.element.node.innerHTML},n.render=function(){t.prototype.render.call(this);var e=this.element;e.on("change",$r),e.on("blur",$r),this.ractive.lazy||(e.on("input",$r),this.node.attachEvent&&e.on("keyup",$r))},n.setFromNode=function(t){this.model.set(t.innerHTML)},n.unrender=function(){var t=this.element;t.off("blur",$r),t.off("change",$r),t.off("input",$r),t.off("keyup",$r)},e}(Pf),zf=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getInitialValue=function(){return""},n.getValue=function(){return this.node.value},n.render=function(){t.prototype.render.call(this);var e=this.ractive.lazy,n=!1,i=this.element;"lazy"in this.element&&(e=this.element.lazy),r(e)&&(n=+e,e=!1),this.handler=n?Wr(n):$r;var s=this.node;i.on("change",$r),"file"!==s.type&&(e||(i.on("input",this.handler),s.attachEvent&&i.on("keyup",this.handler)),i.on("blur",Zr))},n.unrender=function(){var t=this.element;this.rendered=!1,t.off("change",$r),t.off("input",this.handler),t.off("keyup",this.handler),t.off("blur",Zr)},e}(Pf),Uf=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getInitialValue=function(){},n.getValue=function(){return this.node.files},n.render=function(){this.element.lazy=!1,t.prototype.render.call(this)},n.setFromNode=function(t){this.model.set(t.files)},e}(zf),$f=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getInitialValue=function(){return this.element.options.filter(function(t){return t.getAttribute("selected")}).map(function(t){return t.getAttribute("value")})},n.getValue=function(){for(var t=this.element.node.options,e=t.length,n=[],i=0;i<e;i+=1){var r=t[i];if(r.selected){var s=r._ractive?r._ractive.value:r.value;n.push(s)}}return n},n.handleChange=function(){var e=this.attribute.getValue(),n=this.getValue();return!c(e)&&j(n,e)||t.prototype.handleChange.call(this),this},n.render=function(){t.prototype.render.call(this),this.element.on("change",$r),c(this.model.get())&&this.handleChange()},n.setFromNode=function(t){for(var e=Gr(t),n=e.length,i=new Array(n);n--;){var r=e[n];i[n]=r._ractive?r._ractive.value:r.value}this.model.set(i)},n.unrender=function(){this.element.off("change",$r)},e}(Pf),qf=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getInitialValue=function(){},n.getValue=function(){var t=parseFloat(this.node.value);return isNaN(t)?void 0:t},n.setFromNode=function(t){var e=parseFloat(t.value);isNaN(e)||this.model.set(e)},e}(zf),Hf={},Zf=function(t){function e(e){t.call(this,e,"checked"),this.siblings=Qr(this.ractive._guid+this.element.getAttribute("name")),this.siblings.push(this)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getValue=function(){return this.node.checked},n.handleChange=function(){gl.start(),this.siblings.forEach(function(t){t.model.set(t.getValue())}),gl.end()},n.render=function(){t.prototype.render.call(this),this.element.on("change",$r),this.node.attachEvent&&this.element.on("click",$r)},n.setFromNode=function(t){this.model.set(t.checked)},n.unbind=function(){V(this.siblings,this)},n.unrender=function(){this.element.off("change",$r),this.node.attachEvent&&this.element.off("click",$r)},e}(Pf),Wf=function(t){function e(e){var n=this;t.call(this,e,"name"),this.group=qr("radioname",this.model,Yr),this.group.add(this),e.checked&&(this.group.value=this.getValue()),this.attribute.interpolator.pathChanged=function(){return n.updateName()}}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){this.group.bound||this.group.bind()},n.getInitialValue=function(){if(this.element.getAttribute("checked"))return this.element.getAttribute("value")},n.getValue=function(){return this.element.getAttribute("value")},n.handleChange=function(){this.node.checked&&(this.group.value=this.getValue(),t.prototype.handleChange.call(this)),this.updateName()},n.lastVal=function(t,e){if(this.group)return t?void(this.group.lastValue=e):this.group.lastValue},n.rebind=function(e,n){t.prototype.rebind.call(this,e,n),this.updateName()},n.rebound=function(e){t.prototype.rebound.call(this,e),this.updateName()},n.render=function(){t.prototype.render.call(this);var e=this.node;this.updateName(),e.checked=this.element.compare(this.model.get(),this.element.getAttribute("value")),this.element.on("change",$r),e.attachEvent&&this.element.on("click",$r)},n.setFromNode=function(t){t.checked&&this.group.model.set(this.element.getAttribute("value"))},n.unbind=function(){this.group.remove(this)},n.unrender=function(){var t=this.element;t.off("change",$r),this.node.attachEvent&&t.off("click",$r)},n.updateName=function(){this.node&&(this.node.name="{{"+this.model.getKeypath()+"}}")},e}(Pf),Gf=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.forceUpdate=function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,gl.scheduleTask(function(){return t.attribute.locked=!1}),this.model.set(e))},n.getInitialValue=function(){if(void 0===this.element.getAttribute("value")){var t=this.element.options,e=t.length;if(e){for(var n,i,r=e;r--;){var s=t[r];if(s.getAttribute("selected")){s.getAttribute("disabled")||(n=s.getAttribute("value")),i=!0;break}}if(!i)for(;++r<e;)if(!t[r].getAttribute("disabled")){n=t[r].getAttribute("value");break}return void 0!==n&&(this.element.attributeByName.value.value=n),n}}},n.getValue=function(){var t,e=this.node.options,n=e.length;for(t=0;t<n;t+=1){var i=e[t];if(e[t].selected&&!e[t].disabled)return i._ractive?i._ractive.value:i.value}},n.render=function(){t.prototype.render.call(this),this.element.on("change",$r)},n.setFromNode=function(t){var e=Gr(t)[0];this.model.set(e._ractive?e._ractive.value:e.value)},n.unrender=function(){this.element.off("change",$r)},e}(Pf),Qf=/;\s*$/,Yf=function(t){function e(e){var n=this;if(t.call(this,e),this.name=e.template.e.toLowerCase(),this.parent=Fn(this.up,!1),this.parent&&"option"===this.parent.name)throw new Error("An <option> element cannot contain other elements (encountered <"+this.name+">)");this.decorators=[],this.attributeByName={};for(var i,r,s,a,o,u,l,c,f=this.template.m,d=f&&f.length||0,p=0;p<d;p++)if((l=f[p]).g)(n.statics||(n.statics={}))[l.n]=h(l.f)?l.f:l.n;else switch(l.t){case Ho:case Ou:case Su:case Au:case Cu:s=Ws({owner:n,up:n.up,template:l}),r=l.n,i=i||(i=n.attributes=[]),"value"===r?a=s:"name"===r?u=s:"class"===r?o=s:i.push(s);break;case ju:n.delegate=!1;break;default:(c||(c=[])).push(l)}a&&i.push(a),u&&i.push(u),o&&i.unshift(o),c&&((i||(this.attributes=[])).push(new mf({owner:this,up:this.up,template:c})),c=[]),e.template.f&&!e.deferContent&&(this.fragment=new Sp({template:e.template.f,owner:this,cssIds:null})),this.binding=null}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){var t=this.attributes;if(t){t.binding=!0;for(var e=t.length,n=0;n<e;n++)t[n].bind();t.binding=!1}this.fragment&&this.fragment.bind(),this.binding?this.binding.bind():this.recreateTwowayBinding()},n.createTwowayBinding=function(){if("twoway"in this?this.twoway:this.ractive.twoway){var t=Xr(this);if(t){var e=new t(this);if(e&&e.model)return e}}},n.destroyed=function(){this.attributes&&this.attributes.forEach(G),this.fragment&&this.fragment.destroyed()},n.detach=function(){return this.rendered||this.destroyed(),ni(this.node)},n.find=function(t,e){return this.node&&ic(this.node,t)?this.node:this.fragment?this.fragment.find(t,e):void 0},n.findAll=function(t,e){var n=e.result;ic(this.node,t)&&n.push(this.node),this.fragment&&this.fragment.findAll(t,e)},n.findNextNode=function(){return null},n.firstNode=function(){return this.node},n.getAttribute=function(t){if(this.statics&&t in this.statics)return this.statics[t];var e=this.attributeByName[t];return e?e.getValue():void 0},n.getContext=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.fragment?(n=this.fragment).getContext.apply(n,t):(this.ctx||(this.ctx=new Xl(this.up,this)),t.unshift(Ia(this.ctx)),Pa.apply(null,t));var n},n.off=function(t,e,n){void 0===n&&(n=!1);var i=this.up.delegate,r=this.listeners&&this.listeners[t];if(r)if(V(r,e),i){var s=(i.listeners||(i.listeners=[]))&&(i.listeners[t]||(i.listeners[t]=[]));s.refs&&!--s.refs&&i.off(t,is,!0)}else if(this.rendered){var a=this.node,o=a.addEventListener,u=a.removeEventListener;r.length?r.length&&!r.refs&&n&&(u.call(a,t,ss,!0),o.call(a,t,ss,!1)):u.call(a,t,ss,n)}},n.on=function(t,e,n){void 0===n&&(n=!1);var i=this.up.delegate,r=(this.listeners||(this.listeners={}))[t]||(this.listeners[t]=[]);if(i){var s=(i.listeners||(i.listeners=[]))&&i.listeners[t]||(i.listeners[t]=[]);s.refs?s.refs++:(s.refs=0,i.on(t,is,!0),s.refs++)}else if(this.rendered){var a=this.node,o=a.addEventListener,u=a.removeEventListener;r.length?r.length&&!r.refs&&n&&(u.call(a,t,ss,!1),o.call(a,t,ss,!0)):o.call(a,t,ss,n)}C(this.listeners[t],e)},n.recreateTwowayBinding=function(){this.binding&&(this.binding.unbind(),this.binding.unrender()),(this.binding=this.createTwowayBinding())&&(this.binding.bind(),this.rendered&&this.binding.render())},n.rebound=function(e){t.prototype.rebound.call(this,e),this.attributes&&this.attributes.forEach(function(t){return t.rebound(e)}),this.binding&&this.binding.rebound(e)},n.render=function(t,e){var n=this;this.namespace=ns(this);var i,r=!1;if(e)for(var s;s=e.shift();){if(s.nodeName.toUpperCase()===n.template.e.toUpperCase()&&s.namespaceURI===n.namespace){n.node=i=s,r=!0;break}ni(s)}if(!r&&this.node&&(i=this.node,t.appendChild(i),r=!0),!i){var a=this.template.e;i=nc(this.namespace===fc?a.toLowerCase():a,this.namespace,this.getAttribute("is")),this.node=i}Ra(i,"_ractive",{value:{proxy:this},configurable:!0}),this.statics&&Ka(this.statics).forEach(function(t){i.setAttribute(t,n.statics[t])}),r&&this.foundNode&&this.foundNode(i);var o=this.intro;if(o&&o.shouldFire("intro")&&(o.isIntro=!0,o.isOutro=!1,gl.registerTransition(o)),this.fragment){var u=r?P(i.childNodes):void 0;this.fragment.render(i,u),u&&u.forEach(ni)}if(r){this.binding&&this.binding.wasUndefined&&this.binding.setFromNode(i);for(var h=i.attributes.length;h--;){var l=i.attributes[h].name;l in n.attributeByName||n.statics&&l in n.statics||i.removeAttribute(l)}}if(this.up.cssIds&&i.setAttribute("data-ractive-css",this.up.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),this.attributes)for(var c=this.attributes.length,f=0;f<c;f++)n.attributes[f].render();if(this.binding&&this.binding.render(),!this.up.delegate&&this.listeners){var d=this.listeners;for(var p in d)d[p]&&d[p].length&&n.node.addEventListener(p,ss,!!d[p].refs)}r||t.appendChild(i),this.rendered=!0},n.toString=function(){var t=this,e=this.template.e,n=this.attributes&&this.attributes.map(es).join("")||"";this.statics&&Ka(this.statics).forEach(function(e){return"class"!==e&&"style"!==e&&(n=" "+e+'="'+t.statics[e]+'"'+n)}),"option"===this.name&&this.isSelected()&&(n+=" selected"),"input"===this.name&&ts(this)&&(n+=" checked");var i=this.statics?this.statics.style:void 0,r=this.statics?this.statics.class:void 0;this.attributes&&this.attributes.forEach(function(t){"class"===t.name?r=(r||"")+(r?" ":"")+ri(t.getString()):"style"===t.name?(i=(i||"")+(i?" ":"")+ri(t.getString()))&&!Qf.test(i)&&(i+=";"):t.style?i=(i||"")+(i?" ":"")+t.style+": "+ri(t.getString())+";":t.inlineClass&&t.getValue()&&(r=(r||"")+(r?" ":"")+t.inlineClass)}),void 0!==i&&(n=" style"+(i?'="'+i+'"':"")+n),void 0!==r&&(n=" class"+(r?'="'+r+'"':"")+n),this.up.cssIds&&(n+=' data-ractive-css="'+this.up.cssIds.map(function(t){return"{"+t+"}"}).join(" ")+'"');var s="<"+e+n+">";return Ru[this.name.toLowerCase()]?s:("textarea"===this.name&&void 0!==this.getAttribute("value")?s+=bt(this.getAttribute("value")):void 0!==this.getAttribute("contenteditable")&&(s+=this.getAttribute("value")||""),this.fragment&&(s+=this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e))),s+="</"+e+">")},n.unbind=function(t){var e=this.attributes;if(e){e.unbinding=!0;for(var n=e.length,i=0;i<n;i++)e[i].unbind(t);e.unbinding=!1}this.binding&&this.binding.unbind(t),this.fragment&&this.fragment.unbind(t)},n.unrender=function(t){if(this.rendered){this.rendered=!1;var e=this.intro;e&&e.complete&&e.complete(),"option"===this.name?this.detach():t&&gl.detachWhenReady(this);var n=this.outro;n&&n.shouldFire("outro")&&(n.isIntro=!1,n.isOutro=!0,gl.registerTransition(n)),this.fragment&&this.fragment.unrender(),this.binding&&this.binding.unrender()}},n.update=function(){if(this.dirty){this.dirty=!1;var t=this.attributes;if(t)for(var e=t.length,n=0;n<e;n++)t[n].update();this.fragment&&this.fragment.update()}},e}(hf),Jf=null!==za?za.UIEvent:null,Xf=function(t){function e(e){t.call(this,e),this.formBindings=[]}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.render=function(e,n){t.prototype.render.call(this,e,n),this.on("reset",as)},n.unrender=function(e){this.off("reset",as),t.prototype.unrender.call(this,e)},e}(Yf),td=function(t,e){-1!==t.indexOf("*")&&p('Only component proxy-events may contain "*" wildcards, <'+e.name+" on-"+t+'="..."/> is not valid'),this.name=t,this.owner=e,this.handler=null},ed=td.prototype;ed.bind=function(){},ed.render=function(t){var e=this,n=this.name,i=function(){var i=e.owner.node;e.owner.on(n,e.handler=function(e){return t.fire({node:i,original:e,event:e,name:n})})};"load"!==n?gl.scheduleTask(i,!0):i()},ed.unbind=function(){},ed.unrender=function(){this.handler&&this.owner.off(this.name,this.handler)};var nd=function(t,e,n,i){this.eventPlugin=t,this.owner=e,this.name=n,this.handler=null,this.args=i},id=nd.prototype;id.bind=function(){},id.render=function(t){var e=this;gl.scheduleTask(function(){var n=e.owner.node;e.handler=e.eventPlugin.apply(e.owner.ractive,[n,function(i){return void 0===i&&(i={}),i.original?i.event=i.original:i.original=i.event,i.name=e.name,i.node=i.node||n,t.fire(i)}].concat(e.args||[]))})},id.unbind=function(){},id.unrender=function(){this.handler.teardown()};var rd=function(t,e){this.component=t,this.name=e,this.handler=null},sd=rd.prototype;sd.bind=function(t){var e=this.component.instance;this.handler=e.on(this.name,function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n[0]instanceof Xl){var r=n.shift();r.component=e,t.fire(r,n)}else t.fire({},n);return!1})},sd.render=function(){},sd.unbind=function(){this.handler.cancel()},sd.unrender=function(){};var ad=/^(event|arguments|@node|@event|@context)(\..+)?$/,od=/^\$(\d+)(\..+)?$/,ud=function(t){this.owner=t.owner||t.up.owner||Fn(t.up),this.element=this.owner.attributeByName?this.owner:Fn(t.up,!0),this.template=t.template,this.up=t.up,this.ractive=t.up.ractive,this.events=[]},hd=ud.prototype;hd.bind=function(){var t=this;if(this.events.length&&(this.events.forEach(function(t){return t.unrender()}),this.events=[]),this.element.type===Wo||this.element.type===qo)this.template.n.forEach(function(e){t.events.push(new rd(t.element,e))});else{var e;if(e=this.template.a){var n=e.r.map(function(e){var n=Qe(t.up,e);return n?n.get():void 0});try{e=ft(e.s,n.length).apply(null,n)}catch(t){e=null,y("Failed to compute args for event on-"+this.template.n.join("- ")+": "+(t.message||t))}}this.template.n.forEach(function(n){var i=w("events",t.ractive,n);i?t.events.push(new nd(i,t.element,n,e)):t.events.push(new td(n,t.element))})}this.models=null,C(this.element.events||(this.element.events=[]),this),Fr(this,this.template),this.fn||(this.action=this.template.f),this.events.forEach(function(e){return e.bind(t)})},hd.destroyed=function(){this.events.forEach(function(t){return t.unrender()})},hd.fire=function(t,e){var n=this;void 0===e&&(e=[]);var i=t instanceof Xl&&t.refire?t:this.element.getContext(t);if(this.fn){var r=[],s=zr(this,this.template,this.up,{specialRef:function(t){var e=ad.exec(t);if(e)return{special:e[1],keys:e[2]?A(e[2].substr(1)):[]};var n=od.exec(t);return n?{special:"arguments",keys:[n[1]-1].concat(n[2]?A(n[2].substr(1)):[])}:void 0}});s&&s.forEach(function(s){if(!s)return r.push(void 0);if(s.special){var a,o=s.special;"@node"===o?a=n.element.node:"@event"===o?a=t&&t.event:"event"===o?(b("The event reference available to event directives is deprecated and should be replaced with @context and @event"),a=i):a="@context"===o?i:e;for(var u=s.keys.slice();a&&u.length;)a=a[u.shift()];return r.push(a)}if(s.wrapper)return r.push(s.wrapperValue);r.push(s.get())});var a=this.ractive,o=a.event;a.event=i;var u=this.fn.apply(a,r),l=u.pop();if(!1===l){var c=t?t.original:void 0;c?(c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation()):b("handler '"+this.template.n.join(" ")+"' returned false, but there is no event available to cancel")}else!u.length&&Da(l)&&h(l[0])&&(l=bn(this.ractive,l.shift(),i,l));return a.event=o,l}return bn(this.ractive,this.action,i,e)},hd.handleChange=function(){},hd.render=function(){var t=this;this.events.forEach(function(e){return e.render(t)})},hd.toString=function(){return""},hd.unbind=function(t){V(this.element.events,this),this.events.forEach(function(e){return e.unbind(t)})},hd.unrender=function(){this.events.forEach(function(t){return t.unrender()})};var ld=ud.prototype;ld.firstNode=ld.rebound=ld.update=f;var cd=function(e){function n(t,n){e.call(this,t,n),this.isReadonly=!this.root.ractive.syncComputedChildren,this.dirty=!0,this.isComputed=!0}e&&(n.__proto__=e);var i=n.prototype=Object.create(e&&e.prototype);i.constructor=n;var r={setRoot:{}};return r.setRoot.get=function(){return this.parent.setRoot},i.applyValue=function(t){if(e.prototype.applyValue.call(this,t),!this.isReadonly){for(var n=this.parent;n&&n.shuffle;)n=n.parent;n&&n.dependencies.forEach(Y)}this.setRoot&&this.setRoot.set(this.setRoot.value)},i.get=function(t,e){if(t&&H(this),this.dirty){this.dirty=!1;var n=this.parent.get();this.value=n?n[this.key]:void 0,this.wrapper&&(this.newWrapperValue=this.value),this.adapt()}return(e&&"unwrap"in e?!1!==e.unwrap:t)&&this.wrapper?this.wrapperValue:this.value},i.handleChange=function(){this.dirty||(this.dirty=!0,this.boundValue&&(this.boundValue=null),this.links.forEach(X),this.deps.forEach(Q),this.children.forEach(Q))},i.joinKey=function(e){if(c(e)||""===e)return this;if(!t(this.childByKey,e)){var i=new n(this,e);this.children.push(i),this.childByKey[e]=i}return this.childByKey[e]},Object.defineProperties(i,r),n}(El),fd=function(t){function e(e,n,i){t.call(this,e,i),this.signature=n,this.isReadonly=!this.signature.setter,this.isComputed=!0,this.dependencies=[],this.children=[],this.childByKey={},this.deps=[],this.dirty=!0,this.shuffle=void 0}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);n.constructor=e;var r={setRoot:{}};return r.setRoot.get=function(){if(this.signature.setter)return this},n.get=function(t,e){if(t&&H(this),this.dirty){this.dirty=!1;var n=this.value;this.value=this.getValue(),gl.active()?i(n,this.value)||this.notifyUpstream():(gl.start(),i(n,this.value)||this.notifyUpstream(),gl.end()),this.wrapper&&(this.newWrapperValue=this.value),this.adapt()}return K(this,this.wrapper&&(e&&"unwrap"in e?!1!==e.unwrap:t)?this.wrapperValue:this.value,!e||!1!==e.shouldBind)},n.getContext=function(){return this.parent.isRoot?this.root.ractive:this.parent.get(!1,ko)},n.getValue=function(){$();var t;try{t=this.signature.getter.call(this.root.ractive,this.getContext())}catch(t){if(y("Failed to compute "+this.getKeypath()+": "+(t.message||t)),Ha){console.groupCollapsed&&console.groupCollapsed("%cshow details","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;");var e=this.signature;console.error(t.name+": "+t.message+"\n\n"+e.getterString+(e.getterUseStack?"\n\n"+t.stack:"")),console.groupCollapsed&&console.groupEnd()}}var n=q();return this.setDependencies(n),t},n.mark=function(){this.handleChange()},n.rebind=function(t,e){t!==e&&this.handleChange()},n.set=function(t){if(this.isReadonly)throw new Error("Cannot set read-only computed value '"+this.key+"'");this.signature.setter(t),this.mark()},n.setDependencies=function(t){for(var e=this,n=this.dependencies.length;n--;){var i=e.dependencies[n];~t.indexOf(i)||i.unregister(e)}for(n=t.length;n--;){var r=t[n];~e.dependencies.indexOf(r)||r.register(e)}this.dependencies=t},n.teardown=function(){for(var e=this,n=this.dependencies.length;n--;)e.dependencies[n]&&e.dependencies[n].unregister(e);this.parent.computed[this.key]===this&&delete this.parent.computed[this.key],t.prototype.teardown.call(this)},Object.defineProperties(n,r),e}(El),dd=fd.prototype,pd=cd.prototype;dd.handleChange=pd.handleChange,dd.joinKey=pd.joinKey,_l.Computation=fd;var md=function(t){function e(e,n){var i=this;t.call(this,e.ractive.viewmodel,null),this.fragment=e,this.template=n,this.isReadonly=!0,this.isComputed=!0,this.dirty=!0,this.fn=!1===e.ractive.allowExpressions?f:ft(n.s,n.r.length),this.models=this.template.r.map(function(t){return Qe(i.fragment,t)}),this.dependencies=[],this.shuffle=void 0,this.bubble()}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bubble=function(t){void 0===t&&(t=!0),this.keypath=void 0,t&&this.handleChange()},n.getKeypath=function(){var t=this;return this.template?(this.keypath||(this.keypath="@"+this.template.s.replace(/_(\d+)/g,function(e,n){if(n>=t.models.length)return e;var i=t.models[n];return i?i.getKeypath():"@undefined"})),this.keypath):"@undefined"},n.getValue=function(){var t=this;$();var e;try{var n=this.models.map(function(t){return t?t.get(!0):void 0});e=this.fn.apply(this.fragment.ractive,n)}catch(t){y("Failed to compute "+this.getKeypath()+": "+(t.message||t))}var i=q();return this.dependencies.filter(function(t){return!~i.indexOf(t)}).forEach(function(e){e.unregister(t),V(t.dependencies,e)}),i.filter(function(e){return!~t.dependencies.indexOf(e)}).forEach(function(e){e.register(t),t.dependencies.push(e)}),e},n.notifyUpstream=function(){},n.rebind=function(t,e,n){var i=this.models.indexOf(e);~i&&(t=ht(this.template.r[i],t,e))!==e&&(e.unregister(this),this.models.splice(i,1,t),t&&t.addShuffleRegister(this,"mark")),this.bubble(!n)},n.rebound=function(t){var e=this;this.models=this.template.r.map(function(t){return Qe(e.fragment,t)}),t&&this.bubble(!0)},n.retrieve=function(){return this.get()},n.teardown=function(){var e=this;this.fragment=void 0,this.dependencies&&this.dependencies.forEach(function(t){return t.unregister(e)}),t.prototype.teardown.call(this)},n.unreference=function(){t.prototype.unreference.call(this),hs(this)},n.unregister=function(e){t.prototype.unregister.call(this,e),hs(this)},n.unregisterLink=function(e){t.prototype.unregisterLink.call(this,e),hs(this)},e}(El),vd=md.prototype,gd=fd.prototype;vd.get=gd.get,vd.handleChange=gd.handleChange,vd.joinKey=gd.joinKey,vd.mark=gd.mark,vd.unbind=f;var yd=function(t){function e(e,n){t.call(this,null,null,null,"@undefined"),this.root=e.ractive.viewmodel,this.template=n,this.rootLink=!0,this.template=n,this.fragment=e,this.rebound()}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.getKeypath=function(){return this.model?this.model.getKeypath():"@undefined"},n.rebound=function(){var t,e=this,n=this.fragment,i=this.template,r=this.base=fs(n,i);this.proxy&&ls(this);var s=this.proxy={rebind:function(n,o){o===r?(n=ht(i,n,o))!==r&&(e.base=r=n):~(t=a.indexOf(o))&&(n=ht(i.m[t].n,n,o))!==a[t]&&a.splice(t,1,n||Co),n!==o&&(o.unregister(s),n&&n.addShuffleTask(function(){return n.register(s)}))},handleChange:function(){o()}};r.register(s);var a=this.members=i.m.map(function(t){if(h(t))return{get:function(){return t}};var e;return t.t===uu?((e=Qe(n,t.n)).register(s),e):((e=new md(n,t)).register(s),e)}),o=function(){var t=r.joinAll(a.reduce(function(t,e){var n=e.get();return Da(n)?t.concat(n):(t.push(_(String(n))),t)},[]));t!==e.model&&(e.model=t,e.relinking(t),F(),cs(e))};o()},n.teardown=function(){ls(this),t.prototype.teardown.call(this)},n.unreference=function(){t.prototype.unreference.call(this),this.deps.length||this.refs||this.teardown()},n.unregister=function(e){t.prototype.unregister.call(this,e),this.deps.length||this.refs||this.teardown()},e}(Oo),bd=md.prototype,wd=yd.prototype;wd.unreference=bd.unreference,wd.unregister=bd.unregister,wd.unregisterLink=bd.unregisterLink;var xd=function(t){function e(e){t.call(this,e),e.owner&&(this.parent=e.owner),this.isStatic=!!e.template.s,this.model=null,this.dirty=!1}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(t){var e=this.template.y?this.template.y.containerFragment:this.containerFragment||this.up,n=t||fs(e,this.template);if(n){var i=n.get();if(this.isStatic)return this.model={get:function(){return i}},void n.unreference();n.register(this),this.model=n}},n.handleChange=function(){this.bubble()},n.rebind=function(t,e,n){if(!this.isStatic)return(t=ht(this.template,t,e,this.up))!==this.model&&(this.model&&this.model.unregister(this),t&&t.addShuffleRegister(this,"mark"),this.model=t,n||this.handleChange(),!0)},n.rebound=function(t){if(this.model){if(this.model.rebound)this.model.rebound(t);else{var e=fs(this.template.y?this.template.y.containerFragment:this.containerFragment||this.up,this.template);e!==this.model&&(this.model.unregister(this),this.bind(e))}t&&this.bubble()}this.fragment&&this.fragment.rebound(t)},n.unbind=function(){this.isStatic||(this.model&&this.model.unregister(this),this.model=void 0)},e}(of),kd=ds.prototype=Object.create(hf.prototype);Pa(kd,xd.prototype,{constructor:ds});var _d=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bubble=function(){this.owner&&this.owner.bubble(),t.prototype.bubble.call(this)},n.detach=function(){return ni(this.node)},n.firstNode=function(){return this.node},n.getString=function(){return this.model?ii(this.model.get()):""},n.render=function(t,e){if(!br()){var n=this.value=this.getString();this.rendered=!0,us(this,t,e,n)}},n.toString=function(t){var e=this.getString();return t?bt(e):e},n.unrender=function(t){t&&this.detach(),this.rendered=!1},n.update=function(){if(this.dirty&&(this.dirty=!1,this.rendered)){var t=this.getString();t!==this.value&&(this.node.data=this.value=t)}},n.valueOf=function(){return this.model?this.model.get():void 0},e}(xd),Ed=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.render=function(e,n){t.prototype.render.call(this,e,n),this.node.defaultValue=this.node.value},n.compare=function(t,e){var n=this.getAttribute("value-comparator");if(n){if(u(n))return n(t,e);if(t&&e)return t[n]==e[n]}return t==e},e}(Yf),Ad={true:!0,false:!1,null:null,undefined:void 0},Sd=new RegExp("^(?:"+Ka(Ad).join("|")+")"),Cd=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,Od=/\$\{([^\}]+)\}/g,jd=/^\$\{([^\}]+)\}/,Nd=/^\s*$/,Td=Mo.extend({init:function(t,e){this.values=e.values,this.sp()},postProcess:function(t){return 1===t.length&&Nd.test(this.leftover)?{value:t[0].v}:null},converters:[function(e){if(!e.values)return null;var n=e.matchPattern(jd);return n&&t(e.values,n)?{v:e.values[n]}:void 0},function(t){var e=t.matchPattern(Sd);if(e)return{v:Ad[e]}},function(t){var e=t.matchPattern(Cd);if(e)return{v:+e}},function(t){var e=Et(t),n=t.values;return e&&n?{v:e.v.replace(Od,function(t,e){return e in n?n[e]:e})}:e},function(t){if(!t.matchString("{"))return null;var e={};if(t.sp(),t.matchString("}"))return{v:e};for(var n;n=ps(t);){if(e[n.key]=n.value,t.sp(),t.matchString("}"))return{v:e};if(!t.matchString(","))return null}return null},function(t){if(!t.matchString("["))return null;var e=[];if(t.sp(),t.matchString("]"))return{v:e};for(var n;n=t.read();){if(e.push(n.v),t.sp(),t.matchString("]"))return{v:e};if(!t.matchString(","))return null;t.sp()}return null}]}),Vd=function(t){function e(e){t.call(this,e),this.name=e.template.n,this.owner=e.owner||e.up.owner||e.element||Fn(e.up),this.element=e.element||(this.owner.attributeByName?this.owner:Fn(e.up)),this.up=this.element.up,this.ractive=this.up.ractive,this.element.attributeByName[this.name]=this,this.value=e.template.f}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){var t=this.template.f,e=this.element.instance.viewmodel;if(0===t)e.joinKey(this.name).set(!0);else if(h(t)){var n=ms(t);e.joinKey(this.name).set(n?n.value:t)}else Da(t)&&vs(this)},n.rebound=function(t){this.boundFragment&&this.boundFragment.rebound(t),this.link&&(this.model=fs(this.up,this.template.f[0]),this.element.instance.viewmodel.joinAll(A(this.name)).link(this.model,this.name,{mapping:!0}))},n.render=function(){},n.unbind=function(t){this.model&&this.model.unregister(this),this.boundFragment&&this.boundFragment.unbind(t),this.element.bound&&this.link.target===this.model&&this.link.owner.unlink()},n.unrender=function(){},n.update=function(){this.dirty&&(this.dirty=!1,this.boundFragment&&this.boundFragment.update())},e}(of),Md=function(t){function e(e){var n=e.template;n.a||(n.a={}),!c(n.a.value)||"disabled"in n.a||(n.a.value=n.f||""),t.call(this,e),this.select=Fn(this.parent||this.up,!1,"select")}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){if(this.select){var e=this.attributeByName.selected;if(e&&void 0!==this.select.getAttribute("value")){var n=this.attributes.indexOf(e);this.attributes.splice(n,1),delete this.attributeByName.selected}t.prototype.bind.call(this),this.select.options.push(this)}else t.prototype.bind.call(this)},n.bubble=function(){var e=this.getAttribute("value");this.node&&this.node.value!==e&&(this.node._ractive.value=e),t.prototype.bubble.call(this)},n.getAttribute=function(t){var e=this.attributeByName[t];return e?e.getValue():"value"===t&&this.fragment?this.fragment.valueOf():void 0},n.isSelected=function(){var t=this,e=this.getAttribute("value");if(c(e)||!this.select)return!1;var n=this.select.getAttribute("value");if(this.select.compare(n,e))return!0;if(this.select.getAttribute("multiple")&&Da(n))for(var i=n.length;i--;)if(t.select.compare(n[i],e))return!0},n.render=function(e,n){t.prototype.render.call(this,e,n),this.attributeByName.value||(this.node._ractive.value=this.getAttribute("value"))},n.unbind=function(e){t.prototype.unbind.call(this,e),this.select&&V(this.select.options,this)},e}(Yf),Pd=ks.prototype=Ia(ds.prototype);Pa(Pd,{constructor:ks,bind:function(){var t=this.template;if(this.yielder){if(this.container=this.up.ractive,this.component=this.container.component,this.containerFragment=this.up,!this.component)return this.fragment=new Sp({owner:this,template:[]}),void this.fragment.bind();this.up=this.component.up,t.r||t.x||t.rx||(this.refName="content")}this.macro?this.fn=this.macro:(this.refName||(this.refName=t.r),this.refName&&As(this,this.refName),this.partial||this.fn||(ds.prototype.bind.call(this),this.model&&As(this,this.model.get()))),this.partial||this.fn||b("Could not find template for partial '"+this.name+"'"),_s(this,this.partial||[]),this.fn&&Os(this),this.fragment.bind()},bubble:function(){this.dirty||(this.dirty=!0,this.yielder?this.containerFragment.bubble():this.up.bubble())},findNextNode:function(){return(this.containerFragment||this.up).findNextNode(this)},handleChange:function(){this.dirtyTemplate=!0,this.externalChange=!0,this.bubble()},rebound:function(t){var e=this;this._attrs&&Ka(this._attrs).forEach(function(n){return e._attrs[n].rebound(t)}),ds.prototype.rebound.call(this,t)},refreshAttrs:function(){var t=this;Ka(this._attrs).forEach(function(e){t.handle.attributes[e]=!t._attrs[e].items.length||t._attrs[e].valueOf()})},resetTemplate:function(){var t=this;if(this.fn&&this.proxy){if(this.last=0,!this.externalChange)return this.partial=this.fnTemplate,!0;u(this.proxy.teardown)&&this.proxy.teardown(),this.fn=this.proxy=null}if(this.partial=null,this.refName&&(this.partial=gs(this.ractive,this.refName,this.up)),!this.partial&&this.model&&As(this,this.model.get()),!this.fn){if(this.last&&this.partial===this.last)return!1;this.partial&&(this.last=this.partial,Es(this))}return this.unbindAttrs(),this.fn?(Os(this),u(this.proxy.render)&&gl.scheduleTask(function(){return t.proxy.render()})):this.partial||b("Could not find template for partial '"+this.name+"'"),!0},render:function(t,e){this.fn&&this.fn._cssDef&&!this.fn._cssDef.applied&&wi(),this.fragment.render(t,e),this.proxy&&u(this.proxy.render)&&this.proxy.render()},unbind:function(t){this.fragment.unbind(t),this.unbindAttrs(t),ds.prototype.unbind.call(this,t)},unbindAttrs:function(t){var e=this;this._attrs&&Ka(this._attrs).forEach(function(n){e._attrs[n].unbind(t)})},unrender:function(t){this.proxy&&u(this.proxy.teardown)&&this.proxy.teardown(),this.fragment.unrender(t)},update:function(){var t=this,e=this.proxy;this.updating=1,this.dirtyAttrs&&(this.dirtyAttrs=!1,Ka(this._attrs).forEach(function(e){return t._attrs[e].update()}),this.refreshAttrs(),u(e.update)&&e.update(this.handle.attributes)),this.dirtyTemplate&&(this.dirtyTemplate=!1,this.resetTemplate()&&this.fragment.resetTemplate(this.partial||[])),this.dirty&&(this.dirty=!1,e&&u(e.invalidate)&&e.invalidate(),this.fragment.update()),this.externalChange=!1,this.updating=0}});var Id="extra-attributes",Rd=function(t,e,n){this.value=this.key=t,this.context=e,this.isReadonly=this.isKey=!0,this.deps=[],this.links=[],this.children=[],this.instance=n},Bd=Rd.prototype;Bd.applyValue=function(t){t!==this.value&&(this.value=this.key=t,this.deps.forEach(Q),this.links.forEach(Q),this.children.forEach(function(t){t.applyValue(t.context.getKeypath(t.instance))}))},Bd.destroyed=function(){this.upstream&&this.upstream.unregisterChild(this)},Bd.get=function(t){return t&&H(this),S(this.value)},Bd.getKeypath=function(){return S(this.value)},Bd.has=function(){return!1},Bd.rebind=function(t,e){for(var n=this,i=this.deps.length;i--;)n.deps[i].rebind(t,e,!1);for(i=this.links.length;i--;)n.links[i].relinking(t,!1)},Bd.register=function(t){this.deps.push(t)},Bd.registerChild=function(t){C(this.children,t),t.upstream=this},Bd.registerLink=function(t){C(this.links,t)},Bd.unregister=function(t){V(this.deps,t)},Bd.unregisterChild=function(t){V(this.children,t)},Bd.unregisterLink=function(t){V(this.links,t)},Rd.prototype.reference=f,Rd.prototype.unreference=f;var Kd=/^"(\\"|[^"])+"$/,Ld=function(t){this.parent=t.owner.up,this.up=this,this.owner=t.owner,this.ractive=this.parent.ractive,this.delegate=!1!==this.ractive.delegate&&(this.parent.delegate||Ns(this.parent)),this.delegate&&!1===this.delegate.delegate&&(this.delegate=!1),this.delegate&&(this.delegate.delegate=this.delegate),this.cssIds="cssIds"in t?t.cssIds:this.parent?this.parent.cssIds:null,this.context=null,this.rendered=!1,this.iterations=[],this.template=t.template,this.indexRef=t.indexRef,this.keyRef=t.keyRef,this.pendingNewIndices=null,this.previousIterations=null,this.isArray=!1},Dd=Ld.prototype;Dd.bind=function(t){var e=this;this.context=t,this.bound=!0;var n=t.get(),i=this.aliases=this.owner.template.z&&this.owner.template.z.slice(),r=i&&i.find(function(t){return"shuffle"===t.n});r&&r.x&&r.x.x&&("true"===r.x.x.s?this.shuffler=!0:Kd.test(r.x.x.s)&&(this.shuffler=A(r.x.x.s.slice(1,-1)))),this.shuffler&&(this.values=Vs(this,this.shuffler)),this.source&&this.source.model.unbind(this.source);var a=t.isComputed&&i&&i.find(function(t){return"source"===t.n});if(a&&a.x&&a.x.r){var o=fs(this,a.x);this.source={handleChange:function(){},rebind:function(t){this.model.unregister(this),this.model=t,t.register(this)}},this.source.model=o,o.register(this.source)}if(this.isArray=Da(n)){this.iterations=[];for(var u=this.length=n.length,h=0;h<u;h+=1)e.iterations[h]=e.createIteration(h,h)}else if(s(n)){if(this.isArray=!1,this.indexRef){var l=this.indexRef.split(",");this.keyRef=l[0],this.indexRef=l[1]}var c=Ka(n);this.length=c.length,this.iterations=c.map(function(t,n){return e.createIteration(t,n)})}return this},Dd.bubble=function(t){this.bubbled||(this.bubbled=[]),this.bubbled.push(t),this.rebounding||this.owner.bubble()},Dd.createIteration=function(t,e){var n=new Sp({owner:this,template:this.template});return n.isIteration=!0,n.delegate=this.delegate,this.aliases&&(n.aliases={}),Ts(this,n,t,e),n.bind(n.context)},Dd.destroyed=function(){for(var t=this,e=this.iterations.length,n=0;n<e;n++)t.iterations[n].destroyed();this.pathModel&&this.pathModel.destroyed(),this.rootModel&&this.rootModel.destroyed()},Dd.detach=function(){var t=ti();return this.iterations.forEach(function(e){return t.appendChild(e.detach())}),t},Dd.find=function(t,e){return I(this.iterations,function(n){return n.find(t,e)})},Dd.findAll=function(t,e){return this.iterations.forEach(function(n){return n.findAll(t,e)})},Dd.findAllComponents=function(t,e){return this.iterations.forEach(function(n){return n.findAllComponents(t,e)})},Dd.findComponent=function(t,e){return I(this.iterations,function(n){return n.findComponent(t,e)})},Dd.findContext=function(){return this.context},Dd.findNextNode=function(t){var e=this;if(t.index<this.iterations.length-1)for(var n=t.index+1;n<this.iterations.length;n++){var i=e.iterations[n].firstNode(!0);if(i)return i}return this.owner.findNextNode()},Dd.firstNode=function(t){return this.iterations[0]?this.iterations[0].firstNode(t):null},Dd.getLast=function(){return this.lastModel||(this.lastModel=new Rd(this.length-1))},Dd.rebind=function(t){var e=this;this.context=t,this.source||this.iterations.forEach(function(t){Ts(e,t,t.key,t.index)})},Dd.rebound=function(t){var e=this;this.context=this.owner.model,this.iterations.forEach(function(n,i){n.context=Ms(e,n,i),n.rebound(t)})},Dd.render=function(t,e){var n=this.iterations;if(n)for(var i=n.length,r=0;r<i;r++)n[r].render(t,e);this.rendered=!0},Dd.shuffle=function(t,e){var n=this;this.pendingNewIndices||(this.previousIterations=this.iterations.slice()),this.pendingNewIndices||(this.pendingNewIndices=[]),this.pendingNewIndices.push(t);var i=[];t.forEach(function(t,r){if(-1!==t){var s=n.iterations[r];i[t]=s,t!==r&&s&&(s.dirty=!0,e&&(s.shouldRebind=1))}}),this.iterations=i,e||this.bubble()},Dd.shuffled=function(){this.iterations.forEach(nt)},Dd.toString=function(t){return this.iterations?this.iterations.map(t?ut:ot).join(""):""},Dd.unbind=function(t){this.bound=!1,this.source&&this.source.model.unregister(this.source);for(var e=this.pendingNewIndices?this.previousIterations:this.iterations,n=e.length,i=0;i<n;i++)e[i].unbind(t);return this},Dd.unrender=function(t){for(var e=this,n=this.iterations.length,i=0;i<n;i++)e.iterations[i].unrender(t);if(this.pendingNewIndices&&this.previousIterations){n=this.previousIterations.length;for(var r=0;r<n;r++)e.previousIterations[r].unrender(t)}this.rendered=!1},Dd.update=function(){var t=this;if(this.pendingNewIndices)return this.bubbled.length=0,void this.updatePostShuffle();if(!this.updating){if(this.updating=!0,this.shuffler){var e=Vs(this,this.shuffler),n=R(this.values,e);n.same?this.iterations.forEach(at):(this.shuffle(n,!0),this.updatePostShuffle())}else{for(var i=this.iterations.length,r=0;r<i;r++){var a=t.iterations[r];a&&a.idxModel&&a.idxModel.applyValue(r)}var o,u,h,l=this.context.get(),c=this.isArray,f=!0;if(this.isArray=Da(l)){if(this.source){this.rebounding=1;var d=this.source.model.get();this.iterations.forEach(function(e,n){n<l.length&&e.lastValue!==l[n]&&~(h=d.indexOf(l[n]))&&(Ts(t,e,n,n),e.rebound(!0))}),this.rebounding=0}c&&(f=!1,this.iterations.length>l.length&&(o=this.iterations.splice(l.length)))}else if(s(l)&&!c)for(f=!1,o=[],u={},h=this.iterations.length;h--;){var p=t.iterations[h];p.key in l?u[p.key]=!0:(t.iterations.splice(h,1),o.push(p))}var m=Da(l)?l.length:s(l)?Ka(l).length:0;if(this.length=m,this.updateLast(),f&&(o=this.iterations,this.iterations=[]),o){i=o.length;for(var v=0;v<i;v++)o[v].unbind().unrender(!0)}if(!f&&this.isArray&&this.bubbled&&this.bubbled.length){var g=this.bubbled;this.bubbled=[],i=g.length;for(var y=0;y<i;y++)t.iterations[g[y]]&&t.iterations[g[y]].update()}else{i=this.iterations.length;for(var b=0;b<i;b++)t.iterations[b].update()}var w,x;if(m>this.iterations.length){if(w=this.rendered?ti():null,h=this.iterations.length,Da(l))for(;h<l.length;)x=t.createIteration(h,h),t.iterations.push(x),t.rendered&&x.render(w),h+=1;else if(s(l)){if(this.indexRef&&!this.keyRef){var k=this.indexRef.split(",");this.keyRef=k[0],this.indexRef=k[1]}Ka(l).forEach(function(e){u&&e in u||(x=t.createIteration(e,h),t.iterations.push(x),t.rendered&&x.render(w),h+=1)})}if(this.rendered){var _=this.parent.findParentNode(),E=this.parent.findNextNode(this.owner);_.insertBefore(w,E)}}}this.updating=!1}},Dd.updateLast=function(){this.lastModel&&this.lastModel.applyValue(this.length-1)},Dd.updatePostShuffle=function(){var t=this,e=this.pendingNewIndices[0],n=this.rendered?this.parent.findParentNode():null,i=n&&this.owner.findNextNode(),r=n?ti():null;this.pendingNewIndices.slice(1).forEach(function(t){e.forEach(function(n,i){e[i]=t[n]})});var s,a,u,h,l,f,d=this.length=this.context.get().length,p=this.previousIterations,m=this.iterations,v=this.context.get(),g={},y=new Array(e.length);for(e.forEach(function(t,e){return y[t]=e}),this.updateLast(),s=u=0;s<d;)c(y[s])?(h=m[s]=t.createIteration(s,s),n&&(l=(l=p[u])&&n&&l.firstNode()||i,h.render(r),n.insertBefore(r,l)),s++):(-1===(a=e[u])?(p[u]&&p[u].unbind().unrender(!0),p[u++]=0):a>s?(g[a]=p[u],p[u++]=null):(m[s]=h=m[s]||g[s]||t.createIteration(s,s),(g[s]||u!==s)&&(f=t.source&&h.lastValue!==v[s],Ts(t,h,s,s)),!n||!g[s]&&p[u]||(l=(l=p[u+1])&&n&&l.firstNode()||i,g[s]?n.insertBefore(h.detach(),l):(h.render(r),n.insertBefore(r,l))),p[u++]=0,s++),h&&o(h)&&((h.shouldRebind||f)&&(h.rebound(f),h.shouldRebind=0),h.update(),h.shuffled()));for(var b=p.length,w=0;w<b;w++)p[w]&&p[w].unbind().unrender(!0);this.shuffler&&(this.values=Vs(this,this.shuffler)),this.pendingNewIndices=null,this.previousIterations=null},Ld.prototype.getContext=nn,Ld.prototype.getKeypath=Ys;var Fd=function(t){function e(e){t.call(this,e),this.isAlias=e.template.t===Jo,this.sectionType=e.template.n||this.isAlias&&bu||null,this.templateSectionType=this.sectionType,this.subordinate=1===e.template.l,this.fragment=null}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bind=function(){t.prototype.bind.call(this),this.subordinate&&(this.sibling=this.up.items[this.up.items.indexOf(this)-1],this.sibling.nextSibling=this),this.model||this.isAlias?(this.dirty=!0,this.update()):!this.sectionType||this.sectionType!==gu||this.sibling&&this.sibling.isTruthy()||(this.fragment=new Sp({owner:this,template:this.template.f}).bind())},n.bubble=function(){!this.dirty&&this.yield?(this.dirty=!0,this.containerFragment.bubble()):t.prototype.bubble.call(this)},n.detach=function(){var e=this.fragment||this.detached;return e?e.detach():t.prototype.detach.call(this)},n.isTruthy=function(){if(this.subordinate&&this.sibling.isTruthy())return!0;var t=this.model?this.model.isRoot?this.model.value:this.model.get():void 0;return!(!t||this.templateSectionType!==wu&&Ps(t))},n.rebind=function(e,n,i){t.prototype.rebind.call(this,e,n,i)&&this.fragment&&this.sectionType!==vu&&this.sectionType!==gu&&this.fragment.rebind(e)},n.rebound=function(e){this.model&&(this.model.rebound?this.model.rebound(e):(t.prototype.unbind.call(this),t.prototype.bind.call(this),this.sectionType!==bu&&this.sectionType!==wu&&this.sectionType!==yu||this.fragment&&this.fragment.rebind(this.model),e&&this.bubble())),this.fragment&&this.fragment.rebound(e)},n.render=function(t,e){this.rendered=!0,this.fragment&&this.fragment.render(t,e)},n.shuffle=function(t){this.fragment&&this.sectionType===yu&&this.fragment.shuffle(t)},n.unbind=function(e){t.prototype.unbind.call(this,e),this.fragment&&this.fragment.unbind(e)},n.unrender=function(t){this.rendered&&this.fragment&&this.fragment.unrender(t),this.rendered=!1},n.update=function(){var t=this;if(this.dirty&&(this.fragment&&this.sectionType!==vu&&this.sectionType!==gu&&(this.fragment.context=this.model),this.model||this.sectionType===gu||this.isAlias)){this.dirty=!1;var e=this.model?this.model.isRoot?this.model.value:this.model.get():void 0,n=!this.subordinate||!this.sibling.isTruthy(),i=this.sectionType;this.yield&&this.yield!==e?(this.up=this.containerFragment,this.container=null,this.yield=null,this.rendered&&this.fragment.unbind().unrender(!0),this.fragment=null):this.rendered&&!this.yield&&e instanceof Xl&&(this.rendered&&this.fragment&&this.fragment.unbind().unrender(!0),this.fragment=null),null!==this.sectionType&&null!==this.templateSectionType||(this.sectionType=Is(e,this.template.i)),i&&i!==this.sectionType&&this.fragment&&(this.rendered&&this.fragment.unbind().unrender(!0),this.fragment=null);var r;if(this.sectionType===yu||this.sectionType===bu||n&&(this.sectionType===gu?!this.isTruthy():this.isTruthy())||this.isAlias)if(this.fragment||(this.fragment=this.detached),this.fragment)this.detached&&(Rs(this,this.fragment),this.detached=!1,this.rendered=!0),this.fragment.bound||this.fragment.bind(this.model),this.fragment.update();else if(this.sectionType===yu)r=new Ld({owner:this,template:this.template.f,indexRef:this.template.i}).bind(this.model);else{var s=this.sectionType!==vu&&this.sectionType!==gu?this.model:null;e instanceof Xl&&(this.yield=e,this.containerFragment=this.up,this.up=e.fragment,this.container=e.ractive,s=void 0),r=new Sp({owner:this,template:this.template.f}).bind(s)}else this.fragment&&this.rendered?!0!==Vl?this.fragment.unbind().unrender(!0):(this.unrender(!1),this.detached=this.fragment,gl.promise().then(function(){t.detached&&t.detach()})):this.fragment&&this.fragment.unbind(),this.fragment=null;r&&(this.rendered&&Rs(this,r),this.fragment=r),this.nextSibling&&(this.nextSibling.dirty=!0,this.nextSibling.update())}},e}(ds),zd=function(t){function e(e){t.call(this,e),this.options=[]}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.foundNode=function(t){if(this.binding){var e=Gr(t);e.length>0&&(this.selectedOptions=e)}},n.render=function(e,n){t.prototype.render.call(this,e,n),this.sync();for(var i=this.node,r=i.options.length;r--;)i.options[r].defaultSelected=i.options[r].selected;this.rendered=!0},n.sync=function(){var t=this,e=this.node;if(e){var n=P(e.options);if(this.selectedOptions)return n.forEach(function(e){t.selectedOptions.indexOf(e)>=0?e.selected=!0:e.selected=!1}),this.binding.setFromNode(e),void delete this.selectedOptions;var i=this.getAttribute("value"),r=this.getAttribute("multiple"),s=r&&Da(i);if(void 0!==i){var a;n.forEach(function(e){var n=e._ractive?e._ractive.value:e.value,o=r?s&&t.valueContains(i,n):t.compare(i,n);o&&(a=!0),e.selected=o}),a||r||this.binding&&this.binding.forceUpdate()}else this.binding&&this.binding.forceUpdate&&this.binding.forceUpdate()}},n.valueContains=function(t,e){for(var n=this,i=t.length;i--;)if(n.compare(e,t[i]))return!0},n.compare=function(t,e){var n=this.getAttribute("value-comparator");if(n){if(u(n))return n(e,t);if(e&&t)return e[n]==t[n]}return e==t},n.update=function(){var e=this.dirty;t.prototype.update.call(this),e&&this.sync()},e}(Yf),Ud=function(t){function e(e){var n=e.template;e.deferContent=!0,t.call(this,e),this.attributeByName.value||(n.f&&Jr({template:n})?(this.attributes||(this.attributes=[])).push(Ws({owner:this,template:{t:Ho,f:n.f,n:"value"},up:this.up})):this.fragment=new Sp({owner:this,cssIds:null,template:n.f}))}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.bubble=function(){var t=this;this.dirty||(this.dirty=!0,this.rendered&&!this.binding&&this.fragment&&gl.scheduleTask(function(){t.dirty=!1,t.node.value=t.fragment.toString()}),this.up.bubble())},e}(Ed),$d=function(t){function e(e){t.call(this,e),this.type=Io}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.detach=function(){return ni(this.node)},n.firstNode=function(){return this.node},n.render=function(t,e){br()||(this.rendered=!0,us(this,t,e,this.template))},n.toString=function(t){return t?bt(this.template):this.template},n.unrender=function(t){this.rendered&&t&&this.detach(),this.rendered=!1},n.valueOf=function(){return this.template},e}(of),qd=$d.prototype;qd.bind=qd.unbind=qd.update=f;var Hd,Zd="hidden";if(Ua){var Wd;if(Zd in Ua)Wd="";else for(var Gd=Wa.length;Gd--;){var Qd=Wa[Gd];if((Zd=Qd+"Hidden")in Ua){Wd=Qd;break}}void 0!==Wd?(Ua.addEventListener(Wd+"visibilitychange",Bs),Bs()):("onfocusout"in Ua?(Ua.addEventListener("focusout",Ks),Ua.addEventListener("focusin",Ls)):(za.addEventListener("pagehide",Ks),za.addEventListener("blur",Ks),za.addEventListener("pageshow",Ls),za.addEventListener("focus",Ls)),Hd=!0)}var Yd;if($a){var Jd={},Xd=nc("div").style;Yd=function(t){if(!Jd[t]){var e=_e(t);if(void 0!==Xd[t])Jd[t]=e;else for(var n=Wa.length;n--;){var i="-"+Wa[n]+"-"+e;if(void 0!==Xd[i]){Jd[t]=i;break}}}return Jd[t]}}else Yd=null;var tp,ep=Yd,np=new RegExp("^(?:"+Wa.join("|")+")([A-Z])");if($a){var ip,rp,sp,ap,op,up,hp=nc("div").style,lp=function(t){return t},cp={},fp={};void 0!==hp.transition?(ip="transition",rp="transitionend",sp=!0):void 0!==hp.webkitTransition?(ip="webkitTransition",rp="webkitTransitionEnd",sp=!0):sp=!1,ip&&(ap=ip+"Duration",op=ip+"Property",up=ip+"TimingFunction"),tp=function(t,e,n,i,r){setTimeout(function(){function s(){clearTimeout(d)}function a(){c&&f&&(t.unregisterCompleteHandler(s),t.ractive.fire(t.name+":end",t.node,t.isIntro),r())}function o(e){if(e.target===t.node){var n=i.indexOf(e.propertyName);-1!==n&&i.splice(n,1),i.length||(clearTimeout(d),l())}}function l(){m[op]=v.property,m[up]=v.duration,m[ap]=v.timing,t.node.removeEventListener(rp,o,!1),f=!0,a()}var c,f,d,p=(t.node.namespaceURI||"")+t.node.tagName,m=t.node.style,v={property:m[op],timing:m[up],duration:m[ap]};t.node.addEventListener(rp,o,!1),d=setTimeout(function(){i=[],l()},n.duration+(n.delay||0)+50),t.registerCompleteHandler(s),m[op]=i.join(",");var g=Ds(n.easing||"linear");m[up]=g;var w=m[up]===g;m[ap]=n.duration/1e3+"s",setTimeout(function(){for(var r,s,l,d,v,g=i.length,x=null,_=[];g--;){if(l=i[g],r=p+l,w&&sp&&!fp[r]){var E=m[l];m[l]=e[l],r in cp||(x=t.getStyle(l),cp[r]=t.getStyle(l)!=e[l],fp[r]=!cp[r],fp[r]&&(m[l]=E))}w&&sp&&!fp[r]||(null===x&&(x=t.getStyle(l)),-1===(s=i.indexOf(l))?y("Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!",{node:t.node}):i.splice(s,1),d=/[^\d]*$/.exec(x)[0],(v=k(parseFloat(x),parseFloat(e[l])))?_.push({name:l,interpolator:v,suffix:d}):m[l]=e[l],x=null)}if(_.length){var A;h(n.easing)?(A=t.ractive.easing[n.easing])||(b(fo(n.easing,"easing")),A=lp):A=u(n.easing)?n.easing:lp,new wl({duration:n.duration,easing:A,step:function(t){for(var e=_.length;e--;){var n=_[e];m[n.name]=n.interpolator(t)+n.suffix}},complete:function(){c=!0,a()}})}else c=!0;i.length?m[op]=i.join(","):(m[op]="none",t.node.removeEventListener(rp,o,!1),f=!0,a())},0)},n.delay||0)}}else tp=null;var dp=tp,pp=za&&za.getComputedStyle,mp=Promise.resolve(),vp={t0:"intro-outro",t1:"intro",t2:"outro"},gp=function(t){this.owner=t.owner||t.up.owner||Fn(t.up),this.element=this.owner.attributeByName?this.owner:Fn(t.up),this.ractive=this.owner.ractive,this.template=t.template,this.up=t.up,this.options=t,this.onComplete=[]},yp=gp.prototype;yp.animateStyle=function(t,e,n){var i=this;if(4===arguments.length)throw new Error("t.animateStyle() returns a promise - use .then() instead of passing a callback");if(!Hd)return this.setStyle(t,e),mp;var r;return h(t)?(r={})[t]=e:(r=t,n=e),new Promise(function(t){if(!n.duration)return i.setStyle(r),void t();for(var e=Ka(r),s=[],a=pp(i.node),o=e.length;o--;){var u=e[o],h=ep(u),l=a[ep(u)],c=i.node.style[h];h in i.originals||(i.originals[h]=i.node.style[h]),i.node.style[h]=r[u],i.targets[h]=i.node.style[h],i.node.style[h]=c,l!=r[u]&&(s.push(h),r[h]=r[u],i.node.style[h]=l)}s.length?dp(i,r,n,s,t):t()})},yp.bind=function(){var t=this.options,e=t.template&&t.template.v;e&&("t0"!==e&&"t1"!==e||(this.element.intro=this),"t0"!==e&&"t2"!==e||(this.element.outro=this),this.eventName=vp[e]);var n=this.owner.ractive;this.name=t.name||t.template.n,t.params&&(this.params=t.params),u(this.name)?(this._fn=this.name,this.name=this._fn.name):this._fn=w("transitions",n,this.name),this._fn||b(fo(this.name,"transition"),{ractive:n}),Fr(this,t.template)},yp.getParams=function(){if(this.params)return this.params;if(this.fn){var t=zr(this,this.template,this.up).map(function(t){if(t)return t.get()});return this.fn.apply(this.ractive,t)}},yp.getStyle=function(t){var e=pp(this.node);if(h(t))return e[ep(t)];if(!Da(t))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(var n={},i=t.length;i--;){var r=t[i],s=e[ep(r)];"0px"===s&&(s=0),n[r]=s}return n},yp.processParams=function(t,e){return l(t)?t={duration:t}:h(t)?t="slow"===t?{duration:600}:"fast"===t?{duration:200}:{duration:400}:t||(t={}),Pa({},e,t)},yp.registerCompleteHandler=function(t){C(this.onComplete,t)},yp.setStyle=function(e,n){var i=this;if(h(e)){var r=ep(e);t(this.originals,r)||(this.originals[r]=this.node.style[r]),this.node.style[r]=n,this.targets[r]=this.node.style[r]}else{var s;for(s in e)t(e,s)&&i.setStyle(s,e[s])}return this},yp.shouldFire=function(t){if(!this.ractive.transitionsEnabled)return!1;if("intro"===t&&this.ractive.rendering&&Fs("noIntro",this.ractive,!0))return!1;if("outro"===t&&this.ractive.unrendering&&Fs("noOutro",this.ractive,!1))return!1;var e=this.getParams();if(!this.element.parent)return!0;if(e&&e[0]&&s(e[0])&&"nested"in e[0]){if(!1!==e[0].nested)return!0}else if(!1!==Fs("nestedTransitions",this.ractive))return!0;for(var n=this.element.parent;n;){if(n[t]&&n[t].starting)return!1;n=n.parent}return!0},yp.start=function(){var t,e=this,n=this.node=this.element.node,i=this.originals={},r=this.targets={},s=this.getParams();if(this.complete=function(s){if(e.starting=!1,!t){if(e.onComplete.forEach(function(t){return t()}),!s&&e.isIntro)for(var a in r)n.style[a]===r[a]&&(n.style[a]=i[a]);e._manager.remove(e),t=!0}},this._fn){var a=this._fn.apply(this.ractive,[this].concat(s));a&&a.then(this.complete)}else this.complete()},yp.toString=function(){return""},yp.unbind=function(){if(!this.element.attributes.unbinding){var t=this.options&&this.options.template&&this.options.template.v;"t0"!==t&&"t1"!==t||(this.element.intro=null),"t0"!==t&&"t2"!==t||(this.element.outro=null)}},yp.unregisterCompleteHandler=function(t){V(this.onComplete,t)};var bp=gp.prototype;bp.destroyed=bp.firstNode=bp.rebound=bp.render=bp.unrender=bp.update=f;var wp,xp,kp={};try{nc("table").innerHTML="foo"}catch(t){wp=!0,xp={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}var _p=function(t){function e(e){t.call(this,e)}t&&(e.__proto__=t);var n=e.prototype=Object.create(t&&t.prototype);return n.constructor=e,n.detach=function(){var t=ti();return this.nodes&&this.nodes.forEach(function(e){return t.appendChild(e)}),t},n.find=function(t){var e,n=this,i=this.nodes.length;for(e=0;e<i;e+=1){var r=n.nodes[e];if(1===r.nodeType){if(ic(r,t))return r;var s=r.querySelector(t);if(s)return s}}return null},n.findAll=function(t,e){var n,i=this,r=e.result,s=this.nodes.length;for(n=0;n<s;n+=1){var a=i.nodes[n];if(1===a.nodeType){ic(a,t)&&r.push(a);var o=a.querySelectorAll(t);o&&r.push.apply(r,o)}}},n.findComponent=function(){return null},n.firstNode=function(){return this.rendered&&this.nodes[0]},n.render=function(t,e,n){var i=this;if(!this.nodes){var r=this.model?this.model.get():"";this.nodes=zs(r,t)}var s=this.nodes;if(e){for(var a,o=-1;e.length&&(a=this.nodes[o+1]);)for(var u=void 0;u=e.shift();){var h=u.nodeType;if(h===a.nodeType&&(1===h&&u.outerHTML===a.outerHTML||(3===h||8===h)&&u.nodeValue===a.nodeValue)){i.nodes.splice(++o,1,u);break}t.removeChild(u)}o>=0&&(s=this.nodes.slice(o)),e.length&&(n=e[0])}if(s.length){var l=ti();s.forEach(function(t){return l.appendChild(t)}),n?t.insertBefore(l,n):t.appendChild(l)}this.rendered=!0},n.toString=function(){var t=this.model&&this.model.get();return t=null!=t?""+t:"",_r()?yt(t):t},n.unrender=function(){this.nodes&&this.nodes.forEach(function(t){gl.detachWhenReady({node:t,detach:function(){ni(t)}})}),this.rendered=!1,this.nodes=null},n.update=function(){this.rendered&&this.dirty?(this.dirty=!1,this.unrender(),this.render(this.up.findParentNode(),null,this.up.findNextNode(this))):this.dirty=!1},e}(xd),Ep={};Ep[Jo]=Fd,Ep[qo]=Cf,Ep[Xo]=Zs,Ep[Yo]=Vf,Ep[Ro]=_d,Ep[zo]=ks,Ep[Ko]=Fd,Ep[Bo]=_p,Ep[Go]=ks,Ep[Ho]=yf,Ep[Ou]=bf,Ep[Su]=Nf,Ep[Au]=ud,Ep[Cu]=gp,Ep[Uo]=Ar;var Ap={doctype:Vf,form:Xf,input:Ed,option:Md,select:zd,textarea:Ud},Sp=function(t){this.owner=t.owner,this.isRoot=!t.owner.up,this.parent=this.isRoot?null:this.owner.up,this.ractive=t.ractive||(this.isRoot?t.owner:this.parent.ractive),this.componentParent=this.isRoot&&this.ractive.component?this.ractive.component.up:null,!this.isRoot||this.ractive.delegate?this.delegate=this.owner.containerFragment?this.owner.containerFragment&&this.owner.containerFragment.delegate:this.componentParent&&this.componentParent.delegate||this.parent&&this.parent.delegate:this.delegate=!1,this.context=null,this.rendered=!1,this.cssIds="cssIds"in t?t.cssIds&&t.cssIds.length&&t.cssIds:this.parent?this.parent.cssIds:null,this.dirty=!1,this.dirtyValue=!0,this.template=t.template||[],this.createItems()},Cp=Sp.prototype;Cp.bind=function(t){var e=this;this.context=t,this.owner.template.z&&(this.aliases=Qs(this.owner.template.z,this.owner.containerFragment||this.parent));for(var n=this.items.length,i=0;i<n;i++)e.items[i].bind();return this.bound=!0,this.dirty&&this.update(),this},Cp.bubble=function(){this.dirtyValue=!0,this.dirty||(this.dirty=!0,this.isRoot?this.ractive.component?this.ractive.component.bubble():this.bound&&gl.addFragment(this):this.owner.bubble(this.index))},Cp.createItems=function(){var t=this,e=this.template.length;this.items=[];for(var n=0;n<e;n++)t.items[n]=Ws({up:t,template:t.template[n],index:n})},Cp.destroyed=function(){for(var t=this,e=this.items.length,n=0;n<e;n++)t.items[n].destroyed();this.pathModel&&this.pathModel.destroyed(),this.rootModel&&this.rootModel.destroyed()},Cp.detach=function(){for(var t=ti(),e=this.items,n=e.length,i=0;i<n;i++)t.appendChild(e[i].detach());return t},Cp.find=function(t,e){return I(this.items,function(n){return n.find(t,e)})},Cp.findAll=function(t,e){this.items&&this.items.forEach(function(n){return n.findAll&&n.findAll(t,e)})},Cp.findComponent=function(t,e){return I(this.items,function(n){return n.findComponent(t,e)})},Cp.findAllComponents=function(t,e){this.items&&this.items.forEach(function(n){return n.findAllComponents&&n.findAllComponents(t,e)})},Cp.findContext=function(){var t=rn(this);return t&&t.context?t.context:this.ractive.viewmodel},Cp.findNextNode=function(t){var e=this;if(t)for(var n,i=t.index+1;i<this.items.length;i++)if((n=e.items[i])&&n.firstNode){var r=n.firstNode(!0);if(r)return r}return this.isRoot?this.ractive.component?this.ractive.component.up.findNextNode(this.ractive.component):null:this.parent?this.owner.findNextNode(this):void 0},Cp.findParentNode=function(){var t=this;do{if(t.owner.type===Fo)return t.owner.node;if(t.isRoot&&!t.ractive.component)return t.ractive.el;t=t.owner.type===Go?t.owner.containerFragment:t.componentParent||t.parent}while(t);throw new Error("Could not find parent node")},Cp.firstNode=function(t){var e=I(this.items,function(t){return t.firstNode(!0)});return e||(t?null:this.parent.findNextNode(this.owner))},Cp.getKey=function(){return this.keyModel||(this.keyModel=new Rd(this.key))},Cp.getIndex=function(){return this.idxModel||(this.idxModel=new Rd(this.index))},Cp.rebind=function(t){this.context=t,this.rootModel&&(this.rootModel.context=this.context),this.pathModel&&(this.pathModel.context=this.context)},Cp.rebound=function(t){if(this.owner.template.z){var e=this.aliases;for(var n in e)e[n].rebound?e[n].rebound(t):(e[n].unreference(),e[n]=0);Qs(this.owner.template.z,this.owner.containerFragment||this.parent,e)}this.items.forEach(function(e){return e.rebound(t)}),t&&(this.rootModel&&this.rootModel.applyValue(this.context.getKeypath(this.ractive.root)),this.pathModel&&this.pathModel.applyValue(this.context.getKeypath()))},Cp.render=function(t,e){if(this.rendered)throw new Error("Fragment is already rendered!");this.rendered=!0;for(var n=this.items,i=n.length,r=0;r<i;r++)n[r].render(t,e)},Cp.resetTemplate=function(t){var e=this.bound,n=this.rendered;if(e&&(n&&this.unrender(!0),this.unbind()),this.template=t,this.createItems(),e&&(this.bind(this.context),n)){var i=this.findParentNode(),r=this.findNextNode();if(r){var s=ti();this.render(s),i.insertBefore(s,r)}else this.render(i)}},Cp.shuffled=function(){this.items.forEach(nt),this.rootModel&&this.rootModel.applyValue(this.context.getKeypath(this.ractive.root)),this.pathModel&&this.pathModel.applyValue(this.context.getKeypath())},Cp.toString=function(t){return this.items.map(t?ut:ot).join("")},Cp.unbind=function(t){var e=this;if(this.owner.template.z&&!this.owner.yielder){for(var n in e.aliases)e.aliases[n].unreference();this.aliases={}}this.context=null;for(var i=this.items.length,r=0;r<i;r++)e.items[r].unbind(t);return this.bound=!1,this},Cp.unrender=function(t){for(var e=this,n=this.items.length,i=0;i<n;i++)e.items[i].unrender(t);this.rendered=!1},Cp.update=function(){var t=this;if(this.dirty)if(this.updating)this.isRoot&&gl.addFragmentToRoot(this);else{this.dirty=!1,this.updating=!0;for(var e=this.items.length,n=0;n<e;n++)t.items[n].update();this.updating=!1}},Cp.valueOf=function(){if(1===this.items.length)return this.items[0].valueOf();if(this.dirtyValue){var t={},e=ms(Gs(this.items,t,this.ractive._guid),t);this.value=e?e.value:this.toString(),this.dirtyValue=!1}return this.value},Sp.prototype.getContext=nn,Sp.prototype.getKeypath=Ys;var Op=["template","partials","components","decorators","events"],jp={add:cn,animate:mn,attachChild:On,compute:Vn,detach:Mn,detachChild:Pn,find:In,findAll:Rn,findAllComponents:Bn,findComponent:Kn,findContainer:Ln,findParent:Dn,fire:Qn,get:Yn,getContext:Xn,insert:si,link:oi,observe:fi,observeOnce:pi,off:mi,on:vi,once:gi,pop:Ac,push:Sc,readLink:yi,render:ea,reset:na,resetPartial:ra,resetTemplate:sa,reverse:$n("reverse").path,set:aa,shift:$n("shift").path,sort:$n("sort").path,splice:$n("splice").path,subtract:oa,teardown:Sr,toggle:ua,toCSS:ha,toCss:ha,toHTML:la,toHtml:la,toText:ca,transition:fa,unlink:da,unrender:pa,unshift:$n("unshift").path,update:Hn,updateModel:ma,use:va},Np=[],Tp=/super\s*\(|\.call\s*\(\s*this/;if(Ba(Va,{sharedGet:{value:_a},sharedSet:{value:ka},styleGet:{configurable:!0,value:ya.bind(Va)},styleSet:{configurable:!0,value:Ni.bind(Va)},addCSS:{configurable:!1,value:ba.bind(Va)},hasCSS:{configurable:!1,value:xa.bind(Va)}}),za&&!za.Ractive){var Vp="",Mp=document.currentScript||document.querySelector("script[data-ractive-options]");Mp&&(Vp=Mp.getAttribute("data-ractive-options")||""),~Vp.indexOf("ForceGlobal")&&(za.Ractive=Va)}else za&&v("Ractive already appears to be loaded while loading 1.3.7.");return Pa(Va.prototype,jp,ao),Va.prototype.constructor=Va,Va.defaults=Va.prototype,el.defaults=Va.defaults,el.Ractive=Va,Ba(Va,{DEBUG:{writable:!0,value:!0},DEBUG_PROMISES:{writable:!0,value:!0},extend:{value:Aa},extendWith:{value:Sa},escapeKey:{value:_},evalObjectString:{value:ms},findPlugin:{value:Ta},getContext:{value:Jn},getCSS:{value:xi},isInstance:{value:ga},joinKeys:{value:ja},macro:{value:Oa},normaliseKeypath:{value:E},parse:{value:Ie},splitKeypath:{value:Na},unescapeKey:{value:S},use:{value:Ea},enhance:{writable:!0,value:!1},svg:{value:Za},tick:{get:function(){return vl&&vl.promise}},VERSION:{value:"1.3.7"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:oo},events:{writable:!0,value:{}},extensions:{value:[]},helpers:{writable:!0,value:ao.helpers},interpolators:{writable:!0,value:po},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}},cssData:{configurable:!0,value:{}},sharedData:{value:Al},Ractive:{value:Va},Context:{value:jl.Context.prototype}}),Ra(Va,"_cssModel",{configurable:!0,value:new Uc(Va)}),Ra(Va.prototype,"rendered",{get:function(){return this.fragment&&this.fragment.rendered}}),Va});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/ractive-decorators-sortable.js */
!function(e,t){"use strict";if("undefined"!=typeof module&&module.exports&&"function"==typeof require)t(require("Ractive"));else if("function"==typeof define&&define.amd)define(["Ractive"],t);else{if(!e.Ractive)throw new Error("Could not find Ractive! It must be loaded before the Ractive-decorators-sortable plugin");t(e.Ractive)}}("undefined"!=typeof window?window:this,function(e){"use strict";var t,r,n,s,a,o,i,d,f,v,u,c,l;(t=function(e){return e.draggable=!0,l=$(e).find(".drag-handle"),e.addEventListener("dragstart",o,!1),e.addEventListener("dragenter",i,!1),e.addEventListener("dragleave",d,!1),e.addEventListener("drop",d,!1),e.addEventListener("dragover",f,!1),e.addEventListener("mousedown",u,!1),{teardown:function(){e.removeEventListener("mousedown",u,!1),e.removeEventListener("dragstart",o,!1),e.removeEventListener("dragenter",i,!1),e.removeEventListener("dragleave",d,!1),e.removeEventListener("drop",d,!1),e.removeEventListener("dragover",f,!1)}}}).targetClass="droptarget",v="The sortable decorator only works with elements that correspond to array members",u=function(e){c=e.target},o=function(e){if(l[0].isEqualNode(c)){var t,o=this._ractive;if(n=o.keypath,-1===(t=n.str.lastIndexOf(".")))throw new Error(v);if(s=n.str.substr(0,t),a=+n.str.substring(t+1),isNaN(a))throw new Error(v);e.dataTransfer.setData("foo",!0),r=o.root}else e.preventDefault()},i=function(){var e,n,o,i,d,f;if(this._ractive.root===r){if(e=this._ractive.keypath,-1===(n=e.str.lastIndexOf(".")))throw new Error(v);o=e.str.substr(0,n),i=+e.str.substring(n+1),o===s&&(i!==a?(f=(d=r.get(s)).splice(a,1)[0],a=i,d.splice(a,0,f)):this.classList.add(t.targetClass))}},d=function(){this.classList.remove(t.targetClass)},f=function(e){e.preventDefault()},e.decorators.sortable=t});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/ractive-events-tap.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e.Ractive=e.Ractive||{},e.Ractive.events=e.Ractive.events||{},e.Ractive.events.tap=n())}(this,function(){"use strict";function e(e,t){return new n(e,t)}function n(e,n){this.node=e,this.callback=n,this.preventMousedownEvents=!1,this.bind(e)}function t(e){this.__tap_handler__.mousedown(e)}function o(e){this.__tap_handler__.touchdown(e)}function i(){this.addEventListener("keydown",d,!1),this.addEventListener("blur",r,!1)}function r(){this.removeEventListener("keydown",d,!1),this.removeEventListener("blur",r,!1)}function d(e){32===e.which&&this.__tap_handler__.fire()}return n.prototype={bind:function(e){window.PointerEvent||window.navigator.pointerEnabled?e.addEventListener("pointerdown",t,!1):window.MSPointerEvent||window.navigator.msPointerEnabled?e.addEventListener("MSPointerDown",t,!1):(e.addEventListener("mousedown",t,!1),e.addEventListener("touchstart",o,!1)),"BUTTON"!==e.tagName&&"button"!==e.type||e.addEventListener("focus",i,!1),e.__tap_handler__=this},fire:function(e,n,t){this.callback({node:this.node,original:e,x:n,y:t})},mousedown:function(e){var n=this;if(!this.preventMousedownEvents&&(void 0===e.which||1===e.which)){var t=e.clientX,o=e.clientY,i=e.pointerId,r=function(e){e.pointerId==i&&(n.fire(e,t,o),s())},d=function(e){e.pointerId==i&&(Math.abs(e.clientX-t)>=5||Math.abs(e.clientY-o)>=5)&&s()},s=function e(){n.node.removeEventListener("MSPointerUp",r,!1),document.removeEventListener("MSPointerMove",d,!1),document.removeEventListener("MSPointerCancel",e,!1),n.node.removeEventListener("pointerup",r,!1),document.removeEventListener("pointermove",d,!1),document.removeEventListener("pointercancel",e,!1),n.node.removeEventListener("click",r,!1),document.removeEventListener("mousemove",d,!1)};window.PointerEvent||window.navigator.pointerEnabled?(this.node.addEventListener("pointerup",r,!1),document.addEventListener("pointermove",d,!1),document.addEventListener("pointercancel",s,!1)):window.PointerEvent||window.navigator.msPointerEnabled?(this.node.addEventListener("MSPointerUp",r,!1),document.addEventListener("MSPointerMove",d,!1),document.addEventListener("MSPointerCancel",s,!1)):(this.node.addEventListener("click",r,!1),document.addEventListener("mousemove",d,!1)),setTimeout(s,400)}},touchdown:function(e){var n=this,t=e.touches[0],o=t.clientX,i=t.clientY,r=t.identifier,d=function(e){e.changedTouches[0].identifier===r?(e.preventDefault(),n.preventMousedownEvents=!0,clearTimeout(n.preventMousedownTimeout),n.preventMousedownTimeout=setTimeout(function(){n.preventMousedownEvents=!1},400),n.fire(e,o,i),v()):v()},s=function(e){1===e.touches.length&&e.touches[0].identifier===r||v();var n=e.touches[0];(Math.abs(n.clientX-o)>=5||Math.abs(n.clientY-i)>=5)&&v()},v=function e(){n.node.removeEventListener("touchend",d,!1),window.removeEventListener("touchmove",s,!1),window.removeEventListener("touchcancel",e,!1)};this.node.addEventListener("touchend",d,!1),window.addEventListener("touchmove",s,!1),window.addEventListener("touchcancel",v,!1),setTimeout(v,400)},teardown:function(){var e=this.node;e.removeEventListener("pointerdown",t,!1),e.removeEventListener("MSPointerDown",t,!1),e.removeEventListener("mousedown",t,!1),e.removeEventListener("touchstart",o,!1),e.removeEventListener("focus",i,!1)}},e});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/leaflet-sidebar.js */
L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,initialize:function(t,s){var i,a;for(L.setOptions(this,s),this._sidebar=L.DomUtil.get(t),L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch"),i=this._sidebar.children.length-1;i>=0;i--)"UL"==(a=this._sidebar.children[i]).tagName&&L.DomUtil.hasClass(a,"sidebar-tabs")?this._tabs=a:"DIV"==a.tagName&&L.DomUtil.hasClass(a,"sidebar-content")&&(this._container=a);for(this._tabitems=[],i=this._tabs.children.length-1;i>=0;i--)"LI"==(a=this._tabs.children[i]).tagName&&(this._tabitems.push(a),a._sidebar=this);for(this._panes=[],i=this._container.children.length-1;i>=0;i--)"DIV"==(a=this._container.children[i]).tagName&&L.DomUtil.hasClass(a,"sidebar-pane")&&this._panes.push(a);this._hasTouchStart=L.Browser.touch&&"ontouchstart"in document.documentElement},addTo:function(t){this._map=t;for(var s=this._hasTouchStart?"touchstart":"click",i=this._tabitems.length-1;i>=0;i--){var a=this._tabitems[i];L.DomEvent.on(a.firstChild,s,this._onClick,a)}return this},removeFrom:function(t){this._map=null;for(var s=this._hasTouchStart?"touchstart":"click",i=this._tabitems.length-1;i>=0;i--){var a=this._tabitems[i];L.DomEvent.off(a.firstChild,s,this._onClick)}return this},open:function(t){var s,i;for(s=this._panes.length-1;s>=0;s--)(i=this._panes[s]).id==t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");for(s=this._tabitems.length-1;s>=0;s--)(i=this._tabitems[s]).firstChild.hash=="#"+t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");return this.fire("content",{id:t}),L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed")),this},close:function(){for(var t=this._tabitems.length-1;t>=0;t--){var s=this._tabitems[t];L.DomUtil.hasClass(s,"active")&&L.DomUtil.removeClass(s,"active")}return L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed")),this},_onClick:function(t){L.DomUtil.hasClass(this,"active")?this._sidebar.close():this._sidebar.open(this.firstChild.hash.slice(1))}}),L.control.sidebar=function(t,s){return new L.Control.Sidebar(t,s)};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/leaflet-pip.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.leafletPip=t()}}(function(){return function t(n,o,e){function r(i,s){if(!o[i]){if(!n[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=o[i]={exports:{}};n[i][0].call(c.exports,function(t){var o=n[i][1][t];return r(o||t)},c,c.exports,t,n,o,e)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<e.length;i++)r(e[i]);return r}({1:[function(t,n,o){var e=t("geojson-utils"),r={bassackwards:!1,pointInLayer:function(t,n,o){"use strict";t instanceof L.LatLng?t=[t.lng,t.lat]:r.bassackwards&&t.reverse();var a=[];return n.eachLayer(function(n){o&&a.length||n.toGeoJSON&&e.pointInPolygon({type:"Point",coordinates:t},n.toGeoJSON().geometry)&&a.push(n)}),a}};n.exports=r},{"geojson-utils":2}],2:[function(t,n,o){!function(){function t(t){for(var n=[],o=[],e=0;e<t[0].length;e++)n.push(t[0][e][1]),o.push(t[0][e][0]);return n=n.sort(function(t,n){return t-n}),o=o.sort(function(t,n){return t-n}),[[n[0],o[0]],[n[n.length-1],o[o.length-1]]]}function o(t,n,o){for(var e=[[0,0]],r=0;r<o.length;r++){for(i=0;i<o[r].length;i++)e.push(o[r][i]);e.push(o[r][0]),e.push([0,0])}for(var a=!1,r=0,i=e.length-1;r<e.length;i=r++)e[r][0]>n!=e[i][0]>n&&t<(e[i][1]-e[r][1])*(n-e[r][0])/(e[i][0]-e[r][0])+e[r][1]&&(a=!a);return a}var e=this.gju={};void 0!==n&&n.exports&&(n.exports=e),e.lineStringsIntersect=function(t,n){for(var o=[],e=0;e<=t.coordinates.length-2;++e)for(var r=0;r<=n.coordinates.length-2;++r){var a={x:t.coordinates[e][1],y:t.coordinates[e][0]},i={x:t.coordinates[e+1][1],y:t.coordinates[e+1][0]},s={x:n.coordinates[r][1],y:n.coordinates[r][0]},u={x:n.coordinates[r+1][1],y:n.coordinates[r+1][0]},c=(u.x-s.x)*(a.y-s.y)-(u.y-s.y)*(a.x-s.x),f=(i.x-a.x)*(a.y-s.y)-(i.y-a.y)*(a.x-s.x),d=(u.y-s.y)*(i.x-a.x)-(u.x-s.x)*(i.y-a.y);if(0!=d){var h=c/d,l=f/d;0<=h&&h<=1&&0<=l&&l<=1&&o.push({type:"Point",coordinates:[a.x+h*(i.x-a.x),a.y+h*(i.y-a.y)]})}}return 0==o.length&&(o=!1),o},e.pointInBoundingBox=function(t,n){return!(t.coordinates[1]<n[0][0]||t.coordinates[1]>n[1][0]||t.coordinates[0]<n[0][1]||t.coordinates[0]>n[1][1])},e.pointInPolygon=function(n,r){for(var a="Polygon"==r.type?[r.coordinates]:r.coordinates,i=!1,s=0;s<a.length;s++)e.pointInBoundingBox(n,t(a[s]))&&(i=!0);if(!i)return!1;for(var u=!1,s=0;s<a.length;s++)o(n.coordinates[1],n.coordinates[0],a[s])&&(u=!0);return u},e.pointInMultiPolygon=function(n,r){for(var a="MultiPolygon"==r.type?[r.coordinates]:r.coordinates,i=!1,s=!1,u=0;u<a.length;u++){for(var c=a[u],f=0;f<c.length;f++)i||e.pointInBoundingBox(n,t(c[f]))&&(i=!0);if(!i)return!1;for(f=0;f<c.length;f++)s||o(n.coordinates[1],n.coordinates[0],c[f])&&(s=!0)}return s},e.numberToRadius=function(t){return t*Math.PI/180},e.numberToDegree=function(t){return 180*t/Math.PI},e.drawCircle=function(t,n,o){for(var r=[n.coordinates[1],n.coordinates[0]],a=t/1e3/6371,i=[e.numberToRadius(r[0]),e.numberToRadius(r[1])],o=o||15,s=[[r[0],r[1]]],u=0;u<o;u++){var c=2*Math.PI*u/o,f=Math.asin(Math.sin(i[0])*Math.cos(a)+Math.cos(i[0])*Math.sin(a)*Math.cos(c)),d=i[1]+Math.atan2(Math.sin(c)*Math.sin(a)*Math.cos(i[0]),Math.cos(a)-Math.sin(i[0])*Math.sin(f));s[u]=[],s[u][1]=e.numberToDegree(f),s[u][0]=e.numberToDegree(d)}return{type:"Polygon",coordinates:[s]}},e.rectangleCentroid=function(t){var n=t.coordinates[0],o=n[0][0],e=n[0][1];return{type:"Point",coordinates:[o+(n[2][0]-o)/2,e+(n[2][1]-e)/2]}},e.pointDistance=function(t,n){var o=t.coordinates[0],r=t.coordinates[1],a=n.coordinates[0],i=n.coordinates[1],s=e.numberToRadius(i-r),u=e.numberToRadius(a-o),c=Math.pow(Math.sin(s/2),2)+Math.cos(e.numberToRadius(r))*Math.cos(e.numberToRadius(i))*Math.pow(Math.sin(u/2),2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))*1e3},e.geometryWithinRadius=function(t,n,o){if("Point"==t.type)return e.pointDistance(t,n)<=o;if("LineString"==t.type||"Polygon"==t.type){var r,a={};r="Polygon"==t.type?t.coordinates[0]:t.coordinates;for(var i in r)if(a.coordinates=r[i],e.pointDistance(a,n)>o)return!1}return!0},e.area=function(t){for(var n=0,o=t.coordinates[0],e=o.length-1,r=0;r<o.length;e=r++){var a={x:o[r][1],y:o[r][0]},i={x:o[e][1],y:o[e][0]};n+=a.x*i.y,n-=a.y*i.x}return n/=2},e.centroid=function(t){for(var n,o=0,r=0,a=t.coordinates[0],i=a.length-1,s=0;s<a.length;i=s++){var u={x:a[s][1],y:a[s][0]},c={x:a[i][1],y:a[i][0]};n=u.x*c.y-c.x*u.y,o+=(u.x+c.x)*n,r+=(u.y+c.y)*n}return n=6*e.area(t),{type:"Point",coordinates:[r/n,o/n]}},e.simplify=function(t,n){n=n||20,t=t.map(function(t){return{lng:t.coordinates[0],lat:t.coordinates[1]}});var o,e,r,a,i,s,u,c,f,d,h,l,y,p,g,M,x,v,b=Math.PI/180*.5,m=new Array,P=new Array,I=new Array;if(t.length<3)return t;for(o=t.length,f=360*n/(2*Math.PI*6378137),f*=f,r=0,P[0]=0,I[0]=o-1,e=1;e>0;)if(a=P[e-1],i=I[e-1],e--,i-a>1){for(d=t[i].lng()-t[a].lng(),h=t[i].lat()-t[a].lat(),Math.abs(d)>180&&(d=360-Math.abs(d)),l=(d*=Math.cos(b*(t[i].lat()+t[a].lat())))*d+h*h,T=a+1,s=a,c=-1;T<i;T++)y=t[T].lng()-t[a].lng(),p=t[T].lat()-t[a].lat(),Math.abs(y)>180&&(y=360-Math.abs(y)),g=(y*=Math.cos(b*(t[T].lat()+t[a].lat())))*y+p*p,M=t[T].lng()-t[i].lng(),x=t[T].lat()-t[i].lat(),Math.abs(M)>180&&(M=360-Math.abs(M)),(u=g>=l+(v=(M*=Math.cos(b*(t[T].lat()+t[i].lat())))*M+x*x)?v:v>=l+g?g:(y*h-p*d)*(y*h-p*d)/l)>c&&(s=T,c=u);c<f?(m[r]=a,r++):(P[++e-1]=s,I[e-1]=i,P[++e-1]=a,I[e-1]=s)}else m[r]=a,r++;m[r]=o-1,r++;for(var w=new Array,T=0;T<r;T++)w.push(t[m[T]]);return w.map(function(t){return{type:"Point",coordinates:[t.lng,t.lat]}})},e.destinationPoint=function(t,n,o){o/=6371,n=e.numberToRadius(n);var r=e.numberToRadius(t.coordinates[0]),a=e.numberToRadius(t.coordinates[1]),i=Math.asin(Math.sin(a)*Math.cos(o)+Math.cos(a)*Math.sin(o)*Math.cos(n)),s=r+Math.atan2(Math.sin(n)*Math.sin(o)*Math.cos(a),Math.cos(o)-Math.sin(a)*Math.sin(i));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,{type:"Point",coordinates:[e.numberToDegree(s),e.numberToDegree(i)]}}}()},{}]},{},[1])(1)});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/topojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(){function t(n,t){function r(t){var r,e=n.arcs[t<0?~t:t],o=e[0];return n.transform?(r=[0,0],e.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=e[e.length-1],t<0?[r,o]:[o,r]}function e(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[n<0?~n:n]=1}),f.push(e)}}var o={},i={},u={},f=[],c=-1;return t.forEach(function(r,e){var o,i=n.arcs[r<0?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++c],t[c]=r,t[e]=o)}),t.forEach(function(n){var t,e,o=r(n),f=o[0],c=o[1];if(t=u[f])if(delete u[t.end],t.push(n),t.end=c,e=i[c]){delete i[e.start];var a=e===t?t:t.concat(e);i[a.start=t.start]=u[a.end=e.end]=a}else i[t.start]=u[t.end]=t;else if(t=i[c])if(delete i[t.start],t.unshift(n),t.start=f,e=u[f]){delete u[e.end];var s=e===t?t:e.concat(t);i[s.start=e.start]=u[s.end=t.end]=s}else i[t.start]=u[t.end]=t;else i[(t=[n]).start=f]=u[t.end=c]=t}),e(u,i),e(i,u),t.forEach(function(n){o[n<0?~n:n]||f.push([n])}),f}function r(n,r,e){var o=[];if(arguments.length>1){var i,u=function(n){var t=n<0?~n:n;(a[t]||(a[t]=[])).push({i:n,g:i})},f=function(n){n.forEach(u)},c=function(n){n.forEach(f)},a=[],s={LineString:f,MultiLineString:c,Polygon:c,MultiPolygon:function(n){n.forEach(c)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in s&&(i=t,s[t.type](t.arcs))}(r),a.forEach(arguments.length<3?function(n){o.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&o.push(n[0].i)})}else for(var l=0,p=n.arcs.length;l<p;++l)o.push(l);return{type:"MultiLineString",arcs:t(n,o)}}function e(r,e){function o(n){n.forEach(function(t){t.forEach(function(t){(f[t=t<0?~t:t]||(f[t]=[])).push(n)})}),c.push(n)}function i(n){return l(u(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var f={},c=[],a=[];return e.forEach(function(n){"Polygon"===n.type?o(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(o)}),c.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,a.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),c.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:a.map(function(e){var o=[];if(e.forEach(function(n){n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].length<2&&o.push(n)})})}),o=t(r,o),(n=o.length)>1)for(var u,c=i(e[0][0]),a=0;a<n;++a)if(c===i(o[a])){u=o[0],o[0]=o[a],o[a]=u;break}return o})}}function o(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(n,t)};return null==t.id&&delete r.id,r}function u(n,t){function r(n,t){t.length&&t.pop();for(var r,e=s[n<0?~n:n],o=0,i=e.length;o<i;++o)t.push(r=e[o].slice()),a(r,o);n<0&&f(t,i)}function e(n){return n=n.slice(),a(n,0),n}function o(n){for(var t=[],e=0,o=n.length;e<o;++e)r(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=o(n);t.length<4;)t.push(t[0].slice());return t}function u(n){return n.map(i)}function c(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(c)}:t in l?{type:t,coordinates:l[t](n)}:null}var a=y(n.transform),s=n.arcs,l={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return o(n.arcs)},MultiLineString:function(n){return n.arcs.map(o)},Polygon:function(n){return u(n.arcs)},MultiPolygon:function(n){return n.arcs.map(u)}};return c(t)}function f(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}function c(n,t){for(var r=0,e=n.length;r<e;){var o=r+e>>>1;n[o]<t?r=o+1:e=o}return r}function a(n){function t(n,t){n.forEach(function(n){n<0&&(n=~n);var r=o[n];r?r.push(t):o[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function e(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,t)}):n.type in u&&u[n.type](n.arcs,t)}var o={},i=n.map(function(){return[]}),u={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(e);for(var f in o)for(var a=o[f],s=a.length,l=0;l<s;++l)for(var p=l+1;p<s;++p){var h,v=a[l],y=a[p];(h=i[v])[f=c(h,y)]!==y&&h.splice(f,0,y),(h=i[y])[f=c(h,v)]!==v&&h.splice(f,0,v)}return i}function s(n,t){function r(n){i.remove(n),n[1][2]=t(n),i.push(n)}var e=y(n.transform),o=g(n.transform),i=v();return t||(t=p),n.arcs.forEach(function(n){for(var u,f,c=[],a=0,s=0,l=n.length;s<l;++s)f=n[s],e(n[s]=[f[0],f[1],1/0],s);for(var s=1,l=n.length-1;s<l;++s)(u=n.slice(s-1,s+2))[1][2]=t(u),c.push(u),i.push(u);for(var s=0,l=c.length;s<l;++s)(u=c[s]).previous=c[s-1],u.next=c[s+1];for(;u=i.pop();){var p=u.previous,h=u.next;u[1][2]<a?u[1][2]=a:a=u[1][2],p&&(p.next=h,p[2]=u[2],r(p)),h&&(h.previous=p,h[0]=u[0],r(h))}n.forEach(o)}),n}function l(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return.5*i}function p(n){var t=n[0],r=n[1],e=n[2];return Math.abs((t[0]-e[0])*(r[1]-t[1])-(t[0]-r[0])*(e[1]-t[1]))}function h(n,t){return n[1][2]-t[1][2]}function v(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,o=e[r];if(h(n,o)>=0)break;e[o._=t]=o,e[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,f=e[u];if(i<o&&h(e[i],f)<0&&(f=e[u=i]),r<o&&h(e[r],f)<0&&(f=e[u=r]),u===t)break;e[f._=t]=f,e[n._=t=u]=n}}var r={},e=[],o=0;return r.push=function(t){return n(e[t._=o]=t,o++),o},r.pop=function(){if(!(o<=0)){var n,r=e[0];return--o>0&&(n=e[o],t(e[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(e[u]===r)return u!==--o&&(i=e[o],(h(i,r)<0?n:t)(e[i._=u]=i,u)),u},r}function y(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0),n[0]=(t+=n[0])*e+i,n[1]=(r+=n[1])*o+u}}function g(n){if(!n)return m;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0);var c=(n[0]-i)/e|0,a=(n[1]-u)/o|0;n[0]=c-t,n[1]=a-r,t=c,r=a}}function m(){}var d={version:"1.6.19",mesh:function(n){return u(n,r.apply(this,arguments))},meshArcs:r,merge:function(n){return u(n,e.apply(this,arguments))},mergeArcs:e,feature:o,neighbors:a,presimplify:s};"function"==typeof define&&define.amd?define(d):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=d:this.topojson=d}();
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/ractive-tooltip.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.RactiveTooltip=t():e.RactiveTooltip=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function o(e,t,n){var o={x:e.pageX,y:e.pageY},r=n.offsetWidth,s=n.offsetHeight,a=o.y-n.offsetHeight-5,f=o.x-5,u=a-s-5;f+r-i.innerWidth>0&&(f-=r-5),u<0&&(a+=2*s-5),n.style.left=f+"px",n.style.top=a+"px"}function r(e,t){console.log("T is text:",t,e);var n=t;!t&&e.attributes["data-tooltip"]&&(n=e.attributes["data-tooltip"].value);var r,i,a,f=function(t){n&&0!==n.length&&(r||(r=s.createElement("div"),r.className="ractive-tooltip",r.textContent=n),o(t,e,r),s.body.appendChild(r))},u=function(t){return r?void o(t,e,r):void f(t)},p=function(e){r&&r.parentNode&&r.parentNode.removeChild(r)};i={mouseenter:f,touchstart:f,mousemove:u,touchmove:u,mouseleave:p,touchend:p};for(a in i)i.hasOwnProperty(a)&&e.addEventListener(a,i[a],!1);return{update:function(e){t=e,r&&(r.textContent=t),t&&0!==t.length||!r||!r.parentNode||r.parentNode.removeChild(r)},teardown:function(){r&&r.parentNode&&(r.parentNode.removeChild(r),r=null);for(a in i)i.hasOwnProperty(a)&&e.removeEventListener(a,i[a],!1)}}}n(1);var i=window,s=i.document;e.exports=r},function(e,t,n){var o=n(2);"string"==typeof o&&(o=[[e.id,o,""]]),n(4)(o,{}),o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(3)()).push([e.id,".ractive-tooltip{position:absolute;display:table;padding:.5em;color:#fff;background:#000;box-shadow:0 2px 2px rgba(0,0,0,.1);border-radius:5px;white-space:nowrap;z-index:99999;font-style:normal;text-transform:none;pointer-events:none}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&o[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(e,t,n){function o(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=c[o.id];if(r){r.refs++;for(s=0;s<r.parts.length;s++)r.parts[s](o.parts[s]);for(;s<o.parts.length;s++)r.parts.push(u(o.parts[s],t))}else{for(var i=[],s=0;s<o.parts.length;s++)i.push(u(o.parts[s],t));c[o.id]={id:o.id,refs:1,parts:i}}}}function r(e){for(var t=[],n={},o=0;o<e.length;o++){var r=e[o],i=r[0],s={css:r[1],media:r[2],sourceMap:r[3]};n[i]?n[i].parts.push(s):t.push(n[i]={id:i,parts:[s]})}return t}function i(e,t){var n=m(),o=x[x.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),x.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function s(e){e.parentNode.removeChild(e);var t=x.indexOf(e);t>=0&&x.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function f(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function u(e,t){var n,o,r;if(t.singleton){var i=b++;n=y||(y=a(t)),o=p.bind(null,n,i,!1),r=p.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=f(t),o=d.bind(null,n),r=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),o=l.bind(null,n),r=function(){s(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}function p(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=g(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function l(e,t){var n=t.css,o=t.media;if(o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,o=t.sourceMap;o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var c={},h=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},v=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=h(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,b=0,x=[];e.exports=function(e,t){void 0===(t=t||{}).singleton&&(t.singleton=v()),void 0===t.insertAt&&(t.insertAt="bottom");var n=r(e);return o(n,t),function(e){for(var i=[],s=0;s<n.length;s++){var a=n[s];(f=c[a.id]).refs--,i.push(f)}e&&o(r(e),t);for(s=0;s<i.length;s++){var f=i[s];if(0===f.refs){for(var u=0;u<f.parts.length;u++)f.parts[u]();delete c[f.id]}}}};var g=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/path-data-polyfill.js */
SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var e={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},t=function(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},s=-1!==window.navigator.userAgent.indexOf("MSIE ");t.prototype={parseSegment:function(){var t=this._string[this._currentIndex],s=e[t]?e[t]:null;if(null===s){if(null===this._prevCommand)return null;if(null===(s=("+"===t||"-"===t||"."===t||t>="0"&&t<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;this._prevCommand=s;var r=null,a=s.toUpperCase();return"H"===a||"V"===a?r=[this._parseNumber()]:"M"===a||"L"===a||"T"===a?r=[this._parseNumber(),this._parseNumber()]:"S"===a||"Q"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===a?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===a&&(this._skipOptionalSpaces(),r=[]),null===r||r.indexOf(null)>=0?null:{type:s,values:r}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var t=this._string[this._currentIndex];return e[t]?e[t]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var e=0,t=0,s=1,r=0,a=1,n=1,i=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,a=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var u=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==u)for(var h=this._currentIndex-1,l=1;h>=u;)t+=l*(this._string[h]-"0"),h-=1,l*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)r+=(this._string[this._currentIndex]-"0")*(s*=.1),this._currentIndex+=1}if(this._currentIndex!==i&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,n=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)e*=10,e+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var v=t+r;return v*=a,e&&(v*=Math.pow(10,n*e)),i===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),v)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=!1,t=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===t)e=!1;else{if("1"!==t)return null;e=!0}return this._skipOptionalSpacesOrDelimiter(),e}};var r,a=function(e){if(!e||0===e.length)return[];var s=new t(e),r=[];if(s.initialCommandIsMoveTo())for(;s.hasMoreData();){var a=s.parseSegment();if(null===a)break;r.push(a)}return r},n=SVGPathElement.prototype.setAttribute,i=SVGPathElement.prototype.removeAttribute;r=window.Symbol?{cachedPathData:Symbol(),cachedNormalizedPathData:Symbol()}:{cachedPathData:"__cachedPathData",cachedNormalizedPathData:"__cachedNormalizedPathData"};var u=function e(t,s,r,a,n,i,u,h,l,v){var p,c,_,d,o=function(e,t,s){return{x:e*Math.cos(s)-t*Math.sin(s),y:e*Math.sin(s)+t*Math.cos(s)}},I=function(e){return Math.PI*e/180}(u),x=[];if(v)p=v[0],c=v[1],_=v[2],d=v[3];else{var f=o(t,s,-I);t=f.x,s=f.y;var m=o(r,a,-I),y=(t-(r=m.x))/2,g=(s-(a=m.y))/2,M=y*y/(n*n)+g*g/(i*i);M>1&&(n*=M=Math.sqrt(M),i*=M);var P,S=n*n,b=i*i,D=S*b-S*g*g-b*y*y,C=S*g*g+b*y*y,N=(P=h===l?-1:1)*Math.sqrt(Math.abs(D/C));_=N*n*g/i+(t+r)/2,d=N*-i*y/n+(s+a)/2,p=Math.asin(((s-d)/i).toFixed(9)),c=Math.asin(((a-d)/i).toFixed(9)),t<_&&(p=Math.PI-p),r<_&&(c=Math.PI-c),p<0&&(p=2*Math.PI+p),c<0&&(c=2*Math.PI+c),l&&p>c&&(p-=2*Math.PI),!l&&c>p&&(c-=2*Math.PI)}var A=c-p;if(Math.abs(A)>120*Math.PI/180){var V=c,E=r,O=a;c=l&&c>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,r=_+n*Math.cos(c),a=d+i*Math.sin(c),x=e(r,a,E,O,n,i,u,0,l,[c,V,_,d])}A=c-p;var k=Math.cos(p),T=Math.sin(p),z=Math.cos(c),L=Math.sin(c),G=Math.tan(A/4),Q=4/3*n*G,Z=4/3*i*G,H=[t,s],w=[t+Q*T,s-Z*k],q=[r+Q*L,a-Z*z],F=[r,a];if(w[0]=2*H[0]-w[0],w[1]=2*H[1]-w[1],v)return[w,q,F].concat(x);var j=[],U=[];return(x=[w,q,F].concat(x).join().split(",")).forEach(function(e,t){t%2?U.push(o(x[t-1],x[t],I).y):U.push(o(x[t],x[t+1],I).x),6===U.length&&(j.push(U),U=[])}),j},h=function(e){return e.map(function(e){return{type:e.type,values:Array.prototype.slice.call(e.values)}})},l=function(e){var t=[],s=null,r=null,a=null,n=null;return e.forEach(function(e){var i=e.type;if("M"===i){var u=e.values[0],h=e.values[1];t.push({type:"M",values:[u,h]}),a=u,n=h,s=u,r=h}else if("m"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"M",values:[u,h]}),a=u,n=h,s=u,r=h}else if("L"===i){var u=e.values[0],h=e.values[1];t.push({type:"L",values:[u,h]}),s=u,r=h}else if("l"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"L",values:[u,h]}),s=u,r=h}else if("C"===i){var l=e.values[0],v=e.values[1],p=e.values[2],c=e.values[3],u=e.values[4],h=e.values[5];t.push({type:"C",values:[l,v,p,c,u,h]}),s=u,r=h}else if("c"===i){var l=s+e.values[0],v=r+e.values[1],p=s+e.values[2],c=r+e.values[3],u=s+e.values[4],h=r+e.values[5];t.push({type:"C",values:[l,v,p,c,u,h]}),s=u,r=h}else if("Q"===i){var l=e.values[0],v=e.values[1],u=e.values[2],h=e.values[3];t.push({type:"Q",values:[l,v,u,h]}),s=u,r=h}else if("q"===i){var l=s+e.values[0],v=r+e.values[1],u=s+e.values[2],h=r+e.values[3];t.push({type:"Q",values:[l,v,u,h]}),s=u,r=h}else if("A"===i){var u=e.values[5],h=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],u,h]}),s=u,r=h}else if("a"===i){var u=s+e.values[5],h=r+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],u,h]}),s=u,r=h}else if("H"===i){u=e.values[0];t.push({type:"H",values:[u]}),s=u}else if("h"===i){u=s+e.values[0];t.push({type:"H",values:[u]}),s=u}else if("V"===i){h=e.values[0];t.push({type:"V",values:[h]}),r=h}else if("v"===i){h=r+e.values[0];t.push({type:"V",values:[h]}),r=h}else if("S"===i){var p=e.values[0],c=e.values[1],u=e.values[2],h=e.values[3];t.push({type:"S",values:[p,c,u,h]}),s=u,r=h}else if("s"===i){var p=s+e.values[0],c=r+e.values[1],u=s+e.values[2],h=r+e.values[3];t.push({type:"S",values:[p,c,u,h]}),s=u,r=h}else if("T"===i){var u=e.values[0],h=e.values[1];t.push({type:"T",values:[u,h]}),s=u,r=h}else if("t"===i){var u=s+e.values[0],h=r+e.values[1];t.push({type:"T",values:[u,h]}),s=u,r=h}else"Z"!==i&&"z"!==i||(t.push({type:"Z",values:[]}),s=a,r=n)}),t},v=function(e){var t=[],s=null,r=null,a=null,n=null,i=null,h=null,l=null;return e.forEach(function(e){if("M"===e.type){var v=e.values[0],p=e.values[1];t.push({type:"M",values:[v,p]}),h=v,l=p,n=v,i=p}else if("C"===e.type){var c=e.values[0],_=e.values[1],d=e.values[2],o=e.values[3],v=e.values[4],p=e.values[5];t.push({type:"C",values:[c,_,d,o,v,p]}),r=d,a=o,n=v,i=p}else if("L"===e.type){var v=e.values[0],p=e.values[1];t.push({type:"L",values:[v,p]}),n=v,i=p}else if("H"===e.type){v=e.values[0];t.push({type:"L",values:[v,i]}),n=v}else if("V"===e.type){p=e.values[0];t.push({type:"L",values:[n,p]}),i=p}else if("S"===e.type){var d=e.values[0],o=e.values[1],v=e.values[2],p=e.values[3];"C"===s||"S"===s?(I=n+(n-r),x=i+(i-a)):(I=n,x=i),t.push({type:"C",values:[I,x,d,o,v,p]}),r=d,a=o,n=v,i=p}else if("T"===e.type){var v=e.values[0],p=e.values[1];"Q"===s||"T"===s?(c=n+(n-r),_=i+(i-a)):(c=n,_=i);var I=n+2*(c-n)/3,x=i+2*(_-i)/3,f=v+2*(c-v)/3,m=p+2*(_-p)/3;t.push({type:"C",values:[I,x,f,m,v,p]}),r=c,a=_,n=v,i=p}else if("Q"===e.type){var c=e.values[0],_=e.values[1],v=e.values[2],p=e.values[3],I=n+2*(c-n)/3,x=i+2*(_-i)/3,f=v+2*(c-v)/3,m=p+2*(_-p)/3;t.push({type:"C",values:[I,x,f,m,v,p]}),r=c,a=_,n=v,i=p}else if("A"===e.type){var y=e.values[0],g=e.values[1],M=e.values[2],P=e.values[3],S=e.values[4],v=e.values[5],p=e.values[6];0===y||0===g?(t.push({type:"C",values:[n,i,v,p,v,p]}),n=v,i=p):n===v&&i===p||u(n,i,v,p,y,g,M,P,S).forEach(function(e){t.push({type:"C",values:e}),n=v,i=p})}else"Z"===e.type&&(t.push(e),n=h,i=l);s=e.type}),t};SVGPathElement.prototype.setAttribute=function(e,t){"d"===e&&(this[r.cachedPathData]=null,this[r.cachedNormalizedPathData]=null),n.call(this,e,t)},SVGPathElement.prototype.removeAttribute=function(e,t){"d"===e&&(this[r.cachedPathData]=null,this[r.cachedNormalizedPathData]=null),i.call(this,e)},SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){if(this[r.cachedNormalizedPathData])return h(this[r.cachedNormalizedPathData]);this[r.cachedPathData]?s=h(this[r.cachedPathData]):(s=a(this.getAttribute("d")||""),this[r.cachedPathData]=h(s));var t=v(l(s));return this[r.cachedNormalizedPathData]=h(t),t}if(this[r.cachedPathData])return h(this[r.cachedPathData]);var s=a(this.getAttribute("d")||"");return this[r.cachedPathData]=h(s),s},SVGPathElement.prototype.setPathData=function(e){if(0===e.length)s?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",r=0,a=e.length;r<a;r+=1){var n=e[r];r>0&&(t+=" "),t+=n.type,n.values&&(t+=" "+n.values.join(" "))}this.setAttribute("d",t)}}}();
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/togeojson.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},toGeoJSON=function(){"use strict";function e(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function t(e,t){return e.getElementsByTagName(t)}function r(e,t){return e.getAttribute(t)}function n(e,t){return parseFloat(r(e,t))}function o(e,r){var n=t(e,r);return n.length?n[0]:null}function i(e){return e.normalize&&e.normalize(),e}function a(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function s(e){return e&&i(e),e&&e.textContent||""}function l(e,t){var r,n,i={};for(n=0;n<t.length;n++)(r=o(e,t[n]))&&(i[t[n]]=s(r));return i}function u(e,t){for(var r in t)e[r]=t[r]}function f(e){return a(e.replace(y,"").split(","))}function p(e){for(var t=e.replace(m,"").split(d),r=[],n=0;n<t.length;n++)r.push(f(t[n]));return r}function c(e){var t,r=[n(e,"lon"),n(e,"lat")],i=o(e,"ele"),a=o(e,"gpxtpx:hr")||o(e,"hr"),l=o(e,"time");return i&&(t=parseFloat(s(i)),isNaN(t)||r.push(t)),{coordinates:r,time:l?s(l):null,heartRate:a?parseFloat(s(a)):null}}function h(e){return void 0!==e.xml?e.xml:g.serializeToString(e)}var g,y=/\s*/g,m=/^\s*|\s*$/g,d=/\s+/;return"undefined"!=typeof XMLSerializer?g=new XMLSerializer:"object"!==("undefined"==typeof exports?"undefined":_typeof(exports))||"object"!==("undefined"==typeof process?"undefined":_typeof(process))||process.browser||(g=new(require("xmldom").XMLSerializer)),{kml:function(n){function i(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function l(e){return a(e.split(" "))}function u(e){var r=t(e,"coord","gx"),n=[],o=[];0===r.length&&(r=t(e,"gx:coord"));for(var i=0;i<r.length;i++)n.push(l(s(r[i])));for(var a=t(e,"when"),u=0;u<a.length;u++)o.push(s(a[u]));return{coords:n,times:o}}function c(e){var r,n,i,a,l,h=[],g=[];if(o(e,"MultiGeometry"))return c(o(e,"MultiGeometry"));if(o(e,"MultiTrack"))return c(o(e,"MultiTrack"));if(o(e,"gx:MultiTrack"))return c(o(e,"gx:MultiTrack"));for(i=0;i<v.length;i++)if(n=t(e,v[i]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===v[i])h.push({type:"Point",coordinates:f(s(o(r,"coordinates")))});else if("LineString"===v[i])h.push({type:"LineString",coordinates:p(s(o(r,"coordinates")))});else if("Polygon"===v[i]){var y=t(r,"LinearRing"),m=[];for(l=0;l<y.length;l++)m.push(p(s(o(y[l],"coordinates"))));h.push({type:"Polygon",coordinates:m})}else if("Track"===v[i]||"gx:Track"===v[i]){var d=u(r);h.push({type:"LineString",coordinates:d.coords}),d.times.length&&g.push(d.times)}return{geoms:h,coordTimes:g}}for(var g={type:"FeatureCollection",features:[]},y={},m={},d={},v=["Polygon","LineString","Point","Track","gx:Track"],S=t(n,"Placemark"),k=t(n,"Style"),b=t(n,"StyleMap"),x=0;x<k.length;x++){var T=e(h(k[x])).toString(16);y["#"+r(k[x],"id")]=T,m[T]=k[x]}for(var N=0;N<b.length;N++){y["#"+r(b[N],"id")]=e(h(b[N])).toString(16);for(var F=t(b[N],"Pair"),L={},M=0;M<F.length;M++)L[s(o(F[M],"key"))]=s(o(F[M],"styleUrl"));d["#"+r(b[N],"id")]=L}for(var w=0;w<S.length;w++)g.features=g.features.concat(function(e){var n,a=c(e),l={},u=s(o(e,"name")),f=s(o(e,"address")),p=s(o(e,"styleUrl")),h=s(o(e,"description")),g=o(e,"TimeSpan"),v=o(e,"TimeStamp"),S=o(e,"ExtendedData"),k=o(e,"LineStyle"),b=o(e,"PolyStyle"),x=o(e,"visibility");if(!a.geoms.length)return[];if(u&&(l.name=u),f&&(l.address=f),p){"#"!==p[0]&&(p="#"+p),l.styleUrl=p,y[p]&&(l.styleHash=y[p]),d[p]&&(l.styleMapHash=d[p],l.styleHash=y[d[p].normal]);var T=m[l.styleHash];T&&(k||(k=o(T,"LineStyle")),b||(b=o(T,"PolyStyle")))}if(h&&(l.description=h),g){var N=s(o(g,"begin")),F=s(o(g,"end"));l.timespan={begin:N,end:F}}if(v&&(l.timestamp=s(o(v,"when"))),k){var L=i(s(o(k,"color"))),M=L[0],w=L[1],P=parseFloat(s(o(k,"width")));M&&(l.stroke=M),isNaN(w)||(l["stroke-opacity"]=w),isNaN(P)||(l["stroke-width"]=P)}if(b){var R=i(s(o(b,"color"))),z=R[0],C=R[1],G=s(o(b,"fill")),A=s(o(b,"outline"));z&&(l.fill=z),isNaN(C)||(l["fill-opacity"]=C),G&&(l["fill-opacity"]="1"===G?l["fill-opacity"]||1:0),A&&(l["stroke-opacity"]="1"===A?l["stroke-opacity"]||1:0)}if(S){var H=t(S,"Data"),D=t(S,"SimpleData");for(n=0;n<H.length;n++)l[H[n].getAttribute("name")]=s(o(H[n],"value"));for(n=0;n<D.length;n++)l[D[n].getAttribute("name")]=s(D[n])}x&&(l.visibility=s(x)),a.coordTimes.length&&(l.coordTimes=1===a.coordTimes.length?a.coordTimes[0]:a.coordTimes);var U={type:"Feature",geometry:1===a.geoms.length?a.geoms[0]:{type:"GeometryCollection",geometries:a.geoms},properties:l};return r(e,"id")&&(U.id=r(e,"id")),[U]}(S[w]));return g},gpx:function(e){function n(e,r){var n=t(e,r),o=[],i=[],a=[],s=n.length;if(s<2)return{};for(var l=0;l<s;l++){var u=c(n[l]);o.push(u.coordinates),u.time&&i.push(u.time),u.heartRate&&a.push(u.heartRate)}return{line:o,times:i,heartRates:a}}function i(e){var t={};if(e){var r=o(e,"line");if(r){var n=s(o(r,"color")),i=parseFloat(s(o(r,"opacity"))),a=parseFloat(s(o(r,"width")));n&&(t.stroke=n),isNaN(i)||(t["stroke-opacity"]=i),isNaN(a)||(t["stroke-width"]=96*a/25.4)}}return t}function a(e){var n=l(e,["name","cmt","desc","type","time","keywords"]),o=t(e,"link");o.length&&(n.links=[]);for(var i,a=0;a<o.length;a++)u(i={href:r(o[a],"href")},l(o[a],["text","type"])),n.links.push(i);return n}var f,p,h=t(e,"trk"),g=t(e,"rte"),y=t(e,"wpt"),m={type:"FeatureCollection",features:[]};for(f=0;f<h.length;f++)(p=function(e){for(var r,s=t(e,"trkseg"),l=[],f=[],p=[],c=0;c<s.length;c++)(r=n(s[c],"trkpt"))&&(r.line&&l.push(r.line),r.times&&r.times.length&&f.push(r.times),r.heartRates&&r.heartRates.length&&p.push(r.heartRates));if(0!==l.length){var h=a(e);return u(h,i(o(e,"extensions"))),f.length&&(h.coordTimes=1===l.length?f[0]:f),p.length&&(h.heartRates=1===l.length?p[0]:p),{type:"Feature",properties:h,geometry:{type:1===l.length?"LineString":"MultiLineString",coordinates:1===l.length?l[0]:l}}}}(h[f]))&&m.features.push(p);for(f=0;f<g.length;f++)(p=function(e){var t=n(e,"rtept");if(t.line){var r=a(e);return u(r,i(o(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}(g[f]))&&m.features.push(p);for(f=0;f<y.length;f++)m.features.push(function(e){var t=a(e);return u(t,l(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:c(e).coordinates}}}(y[f]));return m}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
</script>

    <!-- THIS NEEDS TO BE FIRST -->
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/polyfills.js */
"function"!=typeof Object.assign&&(Object.assign=function(n,t){"use strict";if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),e=1;e<arguments.length;e++){var o=arguments[e];if(null!=o)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])}return r});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/config.js */
function stringify(e){function n(e){return _.isObject(e)?_.sortBy(_.map(_.pairs(e),function(e){return[e[0],n(e[1])]}),function(e){return e[0]}):e}return JSON.stringify(n(e))}var getParameterByName=function(e){if("undefined"!=typeof window){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}return null},Config={defaults:{"bounding-box":[-73.50821,42.886778,-69.858861,41.187053]},skip_cdn:"disable"===getParameterByName("cdn")};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/layer_info.js */
var GEOSERVER="https://geoserver.nescaum-ccsc-dataservices.com/geoserver",API_SERVER="https://api.nescaum-ccsc-dataservices.com/",CDN=function(e){var a;if(Config.skip_cdn)a=e;else{var t=new URI(e),s=t.hostname();s.match(/geoserver.nescaum-ccsc-dataservices.com/)?(t.hostname("d3dfsz5phlpu8l.cloudfront.net"),t.port(null),t.scheme("https")):s.match(/api.nescaum-ccsc-dataservices.com/)?(t.hostname("d2749s27r5h52i.cloudfront.net"),t.port(null),t.scheme("https")):s.match(/repository.nescaum-ccsc-dataservices.com/)?(t.hostname("d2iq7uivdprspu.cloudfront.net"),t.port(null),t.scheme("https")):console.warn("Hostname not in a CDN",s),a=t.toString()}return a},available_layers=[{id:"boundary_counties",folder:"Boundaries",name:"Counties",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Cartographic Boundary Shapefiles (CBF) of MA counties. These cartographic boundary files are simplified representations of selected geographic areas from the Census Bureau’s MAF/TIGER geographic database. These boundary files are specifically designed for small scale thematic mapping. Generalized boundary files are clipped to a simplified version of the U.S. outline. As a result, some off-shore areas may be excluded from the generalized files.</p>",source:"U.S. Census Bureau",source_url:"https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:county_boundary&maxFeatures=500&outputFormat=SHAPE-ZIP"},{id:"boundary_huc8",folder:"Boundaries",name:"Watersheds (HUC8)",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Recreation","Water Resources"],description:"<p>NRCS Watershed Boundary Dataset (WBD), as of 7/17/2017. The Watershed Boundary Dataset (WBD) defines the areal extent of surface water drainage to a point, accounting for all land and surface areas. Watershed Boundaries are determined solely upon science-based hydrologic principles, not favoring any administrative boundaries or special projects, nor particular program or agency. The intent of defining Hydrologic Units (HU) for the Watershed Boundary Dataset is to establish a baseline drainage boundary framework, accounting for all land and surface areas. At a minimum, the WBD is being delineated and georeferenced to the USGS 1:24,000 scale topographic base map meeting National Map Accuracy Standards (NMAS). Hydrologic units are given a Hydrologic Unit Code (HUC). For example, a hydrologic region has a 2-digit HUC. A HUC describes where the unit is in the country and the level of the unit. </p>",source:"USDA Natural Resources Conservation Service",source_url:"https://www.nrcs.usda.gov",download_url:"https://datagateway.nrcs.usda.gov/GDGOrder.aspx?order=QuickState",metadata_url:"https://gdg.sc.egov.usda.gov/Catalog/ProductDescription/WBD.html"},{id:"huc10",folder:"Boundaries",name:"Watersheds (HUC10)",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Recreation","Water Resources"],description:"<p>This dataset is a digital hydrologic unit boundary layer that is at the  Watershed (10-digit) level. Each basin is identified by a unique Hydrologic Unit Code (HUC), as well a name, at each level. HUCs are identifiers as assigned to basin polygons by the U.S. Geological Survey (USGS).</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/nrcshuc.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/nrcshuc.html"},{id:"major_basins",folder:"Boundaries",name:"Major Basins",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Recreation","Water Resources"],description:"<p>MassGIS has produced a statewide digital datalayer of the 27 major drainage basins of Massachusetts as defined by the USGS Water Resources Division and the MA Water Resources Commission.</p>",source:"MA Water Resources Commission",source_url:"https://www.mass.gov/orgs/water-resources-commission",download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/majorbasins.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/majbas.html"},{id:"boundary_state",folder:"Boundaries",name:"State Boundary",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Derived from cartographic boundary files from the Census Bureau’s MAF/TIGER geographic database. These boundary files are specifically designed for small scale thematic mapping. Generalized boundary files are clipped to a simplified version of the U.S. outline. As a result, some off-shore areas may be excluded from the generalized files.</p>",source:"U.S. Census Bureau",source_url:"https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:state_boundary&maxFeatures=50&outputFormat=SHAPE-ZIP",metadata_url:"https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html"},{id:"boundary_state_mask",folder:"Boundaries",name:"State Mask",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Derived from cartographic boundary files from the Census Bureau’s MAF/TIGER geographic database. These boundary files are specifically designed for small scale thematic mapping. Generalized boundary files are clipped to a simplified version of the U.S. outline. As a result, some off-shore areas may be excluded from the generalized files.</p>",source:"U.S. Census Bureau",source_url:"https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:state_mask&maxFeatures=50&outputFormat=SHAPE-ZIP",metadata_url:"https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html"},{id:"ma_observed_precip",folder:"Climate Observations.Precipitation",name:"Total Precipitation (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Total precipitation summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_precip",folder:"Climate Projections.Precipitation",name:"Total Precipitation (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal total precipitation, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='precip'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_precip",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_consecutive_dry_days",folder:"Climate Observations.Precipitation",name:"Consecutive Dry Days (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Consecutive dry days (no measureable precipitation) summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_consecutive_dry_days",folder:"Climate Projections.Precipitation",name:"Consecutive Dry Days (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal mean consecutive dry days, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='consdrydays'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_consecutive_dry_days",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_precip_gt_1",folder:"Climate Observations.Precipitation",name:'Extreme Precipitation > 1" (Observed)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with precipitation greater than one inch summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_precip_gt_1",folder:"Climate Projections.Precipitation",name:'Extreme Precipitation > 1" (Projected)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with precipitation above 1 inch in a 24-hour period, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='precipgt1'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_precip_gt_1",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_precip_gt_2",folder:"Climate Observations.Precipitation",name:'Extreme Precipitation > 2" (Observed)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with precipitation greater than two inches summmarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_precip_gt_2",folder:"Climate Projections.Precipitation",name:'Extreme Precipitation > 2" (Projected)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with precipitation above 2 inches in a 24-hour period, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='precipgt2'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_precip_gt_2",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_precip_gt_4",folder:"Climate Observations.Precipitation",name:'Extreme Precipitation > 4" (Observed)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with precipitation greater than four inches summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_precip_gt_4",folder:"Climate Projections.Precipitation",name:'Extreme Precipitation > 4" (Projected)',sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with precipitation above 4 inches in a 24-hour period, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='precipgt4'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_precip_gt_4",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_avg_temp",folder:"Climate Observations.Temperature",name:"Average Temperatures (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Average temperature summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_avg_temp",folder:"Climate Projections.Temperature",name:"Average Temperatures (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal average temperature, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='avgtemp'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_avg_temp",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_max_temp",folder:"Climate Observations.Temperature",name:"Maximum Temperatures (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Maximum temperature summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_max_temp",folder:"Climate Projections.Temperature",name:"Maximum Temperatures (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal average maximum temperature, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='maxtemp'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_max_temp",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_min_temp",folder:"Climate Observations.Temperature",name:"Minimum Temperatures (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Minimum temperature summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_min_temp",folder:"Climate Projections.Temperature",name:"Minimum Temperatures (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal average minimum temperature, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>   Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='mintemp'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_min_temp",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_temp_lt_0",folder:"Climate Observations.Temperature",name:"Days < 0 &deg;F (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature below 0 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_temp_lt_0",folder:"Climate Projections.Temperature",name:"Days < 0 &deg;F (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature below 0 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs).</p><p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100. The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='templt0'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_temp_lt_0",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_temp_lt_32",folder:"Climate Observations.Temperature",name:"Days < 32 &deg;F (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with minimum temperatures below 32&deg;F summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_temp_lt_32",folder:"Climate Projections.Temperature",name:"Days < 32 &deg;F (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature below 32 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='templt32'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_temp_lt_32",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_temp_gt_90",folder:"Climate Observations.Temperature",name:"Days > 90 &deg;F (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with maximum temperatures above 90&deg;F summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_temp_gt_90",folder:"Climate Projections.Temperature",name:"Days > 90 &deg;F (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature above 90 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='tempgt90'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_temp_gt_90.zip",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_temp_gt_95",folder:"Climate Observations.Temperature",name:"Days > 95 &deg;F (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with maximum temperatures above 95&deg;F summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_temp_gt_95",folder:"Climate Projections.Temperature",name:"Days > 95 &deg;F (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature above 95 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='tempgt95'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_temp_gt_95",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_temp_gt_100",folder:"Climate Observations.Temperature",name:"Days > 100 &deg;F (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Days with maximum temperatures above 100&deg;F summarized by area (state,county,basin) and decade over the period 1960-2005. Observational dataset: Livneh et al. (2015). <br>Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015)</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_temp_gt_100",folder:"Climate Projections.Temperature",name:"Days > 100 &deg;F (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in the number of days per season or year with temperature above 100 °F, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='tempgt100'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_temp_gt_100",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_heating_degree_days",folder:"Climate Observations.Temperature",name:"Heating Degree Days (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p> Average heating degree-days summarized by area (state,county,basin) and decade over the period 1960-2005. <br>Definition:  Heating degree-days are based on the assumption that when the outside temperature is above 65°F, we don't need heating to be comfortable. Heating degree days are the difference between the daily temperature mean and 65°F.  For example, if the mean temperature mean is 25°F, we subtract the mean from 65 and the result is 40 heating degree-days for that day. (Definition adapted from National Weather Service)<br>   Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_heating_degree_days",folder:"Climate Projections.Temperature",name:"Heating Degree Days (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal mean heating degree-days, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs). </p><p> Heating degree-days are based on the assumption that when the outside temperature is above 65°F, we don't need heating to be comfortable. Heating degree days are the difference between the daily temperature mean and 65°F. For example, if the mean temperature mean is 25°F, we subtract the mean from 65 and the result is 40 heating degree-days for that day. (Definition adapted from National Weather Service)</p> <p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p>Projected changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='precipgt1'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_heating_degree_days",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_cooling_degree_days",folder:"Climate Observations.Temperature",name:"Cooling Degree Days (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p> Average cooling degree-days summarized by area (state,county,basin) and decade over the period 1960-2005. <br>Definition: Cooling degree days are based on the assumption that when the outside temperature is below 65°F, we don't need cooling (air-conditioning) to be comfortable. Cooling degree-days are the difference between the daily temperature mean and 65°F.  For example, if the temperature mean is 85°F, we subtract 65 from the mean and the result is 20 cooling degree-days for that day. (Definition adapted from National Weather Service) <br>  Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_cooling_degree_days",folder:"Climate Projections.Temperature",name:"Cooling Degree Days (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal mean cooling degree-days, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs).   Cooling degree days are based on the assumption that when the outside temperature is below 65°F, we don't need cooling (air-conditioning) to be comfortable. Cooling degree-days are the difference between the daily temperature mean and 65°F. For example, if the temperature mean is 85°F, we subtract 65 from the mean and the result is 20 cooling degree-days for that day. (Definition adapted from National Weather Service).</p><p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p> Projected changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='cooldegdays'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_cooling_degree_days",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_observed_growing_degree_days",folder:"Climate Observations.Temperature",name:"Growing Degree Days (Observed)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p> Average growing degree-days summarized by area (state,county,basin) and decade over the period 1960-2005. <br>Definition: A growing degree day (GDD) is an index used to express crop maturity. The index is computed by subtracting a base temperature of 50°F from the average of the maximum and minimum temperatures for the day. Minimum temperatures less than 50°F are set to 50, and maximum temperatures greater than 86°F are set to 86. These substitutions indicate that no appreciable growth is detected with temperatures lower than 50° or greater than 86°. (Adapted from National Weather Service) <br>  Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014), Observational data: A spatially comprehensive, meteorological data set for Mexico, the U.S., and southern Canada (Livneh et al., 2015).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",metadata_url:"http://loca.ucsd.edu/"},{id:"ma_projected_growing_degree_days",folder:"Climate Projections.Temperature",name:"Growing Degree Days (Projected)",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],description:"<p>Projected changes in annual or seasonal mean growing degree-days, summarized by county, drainage basin, or the entire state, for two different Representative Concentration Pathways (RCPs).  A growing degree day (GDD) is an index used to express crop maturity. The index is computed by subtracting a base temperature of 50°F from the average of the maximum and minimum temperatures for the day. Minimum temperatures less than 50°F are set to 50, and maximum temperatures greater than 86°F are set to 86. These substitutions indicate that no appreciable growth is detected with temperatures lower than 50° or greater than 86°. (Definition adapted from National Weather Service) </p><p>The two emission scenarios are RCP4.5, a 'medium stabilization scenario' in which emissions are expected to peak in the mid-21st century and decline thereafter, and RCP8.5, a high emissions scenario without any reduction in emissions over time.</p><p><br>Projected changes are relative to the 1971-2000 mean. These 30-year means are calculated for four periods centered around 2035 (2020-2049), 2055 (2040-2069), 2075 (2060-2089), and 2090 (2080-2099). Projections for the 2090s are based on a 20-year mean since model simulations are available only until 2100.  The projections are derived from statistically downscaled (LOCA method) CMIP5 daily data. Data Source: Statistically downscaled CMIP5 daily Climate Observations using Localized Constructed Analogs (LOCA; Pierce et al., 2014).</p>",source:"University of California San Diego",source_url:"http://loca.ucsd.edu/",download_url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:climate_data_projected_download&CQL_FILTER=var_name='growdegdays'&maxFeatures=1000&outputFormat=SHAPE-ZIP&format_options=filename:ma_projected_growing_degree_days",metadata_url:"http://loca.ucsd.edu/"},{id:"noaa_slr",folder:"Climate Projections.Sea Level Rise",name:"Sea Level Rise & Coastal Flooding (NOAA)",description:"<p>Sea Level Rise: the maps show inland extent and relative depth of inundation from 0 to 6 feet above mean higher high water (MHHW). Areas that are hydrologically connected (according to the digital elevation model used) are shown in shades of blue. Low-lying areas, displayed in green, are considered hydrologically “unconnected” areas that may flood. The inundation maps are created by subtracting the NOAA VDATUM MHHW surface from the digital elevation model. Mapping Confidence: blue areas denote a high confidence of inundation, orange areas denote a low confidence of inundation, and unshaded areas denote a high confidence that these areas will be dry given the chosen water level.</p>",source:"NOAA",source_url:"https://coast.noaa.gov/slr",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],download_url:null,metadata_url:"https://coast.noaa.gov/slrdata/ "},{id:"acec",folder:"Natural Resources/Habitats",name:"Areas of Critical Environmental Concern",description:"<p>The Areas of Critical Environmental Concern (ACEC) datalayers provide digital polygon and line boundaries for areas that have been designated ACECs by the Secretary of Energy and Environmental Affairs (EEA).  ACECs are places in Massachusetts that receive special recognition because of the quality, uniqueness and significance of their natural and cultural resources.  These areas are identified and nominated at the community level and are reviewed and designated by the state’s EEA Secretary.  ACEC designation creates a framework for local and regional stewardship of these critical resource areas and ecosystems.  ACEC designation also requires stricter environmental review of certain kinds of proposed development under state jurisdiction within the ACEC boundaries.</p>",source:"Department of Conservation and Recreation",source_url:"http://www.mass.gov/eea/agencies/dcr/",sectors:["Agriculture","Forestry","Coastal Zone","Energy","Local Government","Natural Resources/Habitats","Recreation","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/acecs.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/acecs.html"},{id:"barrier_beaches",folder:"Coastal Vulnerability",name:"Barrier Beaches",description:"<p>The state barrier beach data layer was compiled by the Resource Mapping Project staff at the University of Massachusetts, Amherst for the Massachusetts Coastal Zone Management Program.</p>",source:"Massachusetts Coastal Zone Management Program",source_url:"http://www.mass.gov/eea/agencies/czm/",sectors:["Infrastructure","Coastal Zone","Natural Resources/Habitats","Recreation","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/barrb.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/state-designated-barrier-beaches-.html"},{id:"dams",folder:"Public Safety/Emergency Response",name:"Dams",description:"<p>The Massachusetts Dams data layer contains points derived from a dam safety database maintained by the Massachusetts Office of Dam Safety (ODS). The ODS database includes detailed information about each dam for operational purposes.  Most of the location information was derived from historical data and has been ground-truthed against inspection and ownership reports that are maintained by the ODS. The locations of some dams have not been confirmed. These are pending verification and can be identified through the field 'LocStatus.' Dams regulated by the ODS in accordance with regulation CMR 302 10.00 are listed as 'Office of Dam Safety' in the field 'RegAuth'. Please report any data errors or inconsistencies to the Office of Dam Safety (dam.safety@state.ma.us) or DCR-GIS (chandreyee.lahiri@state.ma.us)</p>",source:"Massachusetts Office of Dam Safety",source_url:"http://www.mass.gov/eea/agencies/dcr/conservation/dam-safety/",sectors:["Energy","Local Government","Natural Resources/Habitats","Public Safety/Emergency Response","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/dams.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/dams.html"},{id:"groundwater_discharge",folder:"Water Resources",name:"Groundwater Discharge",description:"<p>The Massachusetts Department of Environmental Protection (MassDEP) Bureau of Water Resources (BWR), Wastewater Management Program is responsible for regulating the discharge of pollutants to the groundwaters of The Commonwealth (314 CMR 5.00). See the MassDEP Groundwater Discharge Permitting website for details.</p>",source:"MassDEP",source_url:"http://www.mass.gov/eea/agencies/massdep/water/wastewater/groundwater-discharge-permitting.html",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/gwp.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/gwp.html"},{id:"public_water_supplies",folder:"Water Resources",name:"Public Water Supplies",description:"<p>The Public Water Supply (PWS) datalayer contains the locations of public community surface and groundwater supply sources and public non-community supply sources as defined in 310 CMR 22.00. The public water supply systems represented in this datalayer are based primarily on information in the DEP’s Water Quality Testing System (WQTS) database. The WQTS database is the Department’s central database for tracking water supply data. The PWS datalayer also contains the locations of proposed wells that have a defined DEP approved wellhead protection area (Zone IIs).</p>",source:"MassDEP",source_url:" https://www.mass.gov/orgs/massachusetts-department-of-environmental-protection",sectors:["Agriculture","Forestry","Infrastructure","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Water Resources"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/order-restricted-data.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/pws.html"},{id:"wellhead_protection",folder:"Water Resources",name:"Wellhead Protection Areas",description:"<p>Wellhead protection areas are important for protecting the recharge area around public water supply (PWS) groundwater sources. A Zone II is a wellhead protection area that has been determined by hydro-geologic modeling and approved by the Department of Environmental Protection’s (DEP) Drinking Water Program (DWP). In cases where hydro-geologic modeling studies have not been performed and there is no approved Zone II, an Interim Wellhead Protection Area (IWPA) is established based on DEP DWP well pumping rates or default values. Certain land uses may be either prohibited or restricted in both approved (Zone II) and interim (IWPA) wellhead protection areas. For MassDEP's regulatory wording of these zones please see Water Supply Protection Area Definitions.</p>",source:"MassDEP Drinking Water Program Drinking Water Program",source_url:"https://www.mass.gov/orgs/massachusetts-department-of-environmental-protection",sectors:["Agriculture","Forestry","Infrastructure","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/zone2_zone1_iwpa.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/dep-wellhead-protection-areas-zone-ii-iwpa.html"},{id:"outstanding_resource_waters",folder:"Water Resources",name:"Outstanding Resource Waters",description:"<p>This datalayer delineates  areas in which certain waters are afforded Outstanding Resource Water (ORW) protection under the Massachusetts Surface Water Quality Standards, 314 CMR 4.00 (WQS). According to 314 CMR 4.04(3): Certain waters are designated for protection under this provision in 314 CMR 4.06. These waters include Class A Public Water Supplies (314 CMR 4.06(1)(d)1.) and their tributaries, certain wetlands as specified in 314 CMR 4.06(2) and other waters as determined by the Department based on their outstanding socio-economic, recreational, ecological and/or aesthetic values. The quality of these waters shall be protected and maintained. It is important to note first, that the areas delineated in this datalayer are not themselves ORWs, and, second, that only certain waters within the delineated areas are ORWs. Additionally, while the WQS designate Massachusetts Division of Fisheries and Wildlife as ORWs, certified vernal pools are NOT included in this datalayer (see 314 CMR 4.06(2)). Further, there may be areas not shown in this datalayer that contain ORWs.</p>",source:"MassDEP",source_url:"http://www.mass.gov/dep/",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/orw.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/orw.html"},{id:"electric_providers",folder:"Energy",name:"Electricity Providers",description:"<p>This layer displays the public Electric utility providers for each Massachusetts municipality. The source of data for Electric was the Massachusetts Department of Public Utilities, September 2015.</p>",source:"Massachusetts Department of Public Utilities",source_url:"http://www.mass.gov/eea/grants-and-tech-assistance/guidance-technical-assistance/agencies-and-divisions/dpu/",sectors:["Coastal Zone","Economy","Energy","Local Government","Public Health","Public Safety/Emergency Response","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/pubutil.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/pubutil.html"},{id:"gas_providers",folder:"Energy",name:"Natural Gas Providers",description:"<p>This layer displays Natural Gas utility providers for each Massachusetts municipality. The source of data for Natural Gas was the Massachusetts Department of Public Utilities, September 2015. .</p>",source:"Massachusetts Department of Public Utilities",source_url:"http://www.mass.gov/eea/grants-and-tech-assistance/guidance-technical-assistance/agencies-and-divisions/dpu/",sectors:["Economy","Energy","Local Government","Public Safety/Emergency Response"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/pubutil.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/pubutil.html"},{id:"power_plants",folder:"Energy",name:"Power Plants",description:"<p>Operable electric generating plants in the Massachusetts by energy source. This includes all plants that are operating, on standby, or short- or long-term out of service with a combined nameplate capacity of 1 MW or more.</p>",source:"US Energy Information Administration",source_url:"https://www.eia.gov/",sectors:["Economy","Energy","Local Government","Public Safety/Emergency Response"],download_url:"https://www.eia.gov/maps/map_data/PowerPlants_US_EIA.zip",metadata_url:"https://www.eia.gov/maps/layer_info-m.php"},{id:"sea_level_rise",folder:"Climate Projections.Sea Level Rise",name:"Sea Level Rise",description:" <p>Future sea level projections are provided for the Massachusetts coastline at established tide gauge stations with long-term records at Boston Harbor, MA; Nantucket, MA; Woods Hole, MA; and Newport, RI. The projections shown in this map layer are adjusted to each station’s mean sea level and converted to the North American Vertical Datum of 1988 (NAVD88).</p> <p>The analysis for Massachusetts (DeConto and Kopp, 2017) consisted of a probabilistic assessment of future relative sea level rise at each tide gauge location given two future atmospheric greenhouse gas concentration pathways, medium (RCP4.5) and high (RCP8.5), and for two methods of accounting for Antarctic ice sheet contributions to sea level rise: one based on expert elicitation (Kopp, 2014) and one where Antarctic ice sheet projections are driven by new, process-based numerical ice sheet model simulations (DeConto and Pollard, 2016; Kopp, 2017). A multi-year reference time period for relative sea level was used to minimize biases caused by tidal, seasonal, and inter-annual climate variability, following the accepted practice of using a 19-year tidal datum epoch centered on the year 2000 as the ‘zero’ reference for changes in relative sea level rise. To account for the ‘zero’ reference point utilized for the models and to provide elevations on a common geodetic datum, sea level rise model projection values at each tidal station were adjusted to the station’s mean sea level as computed for the 19 year tidal datum epoch of 1999-2017 and converted to NAVD88.</p> <p>Following the approach in the 2017 National Climate Assessment and the National Oceanic and Atmospheric Administration’s Global and Regional Sea Level Rise Scenarios for the United States, conditional probability distributions for sea level rise projections can be integrated into different scenarios to support planning and decision-making, given uncertainty and future risks. This approach allows for the many different probabilistic projections (i.e., two models each using two greenhouse gas concentration pathways for multiple time series and several probabilities groups) to be filtered into four scenarios. Under this approach, each of the scenarios—Intermediate, Intermediate-High, High, and Extreme—is cross-walked with two or three probabilistic model outputs (see MetaData URL for definition of scenarios and projections shown in this map layer). </p> <p>On their own, while they are not site-specific projections of mean higher high water levels, these projections provide insight to overall trends in rising sea levels along the Commonwealth coastline, to help coastal municipal officials and workshop participants identify future hazards exacerbated by rising seas.</p> </p>",source:"University of Massachusetts – Amherst",source_url:"",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],download_url:"",metadata_url:"https://s3.amazonaws.com/nescaum-dataservices-assets/resources/production/UMASS+SLR+METADATA_UPDATE_20180327.pdf"},{id:"aquifers",folder:"Water Resources",name:"Aquifers",description:"<p>MassGIS produced an aquifer datalayer composed of 20 individual panels, generally based on the boundaries of the major drainage basins. Areas of high and medium yield were mapped. The SDE layers contain seamless data from Basin-based tiles pdf format of ix_bas.pdf and are named AQUIFERS_POLY and AQUIFERS_ARC.  Aquifer polygons were not delineated for Cape Cod and the Elizabeth Islands. These areas in their entirety are considered by the Massachusetts Contingency Plan (MCP) as medium yield aquifers. The areas of Martha's Vineyard and Nantucket not delineated as high yield aquifers are also considered as medium yield under the MCP.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/aquifers.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/aquifers-.html"},{id:"hospitals",folder:"Public Safety/Emergency Response",name:"Hospitals",description:"<p>This point datalayer shows the location of 82 acute care hospitals in Massachusetts. Acute care hospitals are those licensed under MGL Chapter 111, section 51 and which contain a majority of medical-surgical, pediatric, obstetric, and maternity beds, as defined by the Massachusetts Department of Public Health (DPH).  Sample of Acute Hospitals DataThe features in this layer are based on database information provided to MassGIS from the DPH, Office of Emergency Medical Services (OEMS).</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Public Health","Public Safety/Emergency Response","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/acute_care_hospitals.zip",metadata_url:"https://docs.digital.mass.gov/dataset/massgis-data-acute-care-hospitals"},{id:"schools",folder:"Public Safety/Emergency Response",name:"Schools",description:"<p>This point datalayer shows the locations of schools in Massachusetts. Sample of Schools Data Schools appearing in this layer are those attended by students in pre-kindergarten through high school, based on the Massachusetts Department of Elementary and Secondary Education (ESE) school profiles database as of October 20, 2015. Categories of schools include public, private, charter, and approved and unapproved special education.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Public Health","Public Safety/Emergency Response","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/schools.zip",metadata_url:"https://docs.digital.mass.gov/dataset/massgis-data-massachusetts-schools-pre-k-through-high-school"},{id:"townhalls",folder:"Public Safety/Emergency Response",name:"Town Halls",description:"<p>The Town Halls layer stores the location of primary municipal executive offices in Massachusetts, including town and city halls. The Massachusetts Emergency Management Agency (MEMA) GIS Program in cooperation with the Regional Planning Agencies and participating communities developed the original version of this data layer. MassGIS revised the data using its master address database in spring 2017. Points were adjusted to fall atop building locations.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Public Health","Public Safety/Emergency Response","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/townhalls_pt.zip",metadata_url:"https://docs.digital.mass.gov/dataset/massgis-data-town-and-city-halls"},{id:"surface_water_protection",folder:"Water Resources",name:"Surface Water Protection",description:"<p>These Surface Water Supply Protection Areas delineate those areas included in 310 CMR 22.00, the Massachusetts Drinking Water Regulations, as Surface Water Supply Protection Zones: ZONEA: represents a) the land area between the surface water source and the upper boundary of the bank; b) the land area within a 400 foot lateral distance from the upper boundary of the bank of a Class A surface water source, as defined in 314 CMR 4.05(3)(a); and c) the land area within a 200 foot lateral distance from the upper boundary of the bank of a tributary or associated surface water body. ZONEB: represents the land area within one-half mile of the upper boundary of the bank of a Class A surface water source, as defined in 314 CMR 4.05(3)(a), or edge of watershed, whichever is less. Zone B always includes the land area within a 400 ft lateral distance from the upper boundary of the bank of a Class A surface water source. ZONEC: represents the land area not designated as Zone A or B within the watershed of a Class A surface water source, as defined in 314 CMR 4.05(3)(a).  All active and inactive surface water supplies have zones delineated, but some may be covered by other legislation. MassDEP protection Zones A, B, & C are in effect at MWRA sources and are subject to the protections in 310 CMR 22.00. MWRA has additional protections for their reservoirs that are included in the Massachusetts Watershed Protection Act, MGL 350 CMR 11.00. Watershed extents for all surface water supplies including active, inactive, emergency, sources outside of Massachusetts, watersheds that extend into other states and watersheds of sources from other states that extend into Massachusetts are included in the datalayer SWP Watersheds. Surface water intakes on Class B Rivers are not included in either datalayer. The reservoir features were taken from the datalayer and removed from the Zone A and B features and added as a separate feature. For MassDEP's regulatory wording of these zones please see Water Supply Protection Area Definitions..</p>",source:"Mass Department of Environmental Protection",source_url:"http://www.mass.gov/dep",sectors:["Agriculture","Forestry","Infrastructure","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/swp_zones.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/swp.html"},{id:"transmission_lines",folder:"Energy",name:"Transmission Lines",description:"<p>The U.S. Geological Survey (USGS) distributes Digital Line Graphs (DLG) from its 1:100,000-scale maps showing pipelines, transmission lines, and other miscellaneous transportation features. MassGIS assembled these data into a statewide layer consisting of all the transportation features identified by USGS other than railroads and vehicle roadways and which appear on the 1:100,000 USGS quadrangle sheets.  Although the pipelines and transmission lines appear on maps, they are not necessarily in active use. The linework is generally excellent, although MassGIS has noted that some lines are discontinuous (not perfectly edgematched) at USGS 1:100,000 quadrangle boundaries. Railroad transportation features are included in the Trains layer.</p>",source:"U.S. Geological Survey",source_url:"https://www.usgs.gov/",sectors:["Economy","Energy","Local Government","Public Safety/Emergency Response"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/order-restricted-data.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/trnslns.html"},{id:"nlcd",folder:"Land Cover",name:"National Land Cover Dataset 2016",description:"<p>NLCD 2016 is an ongoing land cover modeling production effort with NLCD scientists providing expertise in research and development, modeling, scripting, scene selection, cloud-masking, land cover mapping, and imperviousness mapping production.  The National Land Cover Database (NLCD) provides nationwide data on land cover and land cover change at a 30m resolution with a 16-class legend based on a modified Anderson Level II classification system. The database is designed to provide cyclical updates of United States land cover and associated changes. Systematically aligned over time, the database provides the ability to understand both current and historical land cover and land cover change, and enables monitoring and trend assessments. The latest evolution of NLCD products are designed for widespread application in biology, climate, education, land management, hydrology, environmental planning, risk and disease analysis, telecommunications and visualization.</p>",source:"USGS",source_url:"http://www.mrlc.gov",sectors:["Agriculture","Natural Resources/Habitats","Infrastructure"],download_url:null,metadata_url:"https://mrlc.gov/downloads/sciweb1/shared/mrlc/metadata/NLCD_2016_Land_Cover_L48.xml"},{id:"impervious_surface",folder:"Land Cover",name:"Impervious Surfaces 2016",description:"<p>NLCD 2016 is an ongoing land cover modeling production effort with NLCD scientists providing expertise in research and development, modeling, scripting, scene selection, cloud-masking, land cover mapping, and imperviousness mapping production.  The National Land Cover Database (NLCD) provides nationwide data on land cover and land cover change at a 30m resolution with a 16-class legend based on a modified Anderson Level II classification system. The database is designed to provide cyclical updates of United States land cover and associated changes. Systematically aligned over time, the database provides the ability to understand both current and historical land cover and land cover change, and enables monitoring and trend assessments. The latest evolution of NLCD products are designed for widespread application in biology, climate, education, land management, hydrology, environmental planning, risk and disease analysis, telecommunications and visualization.</p>",source:"USGS",source_url:"http://www.mrlc.gov",sectors:["Coastal Zone","Local Government","Infrastructure","Water Resources"],download_url:null,metadata_url:"https://www.mrlc.gov/downloads/sciweb1/shared/mrlc/metadata/NLCD_2016_Impervious_L48.xml"},{id:"dcr_roads_trails",folder:"Recreation",name:"DCR Roads and Trails",description:"<p>The Massachusetts Department of Conservation and Recreation (DCR) – Division of State Parks and Recreation (DSPR) Roads and Trails datalayer contains all legal roads and trails (lines and point features) identified by DCR staff and consultants on DCR DSPR properties (as well as some of the Urban Parks; eventually all trails on these properties will be integrated into this dataset). Roads and trails on private and non-DCR public land were mapped if they connected to these roads and trails and should be used with permission and should not be used if posted.</p>",source:"MA Department of Conservation and Recreation",source_url:"http://www.mass.gov/eea/agencies/dcr/",sectors:["Local Government","Recreation","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/dcrtrails.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/dcrtrails.html"},{id:"bicycle_trails",folder:"Recreation",name:"Bicycle Trails",description:"<p>This dataset, formerly named Rail Trails, was created by the Massachusetts Department of Conservation and Recreation (formerly DEM - Dept. of Environmental Management) for the purpose of regional planning and mapping. In 2002 the layer was updated and renamed Bicycle Trails. The linework in this layer represents trails which all permit bicycle travel or corridors with conversion potential; however, bicycles are not the exclusive travel mode permitted on these trails. The manager or owner of the trail should be contacted for detailed information about the permitted uses and rules of conduct that are specific to that trail. Most such corridors use, or connect to, old railway lines. The trails represented in this layer are open to bicycling as well as some combination of activities such as walking, jogging, roller blading, skiing, horse riding, snowmobiling, etc, though there are many other trails in the state that are considered multi-use but which are not included in this layer.</p>",source:"MA Department of Conservation and Recreation",source_url:"http://www.mass.gov/eea/agencies/dcr/",sectors:["Local Government","Recreation","Infrastructure"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/biketrails_arc.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/bicycle-trails.html"},{id:"wetlands",folder:"Water Resources",name:"MassDEP Wetlands",description:"<p> This layer contains polygon features delineating mapped wetland resource areas and attribute codes indicating wetland type.</p>",source:"Mass Department of Environmental Protection",source_url:"http://www.mass.gov/dep/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/wetlandsdep_poly.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/depwetlands112000.html"},{id:"boundary_towns",folder:"Boundaries",name:"Towns",description:"<p>TThe political boundary datalayer is a 1:25,000 scale datalayer containing the boundaries of the 351 communities (cities and towns) in Massachusetts. The seaward boundary of coastal communities has been defined at mean high water in this datalayer.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/towns.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/towns.html"},{id:"fire_stations",folder:"Public Safety/Emergency Response",name:"Fire Stations",description:"<p>The Fire Stations layer shows the point locations of 789 Fire stations in the Commonwealth of Massachusetts. The Massachusetts Emergency Management Agency (MEMA) GIS Program in cooperation with the Regional Planning Agencies and participating communities created the data as part of the development of Homeland Security Data Layers.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Local Government","Public Safety/Emergency Response"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/firestations_pt.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/fire-stations-.html"},{id:"police_stations",folder:"Public Safety/Emergency Response",name:"Police Stations",description:"<p>The Police Stations layer shows the point locations of law enforcement and sheriff offices in Massachusetts, covering local, county and state jurisdictions. The Massachusetts Emergency Management Agency (MEMA) GIS Program in cooperation with the Regional Planning Agencies and participating communities created the original data as part of the development of Homeland Security Data Layers. MassGIS has since incorporated updates into the data.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Local Government","Public Safety/Emergency Response"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/policestations.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/policestations.html"},{id:"land_use_2005",folder:"Land Cover",name:"Land Use 2005",description:"<p>The Land Use (2005) datalayer is a Massachusetts statewide, seamless digital dataset of land cover / land use, created using semi-automated methods, and based on 0.5 meter resolution digital ortho imagery captured in April 2005.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Water Resources"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/ftplus2005.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/lus2005.html"},{id:"land_use_2005_ag",folder:"Agriculture/Forestry",name:"Agricultural Land 2005",description:"<p><p>A subset of the 'Land Use (2005)' datalayer, this layer includes only areas classified as cranberry bog, orchard, nursery, crop land or pasture. </p><p> The Land Use (2005) datalayer is a Massachusetts statewide, seamless digital dataset of land cover / land use, created using semi-automated methods, and based on 0.5 meter resolution digital ortho imagery captured in April 2005.</p></p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Water Resources"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/ftplus2005.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/lus2005.html"},{id:"openspace_owner",folder:"Recreation",name:"Open Space by Owner",description:"<p>The protected and recreational open space datalayer contains the boundaries of conservation lands and outdoor recreational facilities in Massachusetts. The associated database contains relevant information about each parcel, including ownership, level of protection, public accessibility, assessor’s map and lot numbers, and related legal interests held on the land, including conservation restrictions. Conservation and outdoor recreational facilities owned by federal, state, county, municipal, and nonprofit enterprises are included in this datalayer. Not all lands in this layer are protected in perpetuity, though nearly all have at least some level of protection.</p>",source:"Executive Office of Energy and Environmental Affairs",source_url:"http://www.mass.gov/eea/",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/openspace.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/osp.html"},{id:"biomap_core",folder:"Natural Resources/Habitats",name:"BioMAP2",description:"<p>The Massachusetts Natural Heritage & Endangered Species Program and The Nature Conservancy’s Massachusetts Program developed BioMap2 in 2010 as a conservation plan to protect the state’s biodiversity. BioMap2 is designed to guide strategic biodiversity conservation in Massachusetts over the next decade by focusing land protection and stewardship on the areas that are most critical for ensuring the long-term persistence of rare and other native species and their habitats, exemplary natural communities, and a diversity of ecosystems.</p>",source:"The Massachusetts Natural Heritage & Endangered Species Program",source_url:"http://www.mass.gov/eea/agencies/dfg/dfw/natural-heritage/",sectors:["Agriculture","Forestry","Coastal Zone","Natural Resources/Habitats","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/biomap2.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/biomap2.html"},{id:"tax_parcels",folder:"Boundaries",name:"Tax Parcels",description:"<p>MassGIS' Level 3 Assessors’ Parcel Mapping data set, containing property (land lot) boundaries and database information from each community's assessor, was developed through a competitive procurement funded by MassGIS.  Each community in the Commonwealth was bid on by one or more vendors and the unit of work awarded was a city or town.  The specification for this work was Level 3 of the MassGIS Digital Parcel Standard.  As of October 30, 2013, standardization of assessor parcel mapping for 350 of Massachusetts' 351 cities and towns has been completed (data for Boston is not part of this project and will be processed separately). MassGIS is continuing the project, updating parcel data provided by municipalities.</p>",source:"MassGIS",source_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/",sectors:["Local Government"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/l3parcels.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/l3parcels.html"},{id:"flood_zones",folder:"Public Safety/Emergency Response",name:"Flood Zones (DFIRM)",description:"<p><p>The National Flood Hazard Layer (NFHL) dataset represents the current effective flood risk data for those parts of the country where maps have been modernized by the Federal Emergency Management Agency (FEMA). It is a compilation of effective Flood Insurance Rate Map (FIRM) databases and any Letters of Map Revision (LOMR) that have been issued against those databases since their publication date. The NFHL is updated as new data reaches its designated effective date and becomes valid for regulatory use under the National Flood Insurance Program (NFIP).</p><p>>All data included in this layer are considered 'final' by FEMA. Any preliminary or draft data that appear on maps displayed at community meetings, etc., are not included here.<br/>The FIRM Database is the digital, geospatial version of the flood hazard information (location and attributes for boundaries of flood insurance risk zones) shown on the published paper Flood Insurance Rate Maps (FIRMs). The FIRM Database depicts flood risk information and supporting data used to develop the risk data. The primary risk classifications used are the 1-percent-annual-chance flood event, the 0.2-percent-annual-chance flood event, and areas of minimal flood risk. The FIRM Database is derived from Flood Insurance Studies (FISs), previously published FIRMs, flood hazard analyses performed in support of the FISs and FIRMs, and new mapping data, where available. The FISs and FIRMs are published by FEMA.</p></p>",source:"FEMA",source_url:"http://www.fema.gov/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/nfhl.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/nfhl.html"},{id:"flood_zones_q3",folder:"Public Safety/Emergency Response",name:"Flood Zones (Q3)",description:"<p>These data represent a subset of the data available on the paper Flood Insurance Rate Maps (FIRM) as provided by the Federal Emergency Management Agency (FEMA). The Q3 flood data were developed to support floodplain management and planning activities but do not replace the official paper FIRMs. These data are not suitable for engineering applications or site work nor can the data be used to determine absolute delineation of flood boundaries. Instead the data should be used to portray zones of uncertainty and possible risks associated with flooding. All counties except Franklin are available for Massachusetts.</p>",source:"FEMA",source_url:"http://www.fema.gov/",sectors:["Agriculture","Forestry","Coastal Zone","Economy","Energy","Local Government","Natural Resources/Habitats","Public Health","Public Safety/Emergency Response","Recreation","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/FEMA_Q3_Flood.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/q3.html"},{id:"env_justice",folder:"Demographics",name:"Environmental Justice Populations",description:"<p>Environmental Justice neighborhoods are the focus of the state's Executive Office of Energy and Environmental Affairs' (EEA) Environmental Justice (EJ) Policy, which establishes EJ as an integral consideration in all EEA programs, to the extent applicable and allowable by law. For more information please visit EEA's Environmental Justice Web page, which includes a detailed fact sheet as well as text of the full policy.  Polygons in the 2010 Environmental Justice (EJ) Populations layer represent areas across the state with high minority, non-English speaking, and/or low-income populations. Data in this layer were compiled for Census 2010 block groups from the 2010 census redistricting tables and from the American Community Survey (ACS) 2006-2010 5 year estimates tables.</p>",source:"Executive Office of Energy and Environmental Affairs",source_url:"http://www.mass.gov/eea/agencies/massdep/service/justice/",sectors:["Infrastructure","Economy","Energy","Local Government","Public Health","Public Safety/Emergency Response"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/census2010/ej2010.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/cen2010ej.html"},{id:"soils",folder:"Land Cover",name:"Soils",description:"<p>The Soils datalayer has been automated from published soils surveys as provided on various media by the United States Department of Agriculture (USDA) Natural Resources Conservation Service (NRCS). All soils data released by MassGIS have been SSURGO-certified, which means they have been reviewed and approved by the NRCS and meet all standards and requirements for inclusion in the national release of county-level digital soils data. Soil survey areas are roughly based on county boundaries. The SSURGO-certified soils dataset is generally the most detailed level of soil geographic data developed by the National Cooperative Soil Survey. The information was prepared by digitizing maps, by compiling information onto a planimetric correct base and digitizing, or by revising digitized maps using remotely sensed and other information. The data include a detailed, field verified inventory of soils and miscellaneous areas that normally occur in a repeatable pattern on the landscape and that can be cartographically shown at the scale mapped. Data for survey areas were developed using various scale base maps: some areas at a 1:25,000 or 1:12,000 scale, or at larger scales where source materials (e.g. 1:5,000 MassGIS ortho imagery) were available. Details for a specific survey area are provided in the NRCS-produced metadata that are distributed with the spatial data.  The soil map units are linked to attributes in the National Soil Information System (NASIS) relational database, which gives the proportionate extent of the component soils and their properties.</p>",source:"United States Department of Agriculture (USDA) Natural Resources Conservation Service ",source_url:"http://www.nrcs.usda.gov/",sectors:["Agriculture","Forestry","Coastal Zone","Local Government","Natural Resources/Habitats","Recreation","Water Resources"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/ftpsoi.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/soi.html"},{id:"hurricane_surge",folder:"Coastal Vulnerability",name:"Hurricane Surge Inundation Zones",description:"<p>Developed to assist emergency management officials in hurricane preparedness and operations, this layer represents worst-case Hurricane Surge Inundation areas for Category 1 through 4 hurricanes striking the coast of Massachusetts. Hurricane surge values were developed by the National Hurricane Center using the PV2 basin SLOSH (Sea Lake and Overland Surge from Hurricanes) Model data.  This Surge Inundation layer was created by the U.S. Army Corps of Engineers, New England District. Using ArcInfo's Grid extension, LiDAR bare earth elevation data were subtracted from the worst-case hurricane surge values to determine which areas could be expected to be inundated.</p>",source:"National Hurricane Center",source_url:"http://www.nhc.noaa.gov/",sectors:["Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Public Safety/Emergency Response","Infrastructure","Water Resources"],download_url:null,metadata_url:"http://gisprpxy.itd.state.ma.us/arcgisserver/rest/services/MEMA/InundataionZones/MapServer"},{id:"marine_beaches",folder:"Coastal Vulnerability",name:"Marine Beaches",description:"<p>The Massachusetts Department of Public Health (MDPH), Center for Environmental Health (CEH), Environmental Toxicology Program (ETP) has developed two marine beach data layers, an arc feature class representing the linear extents of each beach, and points marking beaches' boundaries and access, sampling, and other locations. Data were collected from 7/20/2003 to 10/20/2003 for public and semi-public beaches in Massachusetts' oceanfront communities as part of the BEACH Act, as administered by the U.S. Environmental Protection Agency. The beach points (based on GPS) are accurate to within 10 meters.</p>",source:"Massachusetts Department of Public Health",source_url:"https://www.mass.gov/orgs/department-of-public-health",sectors:["Coastal Zone","Economy","Local Government","Natural Resources/Habitats","Public Safety/Emergency Response","Infrastructure","Water Resources"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/marinebeaches.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/marinebeaches.html"},{id:"wind_power",folder:"Energy",name:"Wind Power Density at 50m",description:"<p>This data layer is a vector version of the AWS Truewind, LLC, Massachusetts Technology Collaborative 50 meter elevation wind power density raster layer. The raster layer work was jointly funded by the Connecticut Clean Energy Fund, the Massachusetts Technological Collaborative, and Northeast Utilities System.  The raster data were re-classified (AWS_CLASS) in accordance with the 8 classes used by Mass. Tech et al. The data were then converted from raster to polygon using the GRIDPOLY command. The PWRDENSITY field was created to show the power density range (watts/sq. meters) for each class. The data were then transformed from WGS1984 to NAD83 SPC using NAD1983toWGS1984 transform 5 (United States) and clipped to the extent of the WINDSPEEDGRID_POLY layer created by MassGIS and AWS Truewind, LLC. Processing of this polygon layer was completed by the Massachusetts Water Resources Authority (MWRA) GIS program and provided to MassGIS for distribution.</p>",source:"Massachusetts Technology Collaborative",source_url:"http://www.masstech.org/",sectors:["Economy","Energy","Local Government"],download_url:"http://download.massgis.digital.mass.gov/shapefiles/state/windpower.zip",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/wind-power-density-at-50m.html"},{id:"prime_forest",folder:"Agriculture/Forestry",name:"Prime Forest Land",description:"<p>Using primarily the NRCS/MassGIS Soils data, the basic procedure was to classify potentially forested land into nine different categories based on potential average timber productivity of white pine and red oak “…per acre per year at culmination of mean annual increment. Site index values are at age 50.” Other data sets were used to refine this classification, including aspect, land cover, riparian, slope position, wetlands, hydrologic soil association and unique areas.  With the January 2013 update the dataset is complete statewide.</p>",source:"DCR, Bureau of Forestry, Management Forestry Program",source_url:"http://www.mass.gov/eea/agencies/dcr/conservation/forestry-and-fire-control/forestry.html",sectors:["Agriculture","Forestry","Local Government","Natural Resources/Habitats"],download_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/primeforest.html",metadata_url:"http://www.mass.gov/anf/research-and-tech/it-serv-and-support/application-serv/office-of-geographic-information-massgis/datalayers/primeforest.html"},{id:"vernal_pools",folder:"Natural Resources/Habitats",name:"Vernal Pools",description:"<p>This data layer contains points for all vernal pools that have been certified by the Natural Heritage and Endangered Species Program (NHESP) according to the Guidelines for the Certification of Vernal Pool Habitat  (MA Division of Fisheries & Wildlife, 2009).</p>",source:"Natural Heritage and Endangered Species Program (NHESP) ",source_url:"https://docs.digital.mass.gov/dataset/massgis-data-nhesp-certified-vernal-pools",sectors:["Agriculture","Forestry","Economy","Natural Resources/Habitats"],download_url:"https://giswebservices.massgis.state.ma.us/geoserver/wfs?request=GetFeature&service=wfs&version=1.0.0&typename=massgis:GISDATA.CVP_PT&outputformat=SHAPE-ZIP",metadata_url:"https://docs.digital.mass.gov/dataset/massgis-data-nhesp-certified-vernal-pools"},{id:"extreme_heat_tract",folder:"",name:"Populations Vulnerable to Extreme Heat",description:"this layer is for testing only.",source:"Nescaum",source_url:"",sectors:["Agriculture","Forestry","Economy","Natural Resources/Habitats"],download_url:null,metadata_url:null},{id:"nfhl_roads",folder:!1,name:"Major Roads in FEMA flood zones",description:"Roads intersecting FEMA 100 and 500 year flood zones.",source:"NESCAUM",source_url:"",sectors:["Agriculture","Forestry","Economy","Natural Resources/Habitats"],download_url:null,metadata_url:null},{id:"nfhl_parcels",folder:!1,name:"Tax Parcels in FEMA flood zones",description:"Parcels intersecting FEMA 100 and 500 year flood zones.",source:"NESCAUM",source_url:"",sectors:["Agriculture","Forestry","Economy","Natural Resources/Habitats"],download_url:null,metadata_url:null},{id:"vaw_towns",folder:!1,name:"Town Vulnerability",description:"",source:"NESCAUM",source_url:"",sectors:["Agriculture","Forestry","Economy","Natural Resources/Habitats"],download_url:null,metadata_url:null}],desired_active_on_load=[];
</script>

    <!-- Add all the javascript libs here -->
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/lodash.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};(function(){function n(n,t){if(n!==t){var r=null===n,e=n===b,u=n===n,o=null===t,i=t===b,f=t===t;if(n>t&&!o||!u||r&&!i&&f||e&&f)return 1;if(n<t&&!r||!f||o&&!e&&u||i&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return s(n,r);r-=1;for(var e=n.length;++r<e;)if(n[r]===t)return r;return-1}function e(n){return"function"==typeof n||!1}function u(n){return null==n?"":n+""}function o(n,t){for(var r=-1,e=n.length;++r<e&&-1<t.indexOf(n.charAt(r)););return r}function i(n,t){for(var r=n.length;r--&&-1<t.indexOf(n.charAt(r)););return r}function f(t,r){return n(t.a,r.a)||t.b-r.b}function c(n){return Nn[n]}function a(n){return Tn[n]}function l(n,t,r){return t?n=Bn[n]:r&&(n=Dn[n]),"\\"+n}function p(n){return"\\"+Dn[n]}function s(n,t,r){var e=n.length;for(t+=r?0:-1;r?t--:++t<e;){var u=n[t];if(u!==u)return t}return-1}function h(n){return!!n&&"object"==(void 0===n?"undefined":_typeof(n))}function _(n){return 160>=n&&9<=n&&13>=n||32==n||160==n||5760==n||6158==n||8192<=n&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n)}function v(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;)n[r]===t&&(n[r]=z,o[++u]=r);return o}function g(n){for(var t=-1,r=n.length;++t<r&&_(n.charCodeAt(t)););return t}function y(n){for(var t=n.length;t--&&_(n.charCodeAt(t)););return t}function d(n){return Ln[n]}function w(_){function Nn(n){if(h(n)&&!(Oo(n)||n instanceof zn)){if(n instanceof Ln)return n;if(nu.call(n,"__chain__")&&nu.call(n,"__wrapped__"))return Mr(n)}return new Ln(n)}function Tn(){}function Ln(n,t,r){this.__wrapped__=n,this.__actions__=r||[],this.__chain__=!!t}function zn(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ru,this.__views__=[]}function Bn(){this.__data__={}}function Dn(n){var t=n?n.length:0;for(this.data={hash:gu(null),set:new lu};t--;)this.push(n[t])}function Mn(n,t){var r=n.data;return("string"==typeof t||ge(t)?r.set.has(t):r.hash[t])?0:-1}function qn(n,t){var r=-1,e=n.length;for(t||(t=Be(e));++r<e;)t[r]=n[r];return t}function Pn(n,t){for(var r=-1,e=n.length;++r<e&&!1!==t(n[r],r,n););return n}function Kn(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function Vn(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;){var i=n[r];t(i,r,n)&&(o[++u]=i)}return o}function Gn(n,t){for(var r=-1,e=n.length,u=Be(e);++r<e;)u[r]=t(n[r],r,n);return u}function Jn(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function Xn(n,t,r,e){var u=-1,o=n.length;for(e&&o&&(r=n[++u]);++u<o;)r=t(r,n[u],u,n);return r}function Hn(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function Qn(n,t,r,e){return n!==b&&nu.call(e,r)?n:t}function nt(n,t,r){for(var e=-1,u=zo(t),o=u.length;++e<o;){var i=u[e],f=n[i],c=r(f,t[i],i,n,t);(c===c?c===f:f!==f)&&(f!==b||i in n)||(n[i]=c)}return n}function tt(n,t){return null==t?n:et(t,zo(t),n)}function rt(n,t){for(var r=-1,e=null==n,u=!e&&Er(n),o=u?n.length:0,i=t.length,f=Be(i);++r<i;){var c=t[r];f[r]=u?Cr(c,o)?n[c]:b:e?b:n[c]}return f}function et(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var o=t[e];r[o]=n[o]}return r}function ut(n,t,r){var e=void 0===n?"undefined":_typeof(n);return"function"==e?t===b?n:Bt(n,t,r):null==n?Fe:"object"==e?xt(n):t===b?ze(n):mt(n,t)}function ot(n,t,r,e,u,o,i){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==b)return f;if(!ge(n))return n;if(e=Oo(n)){if(f=kr(n),!t)return qn(n,f)}else{var c=ru.call(n),a=c==K;if(c!=Z&&c!=B&&(!a||u))return Fn[c]?Rr(n,c,t):u?n:{};if(f=Ir(a?{}:n),!t)return tt(f,n)}for(o||(o=[]),i||(i=[]),u=o.length;u--;)if(o[u]==n)return i[u];return o.push(n),i.push(f),(e?Pn:_t)(n,function(e,u){f[u]=ot(e,t,r,u,n,o,i)}),f}function it(n,t,r){if("function"!=typeof n)throw new Ge(L);return pu(function(){n.apply(b,r)},t)}function ft(n,t){var e=n?n.length:0,u=[];if(!e)return u;var o=-1,i=mr(),f=i===r,c=f&&t.length>=F&&gu&&lu?new Dn(t):null,a=t.length;c&&(i=Mn,f=!1,t=c);n:for(;++o<e;)if(c=n[o],f&&c===c){for(var l=a;l--;)if(t[l]===c)continue n;u.push(c)}else 0>i(t,c,0)&&u.push(c);return u}function ct(n,t){var r=!0;return $u(n,function(n,e,u){return r=!!t(n,e,u)}),r}function at(n,t,r,e){var u=e,o=u;return $u(n,function(n,i,f){i=+t(n,i,f),(r(i,u)||i===e&&i===o)&&(u=i,o=n)}),o}function lt(n,t){var r=[];return $u(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function pt(n,t,r,e){var u;return r(n,function(n,r,o){return t(n,r,o)?(u=e?r:n,!1):void 0}),u}function st(n,t,r,e){e||(e=[]);for(var u=-1,o=n.length;++u<o;){var i=n[u];h(i)&&Er(i)&&(r||Oo(i)||se(i))?t?st(i,t,r,e):Jn(e,i):r||(e[e.length]=i)}return e}function ht(n,t){Nu(n,t,Re)}function _t(n,t){return Nu(n,t,zo)}function vt(n,t){return Tu(n,t,zo)}function gt(n,t){for(var r=-1,e=t.length,u=-1,o=[];++r<e;){var i=t[r];ve(n[i])&&(o[++u]=i)}return o}function yt(n,t,r){if(null!=n){r!==b&&r in Br(n)&&(t=[r]),r=0;for(var e=t.length;null!=n&&r<e;)n=n[t[r++]];return r&&r==e?n:b}}function dt(n,t,r,e,u,o){if(n===t)n=!0;else if(null==n||null==t||!ge(n)&&!h(t))n=n!==n&&t!==t;else n:{var i=dt,f=Oo(n),c=Oo(t),a=D,l=D;f||(a=ru.call(n),a==B?a=Z:a!=Z&&(f=me(n))),c||(l=ru.call(t),l==B?l=Z:l!=Z&&me(t));var p=a==Z,c=l==Z;if(!(l=a==l)||f||p){if(!e&&(a=p&&nu.call(n,"__wrapped__"),c=c&&nu.call(t,"__wrapped__"),a||c)){n=i(a?n.value():n,c?t.value():t,r,e,u,o);break n}if(l){for(u||(u=[]),o||(o=[]),a=u.length;a--;)if(u[a]==n){n=o[a]==t;break n}u.push(n),o.push(t),n=(f?yr:wr)(n,t,i,r,e,u,o),u.pop(),o.pop()}else n=!1}else n=dr(n,t,a)}return n}function wt(n,t,r){var e=t.length,u=e,o=!r;if(null==n)return!u;for(n=Br(n);e--;){var i=t[e];if(o&&i[2]?i[1]!==n[i[0]]:!(i[0]in n))return!1}for(;++e<u;){var f=(i=t[e])[0],c=n[f],a=i[1];if(o&&i[2]){if(c===b&&!(f in n))return!1}else if(i=r?r(c,a,f):b,i===b?!dt(a,c,r,!0):!i)return!1}return!0}function bt(n,t){var r=-1,e=Er(n)?Be(n.length):[];return $u(n,function(n,u,o){e[++r]=t(n,u,o)}),e}function xt(n){var t=Ar(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null!=n&&(n[r]===e&&(e!==b||r in Br(n)))}}return function(n){return wt(n,t)}}function mt(n,t){var r=Oo(n),e=Ur(n)&&t===t&&!ge(t),u=n+"";return n=Dr(n),function(o){if(null==o)return!1;var i=u;if(o=Br(o),!(!r&&e||i in o)){if(null==(o=1==n.length?o:yt(o,Et(n,0,-1))))return!1;i=Zr(n),o=Br(o)}return o[i]===t?t!==b||i in o:dt(t,o[i],b,!0)}}function At(n,t,r,e,u){if(!ge(n))return n;var o=Er(t)&&(Oo(t)||me(t)),i=o?b:zo(t);return Pn(i||t,function(f,c){if(i&&(c=f,f=t[c]),h(f)){e||(e=[]),u||(u=[]);n:{for(var a=c,l=e,p=u,s=l.length,_=t[a];s--;)if(l[s]==_){n[a]=p[s];break n}var s=n[a],v=r?r(s,_,a,n,t):b,g=v===b;g&&(v=_,Er(_)&&(Oo(_)||me(_))?v=Oo(s)?s:Er(s)?qn(s):[]:we(_)||se(_)?v=se(s)?ke(s):we(s)?s:{}:g=!1),l.push(_),p.push(v),g?n[a]=At(v,_,r,l,p):(v===v?v!==s:s===s)&&(n[a]=v)}}else a=n[c],l=r?r(a,f,c,n,t):b,(p=l===b)&&(l=f),l===b&&(!o||c in n)||!p&&(l===l?l===a:a!==a)||(n[c]=l)}),n}function jt(n){return function(t){return null==t?b:t[n]}}function kt(n){var t=n+"";return n=Dr(n),function(r){return yt(r,n,t)}}function It(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Cr(e)){var u=e;su.call(n,e,1)}}}function Rt(n,t){return n+yu(ku()*(t-n+1))}function Ot(n,t,r,e,u){return u(n,function(n,u,o){r=e?(e=!1,n):t(r,n,u,o)}),r}function Et(n,t,r){var e=-1,u=n.length;for(0>(t=null==t?0:+t||0)&&(t=-t>u?0:u+t),0>(r=r===b||r>u?u:+r||0)&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Be(u);++e<u;)r[e]=n[e+t];return r}function Ct(n,t){var r;return $u(n,function(n,e,u){return!(r=t(n,e,u))}),!!r}function St(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function Ut(t,r,e){var u=br(),o=-1;return r=Gn(r,function(n){return u(n)}),t=bt(t,function(n){return{a:Gn(r,function(t){return t(n)}),b:++o,c:n}}),St(t,function(t,r){var u;n:{for(var o=-1,i=t.a,f=r.a,c=i.length,a=e.length;++o<c;)if(u=n(i[o],f[o])){if(o>=a)break n;u*="asc"===(o=e[o])||!0===o?1:-1;break n}u=t.b-r.b}return u})}function Wt(n,t){var r=0;return $u(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function $t(n,t){var e=-1,u=mr(),o=n.length,i=u===r,f=i&&o>=F,c=f&&gu&&lu?new Dn(void 0):null,a=[];c?(u=Mn,i=!1):(f=!1,c=t?[]:a);n:for(;++e<o;){var l=n[e],p=t?t(l,e,n):l;if(i&&l===l){for(var s=c.length;s--;)if(c[s]===p)continue n;t&&c.push(p),a.push(l)}else 0>u(c,p,0)&&((t||f)&&c.push(p),a.push(l))}return a}function Ft(n,t){for(var r=-1,e=t.length,u=Be(e);++r<e;)u[r]=n[t[r]];return u}function Nt(n,t,r,e){for(var u=n.length,o=e?u:-1;(e?o--:++o<u)&&t(n[o],o,n););return r?Et(n,e?0:o,e?o+1:u):Et(n,e?o+1:0,e?u:o)}function Tt(n,t){(o=n)instanceof zn&&(o=o.value());for(var r=-1,e=t.length;++r<e;)var u=t[r],o=u.func.apply(u.thisArg,Jn([o],u.args));return o}function Lt(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&u<=Eu){for(;e<u;){var o=e+u>>>1,i=n[o];(r?i<=t:i<t)&&null!==i?e=o+1:u=o}return u}return zt(n,t,Fe,r)}function zt(n,t,r,e){t=r(t);for(var u=0,o=n?n.length:0,i=t!==t,f=null===t,c=t===b;u<o;){var a=yu((u+o)/2),l=r(n[a]),p=l!==b,s=l===l;(i?s||e:f?s&&p&&(e||null!=l):c?s&&(e||p):null==l?0:e?l<=t:l<t)?u=a+1:o=a}return mu(o,Ou)}function Bt(n,t,r){if("function"!=typeof n)return Fe;if(t===b)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,o){return n.call(t,r,e,u,o)};case 5:return function(r,e,u,o,i){return n.call(t,r,e,u,o,i)}}return function(){return n.apply(t,arguments)}}function Dt(n){var t=new ou(n.byteLength);return new hu(t).set(new hu(n)),t}function Mt(n,t,r){for(var e=r.length,u=-1,o=xu(n.length-e,0),i=-1,f=t.length,c=Be(f+o);++i<f;)c[i]=t[i];for(;++u<e;)c[r[u]]=n[u];for(;o--;)c[i++]=n[u++];return c}function qt(n,t,r){for(var e=-1,u=r.length,o=-1,i=xu(n.length-u,0),f=-1,c=t.length,a=Be(i+c);++o<i;)a[o]=n[o];for(i=o;++f<c;)a[i+f]=t[f];for(;++e<u;)a[i+r[e]]=n[o++];return a}function Pt(n,t){return function(r,e,u){var o=t?t():{};if(e=br(e,u,3),Oo(r)){u=-1;for(var i=r.length;++u<i;){var f=r[u];n(o,f,e(f,u,r),r)}}else $u(r,function(t,r,u){n(o,t,e(t,r,u),u)});return o}}function Kt(n){return le(function(t,r){var e=-1,u=null==t?0:r.length,o=2<u?r[u-2]:b,i=2<u?r[2]:b,f=1<u?r[u-1]:b;for("function"==typeof o?(o=Bt(o,f,5),u-=2):(o="function"==typeof f?f:b,u-=o?1:0),i&&Sr(r[0],r[1],i)&&(o=3>u?b:o,u=1);++e<u;)(i=r[e])&&n(t,i,o);return t})}function Vt(n,t){return function(r,e){var u=r?Bu(r):0;if(!$r(u))return n(r,e);for(var o=t?u:-1,i=Br(r);(t?o--:++o<u)&&!1!==e(i[o],o,i););return r}}function Zt(n){return function(t,r,e){for(var u=Br(t),o=(e=e(t)).length,i=n?o:-1;n?i--:++i<o;){var f=e[i];if(!1===r(u[f],f,u))break}return t}}function Yt(n,t){function r(){return(this&&this!==Zn&&this instanceof r?e:n).apply(t,arguments)}var e=Jt(n);return r}function Gt(n){return function(t){for(var r=-1,e=(t=We(Ce(t))).length,u="";++r<e;)u=n(u,t[r],r);return u}}function Jt(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Wu(n.prototype);return ge(t=n.apply(r,t))?t:r}}function Xt(n){function t(r,e,u){return u&&Sr(r,e,u)&&(e=b),r=gr(r,n,b,b,b,b,b,e),r.placeholder=t.placeholder,r}return t}function Ht(n,t){return le(function(r){var e=r[0];return null==e?e:(r.push(t),n.apply(b,r))})}function Qt(n,t){return function(r,e,u){if(u&&Sr(r,e,u)&&(e=b),1==(e=br(e,u,3)).length){for(var o=e,i=-1,f=(u=r=Oo(r)?r:zr(r)).length,c=t,a=c;++i<f;){var l=u[i],p=+o(l);n(p,c)&&(c=p,a=l)}if(u=a,!r.length||u!==t)return u}return at(r,e,n,t)}}function nr(n,r){return function(e,u,o){return u=br(u,o,3),Oo(e)?(u=t(e,u,r),-1<u?e[u]:b):pt(e,u,n)}}function tr(n){return function(r,e,u){return r&&r.length?(e=br(e,u,3),t(r,e,n)):-1}}function rr(n){return function(t,r,e){return r=br(r,e,3),pt(t,r,n,!0)}}function er(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,o=Be(r);n?e--:++e<r;){if("function"!=typeof(i=o[u++]=arguments[e]))throw new Ge(L);!t&&Ln.prototype.thru&&"wrapper"==xr(i)&&(t=new Ln([],!0))}for(e=t?-1:r;++e<r;){var i=o[e],f="wrapper"==(u=xr(i))?zu(i):b;t=f&&Wr(f[0])&&f[1]==(E|k|R|C)&&!f[4].length&&1==f[9]?t[xr(f[0])].apply(t,f[3]):1==i.length&&Wr(i)?t[u]():t.thru(i)}return function(){var n=(u=arguments)[0];if(t&&1==u.length&&Oo(n)&&n.length>=F)return t.plant(n).value();for(var e=0,u=r?o[e].apply(this,u):n;++e<r;)u=o[e].call(this,u);return u}}}function ur(n,t){return function(r,e,u){return"function"==typeof e&&u===b&&Oo(r)?n(r,e):t(r,Bt(e,u,3))}}function or(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=Bt(r,e,3)),n(t,r,Re)}}function ir(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=Bt(r,e,3)),n(t,r)}}function fr(n){return function(t,r,e){var u={};return r=br(r,e,3),_t(t,function(t,e,o){o=r(t,e,o),e=n?o:e,t=n?t:o,u[e]=t}),u}}function cr(n){return function(t,r,e){return t=u(t),(n?t:"")+sr(t,r,e)+(n?"":t)}}function ar(n){var t=le(function(r,e){var u=v(e,t.placeholder);return gr(r,n,b,e,u)});return t}function lr(n,t){return function(r,e,u,o){var i=3>arguments.length;return"function"==typeof e&&o===b&&Oo(r)?n(r,e,u,i):Ot(r,br(e,o,4),u,i,t)}}function pr(n,t,r,e,u,o,i,f,c,a){function l(){for(var w=k=arguments.length,x=Be(k);w--;)x[w]=arguments[w];if(e&&(x=Mt(x,e,u)),o&&(x=qt(x,o,i)),(_||y)&&(k=k-(E=v(x,w=l.placeholder)).length)<a){var j=f?qn(f):b,k=xu(a-k,0),I=_?E:b,E=_?b:E,C=_?x:b,x=_?b:x;return t|=_?R:O,t&=~(_?O:R),g||(t&=~(m|A)),x=[n,t,r,C,I,x,E,j,c,k],j=pr.apply(b,x),Wr(n)&&Du(j,x),j.placeholder=w,j}if(w=s?r:this,j=h?w[n]:n,f)for(k=x.length,I=mu(f.length,k),E=qn(x);I--;)C=f[I],x[I]=Cr(C,k)?E[C]:b;return p&&c<x.length&&(x.length=c),this&&this!==Zn&&this instanceof l&&(j=d||Jt(n)),j.apply(w,x)}var p=t&E,s=t&m,h=t&A,_=t&k,g=t&j,y=t&I,d=h?b:Jt(n);return l}function sr(n,t,r){return n=n.length,t=+t,n<t&&wu(t)?(t-=n,r=null==r?" ":r+"",Se(r,vu(t/r.length)).slice(0,t)):""}function hr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,c=-1,a=e.length,l=Be(a+f);++c<a;)l[c]=e[c];for(;f--;)l[c++]=arguments[++t];return(this&&this!==Zn&&this instanceof u?i:n).apply(o?r:this,l)}var o=t&m,i=Jt(n);return u}function _r(n){var t=Pe[n];return function(n,r){return(r=r===b?0:+r||0)?(r=cu(10,r),t(n*r)/r):t(n)}}function vr(n){return function(t,r,e,u){var o=br(e);return null==e&&o===ut?Lt(t,r,n):zt(t,r,o(e,u,1),n)}}function gr(n,t,r,e,u,o,i,f){var c=t&A;if(!c&&"function"!=typeof n)throw new Ge(L);var a=e?e.length:0;if(a||(t&=~(R|O),e=u=b),a-=u?u.length:0,t&O){var l=e,p=u;e=u=b}var s=c?b:zu(n);return r=[n,t,r,e,u,l,p,o,i,f],s&&(e=r[1],t=s[1],f=e|t,u=t==E&&e==k||t==E&&e==C&&r[7].length<=s[8]||t==(E|C)&&e==k,(f<E||u)&&(t&m&&(r[2]=s[2],f|=e&m?0:j),(e=s[3])&&(u=r[3],r[3]=u?Mt(u,e,s[4]):qn(e),r[4]=u?v(r[3],z):qn(s[4])),(e=s[5])&&(u=r[5],r[5]=u?qt(u,e,s[6]):qn(e),r[6]=u?v(r[5],z):qn(s[6])),(e=s[7])&&(r[7]=qn(e)),t&E&&(r[8]=null==r[8]?s[8]:mu(r[8],s[8])),null==r[9]&&(r[9]=s[9]),r[0]=s[0],r[1]=f),t=r[1],f=r[9]),r[9]=null==f?c?0:n.length:xu(f-a,0)||0,(s?Lu:Du)(t==m?Yt(r[0],r[2]):t!=R&&t!=(m|R)||r[4].length?pr.apply(b,r):hr.apply(b,r),r)}function yr(n,t,r,e,u,o,i){var f=-1,c=n.length;if(c!=(l=t.length)&&(!u||l<=c))return!1;for(;++f<c;){var a=n[f],l=t[f],p=e?e(u?l:a,u?a:l,f):b;if(p!==b){if(p)continue;return!1}if(u){if(!Hn(t,function(n){return a===n||r(a,n,e,u,o,i)}))return!1}else if(a!==l&&!r(a,l,e,u,o,i))return!1}return!0}function dr(n,t,r){switch(r){case M:case q:return+n==+t;case P:return n.name==t.name&&n.message==t.message;case V:return n!=+n?t!=+t:n==+t;case Y:case G:return n==t+""}return!1}function wr(n,t,r,e,u,o,i){var f=zo(n),c=f.length,a=zo(t).length;if(c!=a&&!u)return!1;for(a=c;a--;){var l=f[a];if(!(u?l in t:nu.call(t,l)))return!1}for(var p=u;++a<c;){var s=n[l=f[a]],h=t[l],_=e?e(u?h:s,u?s:h,l):b;if(_===b?!r(s,h,e,u,o,i):!_)return!1;p||(p="constructor"==l)}return!(!p&&(r=n.constructor,e=t.constructor,r!=e&&"constructor"in n&&"constructor"in t&&!("function"==typeof r&&r instanceof r&&"function"==typeof e&&e instanceof e)))}function br(n,t,r){var e=(e=Nn.callback||$e)===$e?ut:e;return r?e(n,t,r):e}function xr(n){for(var t=n.name+"",r=Uu[t],e=r?r.length:0;e--;){var u=r[e],o=u.func;if(null==o||o==n)return u.name}return t}function mr(n,t,e){var u=(u=Nn.indexOf||Vr)===Vr?r:u;return n?u(n,t,e):u}function Ar(n){for(var t=(n=Oe(n)).length;t--;){var r=n[t][1];n[t][2]=r===r&&!ge(r)}return n}function jr(n,t){var r=null==n?b:n[t];return ye(r)?r:b}function kr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&nu.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Ir(n){return"function"==typeof(n=n.constructor)&&n instanceof n||(n=Ve),new n}function Rr(n,t,r){var e=n.constructor;switch(t){case J:return Dt(n);case M:case q:return new e(+n);case X:case H:case Q:case nn:case tn:case rn:case en:case un:case on:return t=n.buffer,new e(r?Dt(t):t,n.byteOffset,n.length);case V:case G:return new e(n);case Y:var u=new e(n.source,kn.exec(n));u.lastIndex=n.lastIndex}return u}function Or(n,t,r){return null==n||Ur(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),t=Zr(t)),t=null==n?n:n[t],null==t?b:t.apply(n,r)}function Er(n){return null!=n&&$r(Bu(n))}function Cr(n,t){return n="number"==typeof n||On.test(n)?+n:-1,t=null==t?Cu:t,-1<n&&0==n%1&&n<t}function Sr(n,t,r){if(!ge(r))return!1;var e=void 0===t?"undefined":_typeof(t);return!!("number"==e?Er(r)&&Cr(t,r.length):"string"==e&&t in r)&&(t=r[t],n===n?n===t:t!==t)}function Ur(n,t){var r=void 0===n?"undefined":_typeof(n);return!!("string"==r&&dn.test(n)||"number"==r)||!Oo(n)&&(!yn.test(n)||null!=t&&n in Br(t))}function Wr(n){var t=xr(n),r=Nn[t];return"function"==typeof r&&t in zn.prototype&&(n===r||!!(t=zu(r))&&n===t[0])}function $r(n){return"number"==typeof n&&-1<n&&0==n%1&&n<=Cu}function Fr(n,t){return n===b?t:Eo(n,t,Fr)}function Nr(n,t){n=Br(n);for(var r=-1,e=t.length,u={};++r<e;){var o=t[r];o in n&&(u[o]=n[o])}return u}function Tr(n,t){var r={};return ht(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function Lr(n){for(var t=Re(n),r=t.length,e=r&&n.length,u=!!e&&$r(e)&&(Oo(n)||se(n)),o=-1,i=[];++o<r;){var f=t[o];(u&&Cr(f,e)||nu.call(n,f))&&i.push(f)}return i}function zr(n){return null==n?[]:Er(n)?ge(n)?n:Ve(n):Ee(n)}function Br(n){return ge(n)?n:Ve(n)}function Dr(n){if(Oo(n))return n;var t=[];return u(n).replace(wn,function(n,r,e,u){t.push(e?u.replace(An,"$1"):r||n)}),t}function Mr(n){return n instanceof zn?n.clone():new Ln(n.__wrapped__,n.__chain__,qn(n.__actions__))}function qr(n,t,r){return n&&n.length?((r?Sr(n,t,r):null==t)&&(t=1),Et(n,0>t?0:t)):[]}function Pr(n,t,r){var e=n?n.length:0;return e?((r?Sr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0,0>t?0:t)):[]}function Kr(n){return n?n[0]:b}function Vr(n,t,e){var u=n?n.length:0;if(!u)return-1;if("number"==typeof e)e=0>e?xu(u+e,0):e;else if(e)return e=Lt(n,t),e<u&&(t===t?t===n[e]:n[e]!==n[e])?e:-1;return r(n,t,e||0)}function Zr(n){var t=n?n.length:0;return t?n[t-1]:b}function Yr(n){return qr(n,1)}function Gr(n,t,e,u){if(!n||!n.length)return[];null!=t&&"boolean"!=typeof t&&(u=e,e=Sr(n,t,u)?b:t,t=!1);i=br();if((null!=e||i!==ut)&&(e=i(e,u,3)),t&&mr()===r){t=e;var o;e=-1,u=n.length;for(var i=-1,f=[];++e<u;){var c=n[e],a=t?t(c,e,n):c;e&&o===a||(o=a,f[++i]=c)}n=f}else n=$t(n,e);return n}function Jr(n){if(!n||!n.length)return[];var t=-1,r=0;n=Vn(n,function(n){return Er(n)?(r=xu(n.length,r),!0):void 0});for(var e=Be(r);++t<r;)e[t]=Gn(n,jt(t));return e}function Xr(n,t,r){return n&&n.length?(n=Jr(n),null==t?n:(t=Bt(t,r,4),Gn(n,function(n){return Xn(n,t,b,!0)}))):[]}function Hr(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Oo(n[0])||(t=[]);++r<e;){var o=n[r];t?u[o]=t[r]:o&&(u[o[0]]=o[1])}return u}function Qr(n){return n=Nn(n),n.__chain__=!0,n}function ne(n,t,r){return t.call(r,n)}function te(n,t,r){var e=Oo(n)?Kn:ct;return r&&Sr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=br(t,r,3)),e(n,t)}function re(n,t,r){var e=Oo(n)?Vn:lt;return t=br(t,r,3),e(n,t)}function ee(n,t,r,e){var u=n?Bu(n):0;return $r(u)||(n=Ee(n),u=n.length),r="number"!=typeof r||e&&Sr(t,r,e)?0:0>r?xu(u+r,0):r||0,"string"==typeof n||!Oo(n)&&xe(n)?r<=u&&-1<n.indexOf(t,r):!!u&&-1<mr(n,t,r)}function ue(n,t,r){var e=Oo(n)?Gn:bt;return t=br(t,r,3),e(n,t)}function oe(n,t,r){if(r?Sr(n,t,r):null==t)return 0<(e=(n=zr(n)).length)?n[Rt(0,e-1)]:b;r=-1;var e=(n=je(n)).length,u=e-1;for(t=mu(0>t?0:+t||0,e);++r<t;){var o=n[e=Rt(r,u)];n[e]=n[r],n[r]=o}return n.length=t,n}function ie(n,t,r){var e=Oo(n)?Hn:Ct;return r&&Sr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=br(t,r,3)),e(n,t)}function fe(n,t){var r;if("function"!=typeof t){if("function"!=typeof n)throw new Ge(L);var e=n;n=t,t=e}return function(){return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=b),r}}function ce(n,t,r){function e(t,r){r&&iu(r),c=s=h=b,t&&(_=ho(),a=n.apply(p,f),s||c||(f=p=b))}function u(){var n=t-(ho()-l);0>=n||n>t?e(h,c):s=pu(u,n)}function o(){e(g,s)}function i(){if(f=arguments,l=ho(),p=this,h=g&&(s||!y),!1===v)var r=y&&!s;else{c||y||(_=l);var e=v-(l-_),i=0>=e||e>v;i?(c&&(c=iu(c)),_=l,a=n.apply(p,f)):c||(c=pu(o,e))}return i&&s?s=iu(s):s||t===v||(s=pu(u,t)),r&&(i=!0,a=n.apply(p,f)),!i||s||c||(f=p=b),a}var f,c,a,l,p,s,h,_=0,v=!1,g=!0;if("function"!=typeof n)throw new Ge(L);if(t=0>t?0:+t||0,!0===r)var y=!0,g=!1;else ge(r)&&(y=!!r.leading,v="maxWait"in r&&xu(+r.maxWait||0,t),g="trailing"in r?!!r.trailing:g);return i.cancel=function(){s&&iu(s),c&&iu(c),_=0,c=s=h=b},i}function ae(n,t){function r(){var e=arguments,u=t?t.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=n.apply(this,e),r.cache=o.set(u,e),e)}if("function"!=typeof n||t&&"function"!=typeof t)throw new Ge(L);return r.cache=new ae.Cache,r}function le(n,t){if("function"!=typeof n)throw new Ge(L);return t=xu(t===b?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=xu(r.length-t,0),o=Be(u);++e<u;)o[e]=r[t+e];switch(t){case 0:return n.call(this,o);case 1:return n.call(this,r[0],o);case 2:return n.call(this,r[0],r[1],o)}for(u=Be(t+1),e=-1;++e<t;)u[e]=r[e];return u[t]=o,n.apply(this,u)}}function pe(n,t){return n>t}function se(n){return h(n)&&Er(n)&&nu.call(n,"callee")&&!au.call(n,"callee")}function he(n,t,r,e){return e=(r="function"==typeof r?Bt(r,e,3):b)?r(n,t):b,e===b?dt(n,t,r):!!e}function _e(n){return h(n)&&"string"==typeof n.message&&ru.call(n)==P}function ve(n){return ge(n)&&ru.call(n)==K}function ge(n){var t=void 0===n?"undefined":_typeof(n);return!!n&&("object"==t||"function"==t)}function ye(n){return null!=n&&(ve(n)?uu.test(Qe.call(n)):h(n)&&Rn.test(n))}function de(n){return"number"==typeof n||h(n)&&ru.call(n)==V}function we(n){var t;if(!h(n)||ru.call(n)!=Z||se(n)||!(nu.call(n,"constructor")||"function"!=typeof(t=n.constructor)||t instanceof t))return!1;var r;return ht(n,function(n,t){r=t}),r===b||nu.call(n,r)}function be(n){return ge(n)&&ru.call(n)==Y}function xe(n){return"string"==typeof n||h(n)&&ru.call(n)==G}function me(n){return h(n)&&$r(n.length)&&!!$n[ru.call(n)]}function Ae(n,t){return n<t}function je(n){var t=n?Bu(n):0;return $r(t)?t?qn(n):[]:Ee(n)}function ke(n){return et(n,Re(n))}function Ie(n){return gt(n,Re(n))}function Re(n){if(null==n)return[];ge(n)||(n=Ve(n));for(var t=(t=n.length)&&$r(t)&&(Oo(n)||se(n))&&t||0,r=-1,e="function"==typeof(e=n.constructor)&&e.prototype===n,u=Be(t),o=0<t;++r<t;)u[r]=r+"";for(var i in n)o&&Cr(i,t)||"constructor"==i&&(e||!nu.call(n,i))||u.push(i);return u}function Oe(n){n=Br(n);for(var t=-1,r=zo(n),e=r.length,u=Be(e);++t<e;){var o=r[t];u[t]=[o,n[o]]}return u}function Ee(n){return Ft(n,zo(n))}function Ce(n){return(n=u(n))&&n.replace(En,c).replace(mn,"")}function Se(n,t){var r="";if(n=u(n),1>(t=+t)||!n||!wu(t))return r;do{t%2&&(r+=n),t=yu(t/2),n+=n}while(t);return r}function Ue(n,t,r){var e=n;return(n=u(n))?(r?Sr(e,t,r):null==t)?n.slice(g(n),y(n)+1):(t+="",n.slice(o(n,t),i(n,t)+1)):n}function We(n,t,r){return r&&Sr(n,t,r)&&(t=b),(n=u(n)).match(t||Un)||[]}function $e(n,t,r){return r&&Sr(n,t,r)&&(t=b),h(n)?Ne(n):ut(n,t)}function Fe(n){return n}function Ne(n){return xt(ot(n,!0))}function Te(n,t,r){if(null==r){var e=(o=ge(t))?zo(t):b;((e=e&&e.length?gt(t,e):b)?e.length:o)||(e=!1,r=t,t=n,n=this)}e||(e=gt(t,zo(t)));var u=!0,o=-1,i=ve(n),f=e.length;!1===r?u=!1:ge(r)&&"chain"in r&&(u=r.chain);for(;++o<f;){var c=t[r=e[o]];n[r]=c,i&&(n.prototype[r]=function(t){return function(){var r=this.__chain__;if(u||r){var e=n(this.__wrapped__);return(e.__actions__=qn(this.__actions__)).push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return t.apply(n,Jn([this.value()],arguments))}}(c))}return n}function Le(){}function ze(n){return Ur(n)?jt(n):kt(n)}var Be=(_=_?Yn.defaults(Zn.Object(),_,Yn.pick(Zn,Wn)):Zn).Array,De=_.Date,Me=_.Error,qe=_.Function,Pe=_.Math,Ke=_.Number,Ve=_.Object,Ze=_.RegExp,Ye=_.String,Ge=_.TypeError,Je=Be.prototype,Xe=Ve.prototype,He=Ye.prototype,Qe=qe.prototype.toString,nu=Xe.hasOwnProperty,tu=0,ru=Xe.toString,eu=Zn._,uu=Ze("^"+Qe.call(nu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ou=_.ArrayBuffer,iu=_.clearTimeout,fu=_.parseFloat,cu=Pe.pow,au=Xe.propertyIsEnumerable,lu=jr(_,"Set"),pu=_.setTimeout,su=Je.splice,hu=_.Uint8Array,_u=jr(_,"WeakMap"),vu=Pe.ceil,gu=jr(Ve,"create"),yu=Pe.floor,du=jr(Be,"isArray"),wu=_.isFinite,bu=jr(Ve,"keys"),xu=Pe.max,mu=Pe.min,Au=jr(De,"now"),ju=_.parseInt,ku=Pe.random,Iu=Ke.NEGATIVE_INFINITY,Ru=Ke.POSITIVE_INFINITY,Ou=4294967294,Eu=2147483647,Cu=9007199254740991,Su=_u&&new _u,Uu={};Nn.support={},Nn.templateSettings={escape:_n,evaluate:vn,interpolate:gn,variable:"",imports:{_:Nn}};var Wu=function(){function n(){}return function(t){if(ge(t)){n.prototype=t;var r=new n;n.prototype=b}return r||{}}}(),$u=Vt(_t),Fu=Vt(vt,!0),Nu=Zt(),Tu=Zt(!0),Lu=Su?function(n,t){return Su.set(n,t),n}:Fe,zu=Su?function(n){return Su.get(n)}:Le,Bu=jt("length"),Du=function(){var n=0,t=0;return function(r,e){var u=ho(),o=$-(u-t);if(t=u,0<o){if(++n>=W)return r}else n=0;return Lu(r,e)}}(),Mu=le(function(n,t){return h(n)&&Er(n)?ft(n,st(t,!1,!0)):[]}),qu=tr(),Pu=tr(!0),Ku=le(function(n){for(var t=n.length,e=t,u=Be(l),o=mr(),i=o===r,f=[];e--;){var c=n[e]=Er(c=n[e])?c:[];u[e]=i&&120<=c.length&&gu&&lu?new Dn(e&&c):null}var a=-1,l=(i=n[0])?i.length:0,p=u[0];n:for(;++a<l;)if(c=i[a],0>(p?Mn(p,c):o(f,c,0))){for(e=t;--e;){var s=u[e];if(0>(s?Mn(s,c):o(n[e],c,0)))continue n}p&&p.push(c),f.push(c)}return f}),Vu=le(function(t,r){var e=rt(t,r=st(r));return It(t,r.sort(n)),e}),Zu=vr(),Yu=vr(!0),Gu=le(function(n){return $t(st(n,!1,!0))}),Ju=le(function(n,t){return Er(n)?ft(n,t):[]}),Xu=le(Jr),Hu=le(function(n){var t=n.length,r=2<t?n[t-2]:b,e=1<t?n[t-1]:b;return 2<t&&"function"==typeof r?t-=2:(r=1<t&&"function"==typeof e?(--t,e):b,e=b),n.length=t,Xr(n,r,e)}),Qu=le(function(n){return n=st(n),this.thru(function(t){t=Oo(t)?t:[Br(t)];for(var r=n,e=-1,u=t.length,o=-1,i=r.length,f=Be(u+i);++e<u;)f[e]=t[e];for(;++o<i;)f[e++]=r[o];return f})}),no=le(function(n,t){return rt(n,st(t))}),to=Pt(function(n,t,r){nu.call(n,r)?++n[r]:n[r]=1}),ro=nr($u),eo=nr(Fu,!0),uo=ur(Pn,$u),oo=ur(function(n,t){for(var r=n.length;r--&&!1!==t(n[r],r,n););return n},Fu),io=Pt(function(n,t,r){nu.call(n,r)?n[r].push(t):n[r]=[t]}),fo=Pt(function(n,t,r){n[r]=t}),co=le(function(n,t,r){var e=-1,u="function"==typeof t,o=Ur(t),i=Er(n)?Be(n.length):[];return $u(n,function(n){var f=u?t:o&&null!=n?n[t]:b;i[++e]=f?f.apply(n,r):Or(n,t,r)}),i}),ao=Pt(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),lo=lr(Xn,$u),po=lr(function(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r},Fu),so=le(function(n,t){if(null==n)return[];var r=t[2];return r&&Sr(t[0],t[1],r)&&(t.length=1),Ut(n,st(t),[])}),ho=Au||function(){return(new De).getTime()},_o=le(function(n,t,r){u=m;if(r.length)var e=v(r,_o.placeholder),u=u|R;return gr(n,u,t,r,e)}),vo=le(function(n,t){for(var r=-1,e=(t=t.length?st(t):Ie(n)).length;++r<e;){var u=t[r];n[u]=gr(n[u],m,n)}return n}),go=le(function(n,t,r){u=m|A;if(r.length)var e=v(r,go.placeholder),u=u|R;return gr(t,u,n,r,e)}),yo=Xt(k),wo=Xt(I),bo=le(function(n,t){return it(n,1,t)}),xo=le(function(n,t,r){return it(n,t,r)}),mo=er(),Ao=er(!0),jo=le(function(n,t){if(t=st(t),"function"!=typeof n||!Kn(t,e))throw new Ge(L);var r=t.length;return le(function(e){for(var u=mu(e.length,r);u--;)e[u]=t[u](e[u]);return n.apply(this,e)})}),ko=ar(R),Io=ar(O),Ro=le(function(n,t){return gr(n,C,b,b,b,st(t))}),Oo=du||function(n){return h(n)&&$r(n.length)&&ru.call(n)==D},Eo=Kt(At),Co=Kt(function(n,t,r){return r?nt(n,t,r):tt(n,t)}),So=Ht(Co,function(n,t){return n===b?t:n}),Uo=Ht(Eo,Fr),Wo=rr(_t),$o=rr(vt),Fo=or(Nu),No=or(Tu),To=ir(_t),Lo=ir(vt),zo=bu?function(n){var t=null==n?b:n.constructor;return"function"==typeof t&&t.prototype===n||"function"!=typeof n&&Er(n)?Lr(n):ge(n)?bu(n):[]}:Lr,Bo=fr(!0),Do=fr(),Mo=le(function(n,t){if(null==n)return{};if("function"!=typeof t[0])return t=Gn(st(t),Ye),Nr(n,ft(Re(n),t));var r=Bt(t[0],t[1],3);return Tr(n,function(n,t,e){return!r(n,t,e)})}),qo=le(function(n,t){return null==n?{}:"function"==typeof t[0]?Tr(n,Bt(t[0],t[1],3)):Nr(n,st(t))}),Po=Gt(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Ko=Gt(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Vo=cr(),Zo=cr(!0),Yo=Gt(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Go=Gt(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Jo=le(function(n,t){try{return n.apply(b,t)}catch(n){return _e(n)?n:new Me(n)}}),Xo=le(function(n,t){return function(r){return Or(r,n,t)}}),Ho=le(function(n,t){return function(r){return Or(n,r,t)}}),Qo=_r("ceil"),ni=_r("floor"),ti=Qt(pe,Iu),ri=Qt(Ae,Ru),ei=_r("round");return Nn.prototype=Tn.prototype,Ln.prototype=Wu(Tn.prototype),Ln.prototype.constructor=Ln,zn.prototype=Wu(Tn.prototype),zn.prototype.constructor=zn,Bn.prototype.delete=function(n){return this.has(n)&&delete this.__data__[n]},Bn.prototype.get=function(n){return"__proto__"==n?b:this.__data__[n]},Bn.prototype.has=function(n){return"__proto__"!=n&&nu.call(this.__data__,n)},Bn.prototype.set=function(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this},Dn.prototype.push=function(n){var t=this.data;"string"==typeof n||ge(n)?t.set.add(n):t.hash[n]=!0},ae.Cache=Bn,Nn.after=function(n,t){if("function"!=typeof t){if("function"!=typeof n)throw new Ge(L);var r=n;n=t,t=r}return n=wu(n=+n)?n:0,function(){return 1>--n?t.apply(this,arguments):void 0}},Nn.ary=function(n,t,r){return r&&Sr(n,t,r)&&(t=b),t=n&&null==t?n.length:xu(+t||0,0),gr(n,E,b,b,b,b,t)},Nn.assign=Co,Nn.at=no,Nn.before=fe,Nn.bind=_o,Nn.bindAll=vo,Nn.bindKey=go,Nn.callback=$e,Nn.chain=Qr,Nn.chunk=function(n,t,r){t=(r?Sr(n,t,r):null==t)?1:xu(yu(t)||1,1),r=0;for(var e=n?n.length:0,u=-1,o=Be(vu(e/t));r<e;)o[++u]=Et(n,r,r+=t);return o},Nn.compact=function(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var o=n[t];o&&(u[++e]=o)}return u},Nn.constant=function(n){return function(){return n}},Nn.countBy=to,Nn.create=function(n,t,r){var e=Wu(n);return r&&Sr(n,t,r)&&(t=b),t?tt(e,t):e},Nn.curry=yo,Nn.curryRight=wo,Nn.debounce=ce,Nn.defaults=So,Nn.defaultsDeep=Uo,Nn.defer=bo,Nn.delay=xo,Nn.difference=Mu,Nn.drop=qr,Nn.dropRight=Pr,Nn.dropRightWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!0,!0):[]},Nn.dropWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!0):[]},Nn.fill=function(n,t,r,e){var u=n?n.length:0;if(!u)return[];for(r&&"number"!=typeof r&&Sr(n,t,r)&&(r=0,e=u),u=n.length,0>(r=null==r?0:+r||0)&&(r=-r>u?0:u+r),0>(e=e===b||e>u?u:+e||0)&&(e+=u),u=r>e?0:e>>>0,r>>>=0;r<u;)n[r++]=t;return n},Nn.filter=re,Nn.flatten=function(n,t,r){var e=n?n.length:0;return r&&Sr(n,t,r)&&(t=!1),e?st(n,t):[]},Nn.flattenDeep=function(n){return n&&n.length?st(n,!0):[]},Nn.flow=mo,Nn.flowRight=Ao,Nn.forEach=uo,Nn.forEachRight=oo,Nn.forIn=Fo,Nn.forInRight=No,Nn.forOwn=To,Nn.forOwnRight=Lo,Nn.functions=Ie,Nn.groupBy=io,Nn.indexBy=fo,Nn.initial=function(n){return Pr(n,1)},Nn.intersection=Ku,Nn.invert=function(n,t,r){r&&Sr(n,t,r)&&(t=b),r=-1;for(var e=zo(n),u=e.length,o={};++r<u;){var i=e[r],f=n[i];t?nu.call(o,f)?o[f].push(i):o[f]=[i]:o[f]=i}return o},Nn.invoke=co,Nn.keys=zo,Nn.keysIn=Re,Nn.map=ue,Nn.mapKeys=Bo,Nn.mapValues=Do,Nn.matches=Ne,Nn.matchesProperty=function(n,t){return mt(n,ot(t,!0))},Nn.memoize=ae,Nn.merge=Eo,Nn.method=Xo,Nn.methodOf=Ho,Nn.mixin=Te,Nn.modArgs=jo,Nn.negate=function(n){if("function"!=typeof n)throw new Ge(L);return function(){return!n.apply(this,arguments)}},Nn.omit=Mo,Nn.once=function(n){return fe(2,n)},Nn.pairs=Oe,Nn.partial=ko,Nn.partialRight=Io,Nn.partition=ao,Nn.pick=qo,Nn.pluck=function(n,t){return ue(n,ze(t))},Nn.property=ze,Nn.propertyOf=function(n){return function(t){return yt(n,Dr(t),t+"")}},Nn.pull=function(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=mr(),u=n.length;++r<u;)for(var o=0,i=n[r];-1<(o=e(t,i,o));)su.call(t,o,1);return t},Nn.pullAt=Vu,Nn.range=function(n,t,r){r&&Sr(n,t,r)&&(t=r=b),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;var e=-1;t=xu(vu((t-n)/(r||1)),0);for(var u=Be(t);++e<t;)u[e]=n,n+=r;return u},Nn.rearg=Ro,Nn.reject=function(n,t,r){var e=Oo(n)?Vn:lt;return t=br(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})},Nn.remove=function(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,o=[],i=n.length;for(t=br(t,r,3);++u<i;)t(r=n[u],u,n)&&(e.push(r),o.push(u));return It(n,o),e},Nn.rest=Yr,Nn.restParam=le,Nn.set=function(n,t,r){if(null==n)return n;t=null!=n[e=t+""]||Ur(t,n)?[e]:Dr(t);for(var e=-1,u=t.length,o=u-1,i=n;null!=i&&++e<u;){var f=t[e];ge(i)&&(e==o?i[f]=r:null==i[f]&&(i[f]=Cr(t[e+1])?[]:{})),i=i[f]}return n},Nn.shuffle=function(n){return oe(n,Ru)},Nn.slice=function(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Sr(n,t,r)&&(t=0,r=e),Et(n,t,r)):[]},Nn.sortBy=function(n,t,r){if(null==n)return[];r&&Sr(n,t,r)&&(t=b);var e=-1;return t=br(t,r,3),n=bt(n,function(n,r,u){return{a:t(n,r,u),b:++e,c:n}}),St(n,f)},Nn.sortByAll=so,Nn.sortByOrder=function(n,t,r,e){return null==n?[]:(e&&Sr(t,r,e)&&(r=b),Oo(t)||(t=null==t?[]:[t]),Oo(r)||(r=null==r?[]:[r]),Ut(n,t,r))},Nn.spread=function(n){if("function"!=typeof n)throw new Ge(L);return function(t){return n.apply(this,t)}},Nn.take=function(n,t,r){return n&&n.length?((r?Sr(n,t,r):null==t)&&(t=1),Et(n,0,0>t?0:t)):[]},Nn.takeRight=function(n,t,r){var e=n?n.length:0;return e?((r?Sr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0>t?0:t)):[]},Nn.takeRightWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3),!1,!0):[]},Nn.takeWhile=function(n,t,r){return n&&n.length?Nt(n,br(t,r,3)):[]},Nn.tap=function(n,t,r){return t.call(r,n),n},Nn.throttle=function(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new Ge(L);return!1===r?e=!1:ge(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),ce(n,t,{leading:e,maxWait:+t,trailing:u})},Nn.thru=ne,Nn.times=function(n,t,r){if(1>(n=yu(n))||!wu(n))return[];var e=-1,u=Be(mu(n,4294967295));for(t=Bt(t,r,1);++e<n;)4294967295>e?u[e]=t(e):t(e);return u},Nn.toArray=je,Nn.toPlainObject=ke,Nn.transform=function(n,t,r,e){var u=Oo(n)||me(n);return t=br(t,e,4),null==r&&(u||ge(n)?(e=n.constructor,r=u?Oo(n)?new e:[]:Wu(ve(e)?e.prototype:b)):r={}),(u?Pn:_t)(n,function(n,e,u){return t(r,n,e,u)}),r},Nn.union=Gu,Nn.uniq=Gr,Nn.unzip=Jr,Nn.unzipWith=Xr,Nn.values=Ee,Nn.valuesIn=function(n){return Ft(n,Re(n))},Nn.where=function(n,t){return re(n,xt(t))},Nn.without=Ju,Nn.wrap=function(n,t){return t=null==t?Fe:t,gr(t,R,b,[n],[])},Nn.xor=function(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Er(r))var e=e?Jn(ft(e,r),ft(r,e)):r}return e?$t(e):[]},Nn.zip=Xu,Nn.zipObject=Hr,Nn.zipWith=Hu,Nn.backflow=Ao,Nn.collect=ue,Nn.compose=Ao,Nn.each=uo,Nn.eachRight=oo,Nn.extend=Co,Nn.iteratee=$e,Nn.methods=Ie,Nn.object=Hr,Nn.select=re,Nn.tail=Yr,Nn.unique=Gr,Te(Nn,Nn),Nn.add=function(n,t){return(+n||0)+(+t||0)},Nn.attempt=Jo,Nn.camelCase=Po,Nn.capitalize=function(n){return(n=u(n))&&n.charAt(0).toUpperCase()+n.slice(1)},Nn.ceil=Qo,Nn.clone=function(n,t,r,e){return t&&"boolean"!=typeof t&&Sr(n,t,r)?t=!1:"function"==typeof t&&(e=r,r=t,t=!1),"function"==typeof r?ot(n,t,Bt(r,e,3)):ot(n,t)},Nn.cloneDeep=function(n,t,r){return"function"==typeof t?ot(n,!0,Bt(t,r,3)):ot(n,!0)},Nn.deburr=Ce,Nn.endsWith=function(n,t,r){t+="";var e=(n=u(n)).length;return r=r===b?e:mu(0>r?0:+r||0,e),0<=(r-=t.length)&&n.indexOf(t,r)==r},Nn.escape=function(n){return(n=u(n))&&hn.test(n)?n.replace(pn,a):n},Nn.escapeRegExp=function(n){return(n=u(n))&&xn.test(n)?n.replace(bn,l):n||"(?:)"},Nn.every=te,Nn.find=ro,Nn.findIndex=qu,Nn.findKey=Wo,Nn.findLast=eo,Nn.findLastIndex=Pu,Nn.findLastKey=$o,Nn.findWhere=function(n,t){return ro(n,xt(t))},Nn.first=Kr,Nn.floor=ni,Nn.get=function(n,t,r){return n=null==n?b:yt(n,Dr(t),t+""),n===b?r:n},Nn.gt=pe,Nn.gte=function(n,t){return n>=t},Nn.has=function(n,t){if(null==n)return!1;var r=nu.call(n,t);if(!r&&!Ur(t)){if(t=Dr(t),null==(n=1==t.length?n:yt(n,Et(t,0,-1))))return!1;t=Zr(t),r=nu.call(n,t)}return r||$r(n.length)&&Cr(t,n.length)&&(Oo(n)||se(n))},Nn.identity=Fe,Nn.includes=ee,Nn.indexOf=Vr,Nn.inRange=function(n,t,r){return t=+t||0,r===b?(r=t,t=0):r=+r||0,n>=mu(t,r)&&n<xu(t,r)},Nn.isArguments=se,Nn.isArray=Oo,Nn.isBoolean=function(n){return!0===n||!1===n||h(n)&&ru.call(n)==M},Nn.isDate=function(n){return h(n)&&ru.call(n)==q},Nn.isElement=function(n){return!!n&&1===n.nodeType&&h(n)&&!we(n)},Nn.isEmpty=function(n){return null==n||(Er(n)&&(Oo(n)||xe(n)||se(n)||h(n)&&ve(n.splice))?!n.length:!zo(n).length)},Nn.isEqual=he,Nn.isError=_e,Nn.isFinite=function(n){return"number"==typeof n&&wu(n)},Nn.isFunction=ve,Nn.isMatch=function(n,t,r,e){return r="function"==typeof r?Bt(r,e,3):b,wt(n,Ar(t),r)},Nn.isNaN=function(n){return de(n)&&n!=+n},Nn.isNative=ye,Nn.isNull=function(n){return null===n},Nn.isNumber=de,Nn.isObject=ge,Nn.isPlainObject=we,Nn.isRegExp=be,Nn.isString=xe,Nn.isTypedArray=me,Nn.isUndefined=function(n){return n===b},Nn.kebabCase=Ko,Nn.last=Zr,Nn.lastIndexOf=function(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if("number"==typeof r)u=(0>r?xu(e+r,0):mu(r||0,e-1))+1;else if(r)return u=Lt(n,t,!0)-1,n=n[u],(t===t?t===n:n!==n)?u:-1;if(t!==t)return s(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1},Nn.lt=Ae,Nn.lte=function(n,t){return n<=t},Nn.max=ti,Nn.min=ri,Nn.noConflict=function(){return Zn._=eu,this},Nn.noop=Le,Nn.now=ho,Nn.pad=function(n,t,r){t=+t;var e=(n=u(n)).length;return e<t&&wu(t)?(e=(t-e)/2,t=yu(e),e=vu(e),(r=sr("",e,r)).slice(0,t)+n+r):n},Nn.padLeft=Vo,Nn.padRight=Zo,Nn.parseInt=function(n,t,r){return(r?Sr(n,t,r):null==t)?t=0:t&&(t=+t),n=Ue(n),ju(n,t||(In.test(n)?16:10))},Nn.random=function(n,t,r){r&&Sr(n,t,r)&&(t=r=b);var e=null==n,u=null==t;return null==r&&(u&&"boolean"==typeof n?(r=n,n=1):"boolean"==typeof t&&(r=t,u=!0)),e&&u&&(t=1,u=!1),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1?(r=ku(),mu(n+r*(t-n+fu("1e-"+((r+"").length-1))),t)):Rt(n,t)},Nn.reduce=lo,Nn.reduceRight=po,Nn.repeat=Se,Nn.result=function(n,t,r){var e=null==n?b:n[t];return e===b&&(null==n||Ur(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),e=null==n?b:n[Zr(t)]),e=e===b?r:e),ve(e)?e.call(n):e},Nn.round=ei,Nn.runInContext=w,Nn.size=function(n){var t=n?Bu(n):0;return $r(t)?t:zo(n).length},Nn.snakeCase=Yo,Nn.some=ie,Nn.sortedIndex=Zu,Nn.sortedLastIndex=Yu,Nn.startCase=Go,Nn.startsWith=function(n,t,r){return n=u(n),r=null==r?0:mu(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r},Nn.sum=function(n,t,r){if(r&&Sr(n,t,r)&&(t=b),1==(t=br(t,r,3)).length){r=(n=Oo(n)?n:zr(n)).length;for(var e=0;r--;)e+=+t(n[r])||0;n=e}else n=Wt(n,t);return n},Nn.template=function(n,t,r){var e=Nn.templateSettings;r&&Sr(n,t,r)&&(t=r=b),n=u(n),r=nt(tt({},(t=nt(tt({},r||t),e,Qn)).imports),e.imports,Qn);var o,i,f=zo(r),c=Ft(r,f),a=0;r=t.interpolate||Cn;var l="__p+='";r=Ze((t.escape||Cn).source+"|"+r.source+"|"+(r===gn?jn:Cn).source+"|"+(t.evaluate||Cn).source+"|$","g");var s="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";if(n.replace(r,function(t,r,e,u,f,c){return e||(e=u),l+=n.slice(a,c).replace(Sn,p),r&&(o=!0,l+="'+__e("+r+")+'"),f&&(i=!0,l+="';"+f+";\n__p+='"),e&&(l+="'+((__t=("+e+"))==null?'':__t)+'"),a=c+t.length,t}),l+="';",(t=t.variable)||(l="with(obj){"+l+"}"),l=(i?l.replace(fn,""):l).replace(cn,"$1").replace(an,"$1;"),l="function("+(t||"obj")+"){"+(t?"":"obj||(obj={});")+"var __t,__p=''"+(o?",__e=_.escape":"")+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+l+"return __p}",t=Jo(function(){return qe(f,s+"return "+l).apply(b,c)}),t.source=l,_e(t))throw t;return t},Nn.trim=Ue,Nn.trimLeft=function(n,t,r){var e=n;return(n=u(n))?n.slice((r?Sr(e,t,r):null==t)?g(n):o(n,t+"")):n},Nn.trimRight=function(n,t,r){var e=n;return(n=u(n))?(r?Sr(e,t,r):null==t)?n.slice(0,y(n)+1):n.slice(0,i(n,t+"")+1):n},Nn.trunc=function(n,t,r){r&&Sr(n,t,r)&&(t=b);o=S;if(r=U,null!=t)if(ge(t)){var e="separator"in t?t.separator:e,o="length"in t?+t.length||0:o;r="omission"in t?u(t.omission):r}else o=+t||0;if(n=u(n),o>=n.length)return n;if(1>(o-=r.length))return r;if(t=n.slice(0,o),null==e)return t+r;if(be(e)){if(n.slice(o).search(e)){var i,f=n.slice(0,o);for(e.global||(e=Ze(e.source,(kn.exec(e)||"")+"g")),e.lastIndex=0;n=e.exec(f);)i=n.index;t=t.slice(0,null==i?o:i)}}else n.indexOf(e,o)!=o&&-1<(e=t.lastIndexOf(e))&&(t=t.slice(0,e));return t+r},Nn.unescape=function(n){return(n=u(n))&&sn.test(n)?n.replace(ln,d):n},Nn.uniqueId=function(n){var t=++tu;return u(n)+t},Nn.words=We,Nn.all=te,Nn.any=ie,Nn.contains=ee,Nn.eq=he,Nn.detect=ro,Nn.foldl=lo,Nn.foldr=po,Nn.head=Kr,Nn.include=ee,Nn.inject=lo,Te(Nn,function(){var n={};return _t(Nn,function(t,r){Nn.prototype[r]||(n[r]=t)}),n}(),!1),Nn.sample=oe,Nn.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return oe(t,n)}):oe(this.value())},Nn.VERSION=x,Pn("bind bindKey curry curryRight partial partialRight".split(" "),function(n){Nn[n].placeholder=Nn}),Pn(["drop","take"],function(n,t){zn.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new zn(this);r=null==r?1:xu(yu(r)||0,0);var u=this.clone();return e?u.__takeCount__=mu(u.__takeCount__,r):u.__views__.push({size:r,type:n+(0>u.__dir__?"Right":"")}),u},zn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),Pn(["filter","map","takeWhile"],function(n,t){var r=t+1,e=r!=T;zn.prototype[n]=function(n,t){var u=this.clone();return u.__iteratees__.push({iteratee:br(n,t,1),type:r}),u.__filtered__=u.__filtered__||e,u}}),Pn(["first","last"],function(n,t){var r="take"+(t?"Right":"");zn.prototype[n]=function(){return this[r](1).value()[0]}}),Pn(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");zn.prototype[n]=function(){return this.__filtered__?new zn(this):this[r](1)}}),Pn(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?xt:ze;zn.prototype[n]=function(n){return this[r](e(n))}}),zn.prototype.compact=function(){return this.filter(Fe)},zn.prototype.reject=function(n,t){return n=br(n,t,1),this.filter(function(t){return!n(t)})},zn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return r.__filtered__&&(0<n||0>t)?new zn(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==b&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r)},zn.prototype.takeRightWhile=function(n,t){return this.reverse().takeWhile(n,t).reverse()},zn.prototype.toArray=function(){return this.take(Ru)},_t(zn.prototype,function(n,t){var r=/^(?:filter|map|reject)|While$/.test(t),e=/^(?:first|last)$/.test(t),u=Nn[e?"take"+("last"==t?"Right":""):t];u&&(Nn.prototype[t]=function(){function t(n){return e&&i?u(n,1)[0]:u.apply(b,Jn([n],o))}var o=e?[1]:arguments,i=this.__chain__,f=this.__wrapped__,c=!!this.__actions__.length,a=f instanceof zn,l=o[0],p=a||Oo(f);return p&&r&&"function"==typeof l&&1!=l.length&&(a=p=!1),l={func:ne,args:[t],thisArg:b},c=a&&!c,e&&!i?c?((f=f.clone()).__actions__.push(l),n.call(f)):u.call(b,this.value())[0]:!e&&p?(f=c?f:new zn(this),(f=n.apply(f,o)).__actions__.push(l),new Ln(f,i)):this.thru(t)})}),Pn("join pop push replace shift sort splice split unshift".split(" "),function(n){var t=(/^(?:replace|split)$/.test(n)?He:Je)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);Nn.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),_t(zn.prototype,function(n,t){var r=Nn[t];if(r){var e=r.name+"";(Uu[e]||(Uu[e]=[])).push({name:t,func:r})}}),Uu[pr(b,A).name]=[{name:"wrapper",func:b}],zn.prototype.clone=function(){var n=new zn(this.__wrapped__);return n.__actions__=qn(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=qn(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=qn(this.__views__),n},zn.prototype.reverse=function(){if(this.__filtered__){var n=new zn(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n},zn.prototype.value=function(){var n,t=this.__wrapped__.value(),r=this.__dir__,e=Oo(t),u=0>r,o=e?t.length:0;n=o;for(var i=this.__views__,f=0,c=-1,a=i.length;++c<a;){var l=i[c],p=l.size;switch(l.type){case"drop":f+=p;break;case"dropRight":n-=p;break;case"take":n=mu(n,f+p);break;case"takeRight":f=xu(f,n-p)}}if(n={start:f,end:n},i=n.start,f=n.end,n=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,c=0,a=mu(n,this.__takeCount__),!e||o<F||o==n&&a==n)return Tt(t,this.__actions__);e=[];n:for(;n--&&c<a;){for(o=-1,l=t[u+=r];++o<f;){var p=(s=i[o]).type,s=s.iteratee(l);if(p==T)l=s;else if(!s){if(p==N)continue n;break n}}e[c++]=l}return e},Nn.prototype.chain=function(){return Qr(this)},Nn.prototype.commit=function(){return new Ln(this.value(),this.__chain__)},Nn.prototype.concat=Qu,Nn.prototype.plant=function(n){for(var t,r=this;r instanceof Tn;){var e=Mr(r);t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},Nn.prototype.reverse=function(){function n(n){return n.reverse()}var t=this.__wrapped__;return t instanceof zn?(this.__actions__.length&&(t=new zn(this)),(t=t.reverse()).__actions__.push({func:ne,args:[n],thisArg:b}),new Ln(t,this.__chain__)):this.thru(n)},Nn.prototype.toString=function(){return this.value()+""},Nn.prototype.run=Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){return Tt(this.__wrapped__,this.__actions__)},Nn.prototype.collect=Nn.prototype.map,Nn.prototype.head=Nn.prototype.first,Nn.prototype.select=Nn.prototype.filter,Nn.prototype.tail=Nn.prototype.rest,Nn}var b,x="3.10.1",m=1,A=2,j=4,k=8,I=16,R=32,O=64,E=128,C=256,S=30,U="...",W=150,$=16,F=200,N=1,T=2,L="Expected a function",z="__lodash_placeholder__",B="[object Arguments]",D="[object Array]",M="[object Boolean]",q="[object Date]",P="[object Error]",K="[object Function]",V="[object Number]",Z="[object Object]",Y="[object RegExp]",G="[object String]",J="[object ArrayBuffer]",X="[object Float32Array]",H="[object Float64Array]",Q="[object Int8Array]",nn="[object Int16Array]",tn="[object Int32Array]",rn="[object Uint8Array]",en="[object Uint8ClampedArray]",un="[object Uint16Array]",on="[object Uint32Array]",fn=/\b__p\+='';/g,cn=/\b(__p\+=)''\+/g,an=/(__e\(.*?\)|\b__t\))\+'';/g,ln=/&(?:amp|lt|gt|quot|#39|#96);/g,pn=/[&<>"'`]/g,sn=RegExp(ln.source),hn=RegExp(pn.source),_n=/<%-([\s\S]+?)%>/g,vn=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,yn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,dn=/^\w*$/,wn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,bn=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,xn=RegExp(bn.source),mn=/[\u0300-\u036f\ufe20-\ufe23]/g,An=/\\(\\)?/g,jn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kn=/\w*$/,In=/^0[xX]/,Rn=/^\[object .+?Constructor\]$/,On=/^\d+$/,En=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Cn=/($^)/,Sn=/['\n\r\u2028\u2029\\]/g,Un=RegExp("[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?=[A-Z\\xc0-\\xd6\\xd8-\\xde][a-z\\xdf-\\xf6\\xf8-\\xff]+)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|[0-9]+","g"),Wn="Array ArrayBuffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Math Number Object RegExp Set String _ clearTimeout isFinite parseFloat parseInt setTimeout TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap".split(" "),$n={};$n[X]=$n[H]=$n[Q]=$n[nn]=$n[tn]=$n[rn]=$n[en]=$n[un]=$n[on]=!0,$n[B]=$n[D]=$n[J]=$n[M]=$n[q]=$n[P]=$n[K]=$n["[object Map]"]=$n[V]=$n[Z]=$n[Y]=$n["[object Set]"]=$n[G]=$n["[object WeakMap]"]=!1;var Fn={};Fn[B]=Fn[D]=Fn[J]=Fn[M]=Fn[q]=Fn[X]=Fn[H]=Fn[Q]=Fn[nn]=Fn[tn]=Fn[V]=Fn[Z]=Fn[Y]=Fn[G]=Fn[rn]=Fn[en]=Fn[un]=Fn[on]=!0,Fn[P]=Fn[K]=Fn["[object Map]"]=Fn["[object Set]"]=Fn["[object WeakMap]"]=!1;var Nn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Tn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ln={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},zn={function:!0,object:!0},Bn={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Dn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Mn=zn["undefined"==typeof exports?"undefined":_typeof(exports)]&&exports&&!exports.nodeType&&exports,qn=zn["undefined"==typeof module?"undefined":_typeof(module)]&&module&&!module.nodeType&&module,Pn=zn["undefined"==typeof self?"undefined":_typeof(self)]&&self&&self.Object&&self,Kn=zn["undefined"==typeof window?"undefined":_typeof(window)]&&window&&window.Object&&window,Vn=qn&&qn.exports===Mn&&Mn,Zn=Mn&&qn&&"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global&&global.Object&&global||Kn!==(this&&this.window)&&Kn||Pn||this,Yn=w();"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd?(Zn._=Yn,define(function(){return Yn})):Mn&&qn?Vn?(qn.exports=Yn)._=Yn:Mn._=Yn:Zn._=Yn}).call(this);
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/vendor/hoops.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n){"use strict";var t={};t.getIn=function(n,t,e){var o,r;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),r=t.length,o=0;r>o;o++){if(!(t[o]in n))return e;n=n[t[o]]}return n},t.isIn=function(n,t){var e,o;if(void 0===t)return!1;for(t instanceof Array||(t=(""+t).split(".")),o=t.length,e=0;o>e;e++){if(!(t[e]in n))return!1;n=n[t[e]]}return!0},t.invokeIn=function(n,e){var o,r,i;if(void 0===e)return n;if("function"!=typeof(r=t.getIn(n,e)))return n;if(i=[],arguments.length>2)for(o=2;o<arguments.length;o++)i.push(arguments[o]);return r.apply(null,i),n},t.updateIn=function(n,t,e){var o,r,i;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),i=n,r=t.length,o=0;r>o;o++){if(!(t[o]in i))return n;r-1>o&&(i=i[t[o]])}return i[t[o-1]]=e,n},t.setIn=function(n,t,e){var o,r,i;if(void 0===t)return n;for(t instanceof Array||(t=(""+t).split(".")),i=n,r=t.length,o=0;r>o;o++)"object"!=_typeof(i[t[o]])&&(i[t[o]]={}),r-1>o&&(i=i[t[o]]);return i[t[o-1]]=e,n},"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports?module.exports=t:exports.hoops=t),"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd&&define("hoops",[],function(){return t}),n._&&n._.mixin?n._.mixin(t):n.hoops=t}(this);
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/api_handler.js */
var API_Handler={parse_query_string:function(r){var a={};return r.split("&").forEach(function(r){if(r){var e=r.split("="),n=e[0],i=decodeURIComponent(e[1]),l=n.indexOf("[");if(-1===l)a[n]=i;else{var t=n.indexOf("]"),s=n.substring(l+1,t);n=n.substring(0,l),a[n]||(a[n]=[]),s?a[n][s]=i:a[n].push(i)}}}),a},parameter_error:function(r){console.error(r)},validate_parameters:function(r,a){var e=_.merge(Config.defaults,{"active-layers":[],"available-layers":a});if(r["bounding-box"])try{var n=r["bounding-box"].split(",",4),i=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];i[0]<-90||i[0]>90||i[2]<-90||i[2]>90||i[1]<-180||i[1]>180||i[3]<-180||i[3]>180?API_Handler.parameter_error("Error parsing bounding-box: is out of bounds (+-90, +- 180, +-90, +-180) ["+i+"]"):e["bounding-box"]=i}catch(r){API_Handler.parameter_error("Error parsing bounding-box: "+r+" \nDefaulting to : "+JSON.stringify(e["bounding-box"]))}if(r["available-layers"])try{var l=_.remove(r["available-layers"].split(","),function(r){return r}),t=_.intersection(a,l);(s=_.difference(l,t)).length>0&&API_Handler.parameter_error("Error parsing available-layers: DROPPING layers ["+s.join(",")+"]"),e["available-layers"]=t}catch(r){API_Handler.parameter_error("Error parsing available-layser: "+r+" \nDefaulting to : "+JSON.stringify(e["available-layers"]))}if(r["active-layers"]||""===r["active-layers"])try{var l=_.remove(r["active-layers"].split(","),function(r){return r}),t=_.intersection(l,a),s=_.difference(l,t);s.length>0&&API_Handler.parameter_error("Error parsing active-layers: DROPPING layers ["+s.join(",")+"]"),e["active-layers"]=t}catch(r){API_Handler.parameter_error("Error parsing available-layser: "+r+" \nDefaulting to : "+JSON.stringify(e["available-layers"]))}var o=_.difference(e["active-layers"],e["available-layers"]);return o.length>0&&(e["available-layers"]=_.union(e["available-layers"],o)),e},get_parameters:function(r,a){var e=API_Handler.parse_query_string(r);return API_Handler.validate_parameters(e,a)}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/base_layers.js */
var BASELAYER_PANE="baselayers",BaseLayers=[{name:"Terrain",data:L.tileLayer("https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}.png",{maxZoom:19,attribution:'Basemap Courtesy of <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer" target="_blank">ESRI</a>',pane:BASELAYER_PANE})},{name:"Street Map",data:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'})},{name:"Imagery",data:L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:18,attribution:"Esri, DigitalGlobe, Earthstar Geographics, CNES/Airbus DS, GeoEye, USDA FSA, USGS, Getmapping, Aerogrid, IGN, IGP, and the GIS User Community"})},{name:"2001 Imagery",data:L.tileLayer("https://tiles.arcgis.com/tiles/hGdibHYSPO59RG1h/arcgis/rest/services/orthos_2001_tile_package/MapServer/tile/{z}/{y}/{x}",{maxZoom:18,attribution:'2001-2003 Imagery Courtesy of <a href="https://docs.digital.mass.gov/dataset/massgis-data-15000-color-ortho-imagery-2001-2003" target="_blank">Massachusetts Dept. of Transportation</a>'})},{name:"Watercolor",data:L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="https://stamen.com">Stamen Design</a>, <a href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:1,maxZoom:16,ext:"png"})},{name:"Toner",data:L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="https://stamen.com">Stamen Design</a>, <a href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:1,maxZoom:16,ext:"png"})},{name:"None",data:{Empty:L.tileLayer(""),OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Map data &copy; OpenStreetMap contributors"})}}];
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/data/climate_vulnerability_towns.js */
var _towns=[{name:"Petersham",uid:25027,county:"Worcester"},{name:"Plainville",uid:25021,county:"Norfolk"},{name:"Quincy",uid:25021,county:"Norfolk"},{name:"Rockland",uid:25023,county:"Plymouth"},{name:"Scituate",uid:25023,county:"Plymouth"},{name:"Spencer",uid:25027,county:"Worcester"},{name:"Tyringham",uid:25003,county:"Berkshire"},{name:"Otis",uid:25003,county:"Berkshire"},{name:"Sheffield",uid:25003,county:"Berkshire"},{name:"Northborough",uid:25027,county:"Worcester"},{name:"Westhampton",uid:25015,county:"Hampshire"},{name:"Ware",uid:25015,county:"Hampshire"},{name:"Wareham",uid:25023,county:"Plymouth"},{name:"Washington",uid:25003,county:"Berkshire"},{name:"Wenham",uid:25009,county:"Essex"},{name:"West Boylston",uid:25027,county:"Worcester"},{name:"West Bridgewater",uid:25023,county:"Plymouth"},{name:"Westford",uid:25017,county:"Middlesex"},{name:"Whitman",uid:25023,county:"Plymouth"},{name:"Williamsburg",uid:25015,county:"Hampshire"},{name:"West Brookfield",uid:25027,county:"Worcester"},{name:"Winchester",uid:25017,county:"Middlesex"},{name:"Boylston",uid:25027,county:"Worcester"},{name:"Adams",uid:25003,county:"Berkshire"},{name:"Alford",uid:25003,county:"Berkshire"},{name:"Amherst",uid:25015,county:"Hampshire"},{name:"Ashburnham",uid:25027,county:"Worcester"},{name:"Yarmouth",uid:25001,county:"Barnstable"},{name:"Beverly",uid:25009,county:"Essex"},{name:"Billerica",uid:25017,county:"Middlesex"},{name:"Boxford",uid:25009,county:"Essex"},{name:"Ashby",uid:25017,county:"Middlesex"},{name:"Auburn",uid:25027,county:"Worcester"},{name:"Avon",uid:25021,county:"Norfolk"},{name:"Barre",uid:25027,county:"Worcester"},{name:"Belchertown",uid:25015,county:"Hampshire"},{name:"Berlin",uid:25027,county:"Worcester"},{name:"Bernardston",uid:25011,county:"Franklin"},{name:"Blandford",uid:25013,county:"Hampden"},{name:"Bolton",uid:25027,county:"Worcester"},{name:"Bourne",uid:25001,county:"Barnstable"},{name:"Boxborough",uid:25017,county:"Middlesex"},{name:"Brockton",uid:25023,county:"Plymouth"},{name:"Burlington",uid:25017,county:"Middlesex"},{name:"Chatham",uid:25001,county:"Barnstable"},{name:"Cheshire",uid:25003,county:"Berkshire"},{name:"Chester",uid:25013,county:"Hampden"},{name:"Clarksburg",uid:25003,county:"Berkshire"},{name:"Dartmouth",uid:25005,county:"Bristol"},{name:"Dennis",uid:25001,county:"Barnstable"},{name:"Douglas",uid:25027,county:"Worcester"},{name:"Ashfield",uid:25011,county:"Franklin"},{name:"Acton",uid:25017,county:"Middlesex"},{name:"Attleboro",uid:25005,county:"Bristol"},{name:"Barnstable",uid:25001,county:"Barnstable"},{name:"Blackstone",uid:25027,county:"Worcester"},{name:"Boston",uid:25025,county:"Suffolk"},{name:"Charlton",uid:25027,county:"Worcester"},{name:"Clinton",uid:25027,county:"Worcester"},{name:"Cummington",uid:25015,county:"Hampshire"},{name:"Duxbury",uid:25023,county:"Plymouth"},{name:"Eastham",uid:25001,county:"Barnstable"},{name:"Essex",uid:25009,county:"Essex"},{name:"Dunstable",uid:25017,county:"Middlesex"},{name:"Everett",uid:25017,county:"Middlesex"},{name:"Plainfield",uid:25015,county:"Hampshire"},{name:"Florida",uid:25003,county:"Berkshire"},{name:"Granville",uid:25013,county:"Hampden"},{name:"Plymouth",uid:25023,county:"Plymouth"},{name:"Great Barrington",uid:25003,county:"Berkshire"},{name:"Hardwick",uid:25027,county:"Worcester"},{name:"Hubbardston",uid:25027,county:"Worcester"},{name:"Ipswich",uid:25009,county:"Essex"},{name:"Leverett",uid:25011,county:"Franklin"},{name:"Mansfield",uid:25005,county:"Bristol"},{name:"Mashpee",uid:25001,county:"Barnstable"},{name:"Middleborough",uid:25023,county:"Plymouth"},{name:"Millville",uid:25027,county:"Worcester"},{name:"Nantucket",uid:25019,county:"Nantucket"},{name:"Grafton",uid:25027,county:"Worcester"},{name:"Hawley",uid:25011,county:"Franklin"},{name:"Fitchburg",uid:25027,county:"Worcester"},{name:"Gloucester",uid:25009,county:"Essex"},{name:"Gosnold",uid:25007,county:"Dukes"},{name:"Sutton",uid:25027,county:"Worcester"},{name:"Longmeadow",uid:25013,county:"Hampden"},{name:"Lunenburg",uid:25027,county:"Worcester"},{name:"Marion",uid:25023,county:"Plymouth"},{name:"Marlborough",uid:25017,county:"Middlesex"},{name:"Mendon",uid:25027,county:"Worcester"},{name:"Holden",uid:25027,county:"Worcester"},{name:"Townsend",uid:25017,county:"Middlesex"},{name:"New Ashford",uid:25003,county:"Berkshire"},{name:"Newbury",uid:25009,county:"Essex"},{name:"Norton",uid:25005,county:"Bristol"},{name:"Orleans",uid:25001,county:"Barnstable"},{name:"Dedham",uid:25021,county:"Norfolk"},{name:"Marshfield",uid:25023,county:"Plymouth"},{name:"Maynard",uid:25017,county:"Middlesex"},{name:"Melrose",uid:25017,county:"Middlesex"},{name:"Easthampton",uid:25015,county:"Hampshire"},{name:"Brookfield",uid:25027,county:"Worcester"},{name:"Brookline",uid:25021,county:"Norfolk"},{name:"Erving",uid:25011,county:"Franklin"},{name:"Dracut",uid:25017,county:"Middlesex"},{name:"Deerfield",uid:25011,county:"Franklin"},{name:"Dighton",uid:25005,county:"Bristol"},{name:"Hadley",uid:25015,county:"Hampshire"},{name:"Abington",uid:25023,county:"Plymouth"},{name:"Plympton",uid:25023,county:"Plymouth"},{name:"Bridgewater",uid:25023,county:"Plymouth"},{name:"Brimfield",uid:25013,county:"Hampden"},{name:"Merrimac",uid:25009,county:"Essex"},{name:"Colrain",uid:25011,county:"Franklin"},{name:"Dalton",uid:25003,county:"Berkshire"},{name:"East Longmeadow",uid:25013,county:"Hampden"},{name:"Easton",uid:25005,county:"Bristol"},{name:"Edgartown",uid:25007,county:"Dukes"},{name:"Egremont",uid:25003,county:"Berkshire"},{name:"Falmouth",uid:25001,county:"Barnstable"},{name:"Acushnet",uid:25005,county:"Bristol"},{name:"Franklin",uid:25021,county:"Norfolk"},{name:"Foxborough",uid:25021,county:"Norfolk"},{name:"Andover",uid:25009,county:"Essex"},{name:"Millbury",uid:25027,county:"Worcester"},{name:"Monterey",uid:25003,county:"Berkshire"},{name:"Chilmark",uid:25007,county:"Dukes"},{name:"Framingham",uid:25017,county:"Middlesex"},{name:"Lanesborough",uid:25003,county:"Berkshire"},{name:"Leicester",uid:25027,county:"Worcester"},{name:"Agawam",uid:25013,county:"Hampden"},{name:"Amesbury",uid:25009,county:"Essex"},{name:"Arlington",uid:25017,county:"Middlesex"},{name:"Ashland",uid:25017,county:"Middlesex"},{name:"Athol",uid:25027,county:"Worcester"},{name:"Mount Washington",uid:25003,county:"Berkshire"},{name:"Ayer",uid:25017,county:"Middlesex"},{name:"Belmont",uid:25017,county:"Middlesex"},{name:"Berkley",uid:25005,county:"Bristol"},{name:"Rehoboth",uid:25005,county:"Bristol"},{name:"Chicopee",uid:25013,county:"Hampden"},{name:"Conway",uid:25011,county:"Franklin"},{name:"Littleton",uid:25017,county:"Middlesex"},{name:"Danvers",uid:25009,county:"Essex"},{name:"Huntington",uid:25015,county:"Hampshire"},{name:"Kingston",uid:25023,county:"Plymouth"},{name:"Montague",uid:25011,county:"Franklin"},{name:"Buckland",uid:25011,county:"Franklin"},{name:"Cambridge",uid:25017,county:"Middlesex"},{name:"Richmond",uid:25003,county:"Berkshire"},{name:"Canton",uid:25021,county:"Norfolk"},{name:"Carlisle",uid:25017,county:"Middlesex"},{name:"Hinsdale",uid:25003,county:"Berkshire"},{name:"Cohasset",uid:25021,county:"Norfolk"},{name:"Concord",uid:25017,county:"Middlesex"},{name:"Rutland",uid:25027,county:"Worcester"},{name:"Dover",uid:25021,county:"Norfolk"},{name:"Holland",uid:25013,county:"Hampden"},{name:"Dudley",uid:25027,county:"Worcester"},{name:"East Bridgewater",uid:25023,county:"Plymouth"},{name:"East Brookfield",uid:25027,county:"Worcester"},{name:"Braintree",uid:25021,county:"Norfolk"},{name:"Brewster",uid:25001,county:"Barnstable"},{name:"Becket",uid:25003,county:"Berkshire"},{name:"Bedford",uid:25017,county:"Middlesex"},{name:"Bellingham",uid:25021,county:"Norfolk"},{name:"Chelmsford",uid:25017,county:"Middlesex"},{name:"Chelsea",uid:25025,county:"Suffolk"},{name:"Chesterfield",uid:25015,county:"Hampshire"},{name:"Hanson",uid:25023,county:"Plymouth"},{name:"Harvard",uid:25027,county:"Worcester"},{name:"Harwich",uid:25001,county:"Barnstable"},{name:"Hatfield",uid:25015,county:"Hampshire"},{name:"Carver",uid:25023,county:"Plymouth"},{name:"Charlemont",uid:25011,county:"Franklin"},{name:"Hampden",uid:25013,county:"Hampden"},{name:"Hancock",uid:25003,county:"Berkshire"},{name:"Haverhill",uid:25009,county:"Essex"},{name:"Heath",uid:25011,county:"Franklin"},{name:"Holbrook",uid:25021,county:"Norfolk"},{name:"Hudson",uid:25017,county:"Middlesex"},{name:"Holyoke",uid:25013,county:"Hampden"},{name:"Hopedale",uid:25027,county:"Worcester"},{name:"Holliston",uid:25017,county:"Middlesex"},{name:"Hopkinton",uid:25017,county:"Middlesex"},{name:"Milton",uid:25021,county:"Norfolk"},{name:"Seekonk",uid:25005,county:"Bristol"},{name:"Medway",uid:25021,county:"Norfolk"},{name:"Lenox",uid:25003,county:"Berkshire"},{name:"Leominster",uid:25027,county:"Worcester"},{name:"Lexington",uid:25017,county:"Middlesex"},{name:"Leyden",uid:25011,county:"Franklin"},{name:"Lincoln",uid:25017,county:"Middlesex"},{name:"Methuen",uid:25009,county:"Essex"},{name:"Hingham",uid:25023,county:"Plymouth"},{name:"Natick",uid:25017,county:"Middlesex"},{name:"Shrewsbury",uid:25027,county:"Worcester"},{name:"Manchester",uid:25009,county:"Essex"},{name:"Freetown",uid:25005,county:"Bristol"},{name:"Gardner",uid:25027,county:"Worcester"},{name:"Georgetown",uid:25009,county:"Essex"},{name:"Monroe",uid:25011,county:"Franklin"},{name:"Southbridge",uid:25027,county:"Worcester"},{name:"Stockbridge",uid:25003,county:"Berkshire"},{name:"Gill",uid:25011,county:"Franklin"},{name:"Granby",uid:25015,county:"Hampshire"},{name:"Greenfield",uid:25011,county:"Franklin"},{name:"Lawrence",uid:25009,county:"Essex"},{name:"Groton",uid:25017,county:"Middlesex"},{name:"Groveland",uid:25009,county:"Essex"},{name:"Monson",uid:25013,county:"Hampden"},{name:"Montgomery",uid:25013,county:"Hampden"},{name:"Stoneham",uid:25017,county:"Middlesex"},{name:"Stow",uid:25017,county:"Middlesex"},{name:"Nahant",uid:25009,county:"Essex"},{name:"Lee",uid:25003,county:"Berkshire"},{name:"Medford",uid:25017,county:"Middlesex"},{name:"Hanover",uid:25023,county:"Plymouth"},{name:"Southborough",uid:25027,county:"Worcester"},{name:"Mattapoisett",uid:25023,county:"Plymouth"},{name:"Reading",uid:25017,county:"Middlesex"},{name:"Medfield",uid:25021,county:"Norfolk"},{name:"Lowell",uid:25017,county:"Middlesex"},{name:"New Bedford",uid:25005,county:"Bristol"},{name:"Halifax",uid:25023,county:"Plymouth"},{name:"Watertown",uid:25017,county:"Middlesex"},{name:"Needham",uid:25021,county:"Norfolk"},{name:"New Marlborough",uid:25003,county:"Berkshire"},{name:"Hamilton",uid:25009,county:"Essex"},{name:"Fall River",uid:25005,county:"Bristol"},{name:"Marblehead",uid:25009,county:"Essex"},{name:"Aquinnah",uid:25007,county:"Dukes"},{name:"Goshen",uid:25015,county:"Hampshire"},{name:"Fairhaven",uid:25005,county:"Bristol"},{name:"Hull",uid:25023,county:"Plymouth"},{name:"Lakeville",uid:25023,county:"Plymouth"},{name:"Lancaster",uid:25027,county:"Worcester"},{name:"Ludlow",uid:25013,county:"Hampden"},{name:"Lynn",uid:25009,county:"Essex"},{name:"Lynnfield",uid:25009,county:"Essex"},{name:"Malden",uid:25017,county:"Middlesex"},{name:"Tewksbury",uid:25017,county:"Middlesex"},{name:"Shirley",uid:25017,county:"Middlesex"},{name:"Shutesbury",uid:25011,county:"Franklin"},{name:"Somerset",uid:25005,county:"Bristol"},{name:"Somerville",uid:25017,county:"Middlesex"},{name:"Provincetown",uid:25001,county:"Barnstable"},{name:"Randolph",uid:25021,county:"Norfolk"},{name:"Raynham",uid:25005,county:"Bristol"},{name:"Norwood",uid:25021,county:"Norfolk"},{name:"Oak Bluffs",uid:25007,county:"Dukes"},{name:"Northampton",uid:25015,county:"Hampshire"},{name:"West Springfield",uid:25013,county:"Hampden"},{name:"North Brookfield",uid:25027,county:"Worcester"},{name:"Pembroke",uid:25023,county:"Plymouth"},{name:"Northbridge",uid:25027,county:"Worcester"},{name:"Oakham",uid:25027,county:"Worcester"},{name:"Pepperell",uid:25017,county:"Middlesex"},{name:"Northfield",uid:25011,county:"Franklin"},{name:"Oxford",uid:25027,county:"Worcester"},{name:"Palmer",uid:25013,county:"Hampden"},{name:"Paxton",uid:25027,county:"Worcester"},{name:"Pittsfield",uid:25003,county:"Berkshire"},{name:"Norwell",uid:25023,county:"Plymouth"},{name:"New Salem",uid:25011,county:"Franklin"},{name:"North Adams",uid:25003,county:"Berkshire"},{name:"North Attleborough",uid:25005,county:"Bristol"},{name:"Rowley",uid:25009,county:"Essex"},{name:"Royalston",uid:25027,county:"Worcester"},{name:"Shelburne",uid:25011,county:"Franklin"},{name:"Norfolk",uid:25021,county:"Norfolk"},{name:"Sherborn",uid:25017,county:"Middlesex"},{name:"Phillipston",uid:25027,county:"Worcester"},{name:"New Braintree",uid:25027,county:"Worcester"},{name:"North Andover",uid:25009,county:"Essex"},{name:"Newburyport",uid:25009,county:"Essex"},{name:"Uxbridge",uid:25027,county:"Worcester"},{name:"Russell",uid:25013,county:"Hampden"},{name:"Newton",uid:25017,county:"Middlesex"},{name:"Sturbridge",uid:25027,county:"Worcester"},{name:"Rowe",uid:25011,county:"Franklin"},{name:"Peru",uid:25003,county:"Berkshire"},{name:"North Reading",uid:25017,county:"Middlesex"},{name:"Sterling",uid:25027,county:"Worcester"},{name:"Stoughton",uid:25021,county:"Norfolk"},{name:"Sudbury",uid:25017,county:"Middlesex"},{name:"Sunderland",uid:25011,county:"Franklin"},{name:"Swampscott",uid:25009,county:"Essex"},{name:"Warwick",uid:25011,county:"Franklin"},{name:"Wellfleet",uid:25001,county:"Barnstable"},{name:"Middlefield",uid:25015,county:"Hampshire"},{name:"Rochester",uid:25023,county:"Plymouth"},{name:"Middleton",uid:25009,county:"Essex"},{name:"Milford",uid:25027,county:"Worcester"},{name:"Whately",uid:25011,county:"Franklin"},{name:"Millis",uid:25021,county:"Norfolk"},{name:"Williamstown",uid:25003,county:"Berkshire"},{name:"Orange",uid:25011,county:"Franklin"},{name:"Peabody",uid:25009,county:"Essex"},{name:"Pelham",uid:25015,county:"Hampshire"},{name:"Princeton",uid:25027,county:"Worcester"},{name:"Sharon",uid:25021,county:"Norfolk"},{name:"Southwick",uid:25013,county:"Hampden"},{name:"Wakefield",uid:25017,county:"Middlesex"},{name:"Springfield",uid:25013,county:"Hampden"},{name:"Revere",uid:25025,county:"Suffolk"},{name:"Rockport",uid:25009,county:"Essex"},{name:"Winchendon",uid:25027,county:"Worcester"},{name:"Windsor",uid:25003,county:"Berkshire"},{name:"Worcester",uid:25027,county:"Worcester"},{name:"Wrentham",uid:25021,county:"Norfolk"},{name:"Truro",uid:25001,county:"Barnstable"},{name:"Tyngsborough",uid:25017,county:"Middlesex"},{name:"Upton",uid:25027,county:"Worcester"},{name:"West Tisbury",uid:25007,county:"Dukes"},{name:"Westfield",uid:25013,county:"Hampden"},{name:"Westminster",uid:25027,county:"Worcester"},{name:"Sandisfield",uid:25003,county:"Berkshire"},{name:"Weston",uid:25017,county:"Middlesex"},{name:"Sandwich",uid:25001,county:"Barnstable"},{name:"Westwood",uid:25021,county:"Norfolk"},{name:"Saugus",uid:25009,county:"Essex"},{name:"Savoy",uid:25003,county:"Berkshire"},{name:"Weymouth",uid:25021,county:"Norfolk"},{name:"South Hadley",uid:25015,county:"Hampshire"},{name:"Swansea",uid:25005,county:"Bristol"},{name:"Southampton",uid:25015,county:"Hampshire"},{name:"Taunton",uid:25005,county:"Bristol"},{name:"West Newbury",uid:25009,county:"Essex"},{name:"Templeton",uid:25027,county:"Worcester"},{name:"Wellesley",uid:25021,county:"Norfolk"},{name:"Tisbury",uid:25007,county:"Dukes"},{name:"Tolland",uid:25013,county:"Hampden"},{name:"Walpole",uid:25021,county:"Norfolk"},{name:"Waltham",uid:25017,county:"Middlesex"},{name:"Warren",uid:25027,county:"Worcester"},{name:"Wayland",uid:25017,county:"Middlesex"},{name:"Webster",uid:25027,county:"Worcester"},{name:"Wales",uid:25013,county:"Hampden"},{name:"Wendell",uid:25011,county:"Franklin"},{name:"Salisbury",uid:25009,county:"Essex"},{name:"Topsfield",uid:25009,county:"Essex"},{name:"West Stockbridge",uid:25003,county:"Berkshire"},{name:"Westborough",uid:25027,county:"Worcester"},{name:"Westport",uid:25005,county:"Bristol"},{name:"Woburn",uid:25017,county:"Middlesex"},{name:"Salem",uid:25009,county:"Essex"},{name:"Wilbraham",uid:25013,county:"Hampden"},{name:"Wilmington",uid:25017,county:"Middlesex"},{name:"Winthrop",uid:25025,county:"Suffolk"},{name:"Worthington",uid:25015,county:"Hampshire"}],CLIMATE_VULNERABILITY_TOWNS=_.map(_towns,function(e){return e.name}).sort();CLIMATE_VULNERABILITY_TOWN_TO_COUNTY={},_.each(_towns,function(e){CLIMATE_VULNERABILITY_TOWN_TO_COUNTY[e.name]=e.county});
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/utils.js */
var _slicedToArray=function(){function e(e,t){var r=[],n=!0,a=!1,l=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,l=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw l}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RendererTemplates={},Renderers={opacity:function(e){return e.is_hidden?0:!1===e.parameters.opacity?100:e.parameters.opacity/100},find_geojson_polygon_by_point:function(e,t){var r={type:"Point",coordinates:[e.latlng.lng,e.latlng.lat]};return _.find(t._layers,function(e){return gju.pointInPolygon(r,e.feature.geometry)})},update_legend:function(e){return function(t){"string"==typeof e.update_legend?t.legend_url=e.update_legend:e.update_legend?"object"===_typeof(e.update_legend)?(t.legend_url=e.update_legend.url,t.legend_url_text=e.update_legend.text):e.update_legend?e.update_legend(t):t.legend_url=null:t.legend_url=null}},geojson_add_to_map:function(e,t,r){r.addTo(e),t.leaflet_layer_ids=[r._leaflet_id],Views.ControlPanel.fire("tile-layer-loaded",{},t)},add_layer_error:function(e){Views.ControlPanel.fire("tile-layer-loading-error",{},e)},random:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},update_templates:function(e,t){if(!e.templates){e.templates={};var r=Renderers.random();t.legend_template&&!Ractive.partials[r]&&(Ractive.partials[r]=t.legend_template,e.templates.legend=r);var n=Renderers.random();t.info_template&&!Ractive.partials[n]&&(Ractive.partials[n]=t.info_template,e.templates.info=n);var a=Renderers.random();t.wizard_template&&!Ractive.partials[a]&&(Ractive.partials[a]=t.wizard_template,e.templates.wizard=a)}},is_loading_leaflet_layer:function(e,t){return e.loading_layers=e.loading_layers||{},e.loading_layers[stringify(t)]},loading_leaflet_layer:function(e,t){e.loading_layers=e.loading_layers||{},e.loading_layers[stringify(t)]=!0},loaded_leaflet_layer:function(e,t){e.loading_layers=e.loading_layers||{},e.loading_layers[stringify(t)]=!1},create_leaflet_layer_async:function(e,t,r,n,a){Renderers.get_leaflet_layer(e,t,r)||Renderers.is_loading_leaflet_layer(t,r)?a():(Renderers.loading_leaflet_layer(t,r),n().then(function(n){n.addTo(e),Renderers.save_leaflet_layer(t,n._leaflet_id,r),a()}))},create_leaflet_layer:function(e,t,r,n){if(!Renderers.get_leaflet_layer(e,t,r)&&!Renderers.is_loading_leaflet_layer(t,r)){Renderers.loading_leaflet_layer(t,r);var a=n();a.addTo(e),Renderers.save_leaflet_layer(t,a._leaflet_id,r)}},save_leaflet_layer:function(e,t,r){e.leaflet_layer_ids.push(Object.assign({},{id:stringify(r)},{leaflet_id:t})),Renderers.loaded_leaflet_layer(e,r)},get_all_leaflet_layers:function(e,t){var r=_.pluck(t.leaflet_layer_ids,"leaflet_id");return Renderers.lookup_layers(e,r)},get_leaflet_layer:function(e,t,r){var n,a=_.find(t.leaflet_layer_ids,{id:stringify(r)});return a&&(n=Renderers.lookup_layers(e,[a.leaflet_id])[0]),n},get_layer:function(e,t,r){var n=[];return e.eachLayer(function(e){e._leaflet_id===r.id&&_.contains(leaflet_layer_ids,e._leaflet_id)&&n.push(e)}),n},lookup_layers:function(e,t,r){var n=[];return e.eachLayer(function(e){_.contains(t,e._leaflet_id)&&n.push(e)}),n},layer_to_pane_name:function(e){return e.id.replace(/\W/,".")},remove:function(e,t){var r=Renderers.get_all_leaflet_layers(e,t);_.each(r,function(t){e.hasLayer(t)&&e.removeLayer(t)})},render:function(e,t,r){var n=Renderers[t.renderer_id],a=Renderers.layer_to_pane_name(t),l=e.getPane(a);l||((l=e.createPane(a)).style.pointerEvents="none"),l.style.zIndex=r,l.style.opacity=Renderers.opacity(t),n.render(e,t,a)},zoom_to:function(e,t){Views.ControlPanel.fire("map-set-view",{},e,t)},zoom_to_bounding_box:function(e){var t=e.split(",").map(parseFloat),r=_slicedToArray(t,4);west=r[0],south=r[1],east=r[2],north=r[3],Views.ControlPanel.fire("map-set-bbox",{},west,south,east,north)},utils:{zoom_to_location_link:function(e){return"Point"===e.type?"<a href='#' onclick='Renderers.zoom_to(["+e.coordinates[1]+","+e.coordinates[0]+"], 15);'>Zoom to feature</a>":e._northEast?"<a href='#' onclick='Renderers.zoom_to_bounding_box(\""+e.toBBoxString()+"\");'>Zoom to feature</a>":void 0},addPlusSign:function(e){return e>0?"+"+e:e.toString()}}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/base.js */
RendererTemplates.base=function(e,r,t){var a=Object.assign({},{pickle:function(e){e.leaflet_layer_ids=[],delete e.loading_layers,delete e.templates},clone_layer_name:r.clone_layer_name,parameters:r.parameters,get_feature_info_xml_url:r.get_feature_info_xml_url,get_feature_info_url:r.get_feature_info_url},r,t);return a.render=function(e,a,_){Renderers.update_templates(a,r),t.render(e,a,_)},a};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/geojson_points.js */
RendererTemplates.geojson_points_cache={},RendererTemplates.geojson_points=function(e,n){var t={},r=function(e){return e.parameters.options},a=function(e){return new Promise(function(n,r){RendererTemplates.geojson_points_cache[e]?n(RendererTemplates.geojson_points_cache[e]):t[e]||(t[e]=!0,$.ajax({cache:!0,dataType:"json",url:e,success:function(t){RendererTemplates.geojson_points_cache[e]=t,n(t)},error:function(e){r()}}))})},o=RendererTemplates.base(e,n,{render:function(e,t,o){a(n.url).then(function(a){Renderers.create_leaflet_layer_async(e,t,r(t),function(){return new Promise(function(e,r){var s=n.selectData?n.selectData(t,a.features):a.features;e(new L.GeoJSON(Object.assign({},a,{features:s}),{pointToLayer:function(e,r){if(n.pointToLayer)return n.pointToLayer(t,e,r)},pane:o,onEachFeature:function(e,r){n.onEachGeometry&&n.onEachGeometry(a,t,e,r),n.popupContents&&r.bindPopup(n.popupContents(e,t),{maxWidth:n.maxPopupWidth||300})}})),Views.ControlPanel.fire("tile-layer-loaded",{},t)})},function(){var n=Renderers.opacity(t),a=Renderers.get_all_leaflet_layers(e,t),o=Renderers.get_leaflet_layer(e,t,r(t));_.each(a,function(e){o&&o._leaflet_id===e._leaflet_id?Object.keys(e._layers).forEach(function(t){e._layers[t].setOpacity(n)}):Object.keys(e._layers).forEach(function(n){e._layers[n].setOpacity(0)})})})}).catch(function(e){Views.ControlPanel.fire("tile-layer-loading-error",{},t)})}});Renderers[e]=o};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/geojson_lines.js */
RendererTemplates.geojson_lines=function(e,n){var a={pickle:function(e){delete e.legend_url,e.leaflet_layer_ids=[]},update_legend:Renderers.update_legend(n),create_leaflet_layers:function(e,a){_.isEmpty(a.leaflet_layer_ids)&&(a.leaflet_layer_ids=["loading-so-we-avoid-race-conditions"],$.ajax({cache:!0,dataType:"json",url:n.url,success:function(r){var t=new L.GeoJSON(r,{pointToLayer:n.pointToLayer,onEachFeature:n.onEachFeature||function(e,a){n.popupContents&&a.bindPopup(n.popupContents(e))}});Renderers.geojson_add_to_map(e,a,t)},error:function(e){200!==e.status&&Renderers.add_layer_error(a)}}))}};a.render=function(e,r,t){alert("This is not converted"),a.update_legend(r),a.create_leaflet_layers(e,r);var o=Renderers.opacity(r),l=r.leaflet_layer_ids,s=Renderers.lookup_layers(e,l);_.each(s,function(e){_.each(e._layers,function(e){e.setStyle({opacity:o}),n.each_line&&n.each_line(e)})})},Renderers[e]=a};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/geojson_polygons.js */
RendererTemplates.geojson_polygons=function(e,n){var o={pickle:function(e){delete e.legend_url,e.leaflet_layer_ids=[]},update_legend:Renderers.update_legend(n),create_leaflet_layers:function(e,o){_.isEmpty(o.leaflet_layer_ids)&&(o.leaflet_layer_ids=["loading-so-we-avoid-race-conditions"],$.ajax({cache:!0,dataType:"json",url:n.url,success:function(a){var r=new L.GeoJSON(a,{pointToLayer:n.pointToLayer,onEachFeature:n.onEachFeature||function(e,o){n.popupContents&&o.bindPopup(n.popupContents(e))}});Renderers.geojson_add_to_map(e,o,r)},error:function(e){200!==e.status&&Renderers.add_layer_error(o)}}))},find_geo_json:function(e,o,a){var r=[],t=o.leaflet_layer_ids,l=Renderers.lookup_layers(e,t);return _.each(l,function(e){var t=Renderers.find_geojson_polygon_by_point(a,e);if(t&&n.find_geojson_match){var l=n.find_geojson_match(o,t);l&&r.push(l)}}),{features:r,geojson:r.length>0}}};o.render=function(e,a,r){alert("This is not converted"),o.update_legend(a),o.create_leaflet_layers(e,a);var t=Renderers.opacity(a),l=a.leaflet_layer_ids,s=Renderers.lookup_layers(e,l);_.each(s,function(e){_.each(e._layers,function(e){e.setStyle({fillOpacity:t,opacity:t}),n.each_polygon&&n.each_polygon(e)})})},Renderers[e]=o};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/wms.js */
RendererTemplates.wms=function(e,r){function n(e){var n=r.wms_opts;return"function"==typeof r.wms_opts&&(n=r.wms_opts(e)),n}var a=RendererTemplates.base(e,r,{render:function(e,a,o){Renderers.create_leaflet_layer(e,a,n(a),function(){var e=new L.TileLayer.WMS(r.url,_.merge({pane:o,minZoom:r.parameters.min_zoom||0,maxZoom:r.parameters.max_zoom||18},n(a)));return e.on("tileload",function(e){Views.ControlPanel.fire("tile-layer-loaded",{},a)}),e.on("tileerror",function(e){console.warn("layer_id","WMS Renderer",e),Views.ControlPanel.fire("tile-layer-loading-error",{},a)}),e.on("load",function(e){r.on_load&&r.on_load(a)}),e});var t=Renderers.opacity(a),l=Renderers.get_all_leaflet_layers(e,a),i=Renderers.get_leaflet_layer(e,a,n(a));_.each(l,function(e){i._leaflet_id===e._leaflet_id?e.setOpacity(t):e.setOpacity(0)})}});Renderers[e]=a};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/esri.js */
RendererTemplates.esri=function(e,r){function a(e){var a=r.esri_opts;return"function"==typeof r.esri_opts&&(a=r.esri_opts(e)),a}var n=RendererTemplates.base(e,r,{render:function(e,n,t){Renderers.create_leaflet_layer(e,n,a(n),function(){var e=L.esri.dynamicMapLayer(_.merge({useCors:!1,pane:t,minZoom:r.parameters.min_zoom||0,maxZoom:r.parameters.max_zoom||18},a(n)));return e.on("requestsuccess",function(e){Views.ControlPanel.fire("tile-layer-loaded",{},n)}),e.on("requesterror",function(e){Views.ControlPanel.fire("tile-layer-loading-error",{},n)}),e});var o=Renderers.opacity(n),s=Renderers.get_all_leaflet_layers(e,n),i=Renderers.get_leaflet_layer(e,n,a(n));_.each(s,function(e){i._leaflet_id===e._leaflet_id?e.setOpacity(o):e.setOpacity(0)})}});Renderers[e]=n};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/esri_feature_layer.js */
RendererTemplates.esri_feature_layer=function(e,r){function t(e){var t=r.esri_opts;return"function"==typeof r.esri_opts&&(t=r.esri_opts(e)),t}function n(e,t){if(r.setStyle)return r.setStyle(opacity,t);if(r.parameters.color_buckets){var n=_.find(r.parameters.color_buckets,function(n){var o=r.color_bucket_field;r.color_bucket_field instanceof Function&&(o=r.color_bucket_field(e));var l=_.get(t,o);return _.isArray(n.values)?1==n.values.length?n.values[0]==l:2==n.values.length?n.values[0]<=l&&n.values[1]>l:_.contains(v_.values,l):_.isFunction(n.values)?n.values(l):void console.log("Can't find this: ",t,l,r.parameters.color_buckets)});return n?{stroke:!0,color:n.stroke,weight:n.weight||1,fill:!0,fillColor:n.fill,clickable:!1}:(console.log("Can't find this: ",t,r.parameters.color_buckets),{})}}var o=RendererTemplates.base(e,r,{render:function(e,r,o){Renderers.create_leaflet_layer(e,r,t(r),function(){var e=L.esri.featureLayer(_.merge({useCors:!1,pane:o},t(r)));return e.on("load",function(e){Views.ControlPanel.fire("tile-layer-loaded",{},r)}),e.on("requesterror",function(e){Renderers.add_layer_error(r)}),e.on("error",function(e){Renderers.add_layer_error(r)}),t(r).pointToLayer||e.on("click",function(e){LeafletMap.fire("click",e,!0)}),e});var l=Renderers.opacity(r),a=Renderers.get_all_leaflet_layers(e,r),i=Renderers.get_leaflet_layer(e,r,t(r));_.each(a,function(e){_.each(a,function(e){i._leaflet_id===e._leaflet_id?e.setStyle(function(e){return Object.assign({},n(r,e),{opacity:l,fillOpacity:l})}):e.setStyle(function(){return{opacity:0,fillOpacity:0}})})})},find_geo_json:function(e,t,n){var o=[],l=t.leaflet_layer_ids,a=Renderers.lookup_layers(e,l);return _.each(a,function(e){var l=Renderers.find_geojson_polygon_by_point(n,e);if(l&&r.find_geojson_match){var a=r.find_geojson_match(t,l);a&&o.push(a)}}),{features:o,geojson:o.length>0}}});Renderers[e]=o};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/esri_feature_layer_points.js */
RendererTemplates.esri_feature_layer_points=function(e,r){function t(e){var t=r.esri_opts;return"function"==typeof r.esri_opts&&(t=r.esri_opts(e)),t}function n(e,n){if(r.setStyle)return r.setStyle(opacity,n);if(r.parameters.color_buckets){var o=_.find(r.parameters.color_buckets,function(t){var o=r.color_bucket_field;r.color_bucket_field instanceof Function&&(o=r.color_bucket_field(e));var a=_.get(n,o);return _.isArray(t.values)?1==t.values.length?t.values[0]==a:2==t.values.length?t.values[0]<=a&&t.values[1]>a:_.contains(v_.values,a):_.isFunction(t.values)?t.values(a):void console.log("Can't find this: ",n,a,r.parameters.color_buckets)});return o?{stroke:!0,color:o.stroke,weight:o.weight||1,fill:!0,fillColor:o.fill,clickable:!!t(e).pointToLayer}:(console.log("Can't find this: ",n,r.parameters.color_buckets),{})}}var o=RendererTemplates.base(e,r,{render:function(e,o,a){Renderers.create_leaflet_layer(e,o,t(o),function(){var e=_.merge({useCors:!1,pane:a},{pointToLayer:function(e,t){return r.marker(o,e,t,{pane:Renderers.layer_to_pane_name(o)})},onEachFeature:r.popup_content?function(e,t){t.bindPopup(r.popup_content(o,e,t))}:null},t(o)),n=L.esri.featureLayer(e);return n.on("load",function(e){Views.ControlPanel.fire("tile-layer-loaded",{},o)}),n.on("requesterror",function(e){Renderers.add_layer_error(o)}),n.on("error",function(e){Renderers.add_layer_error(o)}),n});var l=Renderers.get_all_leaflet_layers(e,o),i=Renderers.opacity(o),s=Renderers.get_leaflet_layer(e,o,t(o));_.each(l,function(e){_.each(l,function(e){s._leaflet_id===e._leaflet_id?e.setStyle(function(e){return Object.assign({},n(o,e),{opacity:i,fillOpacity:i})}):e.setStyle(function(){return{opacity:0,fillOpacity:0}})})})}});Renderers[e]=o};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/imported_geojson.js */
RendererTemplates.imported_geojson=function(e,t){var r={templates:{},parameters:{opacity:100},update_legend:Renderers.update_legend(t)};r.render=function(e,r,n){Renderers.create_leaflet_layer(e,r,r.id,function(){var e=new L.GeoJSON(t.data,{pane:n,style:function(e){var t=e.properties||{};return{stroke:!0,opacity:t["stroke-opacity"]||1,color:t.stroke||"#000",fillColor:"rgba(0,102,51,0.8)",weight:t["stroke-width"]||2}},onEachFeature:function(e,r){var n="";r.getBounds&&(n=Renderers.utils.zoom_to_location_link(r.getBounds())),r.bindPopup("<h5>"+t.name+"</h5>\n                <pre>"+JSON.stringify(e.properties,null,2)+"</pre>\n                <br/>\n                "+n+"\n                ")}});return Views.ControlPanel.fire("tile-layer-loaded",{},r),e});Renderers.opacity(r);var a=Renderers.get_all_leaflet_layers(e,r),l=Renderers.get_leaflet_layer(e,r,r.id);_.each(a,function(e){l._leaflet_id===e._leaflet_id?e.setStyle({opacity:100,fillOpacity:100}):e.setStyle({opacity:0,fillOpacity:0})})},Renderers[e]=r};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/ma_climate_data.js */
RendererTemplates.ma_climate_data_cache={},RendererTemplates.ma_climate_data_colorize=function(e,a,t,n){var r=_.findIndex(e,function(e){return n.invert_scale?a>=e:a<=e});return-1===r&&(r=e.length),t[r]},RendererTemplates.ma_climate_data_translation={Massachusetts:"MA","Barnstable County, MA":"Barnstable","Berkshire County, MA":"Berkshire","Bristol County, MA":"Bristol","Dukes County, MA":"Dukes","Essex County, MA":"Essex","Franklin County, MA":"Franklin","Hampden County, MA":"Hampden","Hampshire County, MA":"Hampshire","Middlesex County, MA":"Middlesex","Nantucket County, MA":"Nantucket","Norfolk County, MA":"Norfolk","Plymouth County, MA":"Plymouth","Suffolk County, MA":"Suffolk","Worcester County, MA":"Worcester","Blackstone Basin":"Blackstone","Boston Harbor Basin":"Boston Harbor","Buzzards Bay Basin":"Buzzards Bay","Cape Cod Basin":"Cape Cod","Charles Basin":"Charles","Chicopee Basin":"Chicopee","Connecticut Basin":"Connecticut","Deerfield Basin":"Deerfield","Farmington Basin":"Farmington","French Basin":"French","Housatonic Basin":"Housatonic","Hudson Basin":"Hudson","Islands Basin":"Islands","Ipswich Basin":"Ipswich","Merrimack Basin":"Merrimack","Millers Basin":"Millers","Narragansett Basin":"Narragansett Bay & Mt. Hope Bay Shore","Nashua Basin":"Nashua","North Coastal Basin":"North Coastal","Parker Basin":"Parker","Quinebaug Basin":"Quinebaug","Shawsheen Basin":"Shawsheen","South Coastal Basin":"South Coastal","SuAsCo Basin":"SuAsCo","Taunton Basin":"Taunton","Ten Mile Basin":"Ten Mile","Westfield Basin":"Westfield"},RendererTemplates.ma_climate_data=function(e,a){var t={county:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:county_boundary&maxFeatures=1000&outputFormat=application%2Fjson",state:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:state_boundary&maxFeatures=1000&outputFormat=application%2Fjson",basin:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:basins&maxFeatures=1000&outputFormat=application%2Fjson"},n=function(e){return{options:e.parameters.options}},r={},s=function(e){return new Promise(function(a,t){RendererTemplates.ma_climate_data_cache[e]?a(RendererTemplates.ma_climate_data_cache[e]):r[e]||(r[e]=!0,$.ajax({cache:!0,dataType:"json",url:e,success:function(t){RendererTemplates.ma_climate_data_cache[e]=t,a(t)},error:function(e){t()}}))})},o=function(e){return new Promise(function(a,t){RendererTemplates.ma_climate_data_cache[e]?a(_.cloneDeep(RendererTemplates.ma_climate_data_cache[e])):r[e]||(r[e]=!0,$.ajax({cache:!0,dataType:"json",url:e,success:function(t){RendererTemplates.ma_climate_data_cache[e]=t,a(_.cloneDeep(t))},error:function(e){t()}}))})},i=RendererTemplates.base(e,a,{find_geo_json:function(e,a,t){Renderers.get_all_leaflet_layers(e,a);var r=Renderers.get_leaflet_layer(e,a,n(a));Object.keys(r._layers)[0];if(r){t.latlng;var s=leafletPip.pointInLayer(t.latlng,r,!0);return s[0]?s[0].feature.properties:null}return null},render:function(e,r,i){s(a.data_url).then(function(s){a.onLoadedData&&a.onLoadedData(s,r),Renderers.create_leaflet_layer_async(e,r,n(r),function(){return new Promise(function(e,n){o(t[r.parameters.options.summary]).then(function(t){var n=new L.GeoJSON(t,{pointToLayer:a.pointToLayer,pane:i,onEachFeature:function(e,t){a.onEachGeometry(s,r,e,t)}});e(n),Views.ControlPanel.fire("tile-layer-loaded",{},r)}).catch(function(e){200!==e.status&&Views.ControlPanel.fire("tile-layer-loading-error",{},r),n()})})},function(){var a=Renderers.opacity(r),t=Renderers.get_all_leaflet_layers(e,r),s=Renderers.get_leaflet_layer(e,r,n(r)),o={weight:"1",color:"black"};_.each(t,function(e){s&&s._leaflet_id===e._leaflet_id?e.setStyle(function(e){return _.merge({},o,{opacity:a,fillOpacity:Math.max(0,a-.1)})}):e.setStyle(function(e){return _.merge({},o,{opacity:0,fillOpacity:0})})})})})}});Renderers[e]=i};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/ma_observed_climate_data.js */
var findDataForMAObservedData=function(e,a,t,n){var r={};return _.each(e.features,function(e){e.properties.name===a&&_.each(e.properties.data,function(s){s.season===t&&(r=_.find(s.values,function(e){return e.year===n}))&&(r={value:r,season:t,year:n,area:a,season_data:s,area_data:e})})}),r};RendererTemplates.ma_observed_climate_data=function(e,a){RendererTemplates.ma_climate_data(e,{clone_layer_name:function(e){var t=e.parameters.options;return a.title+" Y:"+e.parameters.years[t.year_indx]+"s S:"+t.season+" by "+t.summary},info_template:"\n        <div class='col-xs-2'>\n          <label> {{{name}}}</label>\n          <i>Table shows decadal average for "+a.title+".  The value highlighted in dark green is the value corresponding to the season and decade currently selected on the map.   Hover over values to see the range (min/max) value for individual years within the currently selected decade. </i>\n        </div>\n        <div class='col-xs-10'>\n          <table class='table'>\n            <thead>\n              <tr>\n                <th style='text-align: center;'\n                    colspan='{{u.object_entries_count(active_layer.parameters.all_seasons) + 2}}'> {{geojson.name}} {{geojson.geomtype}}\n                </th>\n              </tr>\n              <tr>\n                <th> </th>\n                <th class='deltas' style='text-align: center;'\n                    colspan='{{u.object_entries_count(active_layer.parameters.all_seasons)}}'>\n                      "+a.legend+" </th>\n              </tr>\n              <tr>\n                <th> Season </th>\n                {{#active_layer.parameters.years}}\n                  <th> {{.}}s</th>\n                {{/active_layer.parameters.years}}\n              </tr>\n            </thead>\n            <tbody>\n              {{#u.sort_by(geojson.location_data.area_data.properties.data, 'season')}}\n                <tr class=\"{{(season === geojson.location_data.season ? 'active-season' : '')}}\">\n                  <td>{{u.capitalize(season)}}</td>\n                  {{#u.sort_by(values, 'year')}}\n                    <td as-tooltip\n                      data-tooltip=\"Range: {{range}}\"\n                      class='{{(year === geojson.location_data.year ? 'active-year' : '')}}'>{{{delta}}}</td>\n                  {{/sort_by(values, 'year')}}\n                </tr>\n              {{/u.sort_by(geojson.location_data.area_data.properties.data, 'season')}}\n            </tbody>\n          </table>\n        </div>\n    ",legend_template:"\n      <div class='detail-block show-confidence'>\n        <label as-tooltip='\"Choose a Summary Area\"'> Summary: </label>\n        <select value='{{parameters.options.summary}}'>\n          {{#u.to_sorted_values_from_hash(parameters.all_summaries)}}\n            <option value='{{key}}'>{{{value}}}</option>\n          {{/u.to_sorted_values_from_hash(parameters.all_summaries)}}\n        </select>\n      </div>\n      <div class='detail-block opacity'>\n        <label  as-tooltip='\"Use slider to adjust Decade\"'> Decade: </label>\n        <input type=\"range\" value=\"{{parameters.options.year_indx}}\"\n          min=\"0\"\n          max=\"{{parameters.years.length-1}}\">\n        {{parameters.years[parameters.options.year_indx]}}s\n      </div>\n      <div class='detail-block show-confidence'>\n        <label as-tooltip='\"Choose a Season\"'> Season: </label>\n        <select value='{{parameters.options.season}}'>\n          {{#u.to_sorted_values_from_hash(parameters.all_seasons)}}\n            <option value='{{key}}'>{{value}}</option>\n          {{/u.to_sorted_values_from_hash(parameters.all_seasons)}}\n        </select>\n      </div>\n\n      {{#{metrics: parameters.metrics_ranges[parameters.options.season],\n          legend: '"+a.legend+"',\n          inverted: '"+a.invert_scale+"',\n          quantiled: true,\n          signed: false,\n          precision: '"+a.legend_precision+"',\n          colors: parameters.color_range} }}\n        {{> map_color_block_legend_template }}\n      {{/{metrics: parameters.metrics_ranges[parameters.options.season]}}\n    ",data_url:a.data_url,onLoadedData:function(e,t){var n=_.uniq(_.flatten(_.map(e.features,function(e){return _.flatten(_.map(e.properties.data,function(e){return _.flatten(_.map(e.values,function(e){return e.year}))}))}))).sort();t.parameters.years=n;var r={};_.each(e.features,function(e){_.each(e.properties.data,function(e){r[e.season]=r[e.season]||[],_.each(e.values,function(a){r[e.season].push(a.delta)})})});var s=_.cloneDeep(t.parameters.color_range);a.invert_scale&&s.reverse(),_.each(t.parameters.all_seasons,function(e,n){var o=d3.scaleQuantile().domain(r[n]).range(s).quantiles();a.invert_scale&&o.reverse(),t.parameters.metrics_ranges[n]=o})},onEachGeometry:function(e,t,n,r){var s=t.parameters.options,o=RendererTemplates.ma_climate_data_colorize;try{var l=findDataForMAObservedData(e,n.properties.name,s.season,t.parameters.years[s.year_indx]);n.properties.location_data=l;var i=o(t.parameters.metrics_ranges[s.season],l.value.delta,t.parameters.color_range,a);r.setStyle({fillColor:i,color:i})}catch(a){n.properties.location_data=null,console.log("failed to find value for ",s.metric,"Feature Name:",n.properties.name,n.properties.name,"Available Names:",Object.keys(e));var c="transparent";r.setStyle({fillColor:c,color:c})}},parameters:{opacity:100,color_range:a.color_range,metrics_ranges:{},all_summaries:{county:"County",state:"State",basin:"Drainage Basin"},all_seasons:{annual:"Annual",fall:"Fall",winter:"Winter",spring:"Spring",summer:"Summer"},years:[],options:{year_indx:0,season:"annual",summary:"basin"}}})};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/ma_projected_climate_data.js */
var findDataForMAProjectedData=function(e,a,n,t,s){try{_.each(e.features,function(e){e.properties.name===a&&_.each(e.properties.data,function(r){if(r.season===n&&(data_value=_.find(r.values,function(e){return e.year===t}),data_value))throw{value:data_value["delta_"+s],season:n,scenario:s,year:t,area:a,season_data:r,area_data:e}})})}catch(e){return e}};RendererTemplates.ma_projected_climate_data=function(e,a){RendererTemplates.ma_climate_data(e,{clone_layer_name:function(e){var n=e.parameters.options;return a.title+" Y:"+e.parameters.year_map[e.parameters.years[n.year_indx]]+"s S:"+n.season+" by "+n.summary},info_template:"\n        <div class='col-xs-2'>\n          <label> {{{name}}}</label>\n          <i>Table shows estimated 50th percentile values for projected change in "+a.title+".  The value highlighted in dark green is the value corresponding to the season, decade and emissions scenario currently selected on the map.   Hover over values to see the likely range (10th to 90th percentile) for any given value. Projected decreases are denoted by a minus (-) sign .</i>\n        </div>\n        <div class='col-xs-10'>\n          <table class='table'>\n            <thead>\n              <tr>\n                <th style='text-align: center;'\n                    colspan='{{u.object_entries_count(active_layer.parameters.all_seasons) + 2}}'> {{geojson.name}} {{geojson.geomtype}}\n                </th>\n              </tr>\n              <tr>\n                <th> </th>\n                <th></th>\n                <th class='deltas' style='text-align: center;'\n                    colspan='{{u.object_entries_count(active_layer.parameters.all_seasons)}}'>\n                      "+a.legend+" </th>\n              </tr>\n              <tr>\n                <th> Season </th>\n                <th> Baseline ("+a.legend_units+")</th>\n                <th> Emissions Scenario </th>\n                {{#active_layer.parameters.years}}\n                  <th>  {{active_layer.parameters.year_map[.]}}s</th>\n                {{/active_layer.parameters.years}}\n              </tr>\n            </thead>\n              <tbody>\n                {{#u.sort_by(geojson.location_data.area_data.properties.data, 'season')}}\n                  <tr class=\" {{((\"high\" == geojson.location_data.scenario && season === geojson.location_data.season) ? 'active-scenario active-season' : '')}}\">\n                    <td >{{u.capitalize(season)}}</td>\n                    <td >{{u.to_fixed(baseline, "+a.info_precision+")}}</td>\n                    <td> High RCP8.5 </td>\n\n                    {{#u.sort_by(values, 'year')}}\n                      <td class='{{((year === geojson.location_data.year) ? 'active-year' : '')}}' as-tooltip\n                        data-tooltip=\"Likely range (10-90th percentile): {{range_high[0] > 0 ? '+' : ''}}{{range_high[0]}} to {{range_high[0] > 0 ? '+' : ''}}{{range_high[1]}}\">\n                      {{{u.add_sign(u.to_fixed(delta_high, "+a.info_precision+"))}}}</td>\n                    {{/sort_by(values, 'year')}}\n                  </tr>\n\n                  <tr class=\"{{((\"low\" == geojson.location_data.scenario  && season === geojson.location_data.season) ? 'active-scenario active-season' : '')}}\">\n\n                    <td>&nbsp;</td>\n                    <td>&nbsp;</td>\n                    <td> Medium RCP4.5 </td>\n\n                    {{#u.sort_by(values, 'year')}}\n                      <td class='{{((year === geojson.location_data.year) ? 'active-year' : '')}}' as-tooltip\n                        data-tooltip=\"Likely range (10-90th percentile): {{range_low[0] > 0 ? '+' : ''}}{{range_low[0]}} to {{range_low[1] > 0 ? '+' : ''}}{{range_low[1]}}\">\n                      {{{u.add_sign(u.to_fixed(delta_low, "+a.info_precision+"))}}}</td>\n                    {{/sort_by(values, 'year')}}\n                  </tr>\n                {{/u.sort_by(geojson.location_data.area_data.properties.data, 'season')}}\n              </tbody>\n          </table>\n        </div>\n    ",legend_template:"\n      <div class='detail-block show-confidence'>\n        <label as-tooltip='\"Choose an Emissions Scenario\"'> Scenario: </label>\n        <select value='{{parameters.options.scenario}}'>\n          {{#u.to_sorted_values_from_hash(parameters.all_scenarios)}}\n            <option value='{{key}}'>{{{value}}}</option>\n          {{/u.to_sorted_values_from_hash(parameters.all_scenarios)}}\n        </select>\n      </div>\n      <div class='detail-block show-confidence'>\n        <label as-tooltip='\"Choose a Summary Area\"'> Summary: </label>\n        <select value='{{parameters.options.summary}}'>\n          {{#u.to_sorted_values_from_hash(parameters.all_summaries)}}\n            <option value='{{key}}'>{{{value}}}</option>\n          {{/u.to_sorted_values_from_hash(parameters.all_summaries)}}\n        </select>\n      </div>\n      <div class='detail-block opacity'>\n        <label  as-tooltip='\"Use slider to adjust Decade\"'> Year: </label>\n        <input type=\"range\" value=\"{{parameters.options.year_indx}}\"\n          min=\"0\"\n          max=\"{{parameters.years.length-1}}\">\n        {{parameters.year_map[parameters.years[parameters.options.year_indx]]}}\n      </div>\n      <div class='detail-block show-confidence'>\n        <label as-tooltip='\"Choose a Season\"'> Season: </label>\n        <select value='{{parameters.options.season}}'>\n          {{#u.to_sorted_values_from_hash(parameters.all_seasons)}}\n            <option value='{{key}}'>{{value}}</option>\n          {{/u.to_sorted_values_from_hash(parameters.all_seasons)}}\n        </select>\n      </div>\n\n      {{#{metrics: parameters.metrics_ranges[parameters.options.season][parameters.options.scenario],\n          legend: '"+a.legend+"',\n          inverted: '"+a.invert_scale+"',\n          quantiled: true,\n          signed: true,\n          precision: '"+a.legend_precision+"',\n          colors: parameters.color_range} }}\n        {{> map_color_block_legend_template }}\n      {{/{metrics: parameters.metrics_ranges[parameters.options.season]}}\n    ",data_url:a.data_url,onLoadedData:function(e,n){var t=_.uniq(_.flatten(_.map(e.features,function(e){return _.flatten(_.map(e.properties.data,function(e){return _.flatten(_.map(e.values,function(e){return e.year}))}))}))).sort();n.parameters.years=t;var s={};_.each(e.features,function(e){_.each(e.properties.data,function(e){s[e.season]=s[e.season]||{high:[],low:[]},_.each(e.values,function(a){s[e.season].high.push(a.delta_high),s[e.season].low.push(a.delta_low)})})});var r=_.cloneDeep(n.parameters.color_range);a.invert_scale&&r.reverse(),_.each(n.parameters.all_seasons,function(e,t){var o=[].concat(s[t].high.concat(s[t].low)),l=d3.scaleQuantile().domain(o).range(r).quantiles();a.invert_scale&&l.reverse(),n.parameters.metrics_ranges[t]={low:l,high:l}})},onEachGeometry:function(e,n,t,s){var r=n.parameters.options,o=RendererTemplates.ma_climate_data_colorize;try{var l=findDataForMAProjectedData(e,t.properties.name,r.season,n.parameters.years[r.year_indx],r.scenario);t.properties.location_data=l;var i=o(n.parameters.metrics_ranges[r.season][r.scenario],l.value,n.parameters.color_range,a);s.setStyle({fillColor:i,color:i})}catch(a){t.properties.location_data=null;var c=_.map(e.features,function(e){return e.properties.name});console.log("failed to find value for ",r.metric,"Feature Name: [",t.properties.name,"] ","Available Names:",c,a);var d="transparent";s.setStyle({fillColor:d,color:d})}},parameters:{opacity:100,color_range:a.color_range,metrics_ranges:{},all_summaries:{county:"County",state:"Massachusetts - Statewide",basin:"Drainage Basin"},all_scenarios:{high:"High RCP8.5",low:"Medium RCP4.5"},all_seasons:{annual:"Annual",fall:"Fall",winter:"Winter",spring:"Spring",summer:"Summer"},years:[],options:{year_indx:0,season:"annual",summary:"basin",scenario:"high"},year_map:{2035:2030,2055:2050,2075:2070,2090:2090}}})};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderer_templates/ma_climate_vulnerability.js */
!function(){var e={},a={};RendererTemplates.ma_climate_vulnerability_layers=function(){return e},RendererTemplates.ma_climate_vulnerability_associated_layers=function(){return a},RendererTemplates.ma_climate_vulnerability=function(t,r){e[r.key_name]=t;RendererTemplates.wms(t,_.merge({on_load:function(e){a[r.key_name]=a[r.key_name]||[],console.log(a)},parameters:{opacity:70,town:!1,wms_layer:r.wms_layer},clone_layer_name:function(e){return e.name+" Layer:"+e.parameters.town},url:CDN("https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms"),wms_opts:function(e){var a=e.parameters.town;return{layers:r.wms_layer,cql_filter:"town='"+a+"'",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var a=e.parameters.town;return CDN("https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS="+r.wms_layer+"&QUERY_LAYERS="+r.wms_layer+"&CQL_FILTER=town='"+a+"'&PROPERTYNAME=county,town,climate_effect,category,label,stats&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n          <div class='detail-block show-confidence'>\n            <label> Legend: </label>\n              <img src='https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER={{parameters.wms_layer}}&format=image/png'/>\n          </div>\n      ",got_feature_info_response:function(e,a){return new Promise(function(a,t){var n=CLIMATE_VULNERABILITY_TOWN_TO_COUNTY[e.parameters.town];if(n&&r.gfi_fields&&r.gfi_fields.length>0){var s=CDN("https://repository.nescaum-ccsc-dataservices.com/climate-data/details"),o={variables:r.gfi_fields.join(","),states:"ma",years:"2050",counties:n};$.getJSON(s,o,function(e){var t={};e.forEach(function(e){_.set(t,[e.year,e.variable,e.season],e.data)}),a({keypath:"ma_climate_vulnerability_response",value:t})})}})}},r))}}();
</script>


    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/acec.js */
RendererTemplates.wms("acec",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:"https://giswebservices.massgis.state.ma.us/geoserver/wms/",wms_opts:function(e){return{layers:"massgis:GISDATA.ACECS_POLY",format:"image/png",opacity:0,transparent:!0}},get_feature_info_url:function(e){return"https://giswebservices.massgis.state.ma.us/geoserver/wms/?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.ACECS_POLY&QUERY_LAYERS=massgis:GISDATA.ACECS_POLY&PROPERTYNAME=name,acec_acres&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.ACECS_POLY&format=image/png\")}}'/> Areas of Concern\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} ({{properties.acec_acres}} acres)\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/aquifers.js */
RendererTemplates.wms("aquifers",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.AQUIFERS_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.AQUIFERS_POLY&QUERY_LAYERS=massgis:GISDATA.AQUIFERS_POLY&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.AQUIFERS_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Yield= {{properties.YIELD_GPM}} GPM\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/barrier_beaches.js */
RendererTemplates.wms("barrier_beaches",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:barrier_beaches",format:"image/png",opacity:0,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:barrier_beaches&QUERY_LAYERS=ma:barrier_beaches&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER=ma:barrier_beaches&format=image/png\")}}'/> Barrier Beaches\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Beach Name: {{properties.bbname}} (ID={{properties.bbpolyid}})\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/bicycle_trails.js */
RendererTemplates.wms("bicycle_trails",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.BIKETRAILS_ARC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.BIKETRAILS_ARC&QUERY_LAYERS=massgis:GISDATA.BIKETRAILS_ARC&PROPERTYNAME=trailname,owner&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.BIKETRAILS_ARC&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.trailname}} (OWNER: {{properties.owner}})\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/biomap_core.js */
RendererTemplates.wms("biomap_core",{parameters:{opacity:70,layer:"BM2_CH_FOREST_CORE",options:{layer:{BM2_CH_FOREST_CORE:"Forest",BM2_CH_BIOMAP2_WETLANDS:"Wetlands",BM2_CH_AQUATIC_CORE:"Aquatic",BM2_CRITICAL_NATURAL_LANDSCAPE:"Natural Landscape",BM2_CORE_HABITAT:"Habitat"}}},clone_layer_name:function(e){return e.name+" Layer:"+e.parameters.layer},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA."+e.parameters.layer,format:"image/png",opacity:0,zIndex:-1,transparent:!0}},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Layer: </label>\n        <select value='{{parameters.layer}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.layer)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.layer)}}\n        </select>\n      </div>\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n          <img src='https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.{{parameters.layer}}&format=image/png'/>\n      </div>\n\n\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/boundary_counties.js */
RendererTemplates.wms("boundary_counties",{parameters:{opacity:70,options:{}},clone_layer_name:function(n){return n.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(n){return{layers:"ma:county_boundary",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(n){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:county_boundary&QUERY_LAYERS=ma:county_boundary&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:county_boundary&format=image/png'/> County Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} County\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/boundary_huc8.js */
RendererTemplates.wms("boundary_huc8",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:huc8",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:huc8&QUERY_LAYERS=ma:huc8&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:huc8&format=image/png'/> HUC8 Watershed Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} Watershed\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/huc10.js */
RendererTemplates.wms("huc10",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.NRCSHUC10_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.NRCSHUC10_POLY&QUERY_LAYERS=massgis:GISDATA.NRCSHUC10_POLY&PROPERTYNAME=hu_10_name&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.NRCSHUC10_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.hu_10_name}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/boundary_state.js */
RendererTemplates.wms("boundary_state",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:state_boundary",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:state_boundary&QUERY_LAYERS=ma:state_boundary&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:state_boundary&format=image/png'/> State Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            State of Massachussetts\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/boundary_state_mask.js */
RendererTemplates.wms("boundary_state_mask",{parameters:{opacity:70,style:"black",options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:state_mask",format:"image/png",styles:"state_mask_"+e.parameters.style,opacity:0,zIndex:-1,transparent:!0}},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:state_mask&style=state_mask_{{parameters.style}}&format=image/png'/> State Mask\n        <div class='detail-block show-confidence'>\n          <label as-tooltip='\"Choose a color\"'> Color: </label>\n          <select value='{{parameters.style}}'>\n              <option value='black'>Black</option>\n              <option value='white'>White</option>\n          </select>\n        </div>\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} Watershed\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/boundary_towns.js */
RendererTemplates.wms("boundary_towns",{parameters:{opacity:70,options:{}},clone_layer_name:function(n){return n.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(n){return{layers:"ma:towns",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(n){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:towns&QUERY_LAYERS=ma:towns&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:towns&format=image/png'/> State Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.town}} TOWNSHIP\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/dams.js */
RendererTemplates.wms("dams",{parameters:{opacity:70,min_zoom:12,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.DAMS_PT",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.DAMS_PT&QUERY_LAYERS=massgis:GISDATA.DAMS_PT&PROPERTYNAME=damname,hazcode&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.DAMS_PT&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.damname}}, hazard code: {{properties.hazcode}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/dcr_roads_trails.js */
RendererTemplates.wms("dcr_roads_trails",{parameters:{opacity:70,min_zoom:14,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.DCR_ROADS_TRAILS_ARC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.DCR_ROADS_TRAILS_ARC&QUERY_LAYERS=massgis:GISDATA.DCR_ROADS_TRAILS_ARC&PROPERTYNAME=name,width&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.DCR_ROADS_TRAILS_ARC&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} {{properties.width}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/electric_providers.js */
RendererTemplates.wms("electric_providers",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.TOWNS_POLY_V_ELEC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.TOWNS_POLY_V_ELEC&QUERY_LAYERS=massgis:GISDATA.TOWNS_POLY_V_ELEC&PROPERTYNAME=elec_label&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.TOWNS_POLY_V_ELEC&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.elec_label}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/env_justice.js */
RendererTemplates.wms("env_justice",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.EJ_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.EJ_POLY&QUERY_LAYERS=massgis:GISDATA.EJ_POLY&PROPERTYNAME=town2,logsf1,pct_no_eng,med_hh_inc,pct_min,pct_lt_hs_&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.EJ_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n          <table class='table'>\n            <thead>\n              <tr>\n                <th> Town </th>\n                <th> Census 2010<br/>Summary ID </th>\n                <th> % Minority </th>\n                <th> Median household<br/>income </th>\n                <th> % No high school<br/>diploma</th>\n                <th> % No English </th>\n              </tr>\n            </thead>\n             <tbody>\n                {{#json.features}}\n                  <tr><td>{{properties.town2}}</td>\n                  <td>{{properties.logsf1}}</td>\n                  <td>{{properties.pct_min}}</td>\n                  <td>{{properties.med_hh_inc}}</td>\n                  <td>{{properties.pct_lt_hs_}}</td>\n                  <td>{{properties.pct_no_eng}}</td> </tr>\n                {{ else }}\n                  Unknown / No Response\n                {{/json.features}}\n              </tbody>\n          </table>\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/example_esri_feature_layer.js */
RendererTemplates.esri_feature_layer_points("example_esri_feature_layer",{parameters:{opacity:!1,color_buckets:[{fill:"rgba(56,168,0, 200)",stroke:"rgba(56,168,0,255)",label:"0%",values:[0]},{fill:"rgba(121,201,0,200)",stroke:"rgba(121,201,0,255)",label:"1% - 15%",values:[.001,.15]},{fill:"rgba(206,237,0,200)",stroke:"rgba(206,237,0,255)",label:"16% - 30%",values:[.15,.3]},{fill:"rgba(255,204,0,200)",stroke:"rgba(255,204,0,255)",label:"31% - 50%",values:[.3,.5]},{fill:"rgba(255,102,0, 200)",stroke:"rgba(255,102,0, 255)",label:"51% - 75%",values:[.5,.75]},{fill:"rgba(255,0,0, 200)",stroke:"rgba(255,0,0, 255)",label:"76% - 100%",values:[.75,2]}]},color_bucket_field:"properties.Percent_Low_or_High_Alert",legend_template:'\n    <div class=\'detail-block legend\'>\n      {{#parameters.color_buckets}}\n        <div class=\'color-block\' style="width: {{100.0 / parameters.color_buckets.length}}%;">\n              <svg width="100" height="100">\n                <rect height="100" width="100" style="fill: {{fill}}; stroke: {{stroke}}; opacity:1; "/>\n              </svg>\n              <label>{{label}}</label>\n        </div>\n      {{/parameters.color_buckets}}\n    </div>\n  ',esri_opts:{url:CDN("https://services.arcgis.com/YKJ5JtnaPQ2jDbX8/arcgis/rest/services/Cyanobacteria_2013_to_Present_Summary/FeatureServer/0")},marker:function(e,r,t,l){return L.circleMarker(t,_.merge(l,{radius:5}))},popup_content:function(e,r,t){return"<strong>"+r.properties.Station+"</strong></br>Report Frequency:"+r.properties.Report_Frequency+"<br/>Total Observations:"+r.properties.Total_Routine_Observations+"<br/>High/Low/Safe Observations:"+r.properties.High_Alert_Observations+" / "+r.properties.Low_Alert_Observations+" / "+r.properties.Generally_Safe_Observations+"<br/><br/>"+Renderers.utils.zoom_to_location_link(r.geometry)}});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/example_esri_layer.js */
RendererTemplates.esri("example_esri_layer",{parameters:{opacity:70,species:5,scenario:0,options:{species:{4:"Red Maple",5:"Sugar Maple",7:"Yellow Birch",10:"Pignut Hickory",14:"American Beech",15:"White Ash",28:"Red Spruce",35:"Eastern White Pine",40:"Quaking Aspen",41:"Black Cherry",42:"White Oak",49:"Northern Red Oak",55:"Eastern Hemlock"},scenarios:{0:"Current",56:"Low",112:"High"}}},legend_template:"\n    <div class='detail-block show-confidence'>\n      <label as-tooltip='\"Choose a tree species\"'> Species: </label>\n\n      <select value='{{parameters.species}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.species)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.species)}}\n      </select>\n    </div>\n    <div class='detail-block show-confidence'>\n      <label as-tooltip='\"Choose a tree species\"'> Scenario: </label>\n      <select value='{{parameters.scenario}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n      </select>\n    </div>\n\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/taccimo.jpg\">\n    </div>\n  ",clone_layer_name:function(e){var s=e.parameters,a=s.options.scenarios[s.scenario],r=s.options.species[s.species];return e.name+" "+r+" : "+a},esri_opts:function(e){var s=e.parameters.scenario,a=e.parameters.species;return{layers:[Number(s)+Number(a)],url:CDN("http://wassimap.sgcp.ncsu.edu:8399/arcgis/rest/services/taccimo/treeatlas_high/MapServer"),attribution:"USFS",f:"image",clickable:!1}}});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/example_wms_layer.js */
RendererTemplates.wms("example_wms_layer",{parameters:{opacity:70,year:2e3,options:{}},clone_layer_name:function(e){return e.name+" Year:"+e.parameters.year},url:CDN("http://sedac.ciesin.columbia.edu/geoserver/wms"),wms_opts:function(e){return{layers:"anthromes:anthromes-anthropogenic-biomes-world-v2-"+e.parameters.year,format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var a=e.parameters.year;return CDN("http://sedac.ciesin.columbia.edu/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=anthromes:anthromes-anthropogenic-biomes-world-v2-"+a+"&QUERY_LAYERS=anthromes:anthromes-anthropogenic-biomes-world-v2-"+a+"&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:'\n      <div class=\'detail-block show-confidence\'>\n        <label> Model Year: </label>\n        <input type="radio" name=\'{{parameters.year}}\' value="1800"> 1800\n        <input type="radio" name=\'{{parameters.year}}\' value="1900"> 1900\n        <input type="radio" name=\'{{parameters.year}}\' value="2000"> 2000\n        <img src=\'{{CDN("http://sedac.ciesin.columbia.edu/geoserver/wms?request=GetLegendGraphic&LAYER=anthromes:anthromes-anthropogenic-biomes-world-v2-1700&format=image/png")}}\'/>\n      </div>\n  ',info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Value: {{properties.GRAY_INDEX}}\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/fire_stations.js */
RendererTemplates.wms("fire_stations",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.FIRESTATIONS_PT_MEMA",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.FIRESTATIONS_PT_MEMA&QUERY_LAYERS=massgis:GISDATA.FIRESTATIONS_PT_MEMA&PROPERTYNAME=name,office,address&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.FIRESTATIONS_PT_MEMA&format=image/png\")}}'/> Fire Station\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}} ({{properties.office}}, {{properties.address}})\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/flood_zones.js */
RendererTemplates.wms("flood_zones",{parameters:{opacity:70,min_zoom:11,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.FEMA_NFHL_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.FEMA_NFHL_POLY&QUERY_LAYERS=massgis:GISDATA.FEMA_NFHL_POLY&PROPERTYNAME=dfirm_id,label,fld_ar_id&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.FEMA_NFHL_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'><table class='table'>\n            <thead>\n              <tr>\n                <th> DFIRM_ID </th>\n                <th> FLD_AR_ID </th>\n                <th> Zone Info</th>\n              </tr>\n            </thead>\n             <tbody>\n                {{#json.features}}\n                  <tr>\n                    <td>{{properties.dfirm_id}}</td>\n                    <td>{{properties.fld_ar_id}}</td>\n                    <td>{{properties.label}}</td>\n                  </tr>\n                {{ else }}\n                  Unknown / No Response\n                {{/json.features}}\n              </tbody>\n          </table>\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/flood_zones_q3.js */
RendererTemplates.wms("flood_zones_q3",{parameters:{opacity:70,min_zoom:11,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.Q3FLOOD_POLY_NO_NFHL",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.Q3FLOOD_POLY_NO_NFHL&QUERY_LAYERS=massgis:GISDATA.Q3FLOOD_POLY_NO_NFHL&PROPERTYNAME=firm_panel,quad,zone,county,sfha&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.Q3FLOOD_POLY_NO_NFHL&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        <table class='table'>\n            <thead>\n              <tr>\n                <th> County </th>\n                <th> FIRM Panel </th>\n                <th> Quad </th>\n                <th> Zone </th>\n                <th> SFHA </th>\n              </tr>\n            </thead>\n             <tbody>\n                {{#json.features}}\n                  <tr>\n                    <td>{{properties.county}}</td>\n                    <td>{{properties.firm_panel}}</td>\n                    <td>{{properties.quad}}</td>\n                    <td>{{properties.zone}}</td>\n                    <td>{{properties.sfha}}</td>\n                  </tr>\n                {{ else }}\n                  Unknown / No Response\n                {{/json.features}}\n              </tbody>\n          </table>\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/gas_providers.js */
RendererTemplates.wms("gas_providers",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.TOWNS_POLY_V_GAS",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.TOWNS_POLY_V_GAS&QUERY_LAYERS=massgis:GISDATA.TOWNS_POLY_V_GAS&PROPERTYNAME=town,gas_label&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.TOWNS_POLY_V_GAS&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            TOWN OF {{properties.town}}: {{properties.gas_label}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{#if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/groundwater_discharge.js */
RendererTemplates.wms("groundwater_discharge",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.GWP_PT",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.GWP_PT&QUERY_LAYERS=massgis:GISDATA.GWP_PT&PROPERTYNAME=name&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.GWP_PT&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/hospitals.js */
RendererTemplates.geojson_points("hospitals",{parameters:{opacity:!1,options:{}},url:CDN(GEOSERVER+"/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:hospitals&maxFeatures=500&outputFormat=application%2Fjson"),pointToLayer:function(e,t,r){return"./img/hospital.png",L.marker(r,{icon:L.icon({iconUrl:"./img/hospital.png",iconSize:[21,24],iconAnchor:[11,24],popupAnchor:[0,-22]}),title:t.properties.shortname})},popupContents:function(e){e.properties.reason_cls;return"<strong>"+e.properties.shortname+"</strong></br>Address: "+e.properties.address+", "+e.properties.town+"<br/>Emergency Room:"+e.properties.er_status+"<br/>Trauma Center: "+e.properties.trauma+"<br/>Teaching: "+e.properties.teaching+"<br/></br>"+Renderers.utils.zoom_to_location_link(e.geometry)},legend_template:"\n      <div class='detail-block show-confidence' style='float: left; clear: both;'>\n          <div style='width: 50%; float: left;'>\n            <img src={{'./img/hospital.png'}}>\n            <strong>{{value}}</strong>\n          </div>\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/hurricane_surge.js */
RendererTemplates.esri("hurricane_surge",{parameters:{min_zoom:9,max_zoom:20,opacity:85,options:{}},legend_template:"\n    <div class='detail-block show-confidence'>\n      <div class='detail-block legend taccimo '>\n        <label> Legend </label>\n        <img  src=\"img/hurricane_surge.png\">\n      </div>\n    </div>\n  ",clone_layer_name:function(e){return e.name+" copy"},esri_opts:function(e){return{url:CDN("https://gisprpxy.itd.state.ma.us/arcgisserver/rest/services/MEMA/InundataionZones/MapServer"),layers:[0],attribution:"MEMA",f:"image"}}});
</script>
    <!-- <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/hydrology_projections.js */
RendererTemplates.geojson_points("hydrology_projections",{parameters:{opacity:!1,likelihoods:[17,50],years:[2060,2099],options:{year_indx:0,likelihood_indx:0}},url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:hydrology_projections&maxFeatures=10000&outputFormat=application%2Fjson",selectData:function(e,a){var t=e.parameters.years[e.parameters.options.year_indx],n=e.parameters.likelihoods[e.parameters.options.likelihood_indx],i=[],o=0;return a.forEach(function(e){i=i.concat([e.properties.p17,e.properties.p50])}),o=_.max(i),_.reduce(a,function(e,i){if(t===i.properties.year){var r=i.properties["p"+n],s=_.cloneDeep(i);s.properties.value=[n,r,r/o],s.properties.all_data=a,e.push(s)}return e},[])},pointToLayer:function(e,a,t){var n=a.properties.value,i=100*n[2];return L.circleMarker(t,{icon:L.divIcon({className:"tide-guage-slr-icon",iconAnchor:[0,100],html:"<div class='bar likelihood likelihood-"+n[0]+"'>\n                <div class='bar' style='height: "+i+"%; width: 20%;'> </div>\n                <div class='label'>"+Renderers.utils.addPlusSign(n[1])+"%</div>\n            </div>"})})},onEachGeometry:function(e,a,t,n){n.on({click:function(n){var i=t.properties.year,o=a.parameters.likelihoods[a.parameters.options.likelihood_indx],r=t.properties.station_id,s={};_.each(e.features,function(e){e.properties.station_id===r&&(s[e.properties.year]=e)});var l=[];_.each(_.keys(s).sort(),function(e){l.push(s[e])}),Views.ControlPanel.fire("layer-show-singleton-details",{},a,{name:t.properties.name,table_data:l,year:i,likelihood:o})}})},info_template:"\n        <div class='col-xs-2'>\n          <label> {{{name}}}</label>\n        </div>\n        <div class='col-xs-10'>\n          <table class='table slr-table'>\n            <thead>\n              <tr>\n                <th style='text-align: center;'\n                    colspan='{{u.object_entries_count(table_data) + 1}}'> Relative mean seal level (feet NAVD88) for {{name}} </th>\n              </tr>\n              <tr>\n                <th> Scenario </th>\n                {{#table_data}}\n                  <th> {{properties.year}}</th>\n                {{/table_data}}\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"{{likelihood === 13 ? 'active-scenario' : ''}}\">\n                <td>Low Emissions</td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p17}} </td>\n                {{/table_data}}\n              </tr>\n              <tr class=\"{{likelihood === 50 ? 'active-scenario' : ''}}\">\n                <td>High Emissions</td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p50}} </td>\n                {{/table_data}}\n              </tr>\n            </tbody>\n          </table>\n  ",legend_template:'\n      <div class=\'detail-block opacity\'>\n        <label  as-tooltip=\'"Use slider to adjust Year"\'> Year: </label>\n        <input type="range" value="{{parameters.options.year_indx}}"\n          min="0"\n          max="{{parameters.years.length-1}}">\n        {{parameters.years[parameters.options.year_indx]}}\n      </div>\n\n      <div class=\'detail-block show-confidence\'>\n        <label as-tooltip=\'"Choose a likelihood"\'> Scenario: </label>\n        <select value=\'{{parameters.options.likelihood_indx}}\'>\n          <option value=\'0\'>Low</option>\n          <option value=\'1\'>High</option>\n        </select>\n      </div>\n\n      <div class=\'detail-block show-confidence\'>\n        <label> Legend: </label>\n        <svg width="12" height="12">\n          <rect width="12" height="12" style="fill:blue;stroke-width:3;stroke:blue" />\n        </svg>\n        Relative Mean Sea Level (feet NAVD88)\n      </div>\n  '});
</script> -->
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/impervious_surface.js */
RendererTemplates.wms("impervious_surface",{parameters:{opacity:70,options:{},color_buckets:[]},clone_layer_name:function(e){return e.name},url:CDN("https://www.mrlc.gov/geoserver/wms?"),wms_opts:function(e){return{layers:"mrlc_display:NLCD_2016_Impervious_L48",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},on_load:function(e){var r=CDN("https://www.mrlc.gov/geoserver/wms?request=GetLegendGraphic&LAYER=mrlc_display:NLCD_2016_Impervious_L48&format=application/json");e.parameters.loaded_legend||(e.parameters.loaded_legend=!0,$.ajax({cache:!0,dataType:"json",url:r,success:function(r){var n=r.Legend[0].rules[0].symbolizers[0].Raster.colormap.entries;e.parameters.color_buckets=[];for(var s=0;s<n.length;s+=Math.floor((n.length-1)/8))e.parameters.color_buckets.push(n[s]);Views.ControlPanel.fire("tile-layer-loaded",{},e,!0)},error:function(r){Views.ControlPanel.fire("tile-layer-loading-error",{},e)}}))},get_feature_info_url:function(e){return CDN("https://www.mrlc.gov/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=mrlc_display:NLCD_2016_Impervious_L48&QUERY_LAYERS=mrlc_display:NLCD_2016_Impervious_L48&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:'\n    <div class=\'detail-block legend\'>\n      <div class=\'color-legend \'>% Impervious</div>\n      {{#parameters.color_buckets}}\n        <div class=\'color-block\' style="width: {{100.0 / parameters.color_buckets.length}}%;">\n              <svg width="100" height="100">\n                <rect height="100" width="100" style="fill: {{color}}; stroke: {{color}}; opacity:{{opacity}}; "/>\n              </svg>\n              <label>{{label}}</label>\n        </div>\n      {{/parameters.color_buckets}}\n    </div>\n  ',info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            <strong>{{properties.PALETTE_INDEX}}% Impervious Surface</strong> at the clicked location.  Impervious surfaces increase temperatures and impede drainage.  Surface temperatures can rise by <a href=\"https://www.researchgate.net/profile/Alfonso_Crisci/publication/322066994_Urban_Imperviousness_Effects_on_Summer_Surface_Temperatures_Nearby_Residential_Buildings_in_Different_Urban_Zones_of_Parma/links/5bb224e2299bf13e6059d993/Urban-Imperviousness-Effects-on-Summer-Surface-Temperatures-Nearby-Residential-Buildings-in-Different-Urban-Zones-of-Parma.pdf?origin=publication_detail\" target=\"blank_\">up to 1.8°F</a> for every 20% increase in imperviousness.\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/land_use_2005.js */
RendererTemplates.wms("land_use_2005",{parameters:{min_zoom:12,max_zoom:20,opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:landuse_2005",format:"image/png",opacity:0,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:landuse_2005&QUERY_LAYERS=ma:landuse_2005&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER=ma:landuse_2005&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Land Use: {{properties.lu05_desc}}\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/land_use_2005_ag.js */
RendererTemplates.wms("land_use_2005_ag",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:landuse_2005_ag",format:"image/png",opacity:0,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:landuse_2005_ag&QUERY_LAYERS=ma:landuse_2005_ag&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER=ma:landuse_2005_ag&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Land Use: {{properties.lu05_desc}}\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_consecutive_dry_days.js */
RendererTemplates.ma_observed_climate_data("ma_observed_consecutive_dry_days",{title:" Consecutive Dry Days ",legend:" Consecutive Dry Days",legend_precision:1,legend_units:" days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/consdrydays.json",color_range:colorbrewer.YlOrRd[8]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_temp_gt_90.js */
RendererTemplates.ma_observed_climate_data("ma_observed_temp_gt_90",{title:"Days > 90 &deg;F",legend:" Days above 90 &deg;F",legend_precision:1,legend_units:" days ",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/tempgt90.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_temp_gt_95.js */
RendererTemplates.ma_observed_climate_data("ma_observed_temp_gt_95",{title:"Days > 95 &deg;F",legend:" Days above 95 &deg;F",legend_precision:1,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/tempgt95.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_temp_gt_100.js */
RendererTemplates.ma_observed_climate_data("ma_observed_temp_gt_100",{title:"Days > 100 &deg;F",legend:" Days above 100 &deg;F",legend_precision:1,legend_units:" Days ",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/tempgt100.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_temp_lt_0.js */
RendererTemplates.ma_observed_climate_data("ma_observed_temp_lt_0",{title:"Days Below 0 &deg;F ",legend:" Days below 0 &deg;F",legend_precision:1,legend_reverse:!0,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/templt0.json",color_range:colorbrewer.Blues[6],invert_scale:!1});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_temp_lt_32.js */
RendererTemplates.ma_observed_climate_data("ma_observed_temp_lt_32",{title:"Days Below 32 &deg;F ",legend:" Days below 32 &deg;F",legend_precision:1,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/templt32.json",color_range:colorbrewer.Blues[6],invert_scale:!1});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_growing_degree_days.js */
RendererTemplates.ma_observed_climate_data("ma_observed_growing_degree_days",{title:"Growing Degree Days",legend:"Growing Degree-Days (Observed)",legend_precision:0,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/growdegdays.json",color_range:colorbrewer.Greens[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_growing_degree_days.js */
RendererTemplates.ma_observed_climate_data("ma_observed_growing_degree_days",{title:"Growing Degree Days",legend:"Growing Degree-Days (Observed)",legend_precision:0,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/growdegdays.json",color_range:colorbrewer.Greens[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_cooling_degree_days.js */
RendererTemplates.ma_observed_climate_data("ma_observed_cooling_degree_days",{title:"Cooling Degree Days",legend:"Observed Cooling Degree-Days",legend_precision:0,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/cooldegdays.json",color_range:colorbrewer.Blues[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_heating_degree_days.js */
RendererTemplates.ma_observed_climate_data("ma_observed_heating_degree_days",{title:"Heating Degree Days",legend:"Observed Heating Degree-Days",legend_precision:0,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/heatdegdays.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_precip_gt_1.js */
RendererTemplates.ma_observed_climate_data("ma_observed_precip_gt_1",{title:" Precipitation &gt; 1 inch",legend:" Days with precipitation &gt; 1 inch",legend_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/precipgt1.json",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_precip_gt_2.js */
RendererTemplates.ma_observed_climate_data("ma_observed_precip_gt_2",{title:" Precipitation &gt; 2 inches",legend:" Days with precipitation &gt; 2 inches ",legend_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/precipgt2.json",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_precip_gt_4.js */
RendererTemplates.ma_observed_climate_data("ma_observed_precip_gt_4",{title:" Precipitation &gt; 4 inches",legend:" Days with precipitation &gt; 4 inches ",legend_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/precipgt4.json",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_precip.js */
RendererTemplates.ma_observed_climate_data("ma_observed_precip",{title:"Total Precipitation",legend:" Total Precipitation (inches)",legend_precision:1,legend_units:"inches",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/precip.json",color_range:colorbrewer.Blues[7]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_avg_temp.js */
RendererTemplates.ma_observed_climate_data("ma_observed_avg_temp",{title:"Average Temperature",legend:"Observed Average Temperature (&deg;F)",legend_units:" &deg; F",legend_precision:1,data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/avgtemp.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_min_temp.js */
RendererTemplates.ma_observed_climate_data("ma_observed_min_temp",{title:"Minimum Temperature",legend:"Observed Min Temp. (&deg;F)",legend_precision:1,legend_units:" &deg;F",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/mintemp.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_observed_max_temp.js */
RendererTemplates.ma_observed_climate_data("ma_observed_max_temp",{title:"Maximum Temperature",legend:"Observed Max Temp. (&deg;F)",legend_precision:1,legend_units:" &deg;F",data_url:"https://repository.nescaum-ccsc-dataservices.com/data/ma_observed/maxtemp.json",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_consecutive_dry_days.js */
RendererTemplates.ma_projected_climate_data("ma_projected_consecutive_dry_days",{title:" Consecutive Dry Days ",legend:" Projected change in # of consecutive dry days",legend_precision:1,legend_units:"# Consecutive Days",info_precision:2,data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=consdrydays",color_range:colorbrewer.YlOrRd[8]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_temp_gt_90.js */
RendererTemplates.ma_projected_climate_data("ma_projected_temp_gt_90",{title:"Days > 90&deg;F",legend:"Projected change in # days above 90&deg;F",legend_precision:1,info_precision:2,legend_units:" Days ",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=tempgt90",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_temp_gt_95.js */
RendererTemplates.ma_projected_climate_data("ma_projected_temp_gt_95",{title:"Days > 95&deg;F",legend:"Projected change in # days above 95&deg;F",legend_precision:1,info_precision:2,legend_units:" Days ",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=tempgt95",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_temp_gt_100.js */
RendererTemplates.ma_projected_climate_data("ma_projected_temp_gt_100",{title:"Days > 100&deg;F",legend:"Projected change in # days above 100&deg;F",legend_precision:1,info_precision:2,legend_units:" Days ",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=tempgt100",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_temp_lt_0.js */
RendererTemplates.ma_projected_climate_data("ma_projected_temp_lt_0",{title:"Days Below 0 &deg;F ",legend:" Projected change in # days below 0 &deg;F",legend_precision:1,info_precision:2,legend_reverse:!0,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=templt0",color_range:colorbrewer.Blues[6],invert_scale:!0});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_temp_lt_32.js */
RendererTemplates.ma_projected_climate_data("ma_projected_temp_lt_32",{title:"Days Below 32 &deg;F ",legend:" Projected change in # days below 32 &deg;F",legend_precision:1,info_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=templt32",color_range:colorbrewer.Blues[6],invert_scale:!0});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_growing_degree_days.js */
RendererTemplates.ma_projected_climate_data("ma_projected_growing_degree_days",{title:"Growing Degree Days",legend:"Projected change in Growing Degree-Days",legend_precision:0,info_precision:2,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=growdegdays",color_range:colorbrewer.Greens[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_cooling_degree_days.js */
RendererTemplates.ma_projected_climate_data("ma_projected_cooling_degree_days",{title:"Cooling Degree Days",legend:"Projected change in Cooling Degree-Days",legend_precision:0,info_precision:2,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=cooldegdays",color_range:colorbrewer.Blues[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_heating_degree_days.js */
RendererTemplates.ma_projected_climate_data("ma_projected_heating_degree_days",{title:"Heating Degree Days",legend:"Projected change in Heating Degree-Days",legend_precision:0,info_precision:2,legend_units:"Degree-Days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=heatdegdays",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_precip_gt_1.js */
RendererTemplates.ma_projected_climate_data("ma_projected_precip_gt_1",{title:" Precipitation &gt; 1 inch",legend:" Projected change in # Days with precipitation &gt; 1 inch ",legend_precision:1,info_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=precipgt1",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_precip_gt_2.js */
RendererTemplates.ma_projected_climate_data("ma_projected_precip_gt_2",{title:" Precipitation &gt; 2 inches",legend:" Projected change in # Days with precipitation &gt; 2 inches ",legend_precision:2,info_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=precipgt2",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_precip_gt_4.js */
RendererTemplates.ma_projected_climate_data("ma_projected_precip_gt_4",{title:" Precipitation &gt; 4 inches",legend:" Projected change in # Days with precipitation &gt; 4 inches ",legend_precision:2,info_precision:2,legend_units:"days",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=precipgt4",color_range:colorbrewer.Purples[5]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_precip.js */
RendererTemplates.ma_projected_climate_data("ma_projected_precip",{title:"Total Precipitation",legend:" Projected change in inches of total precipitation",legend_precision:1,info_precision:2,legend_units:"Inches",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=precip",color_range:colorbrewer.Blues[7]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_avg_temp.js */
RendererTemplates.ma_projected_climate_data("ma_projected_avg_temp",{title:"Average Temperature",legend:"Projected change in Average Temperature (&deg;F)",legend_units:" &deg;F",legend_precision:2,info_precision:2,data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=avgtemp",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_min_temp.js */
RendererTemplates.ma_projected_climate_data("ma_projected_min_temp",{title:"Minimum Temperature",legend:"Projected change in minimum temperature (&deg;F)",legend_precision:1,info_precision:2,legend_units:" &deg;F",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=mintemp",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_projected_max_temp.js */
RendererTemplates.ma_projected_climate_data("ma_projected_max_temp",{title:"Maximum Temperature",legend:"Projected change in maximum temperature (&deg;F)",legend_precision:1,info_precision:2,legend_units:" &deg;F",data_url:"https://repository.nescaum-ccsc-dataservices.com/umass/projected/?variable_name=maxtemp",color_range:colorbrewer.OrRd[6]});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/major_basins.js */
RendererTemplates.wms("major_basins",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.MAJBAS_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.MAJBAS_POLY&QUERY_LAYERS=massgis:GISDATA.MAJBAS_POLY&PROPERTYNAME=name&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.MAJBAS_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/marine_beaches.js */
RendererTemplates.wms("marine_beaches",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.MARINEBEACHES_ARC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.MARINEBEACHES_ARC&QUERY_LAYERS=massgis:GISDATA.MARINEBEACHES_ARC&PROPERTYNAME=beachname,type,leninmiles&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.MARINEBEACHES_ARC&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.beachname}}: {{properties.type}} Beach ({{properties.leninmiles}} .mi)\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/nfhl.js */
RendererTemplates.esri("nfhl",{parameters:{opacity:85,options:{}},legend_template:"\n    <div class='detail-block show-confidence'>\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/nfhlLegend.png\">\n    </div>\n  ",clone_layer_name:function(e){return e.name+" copy"},esri_opts:function(e){return{url:CDN("http://www.hazards.fema.gov/gis/nfhl/rest/services/public/NFHL/MapServer"),layers:[0,16,28],attribution:"FEMA",f:"image",clickable:!1}}});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/nfhl_roads.js */
RendererTemplates.wms("nfhl_roads",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:nfhl_roads",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:nfhl_roads&QUERY_LAYERS=ma:nfhl_roads&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:nfhl_roads&format=image/png'/> \n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n           {{#json.features}}\n          <div>\n             {{properties.street_name}}: {{properties.length_miles}} mi. in flood zone {{properties.fld_zone}} ({{properties.label}})\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/nfhl_parcels.js */
RendererTemplates.wms("nfhl_parcels",{parameters:{min_zoom:12,max_zoom:20,opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:nfhl_parcels",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:nfhl_parcels&QUERY_LAYERS=ma:nfhl_parcels&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:nfhl_parcels&format=image/png'/> \n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            State of Massachussetts\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/nlcd.js */
RendererTemplates.wms("nlcd",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://www.mrlc.gov/geoserver/wms?"),wms_opts:function(e){return{layers:"mrlc_display:NLCD_2016_Land_Cover_L48",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://www.mrlc.gov/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=mrlc_display:NLCD_2016_Land_Cover_L48&QUERY_LAYERS=mrlc_display:NLCD_2016_Land_Cover_L48&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='img/nlcd_legend.gif'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Land cover class: {{properties.PALETTE_INDEX}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/noaa_slr.js */
RendererTemplates.esri("noaa_slr",{parameters:{opacity:70,sea_level_height:0,display_layer:"slr",options:{sea_level_height:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},display_layer:{slr:"Sea Level Rise",conf:"Confidence"}}},legend_template:"\n    <div class='detail-block opacity'>\n      <label as-tooltip='\"Choose a sea level rise scenario\"'> Predicted Rise: </label>\n      <input type='range'\n        min='0'\n        max='6'\n        value= '{{parameters.sea_level_height}}'> {{parameters.sea_level_height}} ft.\n    </div>\n    <div class='detail-block show-confidence'>\n      <label as-tooltip='\"Choose a layer to display\"'> Layer: </label>\n      <select value='{{parameters.display_layer}}'>\n       {{#u.to_sorted_values_from_hash(parameters.options.display_layer)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.display_layer)}}\n      </select>\n    </div>\n\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/noaa_{{parameters.display_layer}}Legend.jpg\">\n    </div>\n  ",clone_layer_name:function(e){var a=e.parameters;a.options.sea_level_height[a.sea_level_height],a.options.display_layer[a.display_layer];return e.name+" "+view+" : "+rise},esri_opts:function(e){var a=e.parameters,l=a.sea_level_height,s=a.display_layer;return{layers:[Number(l)+Number(s)],url:CDN("https://www.coast.noaa.gov/arcgis/rest/services/dc_slr/"+s+"_"+l+"ft/MapServer"),attribution:"NOAA",f:"image",clickable:!1}}});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/openspace_owner.js */
RendererTemplates.wms("openspace_owner",{parameters:{opacity:70,min_zoom:10,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.OPENSPACE_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.OPENSPACE_POLY&QUERY_LAYERS=massgis:GISDATA.OPENSPACE_POLY&PROPERTYNAME=site_name,fee_owner&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.OPENSPACE_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.site_name}} (OWNER: {{properties.fee_owner}})\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/openspace_type.js */
RendererTemplates.wms("openspace_type",{parameters:{opacity:70,min_zoom:10,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.OPENSPACE_ARC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.OPENSPACE_ARC&QUERY_LAYERS=massgis:GISDATA.OPENSPACE_ARC&STYLES=GISDATA.OPENSPACE_ARC&PROPERTYNAME=site_name,fee_owner&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.OPENSPACE_ARC&STYLES=GISDATA.OPENSPACE_ARC&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.site_name}} (OWNER: {{properties.fee_owner}})\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/orthos1990s.js */
RendererTemplates.esri("orthos1990s",{parameters:{opacity:85,options:{}},legend_template:"\n    <div class='detail-block show-confidence'>\n    <div class='detail-block legend taccimo '>\n      <label> Legend </label>\n      <img  src=\"img/nfhlLegend.png\">\n    </div>\n  ",clone_layer_name:function(e){return e.name+" copy"},esri_opts:function(e){return{url:CDN("http://tiles.arcgis.com/tiles/hGdibHYSPO59RG1h/arcgis/rest/services/BW_Orthos_Tile_Package/MapServer"),layers:[0],attribution:"FEMA",f:"image",clickable:!1}}});
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/outstanding_resource_waters.js */
RendererTemplates.wms("outstanding_resource_waters",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.ORW_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.ORW_POLY&QUERY_LAYERS=massgis:GISDATA.ORW_POLY&PROPERTYNAME=orw_name,orw_type&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.ORW_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.orw_name}} {{properties.orw_type}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/police_stations.js */
RendererTemplates.wms("police_stations",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.POLICESTATIONS_PT_MEMA",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.POLICESTATIONS_PT_MEMA&QUERY_LAYERS=massgis:GISDATA.POLICESTATIONS_PT_MEMA&PROPERTYNAME=name,address,city,state&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.POLICESTATIONS_PT_MEMA&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.name}}<br>\n            {{properties.address}}, {{properties.city}}, {{properties.state}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/power_plants.js */
RendererTemplates.geojson_points("power_plants",{parameters:{opacity:!1,options:{power_plants_to_key:{solar:"Solar","natural gas":"Natural Gas",petroleum:"Petroleum",hydroelectric:"Hydroelectric",biomass:"Biomass",wind:"Wind",nuclear:"Nuclear",coal:"Coal","pumped storage":"Pumped Storage"}}},url:CDN(GEOSERVER+"/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:power_plants&maxFeatures=500&outputFormat=application%2Fjson"),pointToLayer:function(e,r,t){var o;return o="./img/PowerPlant_"+r.properties.primsource+".png",L.marker(t,{icon:L.icon({iconUrl:o,iconSize:[21,24],iconAnchor:[11,24],popupAnchor:[0,-22]}),title:r.properties.plant_name})},popupContents:function(e){e.properties.reason_cls;return"<strong>Name: "+e.properties.plant_name+"</strong></br>Description: "+e.properties.source_des+"<br/>Specs: "+e.properties.tech_desc+"<br/><a href='https://www.eia.gov/electricity/data/browser/#/plant/"+e.properties.plant_code+"' target='_blank_'>View in Electricity Data Browser</a><br/></br>"+Renderers.utils.zoom_to_location_link(e.geometry)},legend_template:"\n    {{#if json.features}}\n      <div class='detail-block show-confidence' style='float: left; clear: both;'>\n        {{#u.to_sorted_values_from_hash(parameters.options.power_plants_to_key)}}\n          <div style='width: 50%; float: left;'>\n            <img src={{'./img/PowerPlant_' + key + '.png'}}>\n            <strong>{{value}}</strong>\n          </div>\n        {{/u.to_sorted_values_from_hash(parameters.options.power_plants_to_key)}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/prime_forest.js */
RendererTemplates.wms("prime_forest",{parameters:{min_zoom:12,max_zoom:20,opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.PRIMEFOREST_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.PRIMEFOREST_POLY&QUERY_LAYERS=massgis:GISDATA.PRIMEFOREST_POLY&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.PRIMEFOREST_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Forest Type: {{properties.prime}} ({{properties.acres}} acres)\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/public_water_supplies.js */
RendererTemplates.wms("public_water_supplies",{parameters:{opacity:100,min_zoom:14,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.PWSDEP_PT",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.PWSDEP_PT&QUERY_LAYERS=massgis:GISDATA.PWSDEP_PT&PROPERTYNAME=site_name,town&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.PWSDEP_PT&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.site_name}}<br>\n            {{properties.town}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/soils.js */
RendererTemplates.wms("soils",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.SOILS_POLY_SV_MUNAME",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.SOILS_POLY_SV_MUNAME&QUERY_LAYERS=massgis:GISDATA.SOILS_POLY_SV_MUNAME&PROPERTYNAME=mapunit_name&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.SOILS_POLY_SV_MUNAME&format=image/png\")}}'/> Soil Polygon\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Map Unit: {{properties.mapunit_name}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/schools.js */
RendererTemplates.geojson_points("schools",{parameters:{opacity:!1,options:{}},url:CDN(GEOSERVER+"/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:schools&maxFeatures=500&outputFormat=application%2Fjson"),pointToLayer:function(e,o,t){return"./img/school.png",L.marker(t,{icon:L.icon({iconUrl:"./img/school.png",iconSize:[21,24],iconAnchor:[11,24],popupAnchor:[0,-22]}),title:o.properties.name})},popupContents:function(e){e.properties.reason_cls;return"<strong>Name: "+e.properties.name+"</strong></br>Address: "+e.properties.address+", "+e.properties.town_mail+"<br/>School Type: "+e.properties.type_desc+"<br/></br>"+Renderers.utils.zoom_to_location_link(e.geometry)},legend_template:"\n      <div class='detail-block show-confidence' style='float: left; clear: both;'>     \n          <div style='width: 50%; float: left;'>\n            <img src={{'./img/school.png'}}>\n            <strong>{{value}}</strong>\n          </div>\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/tax_parcels.js */
RendererTemplates.wms("tax_parcels",{parameters:{opacity:70,min_zoom:15,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.L3_TAXPAR_POLY_ASSESS",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.L3_TAXPAR_POLY_ASSESS&QUERY_LAYERS=massgis:GISDATA.L3_TAXPAR_POLY_ASSESS&PROPERTYNAME=owner1&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.L3_TAXPAR_POLY_ASSESS&format=image/png\")}}'/> Tax Parcel Boundary\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Owner: {{properties.owner1}}\n          </div>\n        {{ else }}\n         Zoom in to view and query the tax parcels layer.\n        {{/json.features}}\n      </div>    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/sea_level_rise.js */
RendererTemplates.geojson_points("sea_level_rise",{parameters:{opacity:!1,likelihoods:[17,50,83,99],years:[2020,2030,2040,2050,2060,2070,2080,2090,2100],options:{year_indx:3,likelihood_indx:2}},url:"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:tide_gauge_slr&maxFeatures=1000&outputFormat=application%2Fjson",selectData:function(e,t){var a=e.parameters.years[e.parameters.options.year_indx],r=e.parameters.likelihoods[e.parameters.options.likelihood_indx],n=[],i=0;return t.forEach(function(e){n=n.concat([e.properties.p17,e.properties.p50,e.properties.p83,e.properties.p99])}),i=_.max(n),_.reduce(t,function(e,n){if(a===n.properties.year){var o=n.properties["p"+r],s=_.cloneDeep(n);s.properties.value=[r,o,o/i],s.properties.all_data=t,e.push(s)}return e},[])},pointToLayer:function(e,t,a){var r=t.properties.value,n=100*r[2];return L.marker(a,{icon:L.divIcon({className:"tide-guage-slr-icon",iconAnchor:[0,100],html:"<div class='bar likelihood likelihood-"+r[0]+"'>\n                <div class='bar' style='height: "+n+"%; width: 100%;'> </div>\n                <div class='label'>"+Renderers.utils.addPlusSign(r[1])+" ft</div>\n            </div>"})})},onEachGeometry:function(e,t,a,r){r.on({click:function(r){var n=a.properties.year,i=t.parameters.likelihoods[t.parameters.options.likelihood_indx],o=a.properties.station_id,s={};_.each(e.features,function(e){e.properties.station_id===o&&(s[e.properties.year]=e)});var l=[];_.each(_.keys(s).sort(),function(e){l.push(s[e])}),Views.ControlPanel.fire("layer-show-singleton-details",{},t,{name:a.properties.name,table_data:l,year:n,likelihood:i})}})},info_template:"\n        <div class='col-xs-2'>\n          <label> {{{name}}}</label>\n          <br><i>The value highlighted in green is the projected value corresponding to the decade and scenario currently selected on the map. For more information about these sea level rise projections, please review the <a href=\"https://s3.amazonaws.com/nescaum-dataservices-assets/resources/production/UMASS+SLR+METADATA_UPDATE_20180327.pdf\" target=\"_blank\">metadata documentation</a>.</i>\n\n        </div>\n        <div class='col-xs-10'>\n          <table class='table slr-table'>\n            <thead>\n              <tr>\n                <th style='text-align: center;'\n                    colspan='{{u.object_entries_count(table_data) + 1}}'> Relative mean sea level (feet NAVD88) for {{name}} </th>\n              </tr>\n              <tr>\n                <th> Scenario </th>\n                {{#table_data}}\n                  <th> {{properties.year}}</th>\n                {{/table_data}}\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"{{likelihood === 13 ? 'active-scenario' : ''}}\">\n                <td>Intermediate </td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p17}} </td>\n                {{/table_data}}\n              </tr>\n              <tr class=\"{{likelihood === 50 ? 'active-scenario' : ''}}\">\n                <td>Intermediate High</td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p50}} </td>\n                {{/table_data}}\n              </tr>\n              <tr class=\"{{likelihood === 83 ? 'active-scenario' : ''}}\">\n                <td>High</td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p83}} </td>\n                {{/table_data}}\n              </tr>\n              <tr class=\"{{likelihood === 99 ? 'active-scenario' : ''}}\">\n                <td>Extreme</td>\n                {{#table_data}}\n                  <td class='{{year === properties.year ? 'active-year' : ''}}'> {{properties.p99}} </td>\n                {{/table_data}}\n              </tr>\n            </tbody>\n          </table>\n        </div>\n  ",legend_template:'\n      <div class=\'detail-block opacity\'>\n        <label  as-tooltip=\'"Use slider to adjust Year"\'> Year: </label>\n        <input type="range" value="{{parameters.options.year_indx}}"\n          min="0"\n          max="{{parameters.years.length-1}}">\n        {{parameters.years[parameters.options.year_indx]}}\n      </div>\n\n      <div class=\'detail-block show-confidence\'>\n        <label as-tooltip=\'"Choose a scenario"\'> Scenario: </label>\n        <select value=\'{{parameters.options.likelihood_indx}}\'>\n          <option value=\'0\'>Intermediate</option>\n          <option value=\'1\'>Intermediate-High</option>\n          <option value=\'2\'>High</option>\n          <option value=\'3\'>Extreme (Maximum physically plausible)</option>\n        </select>\n      </div>\n\n      <div class=\'detail-block show-confidence\'>\n        <label> Legend: </label>\n        <svg width="12" height="12">\n          <rect width="12" height="12" style="fill:blue;stroke-width:3;stroke:blue" />\n        </svg>\n        Relative Mean Sea Level (feet NAVD88)\n      </div>\n  '});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/transmission_lines.js */
RendererTemplates.wms("transmission_lines",{parameters:{opacity:90,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.TRANSLINES_ARC",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.TRANSLINES_ARC&format=image/png\")}}'/>\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/tree_atlas.js */
RendererTemplates.esri("tree_atlas",{parameters:{opacity:70,species:5,scenario:0,options:{species:{4:"Red Maple",5:"Sugar Maple",7:"Yellow Birch",10:"Pignut Hickory",14:"American Beech",15:"White Ash",28:"Red Spruce",35:"Eastern White Pine",40:"Quaking Aspen",41:"Black Cherry",42:"White Oak",49:"Northern Red Oak",55:"Eastern Hemlock"},scenarios:{0:"Current",56:"Low",112:"High"}}},legend_template:"\n    <div class='detail-block show-confidence'>\n      <label as-tooltip='\"Choose a tree species\"'> Species: </label>\n\n      <select value='{{parameters.species}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.species)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.species)}}\n      </select>\n    </div>\n    <div class='detail-block show-confidence'>\n      <label as-tooltip='\"Choose a tree species\"'> Scenario: </label>\n      <select value='{{parameters.scenario}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.scenarios)}}\n      </select>\n    </div>\n\n    <div class='detail-block legend tree_atlas '>\n      <label> Legend </label>\n      <img  src=\"img/tree_atlas.jpg\"> Species Importance Value\n    </div>\n  ",clone_layer_name:function(e){var s=e.parameters,a=s.options.scenarios[s.scenario],r=s.options.species[s.species];return e.name+" "+r+" : "+a},esri_opts:function(e){var s=e.parameters.scenario,a=e.parameters.species;return{layers:[Number(s)+Number(a)],url:CDN("http://wassimap.sgcp.ncsu.edu:8399/arcgis/rest/services/taccimo/treeatlas_high/MapServer"),attribution:"USFS",f:"image",clickable:!1}}});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/townhalls.js */
RendererTemplates.geojson_points("townhalls",{parameters:{opacity:!1,options:{}},url:CDN(GEOSERVER+"/ma/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ma:townhalls&maxFeatures=500&outputFormat=application%2Fjson"),pointToLayer:function(e,o,n){return"./img/townhall.png",L.marker(n,{icon:L.icon({iconUrl:"./img/townhall.png",iconSize:[21,24],iconAnchor:[11,24],popupAnchor:[0,-22]}),title:o.properties.name})},popupContents:function(e){e.properties.reason_cls;return"<strong>Name: "+e.properties.name+"</strong></br>Address: "+e.properties.address+"<br/></br>"+Renderers.utils.zoom_to_location_link(e.geometry)},legend_template:"\n      <div class='detail-block show-confidence' style='float: left; clear: both;'>     \n          <div style='width: 50%; float: left;'>\n            <img src={{'./img/townhall.png'}}>\n            <strong>{{value}}</strong>\n          </div>\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/surface_water_protection.js */
RendererTemplates.wms("surface_water_protection",{parameters:{opacity:90,style:"GISDATA.SWP_ZONES_POLY::Zone_A",options:{style:{"GISDATA.SWP_ZONES_POLY::Zone_A":"Zone A","GISDATA.SWP_ZONES_POLY::Zone_B":"Zone B","GISDATA.SWP_ZONES_POLY::Zone_C":"Zone C"}}},clone_layer_name:function(e){return e.name+" Layer:"+e.parameters.style},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.SWP_ZONES_POLY",styles:e.parameters.style,format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var s=e.parameters.style;return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.SWP_ZONES_POLY&QUERY_LAYERS=massgis:GISDATA.SWP_ZONES_POLY&PROPERTYNAME=supplier,site_name&STYLES="+s+"&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Variable: </label>\n        <select value='{{parameters.style}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.style)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.style)}}\n        </select>\n      </div>\n       <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=\" + encodeURIComponent(\"massgis:GISDATA.SWP_ZONES_POLY\") + \"&style=\" + encodeURIComponent(parameters.style) + \"&format=image/png\")}}'/>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.supplier}} {{properties.sitename}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_climate_vulnerability_drought.js */
RendererTemplates.ma_climate_vulnerability("ma_vulnerability_drought",{key_name:"drought",display_name:"Drought",gfi_fields:["precip","consdrydays"],wms_layer:"ma:vulnerability_drought",info_template:"\n      <div class='climate-vulnerability col-xs-12'>\n        {{#if (json.features)}}\n          <table class='table'>\n            <thead>\n              <tr>\n                <th> Town </th>\n                <th> Dataset </th>\n                <th> Category </th>\n                <th> Total for Town </th>\n              </tr>\n            </thead>\n            <tbody>\n                {{#json.features}}\n                  <tr>\n                    <td>{{properties.town}}</td>\n                    <td>{{properties.label}}</td>\n                    <td>{{properties.category}}</td>\n                    <td>{{properties.stats}}</td>\n                  </tr>\n                {{/json.features}}\n              </tbody>\n          </table>\n        {{ else }}\n          <h6> No drought vulnerabilities found for this location </h6>\n        {{/if (json.features)}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_climate_vulnerability_extreme_heat.js */
RendererTemplates.ma_climate_vulnerability("ma_vulnerability_extreme_heat",{display_name:"Extreme Heat",key_name:"heat",gfi_fields:["avgtemp","tempgt_90","tempgt_95","cooldegdays"],wms_layer:"ma:vulnerability_extreme_heat",info_template:"\n      <div class='climate-vulnerability col-xs-12'>\n        {{#if (json.features)}}\n          <table class='table'>\n              <thead>\n                <tr>\n                  <th> Town </th>\n                  <th> Dataset </th>\n                  <th> Category </th>\n                  <th> Total for Town </th>\n                </tr>\n              </thead>\n              <tbody>\n                  {{#json.features}}\n                    <tr>\n                      <td>{{properties.town}}</td>\n                      <td>{{properties.label}}</td>\n                      <td>{{properties.category}}</td>\n                      <td>{{properties.stats}}</td>\n                    </tr>\n                  {{/json.features}}\n                </tbody>\n            </table>\n        {{ else }}\n          <h6> No extreme heat vulnerabilities found for this location </h6>\n        {{/if (json.features)}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_climate_vulnerability_flood.js */
RendererTemplates.ma_climate_vulnerability("ma_vulnerability_flood",{display_name:"Stormwater Flooding",key_name:"flooding",gfi_fields:["precip","precipgt1","precipgt2"],wms_layer:"ma:vulnerability_flood",info_template:"\n      <div class='climate-vulnerability col-xs-12'>\n        {{#if (json.features)}}\n          <table class='table'>\n              <thead>\n                <tr>\n                  <th> Town </th>\n                  <th> Dataset </th>\n                  <th> Category </th>\n                  <th> Total for Town </th>\n                </tr>\n              </thead>\n              <tbody>\n                  {{#json.features}}\n                    <tr>\n                      <td>{{properties.town}}</td>\n                      <td>{{properties.label}}</td>\n                      <td>{{properties.category}}</td>\n                      <td>{{properties.stats}}</td>\n                    </tr>\n                  {{/json.features}}\n                </tbody>\n            </table>\n        {{ else }}\n          <h6> No flood vulnerabilities found for this location </h6>\n        {{/if (json.features)}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/ma_climate_vulnerability_slr.js */
RendererTemplates.ma_climate_vulnerability("ma_vulnerability_slr",{display_name:"Sea Level Rise",key_name:"slr",gfi_fields:[""],wms_layer:"ma:vulnerability_slr",info_template:"\n      <div class='climate-vulnerability col-xs-12'>\n        {{#if (json.features)}}\n          <table class='table'>\n              <thead>\n                <tr>\n                  <th> Town </th>\n                  <th> Dataset </th>\n                  <th> Category </th>\n                  <th> Total for Town </th>\n                </tr>\n              </thead>\n              <tbody>\n                  {{#json.features}}\n                    <tr>\n                      <td>{{properties.town}}</td>\n                      <td>{{properties.label}}</td>\n                      <td>{{properties.category}}</td>\n                      <td>{{properties.stats}}</td>\n                    </tr>\n                  {{/json.features}}\n                </tbody>\n            </table>\n        {{ else }}\n          <h6> No sea level rise vulnerabilities found for this location </h6>\n        {{/if (json.features)}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/extreme_heat_tract.js */
RendererTemplates.wms("extreme_heat_tract",{parameters:{opacity:75,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:extreme_heat_tract",format:"image/png",opacity:.75,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:extreme_heat_tract&QUERY_LAYERS=ma:extreme_heat_tract&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER=ma:extreme_heat_tract&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n        <i>Data summarized by MA Department of Public Health from 2010 census data.</i>\n      </div>\n      <div class='col-xs-10'>\n        <table class='table'>\n            <thead>\n              <tr>\n                <th> Census Tract ID</th>\n                <th> % Under 5 </th>\n                <th> % Under 15 </th>\n                <th> % Over 65 </th> \n                <th> % Living alone </th>\n                <th> % Poverty </th>\n                <th> % Not White </th>\n                <th> % No High School </th>\n              </tr>\n            </thead>\n             <tbody>\n                {{#json.features}}\n                  <tr>\n                    <td>{{properties.census_tra}}</td>\n                    <td>{{properties.percu5}}</td>\n                    <td>{{properties.percu15}}</td>\n                    <td>{{properties.perc65}}</td>\n                    <td>{{properties.percalone}}</td>\n                    <td>{{properties.percpovert}}</td>\n                    <td>{{properties.percnowhit}}</td>\n                    <td>{{properties.percnohs}}</td>\n                  </tr>\n                {{ else }}\n                  Unknown / No Response\n                {{/json.features}}\n              </tbody>\n          </table>         \n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/vaw_towns.js */
RendererTemplates.wms("vaw_towns",{parameters:{opacity:100,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:towns",cql_filter:"town='"+e.parameters.town.toUpperCase()+"'",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var t=e.parameters.town.toUpperCase();return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:towns&QUERY_LAYERS=ma:towns&CQL_FILTER=town='"+t+"'&STYLES=vaw_highlight&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:towns&styles=vaw_highlight&format=image/png'/> State Boundary\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> Vulnerability for {{properties.town}} </label>\n        <i>Data summarized by MA Department of Public Health from 2010 census data.</i>\n      </div>\n      <div class='col-xs-10'>\n        2010 Population: {{properties.pop2010}}\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/vernal_pools.js */
RendererTemplates.wms("vernal_pools",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN(GEOSERVER+"/ma/wms/"),wms_opts:function(e){return{layers:"ma:vernal_pools",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN(GEOSERVER+"/ma/wms/")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:vernal_pools&QUERY_LAYERS=ma:vernal_pools&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='"+CDN(GEOSERVER)+"/ma/wms?request=GetLegendGraphic&LAYER=ma:vernal_pools&format=image/png'/> \n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.criteria}}. Certified {{properties.certified}}.\n          </div>\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/vulnerability_test.js */
RendererTemplates.wms("vulnerability_test",{parameters:{opacity:70,town:"Falmouth",layer:"flood",options:{town:{Falmouth:"Falmouth",Mashpee:"Mashpee"},layer:{flood:"Stormwater Flooding",slr:"Sea Level Rise",drought:"Drought",extreme_heat:"Extreme Heat"}}},clone_layer_name:function(e){return e.name+" Layer:"+e.parameters.town+"; "+e.parameters.layer},url:CDN("https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms"),wms_opts:function(e){var t=e.parameters.town;return{layers:"ma:vulnerability_"+e.parameters.layer,cql_filter:"town='"+t+"'",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var t=e.parameters.town,a=e.parameters.layer;return CDN("https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=ma:vulnerability_"+a+"&QUERY_LAYERS=ma:vulnerability_"+a+"&CQL_FILTER=town='"+t+"'&PROPERTYNAME=town,climate_effect,category,label,stats&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Town: </label>\n        <select value='{{parameters.town}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.town)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.town)}}\n        </select>\n      </div>\n      <div class='detail-block show-confidence'>\n        <label> Category: </label>\n        <select value='{{parameters.layer}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.layer)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.layer)}}\n        </select>\n      </div>\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n          <img src='https://geoserver.nescaum-ccsc-dataservices.com/geoserver/ma/wms?request=GetLegendGraphic&LAYER=ma:vulnerability_{{parameters.layer}}&format=image/png'/>\n      </div>\n\n\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'><table class='table'>\n            <thead>\n              <tr>\n                <th> Climate Effect </th>\n                <th> Category </th>\n                <th> Dataset </th>\n                <th> Total for Town </th>\n              </tr>\n            </thead>\n             <tbody>\n                {{#json.features}}\n                  <tr>\n                    <td>{{properties.climate_effect}}</td>\n                    <td>{{properties.category}}</td>\n                    <td>{{properties.label}}</td>\n                    <td>{{properties.stats}}</td>\n                  </tr>\n                {{ else }}\n                  Unknown / No Response\n                {{/json.features}}\n              </tbody>\n          </table>\n      </div>\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/wellhead_protection.js */
RendererTemplates.wms("wellhead_protection",{parameters:{opacity:90,layer:"IWPA_POLY",options:{layer:{IWPA_POLY:"IWPA",ZONE1_POLY:"Zone 1",ZONE2_POLY:"Zone 2"}}},clone_layer_name:function(e){return e.name+" Layer:"+e.parameters.layer},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA."+e.parameters.layer,format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){var s=e.parameters.layer;return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA."+s+"&QUERY_LAYERS=massgis:GISDATA."+s+"&PROPERTYNAME=supplier,pws_id&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG%3A4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Variable: </label>\n        <select value='{{parameters.layer}}'>\n        {{#u.to_sorted_values_from_hash(parameters.options.layer)}}\n          <option value='{{key}}'>{{value}}</option>\n        {{/u.to_sorted_values_from_hash(parameters.options.layer)}}\n        </select>\n        <img src='https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.{{parameters.layer}}&format=image/png'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.supplier}}; PWS ID {{properties.pws_id}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/wetlands.js */
RendererTemplates.wms("wetlands",{parameters:{opacity:70,min_zoom:12,max_zoom:20,options:{}},clone_layer_name:function(e){return e.name+" Copy"},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.WETLANDSDEP_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.WETLANDSDEP_POLY&QUERY_LAYERS=massgis:GISDATA.WETLANDSDEP_POLY&PROPERTYNAME=it_valdesc&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.WETLANDSDEP_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n    {{#if json.features}}\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            {{properties.it_valdesc}}\n          </div>\n        {{ else }}\n          Unknown / No Response\n        {{/json.features}}\n      </div>\n    {{/if json.features}}\n  "});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/renderers/wind_power.js */
RendererTemplates.wms("wind_power",{parameters:{opacity:70,options:{}},clone_layer_name:function(e){return e.name},url:CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms"),wms_opts:function(e){return{layers:"massgis:GISDATA.WINDPOWERGRID50_POLY",format:"image/png",opacity:0,zIndex:-1,transparent:!0}},get_feature_info_url:function(e){return CDN("https://giswebservices.massgis.state.ma.us/geoserver/wms")+"?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&LAYERS=massgis:GISDATA.WINDPOWERGRID50_POLY&QUERY_LAYERS=massgis:GISDATA.WINDPOWERGRID50_POLY&PROPERTYNAME=pwrdensity&STYLES=&BBOX=<%= bbox %>&FEATURE_COUNT=5&HEIGHT=<%= height %>&WIDTH=<%= width %>&FORMAT=text%2Fhtml&INFO_FORMAT=application%2Fjson&SRS=EPSG:4326&X=<%= x %>&Y=<%= y %>"},legend_template:"\n      <div class='detail-block show-confidence'>\n        <label> Legend: </label>\n        <img src='{{CDN(\"https://giswebservices.massgis.state.ma.us/geoserver/wms?request=GetLegendGraphic&LAYER=massgis:GISDATA.WINDPOWERGRID50_POLY&format=image/png\")}}'/>\n      </div>\n  ",info_template:"\n      <div class='col-xs-2'>\n        <label> {{name}} </label>\n      </div>\n      <div class='col-xs-10'>\n        {{#json.features}}\n          <div>\n            Power Density: {{properties.pwrdensity}} Watts per square Meter\n          </div>\n        {{/json.features}}\n      </div>\n  "});
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/geometry_loader.js */
var GeometryLoader={load:function(C,e,o){var c={county:"https://repository.nescaum-ccsc-dataservices.com/geofocuses/bulk_geojson/?ids=1545%2C%201724%2C%201646%2C%201644%2C%201596%2C%201554%2C%201645%2C%201622%2C%201676%2C%201606%2C%201708%2C%201555%2C%201725%2C%201730",basin:"https://repository.nescaum-ccsc-dataservices.com/geofocuses/bulk_geojson/?ids=2086%2C2087%2C2088%2C2089%2C2090%2C2091%2C2092%2C2093%2C2094%2C2095%2C2096%2C2097%2C2098%2C2099%2C2100%2C2101%2C2102%2C2103%2C2104%2C2105%2C2106%2C2107%2C2108%2C2109%2C2110%2C2111%2C2112"};GeometryLoader.cache[C]?e(null,GeometryLoader.cache[C]):d3.json(c[C],function(o,c){o?e(o,null):("Topology"===c.type&&(c=topojson.feature(c,c.objects[C])),GeometryLoader.cache[C]=c,e(null,GeometryLoader.cache[C]))})},cache:{}};
</script>

    <script> var Controllers = {}; </script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/controllers/layer_import.js */
Controllers.LayerImport={import_layer:function(e,r){e.set("layer_import.import_file_processing",!0);var t=new FileReader,o=function(){setTimeout(function(){e.set("layer_import.import_file",""),e.set("layer_import.import_file_processing",!1),e.set("layer_import.show_modal",!1),e.set("layer_import.import_file","")},10)},a=function(t){try{Controllers.Layers.add_imported_layer(e,r.name,t)}finally{o()}};r.name.match(".*.json")||r.name.match(".*.geojson")?(t.addEventListener("loadend",function(){a(t.result)}),t.readAsText(r)):r.name.match(".*.zip")?(t.addEventListener("loadend",function(){try{a(shp.parseZip(t.result))}catch(e){console.error(e),o(),alert(e)}}),t.readAsArrayBuffer(r)):r.name.match(".*.gpx")?(t.addEventListener("loadend",function(){try{var e=(new DOMParser).parseFromString(t.result,"text/xml"),r=toGeoJSON.gpx(e);r.features[0].geometry.coordinates.forEach(function(e){e.length=2,delete e[2]}),a(r)}catch(e){console.error(e),o(),alert(e)}}),t.readAsText(r)):r.name.match(".*.kml")?(t.addEventListener("loadend",function(){try{var e=(new DOMParser).parseFromString(t.result,"text/xml"),r=toGeoJSON.kml(e);a(r)}catch(e){console.error(e),o(),alert(e)}}),t.readAsText(r)):alert("This input file is not supported")}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/controllers/search.js */
Controllers.Search={execute_search:function(o,n){$.getJSON("https://maps.google.com/maps/api/geocode/json?bounds="+Config.defaults["bounding-box"][1]+","+Config.defaults["bounding-box"][0]+"|"+Config.defaults["bounding-box"][3]+","+Config.defaults["bounding-box"][2]+"&address="+encodeURIComponent(o)+"&key=AIzaSyAOCQaASjkuA5J9S_6Nn0T7oz4VnFsh5dU",function(e,d,s){n(o,e)})}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/controllers/layers.js */
Controllers.Layers={test_pickler:function(){_.each(Renderers,function(e){e.pickle&&e.pickle({leaflet_layer_ids:[],parameters:{}})})},update_layers_parameters:function(e,r){var a=_.findIndex(e.get("layers.active"),{id:r.id});e.set("layers.active."+a+".parameters",r.parameters)},mark_layer_as_loaded:function(e,r,a,t){var l=e.get("layers_loading_states."+r.layer_default_id)||{loaded:0,errors:0};if(0===l.loaded||!a||t){a?l.loaded=l.loaded+1:l.errors=l.errors+1,e.set("layers_loading_states."+r.layer_default_id,l);var s=_.findIndex(e.get("layers.active"),{id:r.id});e.set("layers.active."+s,r)}},sort_active_layers:function(e){return _.sortBy(e,function(r){var a=_.findIndex(e,r),t="";return r.sort_key?t=sort_key.toString():r.parameters.no_sorting?t="A"+r.name:(t="Z",t+=_.padLeft(a,25,"0")),t})},is_active_layer:function(e,r){return!!_.find(e,{layer_default_id:r,copied_source:null})},counter:0,new_active_layer:function(e,r,a){var t=Renderers[r.renderer_id||r.id];Controllers.Layers.counter=Controllers.Layers.counter+1;var a=Object.assign({},t.parameters||{},r.parameters||{},a||{});return{id:"layer:"+Controllers.Layers.counter,layer_default_id:r.id,parameters:a,renderer_id:r.id,leaflet_layer_ids:[],is_collapsed:!1,is_hidden:!1,name:r.name,legend_url:null,copied_source:null}},pickle_active_layer:function(e){var r=_.cloneDeep(e);r.leaflet_layer_ids=[];var a=Renderers[r.renderer_id];return a&&a.pickle(r),r.legend_url&&(r.legend_url=null),r},add_imported_layer:function(e,r,a){_.cloneDeep(e.get("layers.active"));Controllers.Layers.counter=Controllers.Layers.counter+1;var t="imported_layer:"+Controllers.Layers.counter;e.push("layers.defaults",{folder:"User Imports",id:t,name:r}),RendererTemplates.imported_geojson(t,{templates:{},name:r,data:a.type?a:JSON.parse(a)}),Controllers.Layers.toggle_layer_active(e,t),e.push("layers.available_ids",t)},add_cloned_layer:function(e,r,a){var t=_.cloneDeep(e.get("layers.active")),l=_.cloneDeep(r);Controllers.Layers.counter=Controllers.Layers.counter+1,l.id="cloned_layer:"+Controllers.Layers.counter,l.leaflet_layer_ids=[],l.copied_source=r.id,l.name=Renderers[r.renderer_id].clone_layer_name(r),l.is_collapsed=!0,t.unshift(l),e.set("layers.active",Controllers.Layers.sort_active_layers(t))},remove_active:function(e,r){var a=_.cloneDeep(e.get("layers.active")),t=null;t=r.get?r.get().id:r.id,_.remove(a,{id:t}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},visible_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_hidden=!1}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},hide_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_hidden=!0}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},expand_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_collapsed=!1}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},collapse_all_layers:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.each(a,function(e){e.is_collapsed=!0}),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},toggle_active_collapsed:function(e,r){var a=_.cloneDeep(e.get("layers.active")),t=_.find(a,"id",r.get().id);t.is_collapsed=!t.is_collapsed,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},make_active_hidden:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.find(a,"id",r.get().id).is_hidden=!0,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},make_active_visible:function(e,r){var a=_.cloneDeep(e.get("layers.active"));_.find(a,"id",r.get().id).is_hidden=!1,e.set("layers.active",Controllers.Layers.sort_active_layers(a))},move_active_to_top:function(e,r){var a=_.cloneDeep(e.get("layers.active")),t=_.find(a,{id:r.get().id});_.remove(a,{id:r.get().id}),a.unshift(t),e.set("layers.active",Controllers.Layers.sort_active_layers(a))},add_custom_layer:function(e,r,a){var t=_.cloneDeep(e.get("layers.active",[])),l=r.id,s=_.find(t,{layer_default_id:l,name:r.name,copied_source:null});if(s){t=_.cloneDeep(e.get("layers.active"));return _.find(t,"id",s.id).is_hidden=!1,e.set("layers.active",Controllers.Layers.sort_active_layers(t)),s}var n=Controllers.Layers.new_active_layer(e.get("map"),r,a);return t.unshift(n),e.set("layers.active",Controllers.Layers.sort_active_layers(t)),e.set("active_layers_added_count",e.get("active_layers_added_count")+1),n},toggle_layer_active:function(e,r){var a=e.get("layers.defaults"),t=_.cloneDeep(e.get("layers.active")),l=_.find(t,{layer_default_id:r,copied_source:null});if(l)_.remove(t,l);else{var s=Controllers.Layers.new_active_layer(e.get("map"),_.find(a,"id",r));t.unshift(s)}e.set("layers.active",Controllers.Layers.sort_active_layers(t)),e.set("active_layers_added_count",e.get("active_layers_added_count")+1)},force_layers_active:function(e,r){var a=e.get("layers.defaults"),t=_.map(r,function(r){var t=_.find(e.get("layers.active"),{layer_default_id:r,copied_source:null});return t||(t=Controllers.Layers.new_active_layer(e.get("map"),_.find(a,"id",r))),t});e.set("layers.active",Controllers.Layers.sort_active_layers(t))},set_available_layer_ids:function(e,r){var a=e.get("layers.defaults");_.filter(r,function(e){return _.find(a,"id",e)});e.set("layers.available_ids",r)},ensure_active_are_available:function(e){var r=e.get("layers.active")||[],a=e.get("layers.available_ids");e.set("layers.active",_.filter(r,function(e){return _.contains(a,e.id)||_.contains(a,e.renderer_id)}))},add_tree_node:function(e,r,a,t,l){var s=l>0;if(0===a.length)r.children=r.children.concat(t);else{var n=a.shift(),i=_.find(r.children,function(e){return e.folder_name===n});i||(i={folder_name:n,is_expanded:s,children:[]},r.children=r.children.concat(i)),Controllers.Layers.add_tree_node(e,i,a,t,l-1)}return r.children=_.sortBy(r.children,function(r){var a=_.find(e,"id",r);return a?"A"+a.name:"Z"+r.folder_name}),r},update_layer_tree:function(e){var r={folder_name:null,is_expanded:!0,children:[]},a=e.get("layers.available_ids"),t=e.get("layers.defaults"),l=e.get("layers.search_string").toLowerCase(),s=e.get("sectors.selected");_.each(a,function(e){var a=_.find(t,"id",e);if(a){var n=null,i=!1;_.isEmpty(l)?n=!0:i=n=_.includes((a.name||"").toLowerCase(),l)||_.includes((a.description||"").toLowerCase(),l)||a.id.toLowerCase()===l,n&&s.length>0&&(i=n=_.any(a.sectors,function(e){return _.any(s,function(r){return r.toLowerCase()===e.toLowerCase()})})),""===a.folder&&(n=!1),console.log(a.folder),n&&a.folder&&(r=Controllers.Layers.add_tree_node(t,r,a.folder.split("."),e,i?1e3:1))}}),e.set("layers.tree",r)},deactivate_all:function(e){e.set("layers.active",[])}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/controllers/sharing.js */
Controllers.Sharing={version:1,get_save_data:function(a){return{version:Controllers.Sharing.version,active_layers:_.map(a.get("layers.active"),function(a){return Controllers.Layers.pickle_active_layer(a)}),map_state:a.get("map_state")}},open_sharing:function(a,e){a.set("sharing_modal.open",!0),a.set("sharing_modal.token",null),a.set("sharing_modal.copied",!1)},sharing_url:function(a){var e=URI(window.location.href);return e.removeSearch("map_state_token"),e.addSearch("map_state_token",a),e.toString()},add_token_copy:function(a){var e=$("#sharing_copy_button");new ZeroClipboard(e).on("copy",function(e){a.set("sharing_modal.copied",!0),e.clipboardData.setData("text/plain",Controllers.Sharing.sharing_url(a.get("sharing_modal.token"))),setTimeout(function(){a.set("sharing_modal.copied",!1)},3e3)})},hide_sharing:function(a,e){a.set("sharing_modal.open",!1)},load_active_layers:function(a,e){var t=JSON.parse(e);t.version!==Controllers.Sharing.version?alert("This data is not the correct version. Sorry!"):(a.set("layers.active",t.data),a.set("sharing_modal.open",!1))},save_state:function(a,e){$.ajax({url:"https://repository.nescaum-ccsc-dataservices.com/map_states",method:"POST",contentType:"application/json",data:JSON.stringify({map_state:JSON.stringify(a)}),success:function(a){e(a.token)}})},load_state:function(a,e,t){e.set("sharing_modal_loading",!0),$.ajax({url:CDN("https://repository.nescaum-ccsc-dataservices.com/map_states/"+a),dataType:"json",success:function(a){var n=JSON.parse(a.data);n.version!=Controllers.Sharing.version?alert("Ack! We can't load this saved map!"):(e.set("layers.active",n.active_layers),t.setView(n.map_state.center,n.map_state.zoom),e.set("layer_controls.active_tab","legends")),t.invalidateSize(),setTimeout(function(){e.set("sharing_modal_loading",!1)},1500)}})}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/controllers/feature_info.js */
Controllers.FeatureInfo={get_gfi_url:function(e,t,n){var r={xmin:n.getBounds().getWest(),xmax:n.getBounds().getEast(),ymin:n.getBounds().getSouth(),ymax:n.getBounds().getNorth(),bbox:_.map([n.getBounds().getWest(),n.getBounds().getSouth(),n.getBounds().getEast(),n.getBounds().getNorth()],function(e){return e.toFixed(6)}).join(","),width:n.getSize().x,height:n.getSize().y,lat:t.latlng.lat,lng:t.latlng.lng,x:Math.round(n.layerPointToContainerPoint(t.layerPoint).x),y:Math.round(n.layerPointToContainerPoint(t.layerPoint).y)};return _.template(e)(r)},are_feature_info_layers_active:function(e){return _.filter(e,function(e){return Renderers[e.renderer_id].get_feature_info_url}).length>0},layer_has_click_info:function(e){return!(!e||!Renderers[e.renderer_id])&&!!(Renderers[e.renderer_id].find_geo_json||Renderers[e.renderer_id].get_feature_info_xml_url||Renderers[e.renderer_id].get_feature_info_url)},get_details:function(e,t){var n=e.get("layers.active"),r=e.get("map"),a=_.filter(n,function(e){return!e.is_hidden&&Controllers.FeatureInfo.layer_has_click_info(e)});a.length>0&&(e.set("map_details.feature_info_responses",{}),e.set("map_details.feature_info_requests",[]),e.set("map_details.location",t.latlng),_.each(a,function(n){var a=Renderers[n.renderer_id],o=_.cloneDeep(e.get("map_details.feature_info_requests")),s=n.id+"-"+Date.now(),i=function(t,r){a.got_feature_info_response&&a.got_feature_info_response(n,r).then(function(n){e.set("map_details.feature_info_responses."+t+"."+n.keypath,n.value)})};if(o.push({name:n.name,active_layer:n,response_id:s}),e.set("map_details.feature_info_requests",_.sortBy(o,"name")),a.get_feature_info_url){var l=a.get_feature_info_url(n),u=Controllers.FeatureInfo.get_gfi_url(l,t,r);$.ajax(u,{dataType:"json",success:function(r){e.get("map_details.location")===t.latlng&&(i(s,r),e.set("map_details.feature_info_responses."+s,{active_layer:n,json:r}))},error:function(r){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+s,{active_layer:n,error:r.responseText})}})}else if(a.get_feature_info_xml_url){var l=a.get_feature_info_xml_url(n),u=Controllers.FeatureInfo.get_gfi_url(l,t,r);$.ajax(u,{dataType:"xml",success:function(r){e.get("map_details.location")===t.latlng&&(i(s,r),e.set("map_details.feature_info_responses."+s,{active_layer:n,xml:r}))},error:function(r){e.get("map_details.location")===t.latlng&&e.set("map_details.feature_info_responses."+s,{active_layer:n,error:r.responseText})}})}else if(a.find_geo_json){var f=a.find_geo_json(r,n,t);if(f)i(s,f),e.set("map_details.feature_info_responses."+s,{active_layer:n,geojson:f});else{var d=e.get("map_details.feature_info_requests");e.set("map_details.feature_info_requests",_.without(d,_.find(d,{response_id:s})))}}}))}};
</script>

    <script> var Views = {}; </script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/views/utils.js */
var ViewUtils={add_sign:function(n){var t=" ";return n>0?t="+":n<0&&(t="-"),"<span class='sign'>"+t+"</span>"+Math.abs(n)},contains:function(n,t){return _.includes(n,t)},object_entries_count:function(n){return Object.keys(n).length},to_fixed:function(n,t){return n.toFixed(t||2)},color_range_label:function(n,t,r,e,u,i){var o="";return e||0===e||(e=2),r<n.length?(o=n[r].toFixed(e),u?ViewUtils.add_sign(o):o):r>=n.length?"":void 0},sort_by:function(n,t){return _.sortBy(n,t)},capitalize:function(n){return _.capitalize(n)},to_sorted_keys_from_hash:function(n){var t=_.reduce(n,function(n,t,r){return n.push([r,t]),n},[]);return _.map(_.sortBy(t,function(n){return n[0]}),function(n){return{key:n[0],value:n[1]}})},to_sorted_values_from_hash:function(n){var t=_.reduce(n,function(n,t,r){return n.push([r,t]),n},[]);return _.map(_.sortBy(t,function(n){return n[1]}),function(n){return{key:n[0],value:n[1]}})},to_month_name:function(n){return{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}[parseInt(n,10)]},shorten_string:function(n,t,r){for(var e=[" ","/","&"],u=.8*t,n=(r=void 0!==r&&r)?n.split("").reverse().join(""):n,i="",o=0;o<t-1&&(i+=n[o],!(o>=u&&e.indexOf(n[o])>=0));o++);return r?i.split("").reverse().join(""):i},shorten_url:function(n,t){var r=(t=void 0!==t?t:50)/2;return n&&n.length>0?(n=n.replace("http://","").replace("https://","")).length<=t?n:ViewUtils.shorten_string(n,r,!1)+".."+ViewUtils.shorten_string(n,r,!0):n}};
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/views/map.js */
var LeafletMap=L.map("map",{zoomControl:!1}),z_indexes={base:0,layers:1e3};L.control.scale().addTo(LeafletMap),LeafletMap.on("zoomend",function(e){Views.ControlPanel.set("map_state.zoom",LeafletMap.getZoom())}),LeafletMap.on("moveend",function(e){Views.ControlPanel.set("map_state.center",LeafletMap.getCenter())}),LeafletMap.on("click",function(e){Controllers.FeatureInfo.get_details(Views.ControlPanel,e)}),LeafletMap.createPane(BASELAYER_PANE);
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/views/control_panel.js */
Views.ControlPanel=new Ractive({template:"#control_panel_template",el:"control_panel_root",data:{u:ViewUtils,CDN:CDN,sharing_url:function(e){return Controllers.Sharing.sharing_url(e)},out_of_view_layers:function(e,n){return _.select(e,function(e){var t=e.parameters.min_zoom||-1,o=e.parameters.max_zoom||100;return!e.is_hidden&&(n<t||n>o)})},all_active_hidden:function(e){return!0===_.uniq(_.pluck(e,"is_hidden"))[0]},layer_load_state_error_count:function(e,n){return(e[n]?e[n].errors:0)+" Errors"},fixed_precision:function(e,n){return e?e.toFixed(n):e},layer_load_state:function(e,n){var t="",o=e[n]?e[n].errors:0,a=e[n]?e[n].loaded:0;return o>0&&0===a?t="danger":o>0&&a>0?t="warning":0===o&&a>0&&(t="success"),t},all_active_collapsed:function(e){return!0===_.uniq(_.pluck(e,"is_collapsed"))[0]},able_to_copy:function(e){return!!(e&&Renderers[e.renderer_id]&&Renderers[e.renderer_id].clone_layer_name)},layer_has_standalone_wizard:function(e){return!!e&&!!e.parameters.standalone_wizard},layer_has_click_info:function(e){return Controllers.FeatureInfo.layer_has_click_info(e)},get_layer_defaults:function(e,n){return _.find(e,"id",n)||{}},is_active_layer:function(e,n){return Controllers.Layers.is_active_layer(e,n)},is_sector_selected:function(e,n){return _.contains(e,n)},selected_sectors_text:function(e){return 0===e.length?"All Sectors":e.join(", ")},sectors:{all:[],selected:[]},layers:{defaults:[],available_ids:[],active:[],tree:[]},map:LeafletMap,has_geolocation:!!navigator.geolocation,layer_controls:{current_layer_info:null,active_tab:"layers",search_string:"",search_results:[],tray:{open:!0}},layers_loading_states:{},map_state:{zoom:null,center:null},zoom_max:16,parameters:{},base_layers:[],active_base_layer:null,map_controls:{active_base_layer:null,base_layer_control_open:!1},map_details:{feature_info_requests:null,location:null},sharing_modal:{open:!1},wizard:{adding_layers_popup:!1,open:!1,current_step:0,steps:["welcome","sidebar_intro","base_layers","adding_things","find_more_info","order_layers","using_legends_tab","printing","advanced_layer_controls"]},climate_vulnerability:{show:!1,town:"",towns:CLIMATE_VULNERABILITY_TOWNS,features:[],all_features:Object.keys(RendererTemplates.ma_climate_vulnerability_layers()).sort()}},decorators:{tooltip:RactiveTooltip}}),Views.ControlPanel.on({"remove-layer-add-notice":function(e){e.original.stopPropagation(),e.original.preventDefault(),Views.ControlPanel.set("wizard.adding_layers_popup",!1)},"show-layers-control":function(e){var n=Views.ControlPanel;"layers"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","layers"))},"show-details-control":function(e){var n=Views.ControlPanel;"details"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","details"))},"show-search-control":function(e){var n=Views.ControlPanel;"search"===n.get("layer_controls.active_tab")?n.set("layer_controls.tray.open",!n.get("layer_controls.tray.open")):(n.set("layer_controls.tray.open",!0),n.set("layer_controls.active_tab","search"))},"map-zoom-in":function(e){Views.ControlPanel.get("map").zoomIn()},"map-zoom-out":function(e){Views.ControlPanel.get("map").zoomOut()},"map-set-view":function(e,n,t){Views.ControlPanel.get("map").setView(n,t)},"map-set-bbox":function(e,n,t,o,a){Views.ControlPanel.get("map").fitBounds(new L.LatLngBounds(new L.LatLng(t,n),new L.LatLng(a,o)))},"map-zoom-home":function(e){var n=Views.ControlPanel.get("map"),t=Views.ControlPanel.get("parameters.bounding-box");t?n.fitBounds(new L.LatLngBounds(new L.LatLng(t[1],t[0]),new L.LatLng(t[3],t[2]))):n.setView([42.4,-76],6)},"map-zoom-me":function(e){var n=Views.ControlPanel.get("map");navigator.geolocation.getCurrentPosition(function(e){n.setView({lat:e.coords.latitude,lng:e.coords.longitude},14)},function(){console.log("Failed to geo-locate")},{enableHighAccuracy:!0,timeout:5e3,maximumAge:72e4})},"update-layers-parameters":function(e){var n=Views.ControlPanel;Controllers.Layers.update_layers_parameters(n,e)},"tile-layer-loaded":function(e,n,t,o,a,r,l,s){var i=Views.ControlPanel;Controllers.Layers.mark_layer_as_loaded(i,n,!0,t)},"tile-layer-loading-error":function(e,n){var t=Views.ControlPanel;Controllers.Layers.mark_layer_as_loaded(t,n,!1)},"activate-base-layer":function(e){Views.ControlPanel.set("map_controls.active_base_layer",e.get().name)},"toggle-base-layer-control":function(e){var n=Views.ControlPanel;n.set("map_controls.base_layer_control_open",!n.get("map_controls.base_layer_control_open"))},"toggle-layer-active":function(e){var n=Views.ControlPanel;Controllers.Layers.toggle_layer_active(n,e.get()),"true"!==document.cookie.replace(/(?:(?:^|.*;\s*)seen_adding_layers_popup\s*\=\s*([^;]*).*$)|^.*$/,"$1")&&Views.ControlPanel.set("wizard.adding_layers_popup",!0),document.cookie="seen_adding_layers_popup=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"},"move-active-to-top":function(e){var n=Views.ControlPanel;Controllers.Layers.move_active_to_top(n,e)},"make-active-hidden":function(e){var n=Views.ControlPanel;Controllers.Layers.make_active_hidden(n,e)},"make-active-visible":function(e){var n=Views.ControlPanel;Controllers.Layers.make_active_visible(n,e)},"expand-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.expand_all_layers(n,e)},"visible-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.visible_all_layers(n,e)},"hide-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.hide_all_layers(n,e)},"collapse-all-layers":function(e){var n=Views.ControlPanel;Controllers.Layers.collapse_all_layers(n,e)},"toggle-active-collapsed":function(e){var n=Views.ControlPanel;Controllers.Layers.toggle_active_collapsed(n,e)},"remove-active":function(e){var n=Views.ControlPanel;Controllers.Layers.remove_active(n,e)},"toggle-layer-group-collapse":function(e){Views.ControlPanel;var n=!e.get().is_expanded;e.set("is_expanded",n)},"show-layer-info":function(e){var n=Views.ControlPanel;e.original.stopPropagation(),e.original.preventDefault(),n.set("layer_controls.current_layer_info",e.get())},"show-active-layer-info":function(e){Views.ControlPanel.set("layer_controls.current_layer_info",e.get().layer_default_id),e.original.stopPropagation(),e.original.preventDefault()},"hide-feature-info-modal":function(e){Views.ControlPanel.set("map_details.location",null)},"hide-layer-info-modal":function(e){Views.ControlPanel.set("layer_controls.current_layer_info",null)},"deactivate-all-layers":function(e){Controllers.Layers.deactivate_all(Views.ControlPanel)},"zoom-to-search-result":function(e){var n=Views.ControlPanel.get("map"),t=e.get().geometry.bounds;t?n.fitBounds([[t.northeast.lat,t.northeast.lng],[t.southwest.lat,t.southwest.lng]]):n.setView([e.get().geometry.location.lat,e.get().geometry.location.lng],15)},"print-map":function(e){var n=Views.ControlPanel,t=n.get("layer_controls.tray.open");n.set("layer_controls.tray.open",!1),window.print(),n.set("layer_controls.tray.open",t)},"clear-layers-search-query":function(e){Views.ControlPanel.set("layers.search_string",""),$("#layers_search_input").focus()},"clear-search-query":function(e){Views.ControlPanel.set("layer_controls.search_string",""),$("#search_input").focus()},"clone-active-layer":function(e){var n=Views.ControlPanel;Controllers.Layers.add_cloned_layer(n,e.get(),"testly")},"open-sharing-modal":function(e){var n=Views.ControlPanel;Controllers.Sharing.open_sharing(n,e)},"request-share-link-token":function(e){Views.ControlPanel.set("sharing_modal.token","loading"),Controllers.Sharing.save_state(Controllers.Sharing.get_save_data(Views.ControlPanel),function(e){Views.ControlPanel.set("sharing_modal.token",e),Controllers.Sharing.add_token_copy(Views.ControlPanel)})},"hide-sharing-modal":function(e){var n=Views.ControlPanel;Controllers.Sharing.hide_sharing(n,e)},"show-wizard":function(e){var n=Views.ControlPanel;n.get("wizard.current_step")&&n.set("wizard.current_step",0),n.set("wizard.open",!0)},"next-wizard":function(e){var n=Views.ControlPanel;n.set("wizard.current_step",(1+n.get("wizard.current_step"))%n.get("wizard.steps").length)},"wizard-sidebar-intro":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"sidebar_intro"===e}))},"wizard-base-layers":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"base_layers"===e}))},"wizard-adding-things":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"adding_things"===e}))},"wizard-find-more-info":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"find_more_info"===e}))},"wizard-order-layers":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"order_layers"===e}))},"wizard-using-legends-tab":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"using_legends_tab"===e}))},"wizard-printing":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"printing"===e}))},"wizard-advanced-layer-controls":function(e){Views.ControlPanel.set("wizard.current_step",_.findIndex(Views.ControlPanel.get("wizard.steps"),function(e){return"advanced_layer_controls"===e}))},"prev-wizard":function(e){var n=Views.ControlPanel,t=n.get("wizard.current_step"),o=n.get("wizard.steps").length,a=t-1;a<0&&(a+=o),n.set("wizard.current_step",a)},"show-standalone-wizard":function(e){Views.ControlPanel.set("wizard.standalone",e.get().parameters.standalone_wizard)},"toggle-climate-vulnerability-wizard":function(e){Views.ControlPanel.set("climate_vulnerability.show",!Views.ControlPanel.get("climate_vulnerability.show"))},"show-climate-vulnerability-layer":function(e){$("#map").toggleClass("vuln-report-showing",!0);var n=Views.ControlPanel.get("map"),t=Views.ControlPanel.get("climate_vulnerability.town"),o=e.node.attributes["climate-vuln"].value;Views.ClimateVulnerability.add_layers(n,t,o),e.original.stopPropagation(),e.original.preventDefault()},"hide-climate-vulnerability-layer":function(e){Views.ControlPanel.set("climate_vulnerability.show_report",!1),$("#map").toggleClass("vuln-report-showing",!1),e.original.stopPropagation(),e.original.preventDefault()},"toggle-climate-vulnerability-feature":function(e){var n=Views.ControlPanel.get("climate_vulnerability.features",[]);_.includes(n,e.get())?n=_.without(n,e.get()):n.push(e.get()),Views.ControlPanel.set("climate_vulnerability.features",n)},"close-standalone-wizard":function(e){Views.ControlPanel.set("wizard.standalone",null)},"close-wizard":function(e){Views.ControlPanel.set("wizard.open",!1)},"toggle-show-feature-info-response-details":function(e){Views.ControlPanel;e.set("show_error_details",!e.get().show_error_details)},"zoom-to-view-layer":function(e){var n=Views.ControlPanel,t=Views.ControlPanel.get("map"),o=n.get("map_state.zoom"),a=e.get().parameters.min_zoom,r=e.get().parameters.max_zoom;a&&o<a?t.setZoom(a):r&&o>r&&t.setZoom(r)},"toggle-sector-dropdown":function(e){var n=Views.ControlPanel;n.set("sectors.show_dropdown",!n.get("sectors.show_dropdown"))},"toggle-sector-selection":function(e){var n=Views.ControlPanel,t="sectors.selected",o=n.get(t);_.contains(o,e.get())?n.set(t,_.without(o,e.get())):n.set(t,o.concat(e.get()))},"clear-sector-dropdown":function(e){var n=Views.ControlPanel;n.get("sectors.selected");n.set("sectors.selected",[]),n.set("sectors.show_dropdown",!1)},"open-layer-import-modal":function(e){Views.ControlPanel.set("layer_import.show_modal",!0),e.original.stopPropagation(),e.original.preventDefault()},"close-layer-import-modal":function(e){Views.ControlPanel.set("layer_import.show_modal",!1),e.original.stopPropagation(),e.original.preventDefault()},"upload-layer-import-file":function(e){var n=Views.ControlPanel;Controllers.LayerImport.import_layer(n,e.get().layer_import.import_file[0]),e.original.stopPropagation(),e.original.preventDefault()}}),Views.ControlPanel.observe("layer_controls.search_string",function(e){var n=Views.ControlPanel;e.length>1?Controllers.Search.execute_search(e,function(e,t){n.get("layer_controls.search_string")===e&&n.set("layer_controls.search_results",t)}):n.set("layer_controls.search_results",[])}),Views.ControlPanel.observe("parameters.bounding-box",function(e){var n=Views.ControlPanel.get("map");if(e){var t=new L.LatLng(e[1],e[0]),o=new L.LatLng(e[3],e[2]);n.fitBounds(new L.LatLngBounds(t,o))}}),Views.ControlPanel.observe("parameters.available-layers",function(e){if(e){var n=Views.ControlPanel;Controllers.Layers.set_available_layer_ids(n,e)}}),Views.ControlPanel.observe("parameters.active-layers",function(e){var n=Views.ControlPanel;e&&Controllers.Layers.force_layers_active(n,e)}),Views.ControlPanel.observe("map_controls.active_base_layer",function(e){var n=Views.ControlPanel.get("map"),t=Views.ControlPanel.get("base_layers"),o=_.find(t,function(n){return n.name===e}),a=_.reject(t,o);o&&(_.each(a,function(e){n.hasLayer(e.data)&&n.removeLayer(e.data)}),"None"===o.name||(n.addLayer(o.data),o.data.setZIndex(z_indexes.base)))}),Views.ControlPanel.on("layer-show-singleton-details",function(e,n,t){var o=Views.ControlPanel;o.set("map_details.location",!0),o.set("map_details.feature_info_requests",[{name:n.name,active_layer:n,response_id:"singleton"}]),o.set("map_details.feature_info_responses",{singleton:t})}),Views.ControlPanel.observe("layers.defaults",function(e){if(e)var n=Views.ControlPanel;n.set("sectors.all",_.uniq(_.compact(_.flatten(_.pluck(e,"sectors")))).sort())}),Views.ControlPanel.observe("layers.available_ids",function(e){if(e){var n=Views.ControlPanel;Controllers.Layers.ensure_active_are_available(n),Controllers.Layers.update_layer_tree(n)}}),Views.ControlPanel.observe("sectors.selected",function(e){var n=Views.ControlPanel;Controllers.Layers.update_layer_tree(n),Controllers.Layers.expand_all_layers(n)}),Views.ControlPanel.observe("layers.search_string",function(e){var n=Views.ControlPanel;Controllers.Layers.update_layer_tree(n)}),Views.ControlPanel.observe("layers.active",function(e,n){var t=Views.ControlPanel.get("map"),o=Views.ControlPanel;_.each(n,function(n){_.find(e,"id",n.id)||Renderers.remove(t,n)}),_.map(e,function(n){var o=_.findIndex(_.cloneDeep(e).reverse(),"id",n.id),a=z_indexes.layers+o;Renderers.render(t,n,a)}),o.update("layers.active"),t.closePopup()}),Views.ControlPanel.observe("map_details.location",function(e){var n=Views.ControlPanel.get("map"),t=Views.ControlPanel,o=t.get("map_details.location_marker");!0!==e&&e?(o&&o.getLatLng()!==e&&(n.removeLayer(o),o=null,t.set("map_details.location_marker",o)),o||(o=new L.marker(e),t.set("map_details.location_marker",o),o.addTo(n))):o&&(n.removeLayer(o),o=null,t.set("map_details.location_marker",o))}),Views.ControlPanel.observe("base_layers",function(e){!Views.ControlPanel.get("map_controls.active_base_layer")&&e.length>0&&Views.ControlPanel.set("map_controls.active_base_layer",e[0].name)}),Views.ControlPanel.observe("layer_controls.tray.open",function(e){$("#map").toggleClass("tray-open",e);var n=Views.ControlPanel.get("map");n&&n.invalidateSize()});
</script>
    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/views/climate_vulnerability.js */
Views.ClimateVulnerability={layers:{heat:["impervious_surface","extreme_heat_tract"],drought:["land_use_2005_ag","vernal_pools"],flooding:["nfhl","nfhl_roads","nfhl_parcels"]},add_layers:function(e,a,r){var t=Views.ControlPanel;_.pluck(Views.ControlPanel.get("layers.active"),"layer_default_id");Controllers.Layers.hide_all_layers(t,{});var l=Views.ClimateVulnerability.layers[r];Controllers.Layers.force_layers_active(t,l),Controllers.Layers.remove_active(t,{context:{id:"vaw_towns"}});Controllers.Layers.add_custom_layer(t,{id:"vaw_towns",name:a+" Boundary "},{town:a});setTimeout(function(){Controllers.Search.execute_search(a+", MA, USA",function(e,a){Views.ControlPanel.fire("zoom-to-search-result",{},{context:a.results[0]})})},500),t.set("climate_vulnerability.show_report",{town:a,hazard:r}),setTimeout(function(){e.invalidateSize()},0)}};
</script>

    <script> /* /Users/cfitzhugh/working/ma-ccc-map/src/js/init.js */
var all_layer_ids=_.pluck(available_layers,"id"),parameters=API_Handler.get_parameters(window.location.search.substr(1),all_layer_ids);Views.ControlPanel.set({base_layers:BaseLayers}),Views.ControlPanel.set("layers.defaults",available_layers),Views.ControlPanel.set({parameters:parameters});var params=URI.parseQuery(window.location.search);if(params.map_state_token&&Controllers.Sharing.load_state(params.map_state_token,Views.ControlPanel,LeafletMap),params.climate_vulnerability&&Views.ControlPanel.set("tools.climate_vulnerability",!0),params.sectors&&Views.ControlPanel.set("sectors.selected",params.sectors.split(",")),"true"!==document.cookie.replace(/(?:(?:^|.*;\s*)show_welcome_modal_to_new_users\s*\=\s*([^;]*).*$)|^.*$/,"$1")&&(Views.ControlPanel.fire("show-wizard"),document.cookie="show_welcome_modal_to_new_users=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"),desired_active_on_load.length>0){var already_active_layers=_.pluck(Views.ControlPanel.get("layers.active"),"layer_default_id");Controllers.Layers.force_layers_active(Views.ControlPanel,already_active_layers.concat(desired_active_layer_ids))}
</script>
</body>
</html>
